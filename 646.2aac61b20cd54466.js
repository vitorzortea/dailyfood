(self.webpackChunkdailyfood=self.webpackChunkdailyfood||[]).push([[646],{1646:(oh,q,K)=>{"use strict";K.r(q),K.d(q,{PanelModule:()=>E0});var $e=K(6895),x=K(9392),In=K(5226),vt=K.n(In),y=K(4650),Ke=K(4004),V=(()=>{return(n=V||(V={}))[n.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",n[n.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",n[n.CLASS_TO_CLASS=2]="CLASS_TO_CLASS",V;var n})();const Ve=new class Nt{constructor(){this._typeMetadatas=new Map,this._transformMetadatas=new Map,this._exposeMetadatas=new Map,this._excludeMetadatas=new Map,this._ancestorsMap=new Map}addTypeMetadata(e){this._typeMetadatas.has(e.target)||this._typeMetadatas.set(e.target,new Map),this._typeMetadatas.get(e.target).set(e.propertyName,e)}addTransformMetadata(e){this._transformMetadatas.has(e.target)||this._transformMetadatas.set(e.target,new Map),this._transformMetadatas.get(e.target).has(e.propertyName)||this._transformMetadatas.get(e.target).set(e.propertyName,[]),this._transformMetadatas.get(e.target).get(e.propertyName).push(e)}addExposeMetadata(e){this._exposeMetadatas.has(e.target)||this._exposeMetadatas.set(e.target,new Map),this._exposeMetadatas.get(e.target).set(e.propertyName,e)}addExcludeMetadata(e){this._excludeMetadatas.has(e.target)||this._excludeMetadatas.set(e.target,new Map),this._excludeMetadatas.get(e.target).set(e.propertyName,e)}findTransformMetadatas(e,t,s){return this.findMetadatas(this._transformMetadatas,e,t).filter(r=>!r.options||!0===r.options.toClassOnly&&!0===r.options.toPlainOnly||(!0===r.options.toClassOnly?s===V.CLASS_TO_CLASS||s===V.PLAIN_TO_CLASS:!0!==r.options.toPlainOnly||s===V.CLASS_TO_PLAIN))}findExcludeMetadata(e,t){return this.findMetadata(this._excludeMetadatas,e,t)}findExposeMetadata(e,t){return this.findMetadata(this._exposeMetadatas,e,t)}findExposeMetadataByCustomName(e,t){return this.getExposedMetadatas(e).find(s=>s.options&&s.options.name===t)}findTypeMetadata(e,t){return this.findMetadata(this._typeMetadatas,e,t)}getStrategy(e){const t=this._excludeMetadatas.get(e),s=t&&t.get(void 0),r=this._exposeMetadatas.get(e),i=r&&r.get(void 0);return s&&i||!s&&!i?"none":s?"excludeAll":"exposeAll"}getExposedMetadatas(e){return this.getMetadata(this._exposeMetadatas,e)}getExcludedMetadatas(e){return this.getMetadata(this._excludeMetadatas,e)}getExposedProperties(e,t){return this.getExposedMetadatas(e).filter(s=>!s.options||!0===s.options.toClassOnly&&!0===s.options.toPlainOnly||(!0===s.options.toClassOnly?t===V.CLASS_TO_CLASS||t===V.PLAIN_TO_CLASS:!0!==s.options.toPlainOnly||t===V.CLASS_TO_PLAIN)).map(s=>s.propertyName)}getExcludedProperties(e,t){return this.getExcludedMetadatas(e).filter(s=>!s.options||!0===s.options.toClassOnly&&!0===s.options.toPlainOnly||(!0===s.options.toClassOnly?t===V.CLASS_TO_CLASS||t===V.PLAIN_TO_CLASS:!0!==s.options.toPlainOnly||t===V.CLASS_TO_PLAIN)).map(s=>s.propertyName)}clear(){this._typeMetadatas.clear(),this._exposeMetadatas.clear(),this._excludeMetadatas.clear(),this._ancestorsMap.clear()}getMetadata(e,t){const s=e.get(t);let r;s&&(r=Array.from(s.values()).filter(o=>void 0!==o.propertyName));const i=[];for(const o of this.getAncestors(t)){const a=e.get(o);if(a){const l=Array.from(a.values()).filter(h=>void 0!==h.propertyName);i.push(...l)}}return i.concat(r||[])}findMetadata(e,t,s){const r=e.get(t);if(r){const i=r.get(s);if(i)return i}for(const i of this.getAncestors(t)){const o=e.get(i);if(o){const a=o.get(s);if(a)return a}}}findMetadatas(e,t,s){const r=e.get(t);let i;r&&(i=r.get(s));const o=[];for(const a of this.getAncestors(t)){const l=e.get(a);l&&l.has(s)&&o.push(...l.get(s))}return o.slice().reverse().concat((i||[]).slice().reverse())}getAncestors(e){if(!e)return[];if(!this._ancestorsMap.has(e)){const t=[];for(let s=Object.getPrototypeOf(e.prototype.constructor);typeof s.prototype<"u";s=Object.getPrototypeOf(s.prototype.constructor))t.push(s);this._ancestorsMap.set(e,t)}return this._ancestorsMap.get(e)}};class bt{constructor(e,t){this.transformationType=e,this.options=t,this.recursionStack=new Set}transform(e,t,s,r,i,o=0){if(Array.isArray(t)||t instanceof Set){const a=r&&this.transformationType===V.PLAIN_TO_CLASS?function bs(n){const e=new n;return e instanceof Set||"push"in e?e:[]}(r):[];return t.forEach((l,h)=>{const f=e?e[h]:void 0;if(this.options.enableCircularCheck&&this.isCircular(l))this.transformationType===V.CLASS_TO_CLASS&&(a instanceof Set?a.add(l):a.push(l));else{let p;if("function"!=typeof s&&s&&s.options&&s.options.discriminator&&s.options.discriminator.property&&s.options.discriminator.subTypes){if(this.transformationType===V.PLAIN_TO_CLASS){p=s.options.discriminator.subTypes.find(S=>S.name===l[s.options.discriminator.property]);const T=s.typeFunction({newObject:a,object:l,property:void 0});p=void 0===p?T:p.value,s.options.keepDiscriminatorProperty||delete l[s.options.discriminator.property]}this.transformationType===V.CLASS_TO_CLASS&&(p=l.constructor),this.transformationType===V.CLASS_TO_PLAIN&&(l[s.options.discriminator.property]=s.options.discriminator.subTypes.find(w=>w.value===l.constructor).name)}else p=s;const g=this.transform(f,l,p,void 0,l instanceof Map,o+1);a instanceof Set?a.add(g):a.push(g)}}),a}if(s===String&&!i)return null==t?t:String(t);if(s===Number&&!i)return null==t?t:Number(t);if(s===Boolean&&!i)return null==t?t:Boolean(t);if((s===Date||t instanceof Date)&&!i)return t instanceof Date?new Date(t.valueOf()):null==t?t:new Date(t);if(function tc(){return typeof globalThis<"u"?globalThis:typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:void 0}().Buffer&&(s===Buffer||t instanceof Buffer)&&!i)return null==t?t:Buffer.from(t);if(function nc(n){return null!==n&&"object"==typeof n&&"function"==typeof n.then}(t)&&!i)return new Promise((a,l)=>{t.then(h=>a(this.transform(void 0,h,s,void 0,void 0,o+1)),l)});if(!i&&null!==t&&"object"==typeof t&&"function"==typeof t.then)return t;if("object"==typeof t&&null!==t){!s&&t.constructor!==Object&&(!Array.isArray(t)&&t.constructor===Array||(s=t.constructor)),!s&&e&&(s=e.constructor),this.options.enableCircularCheck&&this.recursionStack.add(t);const a=this.getKeys(s,t,i);let l=e||{};!e&&(this.transformationType===V.PLAIN_TO_CLASS||this.transformationType===V.CLASS_TO_CLASS)&&(l=i?new Map:s?new s:{});for(const h of a){if("__proto__"===h||"constructor"===h)continue;const f=h;let w,p=h,g=h;if(!this.options.ignoreDecorators&&s)if(this.transformationType===V.PLAIN_TO_CLASS){const N=Ve.findExposeMetadataByCustomName(s,h);N&&(g=N.propertyName,p=N.propertyName)}else if(this.transformationType===V.CLASS_TO_PLAIN||this.transformationType===V.CLASS_TO_CLASS){const N=Ve.findExposeMetadata(s,h);N&&N.options&&N.options.name&&(p=N.options.name)}w=this.transformationType===V.PLAIN_TO_CLASS?t[f]:t instanceof Map?t.get(f):t[f]instanceof Function?t[f]():t[f];let T,S=w instanceof Map;if(s&&i)T=s;else if(s){const N=Ve.findTypeMetadata(s,g);if(N){const le=N.typeFunction?N.typeFunction({newObject:l,object:t,property:g}):N.reflectedType;N.options&&N.options.discriminator&&N.options.discriminator.property&&N.options.discriminator.subTypes?t[f]instanceof Array?T=N:(this.transformationType===V.PLAIN_TO_CLASS&&(T=N.options.discriminator.subTypes.find(z=>{if(w&&w instanceof Object&&N.options.discriminator.property in w)return z.name===w[N.options.discriminator.property]}),T=void 0===T?le:T.value,N.options.keepDiscriminatorProperty||w&&w instanceof Object&&N.options.discriminator.property in w&&delete w[N.options.discriminator.property]),this.transformationType===V.CLASS_TO_CLASS&&(T=w.constructor),this.transformationType===V.CLASS_TO_PLAIN&&w&&(w[N.options.discriminator.property]=N.options.discriminator.subTypes.find(z=>z.value===w.constructor).name)):T=le,S=S||N.reflectedType===Map}else if(this.options.targetMaps)this.options.targetMaps.filter(L=>L.target===s&&!!L.properties[g]).forEach(L=>T=L.properties[g]);else if(this.options.enableImplicitConversion&&this.transformationType===V.PLAIN_TO_CLASS){const L=Reflect.getMetadata("design:type",s.prototype,g);L&&(T=L)}}const P=Array.isArray(t[f])?this.getReflectedType(s,g):void 0,te=e?e[f]:void 0;if(l.constructor.prototype){const N=Object.getOwnPropertyDescriptor(l.constructor.prototype,p);if((this.transformationType===V.PLAIN_TO_CLASS||this.transformationType===V.CLASS_TO_CLASS)&&(N&&!N.set||l[p]instanceof Function))continue}if(this.options.enableCircularCheck&&this.isCircular(w)){if(this.transformationType===V.CLASS_TO_CLASS){let N=w;N=this.applyCustomTransformations(N,s,h,t,this.transformationType),(void 0!==N||this.options.exposeUnsetFields)&&(l instanceof Map?l.set(p,N):l[p]=N)}}else{const N=this.transformationType===V.PLAIN_TO_CLASS?p:h;let L;this.transformationType===V.CLASS_TO_PLAIN?(L=t[N],L=this.applyCustomTransformations(L,s,N,t,this.transformationType),L=t[N]===L?w:L,L=this.transform(te,L,T,P,S,o+1)):void 0===w&&this.options.exposeDefaultValues?L=l[p]:(L=this.transform(te,w,T,P,S,o+1),L=this.applyCustomTransformations(L,s,N,t,this.transformationType)),(void 0!==L||this.options.exposeUnsetFields)&&(l instanceof Map?l.set(p,L):l[p]=L)}}return this.options.enableCircularCheck&&this.recursionStack.delete(t),l}return t}applyCustomTransformations(e,t,s,r,i){let o=Ve.findTransformMetadatas(t,s,this.transformationType);return void 0!==this.options.version&&(o=o.filter(a=>!a.options||this.checkVersion(a.options.since,a.options.until))),o=o.filter(this.options.groups&&this.options.groups.length?a=>!a.options||this.checkGroups(a.options.groups):a=>!a.options||!a.options.groups||!a.options.groups.length),o.forEach(a=>{e=a.transformFn({value:e,key:s,obj:r,type:i,options:this.options})}),e}isCircular(e){return this.recursionStack.has(e)}getReflectedType(e,t){if(!e)return;const s=Ve.findTypeMetadata(e,t);return s?s.reflectedType:void 0}getKeys(e,t,s){let r=Ve.getStrategy(e);"none"===r&&(r=this.options.strategy||"exposeAll");let i=[];if(("exposeAll"===r||s)&&(i=t instanceof Map?Array.from(t.keys()):Object.keys(t)),s)return i;if(this.options.ignoreDecorators&&this.options.excludeExtraneousValues&&e&&(i=[...Ve.getExposedProperties(e,this.transformationType),...Ve.getExcludedProperties(e,this.transformationType)]),!this.options.ignoreDecorators&&e){let o=Ve.getExposedProperties(e,this.transformationType);this.transformationType===V.PLAIN_TO_CLASS&&(o=o.map(l=>{const h=Ve.findExposeMetadata(e,l);return h&&h.options&&h.options.name?h.options.name:l})),i=this.options.excludeExtraneousValues?o:i.concat(o);const a=Ve.getExcludedProperties(e,this.transformationType);a.length>0&&(i=i.filter(l=>!a.includes(l))),void 0!==this.options.version&&(i=i.filter(l=>{const h=Ve.findExposeMetadata(e,l);return!h||!h.options||this.checkVersion(h.options.since,h.options.until)})),i=i.filter(this.options.groups&&this.options.groups.length?l=>{const h=Ve.findExposeMetadata(e,l);return!h||!h.options||this.checkGroups(h.options.groups)}:l=>{const h=Ve.findExposeMetadata(e,l);return!(h&&h.options&&h.options.groups&&h.options.groups.length)})}return this.options.excludePrefixes&&this.options.excludePrefixes.length&&(i=i.filter(o=>this.options.excludePrefixes.every(a=>o.substr(0,a.length)!==a))),i=i.filter((o,a,l)=>l.indexOf(o)===a),i}checkVersion(e,t){let s=!0;return s&&e&&(s=this.options.version>=e),s&&t&&(s=this.options.version<t),s}checkGroups(e){return!e||this.options.groups.some(t=>e.includes(t))}}const at={enableCircularCheck:!1,enableImplicitConversion:!1,excludeExtraneousValues:!1,excludePrefixes:void 0,exposeDefaultValues:!1,exposeUnsetFields:!0,groups:void 0,ignoreDecorators:!1,strategy:void 0,targetMaps:void 0,version:void 0},se=new class kr{instanceToPlain(e,t){return new bt(V.CLASS_TO_PLAIN,{...at,...t}).transform(void 0,e,void 0,void 0,void 0,void 0)}classToPlainFromExist(e,t,s){return new bt(V.CLASS_TO_PLAIN,{...at,...s}).transform(t,e,void 0,void 0,void 0,void 0)}plainToInstance(e,t,s){return new bt(V.PLAIN_TO_CLASS,{...at,...s}).transform(void 0,t,e,void 0,void 0,void 0)}plainToClassFromExist(e,t,s){return new bt(V.PLAIN_TO_CLASS,{...at,...s}).transform(e,t,void 0,void 0,void 0,void 0)}instanceToInstance(e,t){return new bt(V.CLASS_TO_CLASS,{...at,...t}).transform(void 0,e,void 0,void 0,void 0,void 0)}classToClassFromExist(e,t,s){return new bt(V.CLASS_TO_CLASS,{...at,...s}).transform(t,e,void 0,void 0,void 0,void 0)}serialize(e,t){return JSON.stringify(this.instanceToPlain(e,t))}deserialize(e,t,s){const r=JSON.parse(t);return this.plainToInstance(e,r,s)}deserializeArray(e,t,s){const r=JSON.parse(t);return this.plainToInstance(e,r,s)}};class xt{constructor(e,t,s){this.type=e,this.firestore=t,this.caminho=s,this.ref=this.firestore.collection(this.caminho)}get(e){return this.ref.doc(e).get().pipe((0,Ke.U)(s=>this.docToClass(s)))}list(){return this.ref.valueChanges()}createOrUpdate(e){let t=e.id;if(!e)return null;let s=null;return s=e instanceof this.type?e.toObject():e,t?this.ref.doc(t).set(s):this.ref.add(s).then(r=>{s.id=r.id,this.ref.doc(r.id).set(s)})}delete(e){return this.ref.doc(e).delete()}docToClass(e){let t={id:e.id,...e.data()};return function En(n,e,t){return se.plainToInstance(n,e,t)}(this.type,t)}}class ft{toObject(){let e=function Cn(n,e){return se.instanceToPlain(n,e)}(this);return delete e.id,e}}class ic extends ft{}class Gt extends ft{}var Sn=K(4986),fo=K(9751),Pt=K(8996),xs=K(9646),Xe=K(2122),An=K(8675),Nr=K(4482),_s=K(5403);function Pr(){return(0,Nr.e)((n,e)=>{let t,s=!1;n.subscribe((0,_s.x)(e,r=>{const i=t;t=r,s&&e.next([i,r]),s=!0}))})}var k,_t=K(5026),Ge=K(1884),ut=K(9300),Ts=K(2011),Or=(K(4217),K(3942)),I=K(5861),kn=K(9681),G=K(4859),Ae=K(1877),H=K(2090),zt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ie={},Is=Is||{},B=zt||self;function ke(){}function Cs(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Ht(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Dn="closure_uid_"+(1e9*Math.random()>>>0),oc=0;function ac(n,e,t){return n.call.apply(n.bind,arguments)}function $(n,e,t){if(!n)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,s),n.apply(e,r)}}return function(){return n.apply(e,arguments)}}function De(n,e,t){return(De=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ac:$).apply(null,arguments)}function Es(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var s=t.slice();return s.push.apply(s,arguments),n.apply(this,s)}}function be(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(s,r,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(s,o)}}function Tt(){this.s=this.s,this.o=this.o}Tt.prototype.s=!1,Tt.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function po(n){Object.prototype.hasOwnProperty.call(n,Dn)&&n[Dn]||(n[Dn]=++oc)}(this)},Tt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const It=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function Lr(n){const e=n.length;if(0<e){const t=Array(e);for(let s=0;s<e;s++)t[s]=n[s];return t}return[]}function mo(n,e){for(let t=1;t<arguments.length;t++){const s=arguments[t];if(Cs(s)){const r=n.length||0,i=s.length||0;n.length=r+i;for(let o=0;o<i;o++)n[r+o]=s[o]}else n.push(s)}}function Me(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Me.prototype.h=function(){this.defaultPrevented=!0};var uc=function(){if(!B.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{B.addEventListener("test",ke,e),B.removeEventListener("test",ke,e)}catch{}return n}();function Ss(n){return/^[\s\xa0]*$/.test(n)}var As=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function Fr(n,e){return n<e?-1:n>e?1:0}function ks(){var n=B.navigator;return n&&(n=n.userAgent)?n:""}function Ue(n){return-1!=ks().indexOf(n)}function Rr(n){return Rr[" "](n),n}Rr[" "]=ke;var Ms,n,hc=Ue("Opera"),Qt=Ue("Trident")||Ue("MSIE"),Ds=Ue("Edge"),Vr=Ds||Qt,go=Ue("Gecko")&&!(-1!=ks().toLowerCase().indexOf("webkit")&&!Ue("Edge"))&&!(Ue("Trident")||Ue("MSIE"))&&!Ue("Edge"),dc=-1!=ks().toLowerCase().indexOf("webkit")&&!Ue("Edge");function yo(){var n=B.document;return n?n.documentMode:void 0}e:{var Br="",qr=(n=ks(),go?/rv:([^\);]+)(\)|;)/.exec(n):Ds?/Edge\/([\d\.]+)/.exec(n):Qt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):dc?/WebKit\/(\S+)/.exec(n):hc?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(qr&&(Br=qr?qr[1]:""),Qt){var Ur=yo();if(null!=Ur&&Ur>parseFloat(Br)){Ms=String(Ur);break e}}Ms=Br}var fc={};var Mn=B.document&&Qt&&(yo()||parseInt(Ms,10))||void 0;function Zt(n,e){if(Me.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,s=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(go){e:{try{Rr(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,s?(this.clientX=void 0!==s.clientX?s.clientX:s.pageX,this.clientY=void 0!==s.clientY?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Ps[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Zt.X.h.call(this)}}be(Zt,Me);var Ps={2:"touch",3:"pen",4:"mouse"};Zt.prototype.h=function(){Zt.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var xe="closure_listenable_"+(1e6*Math.random()|0),mc=0;function gc(n,e,t,s,r){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!s,this.ha=r,this.key=++mc,this.ba=this.ea=!1}function Os(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function Ls(n,e,t){for(const s in n)e.call(t,n[s],s,n)}function wo(n){const e={};for(const t in n)e[t]=n[t];return e}const vo="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function bo(n,e){let t,s;for(let r=1;r<arguments.length;r++){for(t in s=arguments[r],s)n[t]=s[t];for(let i=0;i<vo.length;i++)t=vo[i],Object.prototype.hasOwnProperty.call(s,t)&&(n[t]=s[t])}}function Nn(n){this.src=n,this.g={},this.h=0}function $r(n,e){var t=e.type;if(t in n.g){var i,s=n.g[t],r=It(s,e);(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(Os(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Fs(n,e,t,s){for(var r=0;r<n.length;++r){var i=n[r];if(!i.ba&&i.listener==e&&i.capture==!!t&&i.ha==s)return r}return-1}Nn.prototype.add=function(n,e,t,s,r){var i=n.toString();(n=this.g[i])||(n=this.g[i]=[],this.h++);var o=Fs(n,e,s,r);return-1<o?(e=n[o],t||(e.ea=!1)):((e=new gc(e,this.src,i,!!s,r)).ea=t,n.push(e)),e};var Kr="closure_lm_"+(1e6*Math.random()|0),Gr={};function xo(n,e,t,s,r){if(s&&s.once)return To(n,e,t,s,r);if(Array.isArray(e)){for(var i=0;i<e.length;i++)xo(n,e[i],t,s,r);return null}return t=Vs(t),n&&n[xe]?n.N(e,t,Ht(s)?!!s.capture:!!s,r):_o(n,e,t,!1,s,r)}function _o(n,e,t,s,r,i){if(!e)throw Error("Invalid event type");var o=Ht(r)?!!r.capture:!!r,a=Hr(n);if(a||(n[Kr]=a=new Nn(n)),(t=a.add(e,t,s,o,i)).proxy)return t;if(s=function yc(){const e=wc;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=s,s.src=n,s.listener=t,n.addEventListener)uc||(r=o),void 0===r&&(r=!1),n.addEventListener(e.toString(),s,r);else if(n.attachEvent)n.attachEvent(zr(e.toString()),s);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(s)}return t}function To(n,e,t,s,r){if(Array.isArray(e)){for(var i=0;i<e.length;i++)To(n,e[i],t,s,r);return null}return t=Vs(t),n&&n[xe]?n.O(e,t,Ht(s)?!!s.capture:!!s,r):_o(n,e,t,!0,s,r)}function Io(n,e,t,s,r){if(Array.isArray(e))for(var i=0;i<e.length;i++)Io(n,e[i],t,s,r);else s=Ht(s)?!!s.capture:!!s,t=Vs(t),n&&n[xe]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Fs(i=n.g[e],t,s,r))&&(Os(i[t]),Array.prototype.splice.call(i,t,1),0==i.length&&(delete n.g[e],n.h--))):n&&(n=Hr(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Fs(e,t,s,r)),(t=-1<n?e[n]:null)&&Rs(t))}function Rs(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[xe])$r(e.i,n);else{var t=n.type,s=n.proxy;e.removeEventListener?e.removeEventListener(t,s,n.capture):e.detachEvent?e.detachEvent(zr(t),s):e.addListener&&e.removeListener&&e.removeListener(s),(t=Hr(e))?($r(t,n),0==t.h&&(t.src=null,e[Kr]=null)):Os(n)}}}function zr(n){return n in Gr?Gr[n]:Gr[n]="on"+n}function wc(n,e){if(n.ba)n=!0;else{e=new Zt(e,this);var t=n.listener,s=n.ha||n.src;n.ea&&Rs(n),n=t.call(s,e)}return n}function Hr(n){return(n=n[Kr])instanceof Nn?n:null}var Qr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Vs(n){return"function"==typeof n?n:(n[Qr]||(n[Qr]=function(e){return n.handleEvent(e)}),n[Qr])}function _e(){Tt.call(this),this.i=new Nn(this),this.P=this,this.I=null}function Ie(n,e){var t,s=n.I;if(s)for(t=[];s;s=s.I)t.push(s);if(n=n.P,s=e.type||e,"string"==typeof e)e=new Me(e,n);else if(e instanceof Me)e.target=e.target||n;else{var r=e;bo(e=new Me(s,n),r)}if(r=!0,t)for(var i=t.length-1;0<=i;i--){var o=e.g=t[i];r=pt(o,s,!0,e)&&r}if(r=pt(o=e.g=n,s,!0,e)&&r,r=pt(o,s,!1,e)&&r,t)for(i=0;i<t.length;i++)r=pt(o=e.g=t[i],s,!1,e)&&r}function pt(n,e,t,s){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ba&&o.capture==t){var a=o.listener,l=o.ha||o.src;o.ea&&$r(n.i,o),r=!1!==a.call(l,s)&&r}}return r&&!s.defaultPrevented}be(_e,Tt),_e.prototype[xe]=!0,_e.prototype.removeEventListener=function(n,e,t,s){Io(this,n,e,t,s)},_e.prototype.M=function(){if(_e.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],s=0;s<t.length;s++)Os(t[s]);delete n.g[e],n.h--}}this.I=null},_e.prototype.N=function(n,e,t,s){return this.i.add(String(n),e,!1,t,s)},_e.prototype.O=function(n,e,t,s){return this.i.add(String(n),e,!0,t,s)};var Bs=B.JSON.stringify;function vc(){var n=Wt;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Xr,Wr=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new bc,n=>n.reset());class bc{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function xc(n){B.setTimeout(()=>{throw n},0)}function Co(n,e){Xr||function _c(){var n=B.Promise.resolve(void 0);Xr=function(){n.then(Tc)}}(),Yr||(Xr(),Yr=!0),Wt.add(n,e)}var Yr=!1,Wt=new class Zr{constructor(){this.h=this.g=null}add(e,t){const s=Wr.get();s.set(e,t),this.h?this.h.next=s:this.g=s,this.h=s}};function Tc(){for(var n;n=vc();){try{n.h.call(n.g)}catch(t){xc(t)}var e=Wr;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Yr=!1}function Pn(n,e){_e.call(this),this.h=n||1,this.g=e||B,this.j=De(this.lb,this),this.l=Date.now()}function Jr(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function ei(n,e,t){if("function"==typeof n)t&&(n=De(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=De(n.handleEvent,n)}return 2147483647<Number(e)?-1:B.setTimeout(n,e||0)}function Eo(n){n.g=ei(()=>{n.g=null,n.i&&(n.i=!1,Eo(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}be(Pn,_e),(k=Pn.prototype).ca=!1,k.R=null,k.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Ie(this,"tick"),this.ca&&(Jr(this),this.start()))}},k.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},k.M=function(){Pn.X.M.call(this),Jr(this),delete this.g};class Ic extends Tt{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Eo(this)}M(){super.M(),this.g&&(B.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function On(n){Tt.call(this),this.h=n,this.g={}}be(On,Tt);var So=[];function Ao(n,e,t,s){Array.isArray(t)||(t&&(So[0]=t.toString()),t=So);for(var r=0;r<t.length;r++){var i=xo(e,t[r],s||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function ko(n){Ls(n.g,function(e,t){this.g.hasOwnProperty(t)&&Rs(e)},n),n.g={}}function qs(){this.g=!0}function mt(n,e,t,s){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Sc(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var s=t[n];if(!(2>s.length)){var r=s[1];if(Array.isArray(r)&&!(1>r.length)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<r.length;o++)r[o]=""}}}return Bs(t)}catch{return e}}(n,t)+(s?" "+s:"")})}On.prototype.M=function(){On.X.M.call(this),ko(this)},On.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},qs.prototype.Aa=function(){this.g=!1},qs.prototype.info=function(){};var Ot={},Xt=null;function Us(){return Xt=Xt||new _e}function Mo(n){Me.call(this,Ot.Pa,n)}function Ln(n){const e=Us();Ie(e,new Mo(e))}function ti(n,e){Me.call(this,Ot.STAT_EVENT,n),this.stat=e}function Ne(n){const e=Us();Ie(e,new ti(e,n))}function ni(n,e){Me.call(this,Ot.Qa,n),this.size=e}function Fn(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return B.setTimeout(function(){n()},e)}Ot.Pa="serverreachability",be(Mo,Me),Ot.STAT_EVENT="statevent",be(ti,Me),Ot.Qa="timingevent",be(ni,Me);var js={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},No={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function si(){}function Oo(){}si.prototype.h=null;var oi,lt={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function ri(){Me.call(this,"d")}function ii(){Me.call(this,"c")}function Rn(){}function Yt(n,e,t,s){this.l=n,this.j=e,this.m=t,this.U=s||1,this.S=new On(this),this.O=Ac,this.T=new Pn(n=Vr?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new $s}function $s(){this.i=null,this.g="",this.h=!1}be(ri,Me),be(ii,Me),be(Rn,si),Rn.prototype.g=function(){return new XMLHttpRequest},Rn.prototype.i=function(){return{}},oi=new Rn;var Ac=45e3,ai={},Ks={};function ci(n,e,t){n.K=1,n.v=zs(gt(e)),n.s=t,n.P=!0,Lo(n,null)}function Lo(n,e){n.F=Date.now(),Jt(n),n.A=gt(n.v);var t=n.A,s=n.U;Array.isArray(s)||(s=[String(s)]),Ko(t.i,"t",s),n.C=0,t=n.l.H,n.h=new $s,n.g=Vt(n.l,t?e:null,!n.s),0<n.N&&(n.L=new Ic(De(n.La,n,n.g),n.N)),Ao(n.S,n.g,"readystatechange",n.ib),e=n.H?wo(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),Ln(),function Do(n,e,t,s,r,i){n.info(function(){if(n.g)if(i)for(var o="",a=i.split("&"),l=0;l<a.length;l++){var h=a[l].split("=");if(1<h.length){var f=h[0];h=h[1];var p=f.split("_");o=2<=p.length&&"type"==p[1]?o+(f+"=")+h+"&":o+(f+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+s+") [attempt "+r+"]: "+e+"\n"+t+"\n"+o})}(n.j,n.u,n.A,n.m,n.U,n.s)}function Fo(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function Ro(n,e,t){let r,s=!0;for(;!n.I&&n.C<t.length;){if(r=kc(n,t),r==Ks){4==e&&(n.o=4,Ne(14),s=!1),mt(n.j,n.m,null,"[Incomplete Response]");break}if(r==ai){n.o=4,Ne(15),mt(n.j,n.m,t,"[Invalid Chunk]"),s=!1;break}mt(n.j,n.m,r,null),ui(n,r)}Fo(n)&&r!=Ks&&r!=ai&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Ne(16),s=!1),n.i=n.i&&s,s?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),u(e),e.K=!0,Ne(11))):(mt(n.j,n.m,t,"[Invalid Chunked Response]"),Lt(n),ht(n))}function kc(n,e){var t=n.C,s=e.indexOf("\n",t);return-1==s?Ks:(t=Number(e.substring(t,s)),isNaN(t)?ai:(s+=1)+t>e.length?Ks:(e=e.substr(s,t),n.C=s+t,e))}function Jt(n){n.V=Date.now()+n.O,Gs(n,n.O)}function Gs(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Fn(De(n.gb,n),e)}function Vn(n){n.B&&(B.clearTimeout(n.B),n.B=null)}function ht(n){0==n.l.G||n.I||_(n.l,n)}function Lt(n){Vn(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,Jr(n.T),ko(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function ui(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||Hs(t.h,n)))if(!n.J&&Hs(t.h,n)&&3==t.G){try{var s=t.Fa.g.parse(e)}catch{s=null}if(Array.isArray(s)&&3==s.length){var r=s;if(0==r[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;m(t),Xs(t)}c(t),Ne(18)}}else t.Ba=r[1],0<t.Ba-t.T&&37500>r[2]&&t.L&&0==t.A&&!t.v&&(t.v=Fn(De(t.cb,t),6e3));if(1>=fi(t.h)&&t.ja){try{t.ja()}catch{}t.ja=void 0}}else W(t,11)}else if((n.J||t.g==n)&&m(t),!Ss(e))for(r=t.Fa.g.parse(e),e=0;e<r.length;e++){let h=r[e];if(t.T=h[0],h=h[1],2==t.G)if("c"==h[0]){t.I=h[1],t.ka=h[2];const f=h[3];null!=f&&(t.ma=f,t.j.info("VER="+t.ma));const p=h[4];null!=p&&(t.Ca=p,t.j.info("SVER="+t.Ca));const g=h[5];null!=g&&"number"==typeof g&&0<g&&(t.J=s=1.5*g,t.j.info("backChannelRequestTimeoutMs_="+s)),s=t;const w=n.g;if(w){const T=w.g?w.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(T){var i=s.h;i.g||-1==T.indexOf("spdy")&&-1==T.indexOf("quic")&&-1==T.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(pi(i,i.h),i.h=null))}if(s.D){const S=w.g?w.g.getResponseHeader("X-HTTP-Session-Id"):null;S&&(s.za=S,oe(s.F,s.D,S))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var o=n;if((s=t).sa=Pe(s,s.H?s.ka:null,s.V),o.J){Qo(s.h,o);var a=o,l=s.J;l&&a.setTimeout(l),a.B&&(Vn(a),Jt(a)),s.g=o}else Qn(s);0<t.i.length&&Ys(t)}else"stop"!=h[0]&&"close"!=h[0]||W(t,7);else 3==t.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?W(t,7):Ct(t):"noop"!=h[0]&&t.l&&t.l.wa(h),t.A=0)}Ln()}catch{}}function Vo(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(Cs(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function Mc(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Cs(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const s in n)e[t++]=s;return e}}}(n),s=function Dc(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(Cs(n)){for(var e=[],t=n.length,s=0;s<t;s++)e.push(n[s]);return e}for(s in e=[],t=0,n)e[t++]=n[s];return e}(n),r=s.length,i=0;i<r;i++)e.call(void 0,s[i],t&&t[i],n)}(k=Yt.prototype).setTimeout=function(n){this.O=n},k.ib=function(n){n=n.target;const e=this.L;e&&3==yt(n)?e.l():this.La(n)},k.La=function(n){try{if(n==this.g)e:{const f=yt(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>f)&&(3!=f||Vr||this.g&&(this.h.h||this.g.fa()||vi(this.g)))){this.I||4!=f||7==e||Ln(),Vn(this);var t=this.g.aa();this.Y=t;t:if(Fo(this)){var s=vi(this.g);n="";var r=s.length,i=4==yt(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Lt(this),ht(this);var o="";break t}this.h.i=new B.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,n+=this.h.i.decode(s[e],{stream:i&&e==r-1});s.splice(0,r),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==t,function Cc(n,e,t,s,r,i,o){n.info(function(){return"XMLHTTP RESP ("+s+") [ attempt "+r+"]: "+e+"\n"+t+"\n"+i+" "+o})}(this.j,this.u,this.A,this.m,this.U,f,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ss(a)){var h=a;break t}}h=null}if(!(t=h)){this.i=!1,this.o=3,Ne(12),Lt(this),ht(this);break e}mt(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ui(this,t)}this.P?(Ro(this,f,o),Vr&&this.i&&3==f&&(Ao(this.S,this.T,"tick",this.hb),this.T.start())):(mt(this.j,this.m,o,null),ui(this,o)),4==f&&Lt(this),this.i&&!this.I&&(4==f?_(this.l,this):(this.i=!1,Jt(this)))}else 400==t&&0<o.indexOf("Unknown SID")?(this.o=3,Ne(12)):(this.o=0,Ne(13)),Lt(this),ht(this)}}}catch{}},k.hb=function(){if(this.g){var n=yt(this.g),e=this.g.fa();this.C<e.length&&(Vn(this),Ro(this,n,e),this.i&&4!=n&&Jt(this))}},k.cancel=function(){this.I=!0,Lt(this)},k.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function Ec(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Ln(),Ne(17)),Lt(this),this.o=2,ht(this)):Gs(this,this.V-n)};var Bo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ft(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Ft){this.h=void 0!==e?e:n.h,en(this,n.j),this.s=n.s,this.g=n.g,Bn(this,n.m),this.l=n.l,e=n.i;var t=new Un;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),qo(this,t),this.o=n.o}else n&&(t=String(n).match(Bo))?(this.h=!!e,en(this,t[1]||"",!0),this.s=tn(t[2]||""),this.g=tn(t[3]||"",!0),Bn(this,t[4]),this.l=tn(t[5]||"",!0),qo(this,t[6]||"",!0),this.o=tn(t[7]||"")):(this.h=!!e,this.i=new Un(null,this.h))}function gt(n){return new Ft(n)}function en(n,e,t){n.j=t?tn(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Bn(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function qo(n,e,t){e instanceof Un?(n.i=e,function Go(n,e){e&&!n.j&&(nt(n),n.i=null,n.g.forEach(function(t,s){var r=s.toLowerCase();s!=r&&(jo(this,s),Ko(this,r,t))},n)),n.j=e}(n.i,n.h)):(t||(e=qn(e,Pc)),n.i=new Un(e,n.h))}function oe(n,e,t){n.i.set(e,t)}function zs(n){return oe(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function tn(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function qn(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,li),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function li(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Ft.prototype.toString=function(){var n=[],e=this.j;e&&n.push(qn(e,hi,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(qn(e,hi,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(qn(t,"/"==t.charAt(0)?di:Uo,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",qn(t,Oc)),n.join("")};var hi=/[#\/\?@]/g,Uo=/[#\?:]/g,di=/[#\?]/g,Pc=/[#\?@]/g,Oc=/#/g;function Un(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function nt(n){n.g||(n.g=new Map,n.h=0,n.i&&function Nc(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var s=n[t].indexOf("="),r=null;if(0<=s){var i=n[t].substring(0,s);r=n[t].substring(s+1)}else i=n[t];e(i,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function jo(n,e){nt(n),e=nn(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function $o(n,e){return nt(n),e=nn(n,e),n.g.has(e)}function Ko(n,e,t){jo(n,e),0<t.length&&(n.i=null,n.g.set(nn(n,e),Lr(t)),n.h+=t.length)}function nn(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function zo(n){this.l=n||Fc,n=B.PerformanceNavigationTiming?0<(n=B.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(B.g&&B.g.Ga&&B.g.Ga()&&B.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(k=Un.prototype).add=function(n,e){nt(this),this.i=null,n=nn(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},k.forEach=function(n,e){nt(this),this.g.forEach(function(t,s){t.forEach(function(r){n.call(e,r,s,this)},this)},this)},k.oa=function(){nt(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let s=0;s<e.length;s++){const r=n[s];for(let i=0;i<r.length;i++)t.push(e[s])}return t},k.W=function(n){nt(this);let e=[];if("string"==typeof n)$o(this,n)&&(e=e.concat(this.g.get(nn(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},k.set=function(n,e){return nt(this),this.i=null,$o(this,n=nn(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},k.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},k.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var s=e[t];const i=encodeURIComponent(String(s)),o=this.W(s);for(s=0;s<o.length;s++){var r=i;""!==o[s]&&(r+="="+encodeURIComponent(String(o[s]))),n.push(r)}}return this.i=n.join("&")};var Fc=10;function Ho(n){return!!n.h||!!n.g&&n.g.size>=n.j}function fi(n){return n.h?1:n.g?n.g.size:0}function Hs(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function pi(n,e){n.g?n.g.add(e):n.h=e}function Qo(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function Zo(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return Lr(n.i)}function Qs(){}function mi(){this.g=new Qs}function Rc(n,e,t){const s=t||"";try{Vo(n,function(r,i){let o=r;Ht(r)&&(o=Bs(r)),e.push(s+i+"="+encodeURIComponent(o))})}catch(r){throw e.push(s+"type="+encodeURIComponent("_badmap")),r}}function Zs(n,e,t,s,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(s)}catch{}}function jn(n){this.l=n.ac||null,this.j=n.jb||!1}function $n(n,e){_e.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=gi,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}zo.prototype.cancel=function(){if(this.i=Zo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},Qs.prototype.stringify=function(n){return B.JSON.stringify(n,void 0)},Qs.prototype.parse=function(n){return B.JSON.parse(n,void 0)},be(jn,si),jn.prototype.g=function(){return new $n(this.l,this.j)},jn.prototype.i=function(n){return function(){return n}}({}),be($n,_e);var gi=0;function Wo(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function Kn(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Gn(n)}function Gn(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(k=$n.prototype).open=function(n,e){if(this.readyState!=gi)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Gn(this)},k.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||B).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},k.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Kn(this)),this.readyState=gi},k.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Gn(this)),this.g&&(this.readyState=3,Gn(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof B.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Wo(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},k.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Kn(this):Gn(this),3==this.readyState&&Wo(this)}},k.Va=function(n){this.g&&(this.response=this.responseText=n,Kn(this))},k.Ua=function(n){this.g&&(this.response=n,Kn(this))},k.ga=function(){this.g&&Kn(this)},k.setRequestHeader=function(n,e){this.v.append(n,e)},k.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},k.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty($n.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Bc=B.JSON.parse;function he(n){_e.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Xo,this.K=this.L=!1}be(he,_e);var Xo="",qc=/^https?$/i,Uc=["POST","PUT"];function yi(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,Yo(n),Ws(n)}function Yo(n){n.D||(n.D=!0,Ie(n,"complete"),Ie(n,"error"))}function wi(n){if(n.h&&typeof Is<"u"&&(!n.C[1]||4!=yt(n)||2!=n.aa()))if(n.v&&4==yt(n))ei(n.Ha,0,n);else if(Ie(n,"readystatechange"),4==yt(n)){n.h=!1;try{const a=n.aa();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var s;if(s=0===a){var r=String(n.H).match(Bo)[1]||null;if(!r&&B.self&&B.self.location){var i=B.self.location.protocol;r=i.substr(0,i.length-1)}s=!qc.test(r?r.toLowerCase():"")}t=s}if(t)Ie(n,"complete"),Ie(n,"success");else{n.m=6;try{var o=2<yt(n)?n.g.statusText:""}catch{o=""}n.j=o+" ["+n.aa()+"]",Yo(n)}}finally{Ws(n)}}}function Ws(n,e){if(n.g){Jo(n);const t=n.g,s=n.C[0]?ke:null;n.g=null,n.C=null,e||Ie(n,"ready");try{t.onreadystatechange=s}catch{}}}function Jo(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(B.clearTimeout(n.A),n.A=null)}function yt(n){return n.g?n.g.readyState:0}function vi(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case Xo:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function ea(n){let e="";return Ls(n,function(t,s){e+=s,e+=":",e+=t,e+="\r\n"}),e}function bi(n,e,t){e:{for(s in t){var s=!1;break e}s=!0}s||(t=ea(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):oe(n,e,t))}function zn(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function st(n){this.Ca=0,this.i=[],this.j=new qs,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=zn("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=zn("baseRetryDelayMs",5e3,n),this.bb=zn("retryDelaySeedMs",1e4,n),this.$a=zn("forwardChannelMaxRetries",2,n),this.ta=zn("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new zo(n&&n.concurrentRequestLimit),this.Fa=new mi,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Ct(n){if(ta(n),3==n.G){var e=n.U++,t=gt(n.F);oe(t,"SID",n.I),oe(t,"RID",e),oe(t,"TYPE","terminate"),Hn(n,t),(e=new Yt(n,n.j,e,void 0)).K=2,e.v=zs(gt(t)),t=!1,B.navigator&&B.navigator.sendBeacon&&(t=B.navigator.sendBeacon(e.v.toString(),"")),!t&&B.Image&&((new Image).src=e.v,t=!0),t||(e.g=Vt(e.l,null),e.g.da(e.v)),e.F=Date.now(),Jt(e)}je(n)}function Xs(n){n.g&&(u(n),n.g.cancel(),n.g=null)}function ta(n){Xs(n),n.u&&(B.clearTimeout(n.u),n.u=null),m(n),n.h.cancel(),n.m&&("number"==typeof n.m&&B.clearTimeout(n.m),n.m=null)}function Ys(n){Ho(n.h)||n.m||(n.m=!0,Co(n.Ja,n),n.C=0)}function na(n,e){var t;t=e?e.m:n.U++;const s=gt(n.F);oe(s,"SID",n.I),oe(s,"RID",t),oe(s,"AID",n.T),Hn(n,s),n.o&&n.s&&bi(s,n.o,n.s),t=new Yt(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=sa(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),pi(n.h,t),ci(t,s,e)}function Hn(n,e){n.ia&&Ls(n.ia,function(t,s){oe(e,s,t)}),n.l&&Vo({},function(t,s){oe(e,s,t)})}function sa(n,e,t){t=Math.min(n.i.length,t);var s=n.l?De(n.l.Ra,n.l,n):null;e:{var r=n.i;let i=-1;for(;;){const o=["count="+t];-1==i?0<t?(i=r[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let l=0;l<t;l++){let h=r[l].h;const f=r[l].g;if(h-=i,0>h)i=Math.max(0,r[l].h-100),a=!1;else try{Rc(f,o,"req"+h+"_")}catch{s&&s(f)}}if(a){s=o.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,s}function Qn(n){n.g||n.u||(n.Z=1,Co(n.Ia,n),n.A=0)}function c(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Fn(De(n.Ia,n),F(n,n.A)),n.A++,0))}function u(n){null!=n.B&&(B.clearTimeout(n.B),n.B=null)}function d(n){n.g=new Yt(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=gt(n.sa);oe(e,"RID","rpc"),oe(e,"SID",n.I),oe(e,"CI",n.L?"0":"1"),oe(e,"AID",n.T),oe(e,"TYPE","xmlhttp"),Hn(n,e),n.o&&n.s&&bi(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=zs(gt(e)),t.s=null,t.P=!0,Lo(t,n)}function m(n){null!=n.v&&(B.clearTimeout(n.v),n.v=null)}function _(n,e){var t=null;if(n.g==e){m(n),u(n),n.g=null;var s=2}else{if(!Hs(n.h,e))return;t=e.D,Qo(n.h,e),s=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==s){t=e.s?e.s.length:0,e=Date.now()-e.F;var r=n.C;Ie(s=Us(),new ni(s,t)),Ys(n)}else Qn(n);else if(3==(r=e.o)||0==r&&0<n.pa||!(1==s&&function jc(n,e){return!(fi(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=Fn(De(n.Ja,n,e),F(n,n.C)),n.C++,0)))}(n,e)||2==s&&c(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),r){case 1:W(n,5);break;case 4:W(n,10);break;case 3:W(n,6);break;default:W(n,2)}}function F(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function W(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var s=De(n.kb,n);t||(t=new Ft("//www.google.com/images/cleardot.gif"),B.location&&"http"==B.location.protocol||en(t,"https"),zs(t)),function Vc(n,e){const t=new qs;if(B.Image){const s=new Image;s.onload=Es(Zs,t,s,"TestLoadImage: loaded",!0,e),s.onerror=Es(Zs,t,s,"TestLoadImage: error",!1,e),s.onabort=Es(Zs,t,s,"TestLoadImage: abort",!1,e),s.ontimeout=Es(Zs,t,s,"TestLoadImage: timeout",!1,e),B.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=n}else e(!1)}(t.toString(),s)}else Ne(2);n.G=0,n.l&&n.l.va(e),je(n),ta(n)}function je(n){if(n.G=0,n.la=[],n.l){const e=Zo(n.h);(0!=e.length||0!=n.i.length)&&(mo(n.la,e),mo(n.la,n.i),n.h.i.length=0,Lr(n.i),n.i.length=0),n.l.ua()}}function Pe(n,e,t){var s=t instanceof Ft?gt(t):new Ft(t,void 0);if(""!=s.g)e&&(s.g=e+"."+s.g),Bn(s,s.m);else{var r=B.location;s=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var i=new Ft(null,void 0);s&&en(i,s),e&&(i.g=e),r&&Bn(i,r),t&&(i.l=t),s=i}return e=n.za,(t=n.D)&&e&&oe(s,t,e),oe(s,"VER",n.ma),Hn(n,s),s}function Vt(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new he(t&&n.Da&&!n.ra?new jn({jb:!0}):n.ra)).Ka(n.H),e}function Js(){}function ra(){if(Qt&&!(10<=Number(Mn)))throw Error("Environmental error: no available transport.")}function rt(n,e){_e.call(this),this.g=new st(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!Ss(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ss(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new er(this)}function ch(n){ri.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function uh(){ii.call(this),this.status=1}function er(n){this.g=n}(k=he.prototype).Ka=function(n){this.L=n},k.da=function(n,e,t,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():oi.g(),this.C=function Po(n){return n.h||(n.h=n.i())}(this.u?this.u:oi),this.g.onreadystatechange=De(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(i){return void yi(this,i)}if(n=t||"",t=new Map(this.headers),s)if(Object.getPrototypeOf(s)===Object.prototype)for(var r in s)t.set(r,s[r]);else{if("function"!=typeof s.keys||"function"!=typeof s.get)throw Error("Unknown input type for opt_headers: "+String(s));for(const i of s.keys())t.set(i,s.get(i))}s=Array.from(t.keys()).find(i=>"content-type"==i.toLowerCase()),r=B.FormData&&n instanceof B.FormData,!(0<=It(Uc,e))||s||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of t)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Jo(this),0<this.B&&((this.K=function Rt(n){return Qt&&function pc(){return function lc(n){var e=fc;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=As(String(Ms)).split("."),t=As("9").split("."),s=Math.max(e.length,t.length);for(let o=0;0==n&&o<s;o++){var r=e[o]||"",i=t[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],0==r[0].length&&0==i[0].length)break;n=Fr(0==r[1].length?0:parseInt(r[1],10),0==i[1].length?0:parseInt(i[1],10))||Fr(0==r[2].length,0==i[2].length)||Fr(r[2],i[2]),r=r[3],i=i[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=De(this.qa,this)):this.A=ei(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){yi(this,i)}},k.qa=function(){typeof Is<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ie(this,"timeout"),this.abort(8))},k.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Ie(this,"complete"),Ie(this,"abort"),Ws(this))},k.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ws(this,!0)),he.X.M.call(this)},k.Ha=function(){this.s||(this.F||this.v||this.l?wi(this):this.fb())},k.fb=function(){wi(this)},k.aa=function(){try{return 2<yt(this)?this.g.status:-1}catch{return-1}},k.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},k.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Bc(e)}},k.Ea=function(){return this.m},k.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(k=st.prototype).ma=8,k.G=1,k.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const r=new Yt(this,this.j,n,void 0);let i=this.s;if(this.S&&(i?(i=wo(i),bo(i,this.S)):i=this.S),null!==this.o||this.N||(r.H=i,i=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var s=this.i[t];if(void 0===(s="__data__"in s.g&&"string"==typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(e+=s)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=sa(this,r,e),oe(t=gt(this.F),"RID",n),oe(t,"CVER",22),this.D&&oe(t,"X-HTTP-Session-Id",this.D),Hn(this,t),i&&(this.N?e="headers="+encodeURIComponent(String(ea(i)))+"&"+e:this.o&&bi(t,this.o,i)),pi(this.h,r),this.Ya&&oe(t,"TYPE","init"),this.O?(oe(t,"$req",e),oe(t,"SID","null"),r.Z=!0,ci(r,t,null)):ci(r,t,e),this.G=2}}else 3==this.G&&(n?na(this,n):0==this.i.length||Ho(this.h)||na(this))},k.Ia=function(){if(this.u=null,d(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Fn(De(this.eb,this),n)}},k.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Ne(10),Xs(this),d(this))},k.cb=function(){null!=this.v&&(this.v=null,Xs(this),c(this),Ne(19))},k.kb=function(n){n?(this.j.info("Successfully pinged google.com"),Ne(2)):(this.j.info("Failed to ping google.com"),Ne(1))},(k=Js.prototype).xa=function(){},k.wa=function(){},k.va=function(){},k.ua=function(){},k.Ra=function(){},ra.prototype.g=function(n,e){return new rt(n,e)},be(rt,_e),rt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;Ne(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=Pe(n,null,n.V),Ys(n)},rt.prototype.close=function(){Ct(this.g)},rt.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=Bs(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.ab++,n)),3==e.G&&Ys(e)},rt.prototype.M=function(){this.g.l=null,delete this.j,Ct(this.g),delete this.g,rt.X.M.call(this)},be(ch,ri),be(uh,ii),be(er,Js),er.prototype.xa=function(){Ie(this.g,"a")},er.prototype.wa=function(n){Ie(this.g,new ch(n))},er.prototype.va=function(n){Ie(this.g,new uh)},er.prototype.ua=function(){Ie(this.g,"b")},ra.prototype.createWebChannel=ra.prototype.g,rt.prototype.send=rt.prototype.u,rt.prototype.open=rt.prototype.m,rt.prototype.close=rt.prototype.close,js.NO_ERROR=0,js.TIMEOUT=8,js.HTTP_ERROR=6,No.COMPLETE="complete",Oo.EventType=lt,lt.OPEN="a",lt.CLOSE="b",lt.ERROR="c",lt.MESSAGE="d",_e.prototype.listen=_e.prototype.N,he.prototype.listenOnce=he.prototype.O,he.prototype.getLastError=he.prototype.Oa,he.prototype.getLastErrorCode=he.prototype.Ea,he.prototype.getStatus=he.prototype.aa,he.prototype.getResponseJson=he.prototype.Sa,he.prototype.getResponseText=he.prototype.fa,he.prototype.send=he.prototype.da,he.prototype.setWithCredentials=he.prototype.Ka;var $p=ie.createWebChannelTransport=function(){return new ra},Kp=ie.getStatEventTarget=function(){return Us()},$c=ie.ErrorCode=js,Gp=ie.EventType=No,zp=ie.Event=Ot,lh=ie.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Hp=ie.FetchXmlHttpFactory=jn,ia=ie.WebChannel=Oo,Qp=ie.XhrIo=he;const hh="@firebase/firestore";class Oe{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Oe.UNAUTHENTICATED=new Oe(null),Oe.GOOGLE_CREDENTIALS=new Oe("google-credentials-uid"),Oe.FIRST_PARTY=new Oe("first-party-uid"),Oe.MOCK_USER=new Oe("mock-user");let tr="9.17.2";const sn=new Ae.Yd("@firebase/firestore");function Kc(){return sn.logLevel}function E(n,...e){if(sn.logLevel<=Ae.in.DEBUG){const t=e.map(Gc);sn.debug(`Firestore (${tr}): ${n}`,...t)}}function ye(n,...e){if(sn.logLevel<=Ae.in.ERROR){const t=e.map(Gc);sn.error(`Firestore (${tr}): ${n}`,...t)}}function Zn(n,...e){if(sn.logLevel<=Ae.in.WARN){const t=e.map(Gc);sn.warn(`Firestore (${tr}): ${n}`,...t)}}function Gc(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function M(n="Unexpected state"){const e=`FIRESTORE (${tr}) INTERNAL ASSERTION FAILED: `+n;throw ye(e),new Error(e)}function O(n,e){n||M()}function D(n,e){return n}const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class C extends H.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ce{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class dh{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Xp{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Oe.UNAUTHENTICATED))}shutdown(){}}class Yp{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Jp{constructor(e){this.t=e,this.currentUser=Oe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var s=this;let r=this.i;const i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let o=new Ce;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ce,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const h=o;e.enqueueRetryable((0,I.Z)(function*(){yield h.promise,yield i(s.currentUser)}))},l=h=>{E("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?l(h):(E("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ce)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(E("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(O("string"==typeof s.accessToken),new dh(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return O(null===e||"string"==typeof e),new Oe(e)}}class em{constructor(e,t,s,r){this.h=e,this.l=t,this.m=s,this.g=r,this.type="FirstParty",this.user=Oe.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(O(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class tm{constructor(e,t,s,r){this.h=e,this.l=t,this.m=s,this.g=r}getToken(){return Promise.resolve(new em(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(Oe.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class fh{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nm{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const s=i=>{null!=i.error&&E("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,E("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{E("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?r(i):E("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(O("string"==typeof t.token),this.A=t.token,new fh(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function sm(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}class ph{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const r=sm(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<t&&(s+=e.charAt(r[i]%e.length))}return s}}function U(n,e){return n<e?-1:n>e?1:0}function nr(n,e,t){return n.length===e.length&&n.every((s,r)=>t(s,e[r]))}function mh(n){return n+"\0"}class de{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new C(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new C(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new C(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new C(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return de.fromMillis(Date.now())}static fromDate(e){return de.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*t));return new de(t,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?U(this.nanoseconds,e.nanoseconds):U(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class R{constructor(e){this.timestamp=e}static fromTimestamp(e){return new R(e)}static min(){return new R(new de(0,0))}static max(){return new R(new de(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class xi{constructor(e,t,s){void 0===t?t=0:t>e.length&&M(),void 0===s?s=e.length-t:s>e.length-t&&M(),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return 0===xi.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof xi?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const i=e.get(r),o=t.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class X extends xi{construct(e,t,s){return new X(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new C(b.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(r=>r.length>0))}return new X(t)}static emptyPath(){return new X([])}}const rm=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pe extends xi{construct(e,t,s){return new pe(e,t,s)}static isValidIdentifier(e){return rm.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new pe(["__name__"])}static fromServerFormat(e){const t=[];let s="",r=0;const i=()=>{if(0===s.length)throw new C(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if("\\"===a){if(r+1===e.length)throw new C(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if("\\"!==l&&"."!==l&&"`"!==l)throw new C(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=l,r+=2}else"`"===a?(o=!o,r++):"."!==a||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new C(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pe(t)}static emptyPath(){return new pe([])}}class A{constructor(e){this.path=e}static fromPath(e){return new A(X.fromString(e))}static fromName(e){return new A(X.fromString(e).popFirst(5))}static empty(){return new A(X.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===X.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return X.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new A(new X(e.slice()))}}class oa{constructor(e,t,s,r){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=r}}function zc(n){return n.fields.find(e=>2===e.kind)}function Wn(n){return n.fields.filter(e=>2!==e.kind)}oa.UNKNOWN_ID=-1;class aa{constructor(e,t){this.fieldPath=e,this.kind=t}}class _i{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new _i(0,it.min())}}function gh(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=R.fromTimestamp(1e9===s?new de(t+1,0):new de(t,s));return new it(r,A.empty(),e)}function yh(n){return new it(n.readTime,n.key,-1)}class it{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new it(R.min(),A.empty(),-1)}static max(){return new it(R.max(),A.empty(),-1)}}function Hc(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=A.comparator(n.documentKey,e.documentKey),0!==t?t:U(n.largestBatchId,e.largestBatchId))}const wh="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vh{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function rn(n){return Qc.apply(this,arguments)}function Qc(){return Qc=(0,I.Z)(function*(n){if(n.code!==b.FAILED_PRECONDITION||n.message!==wh)throw n;E("LocalStore","Unexpectedly lost primary lease")}),Qc.apply(this,arguments)}class v{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&M(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new v((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(s,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof v?t:v.resolve(t)}catch(t){return v.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):v.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):v.reject(t)}static resolve(e){return new v((t,s)=>{t(e)})}static reject(e){return new v((t,s)=>{s(e)})}static waitFor(e){return new v((t,s)=>{let r=0,i=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++i,o&&i===r&&t()},l=>s(l))}),o=!0,i===r&&t()})}static or(e){let t=v.resolve(!1);for(const s of e)t=t.next(r=>r?v.resolve(r):s());return t}static forEach(e,t){const s=[];return e.forEach((r,i)=>{s.push(t.call(this,r,i))}),this.waitFor(s)}static mapArray(e,t){return new v((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const h=l;t(e[h]).next(f=>{o[h]=f,++a,a===i&&s(o)},f=>r(f))}})}static doWhile(e,t){return new v((s,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):s()};i()})}}class ca{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.v=new Ce,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{t.error?this.v.reject(new Ti(e,t.error)):this.v.resolve()},this.transaction.onerror=s=>{const r=Zc(s.target.error);this.v.reject(new Ti(e,r))}}static open(e,t,s,r){try{return new ca(t,e.transaction(r,s))}catch(i){throw new Ti(t,i)}}get P(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(E("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new cm(t)}}class wt{constructor(e,t,s){this.name=e,this.version=t,this.S=s,12.2===wt.D((0,H.z$)())&&ye("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return E("SimpleDb","Removing database:",e),Xn(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!(0,H.hl)())return!1;if(wt.N())return!0;const e=(0,H.z$)(),t=wt.D(e),s=0<t&&t<10,r=wt.k(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static N(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.O)}static M(e,t){return e.store(t)}static D(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}static k(e){const t=e.match(/Android ([\d.]+)/i),s=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(s)}F(e){var t=this;return(0,I.Z)(function*(){return t.db||(E("SimpleDb","Opening database:",t.name),t.db=yield new Promise((s,r)=>{const i=indexedDB.open(t.name,t.version);i.onsuccess=o=>{s(o.target.result)},i.onblocked=()=>{r(new Ti(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const a=o.target.error;r("VersionError"===a.name?new C(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new C(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new Ti(e,a))},i.onupgradeneeded=o=>{E("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',o.oldVersion),t.S.$(o.target.result,i.transaction,o.oldVersion,t.version).next(()=>{E("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=s=>t.B(s)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,s,r){var i=this;return(0,I.Z)(function*(){const o="readonly"===t;let a=0;for(;;){++a;try{i.db=yield i.F(e);const l=ca.open(i.db,e,o?"readonly":"readwrite",s),h=r(l).next(f=>(l.V(),f)).catch(f=>(l.abort(f),v.reject(f))).toPromise();return h.catch(()=>{}),yield l.P,h}catch(l){const h=l,f="FirebaseError"!==h.name&&a<3;if(E("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),i.close(),!f)return Promise.reject(h)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class am{constructor(e){this.q=e,this.U=!1,this.K=null}get isDone(){return this.U}get G(){return this.K}set cursor(e){this.q=e}done(){this.U=!0}j(e){this.K=e}delete(){return Xn(this.q.delete())}}class Ti extends C{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function on(n){return"IndexedDbTransactionError"===n.name}class cm{constructor(e){this.store=e}put(e,t){let s;return void 0!==t?(E("SimpleDb","PUT",this.store.name,e,t),s=this.store.put(t,e)):(E("SimpleDb","PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Xn(s)}add(e){return E("SimpleDb","ADD",this.store.name,e,e),Xn(this.store.add(e))}get(e){return Xn(this.store.get(e)).next(t=>(void 0===t&&(t=null),E("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return E("SimpleDb","DELETE",this.store.name,e),Xn(this.store.delete(e))}count(){return E("SimpleDb","COUNT",this.store.name),Xn(this.store.count())}W(e,t){const s=this.options(e,t);if(s.index||"function"!=typeof this.store.getAll){const r=this.cursor(s),i=[];return this.H(r,(o,a)=>{i.push(a)}).next(()=>i)}{const r=this.store.getAll(s.range);return new v((i,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}}J(e,t){const s=this.store.getAll(e,null===t?void 0:t);return new v((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}Y(e,t){E("SimpleDb","DELETE ALL",this.store.name);const s=this.options(e,t);s.Z=!1;const r=this.cursor(s);return this.H(r,(i,o,a)=>a.delete())}X(e,t){let s;t?s=e:(s={},t=e);const r=this.cursor(s);return this.H(r,t)}tt(e){const t=this.cursor({});return new v((s,r)=>{t.onerror=i=>{const o=Zc(i.target.error);r(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():s()}):s()}})}H(e,t){const s=[];return new v((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const l=new am(a),h=t(a.primaryKey,a.value,l);if(h instanceof v){const f=h.catch(p=>(l.done(),v.reject(p)));s.push(f)}l.isDone?r():null===l.G?a.continue():a.continue(l.G)}}).next(()=>v.waitFor(s))}options(e,t){let s;return void 0!==e&&("string"==typeof e?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.Z?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Xn(n){return new v((e,t)=>{n.onsuccess=s=>{e(s.target.result)},n.onerror=s=>{const r=Zc(s.target.error);t(r)}})}let bh=!1;function Zc(n){const e=wt.D((0,H.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new C("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return bh||(bh=!0,setTimeout(()=>{throw s},0)),s}}return n}class um{constructor(e,t){this.asyncQueue=e,this.et=t,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}nt(e){var t=this;E("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,I.Z)(function*(){t.task=null;try{E("IndexBackiller",`Documents written: ${yield t.et.st()}`)}catch(s){on(s)?E("IndexBackiller","Ignoring IndexedDB error during index backfill: ",s):yield rn(s)}yield t.nt(6e4)}))}}class lm{constructor(e,t){this.localStore=e,this.persistence=t}st(e=50){var t=this;return(0,I.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",s=>t.it(s,e))})()}it(e,t){const s=new Set;let r=t,i=!0;return v.doWhile(()=>!0===i&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!s.has(o))return E("IndexBackiller",`Processing collection: ${o}`),this.rt(e,o,r).next(a=>{r-=a,s.add(o)});i=!1})).next(()=>t-r)}rt(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ot(r,i)).next(a=>(E("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}ot(e,t){let s=e;return t.changes.forEach((r,i)=>{const o=yh(i);Hc(o,s)>0&&(s=o)}),new it(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}let ot=(()=>{class n{constructor(t,s){this.previousValue=t,s&&(s.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>s.writeSequenceNumber(r))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}return n.at=-1,n})();class fm{constructor(e,t,s,r,i,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=l}}class an{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new an("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof an&&e.projectId===this.projectId&&e.database===this.database}}function xh(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Yn(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function _h(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ii(n){return null==n}function Ci(n){return 0===n&&1/n==-1/0}function Th(n){return"number"==typeof n&&Number.isInteger(n)&&!Ci(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}class pm extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ee{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(r){throw r instanceof DOMException?new pm("Invalid base64 string: "+r):r}}(e);return new Ee(t)}static fromUint8Array(e){const t=function(s){let r="";for(let i=0;i<s.length;++i)r+=String.fromCharCode(s[i]);return r}(e);return new Ee(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let s=0;s<e.length;s++)t[s]=e.charCodeAt(s);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return U(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ee.EMPTY_BYTE_STRING=new Ee("");const gm=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cn(n){if(O(!!n),"string"==typeof n){let e=0;const t=gm.exec(n);if(O(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:me(n.seconds),nanos:me(n.nanos)}}function me(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Jn(n){return"string"==typeof n?Ee.fromBase64String(n):Ee.fromUint8Array(n)}function Xc(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Ih(n){const e=n.mapValue.fields.__previous_value__;return Xc(e)?Ih(e):e}function Ei(n){const e=cn(n.mapValue.fields.__local_write_time__.timestampValue);return new de(e.seconds,e.nanos)}const un={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ua={nullValue:"NULL_VALUE"};function es(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Xc(n)?4:Ah(n)?9007199254740991:10:M()}function Et(n,e){if(n===e)return!0;const t=es(n);if(t!==es(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ei(n).isEqual(Ei(e));case 3:return function(s,r){if("string"==typeof s.timestampValue&&"string"==typeof r.timestampValue&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const i=cn(s.timestampValue),o=cn(r.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return r=e,Jn(n.bytesValue).isEqual(Jn(r.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,r){return me(s.geoPointValue.latitude)===me(r.geoPointValue.latitude)&&me(s.geoPointValue.longitude)===me(r.geoPointValue.longitude)}(n,e);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return me(s.integerValue)===me(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const i=me(s.doubleValue),o=me(r.doubleValue);return i===o?Ci(i)===Ci(o):isNaN(i)&&isNaN(o)}return!1}(n,e);case 9:return nr(n.arrayValue.values||[],e.arrayValue.values||[],Et);case 10:return function(s,r){const i=s.mapValue.fields||{},o=r.mapValue.fields||{};if(xh(i)!==xh(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(void 0===o[a]||!Et(i[a],o[a])))return!1;return!0}(n,e);default:return M()}var r}function Si(n,e){return void 0!==(n.values||[]).find(t=>Et(t,e))}function ln(n,e){if(n===e)return 0;const t=es(n),s=es(e);if(t!==s)return U(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return U(n.booleanValue,e.booleanValue);case 2:return function(r,i){const o=me(r.integerValue||r.doubleValue),a=me(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(n,e);case 3:return Ch(n.timestampValue,e.timestampValue);case 4:return Ch(Ei(n),Ei(e));case 5:return U(n.stringValue,e.stringValue);case 6:return function(r,i){const o=Jn(r),a=Jn(i);return o.compareTo(a)}(n.bytesValue,e.bytesValue);case 7:return function(r,i){const o=r.split("/"),a=i.split("/");for(let l=0;l<o.length&&l<a.length;l++){const h=U(o[l],a[l]);if(0!==h)return h}return U(o.length,a.length)}(n.referenceValue,e.referenceValue);case 8:return function(r,i){const o=U(me(r.latitude),me(i.latitude));return 0!==o?o:U(me(r.longitude),me(i.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(r,i){const o=r.values||[],a=i.values||[];for(let l=0;l<o.length&&l<a.length;++l){const h=ln(o[l],a[l]);if(h)return h}return U(o.length,a.length)}(n.arrayValue,e.arrayValue);case 10:return function(r,i){if(r===un.mapValue&&i===un.mapValue)return 0;if(r===un.mapValue)return 1;if(i===un.mapValue)return-1;const o=r.fields||{},a=Object.keys(o),l=i.fields||{},h=Object.keys(l);a.sort(),h.sort();for(let f=0;f<a.length&&f<h.length;++f){const p=U(a[f],h[f]);if(0!==p)return p;const g=ln(o[a[f]],l[h[f]]);if(0!==g)return g}return U(a.length,h.length)}(n.mapValue,e.mapValue);default:throw M()}}function Ch(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return U(n,e);const t=cn(n),s=cn(e),r=U(t.seconds,s.seconds);return 0!==r?r:U(t.nanos,s.nanos)}function sr(n){return Yc(n)}function Yc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(s){const r=cn(s);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Jn(n.bytesValue).toBase64():"referenceValue"in n?A.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(s){let r="[",i=!0;for(const o of s.values||[])i?i=!1:r+=",",r+=Yc(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(s){const r=Object.keys(s.fields||{}).sort();let i="{",o=!0;for(const a of r)o?o=!1:i+=",",i+=`${a}:${Yc(s.fields[a])}`;return i+"}"}(n.mapValue):M();var e}function ts(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Jc(n){return!!n&&"integerValue"in n}function Ai(n){return!!n&&"arrayValue"in n}function Eh(n){return!!n&&"nullValue"in n}function Sh(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function la(n){return!!n&&"mapValue"in n}function ki(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Yn(n.mapValue.fields,(t,s)=>e.mapValue.fields[t]=ki(s)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ki(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Ah(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function ym(n){return"nullValue"in n?ua:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ts(an.empty(),A.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:M()}function wm(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ts(an.empty(),A.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?un:M()}function kh(n,e){const t=ln(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Dh(n,e){const t=ln(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class hn{constructor(e,t){this.position=e,this.inclusive=t}}function Mh(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const i=e[r],o=n.position[r];if(s=i.field.isKeyField()?A.comparator(A.fromName(o.referenceValue),t.key):ln(o,t.data.field(i.field)),"desc"===i.dir&&(s*=-1),0!==s)break}return s}function Nh(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Et(n.position[t],e.position[t]))return!1;return!0}class Ph{}class Q extends Ph{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,s):new vm(e,t,s):"array-contains"===t?new _m(e,s):"in"===t?new Bh(e,s):"not-in"===t?new Tm(e,s):"array-contains-any"===t?new Im(e,s):new Q(e,t,s)}static createKeyFieldInFilter(e,t,s){return"in"===t?new bm(e,s):new xm(e,s)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(ln(t,this.value)):null!==t&&es(this.value)===es(t)&&this.matchesComparison(ln(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return M()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class ne extends Ph{constructor(e,t){super(),this.filters=e,this.op=t,this.ft=null}static create(e,t){return new ne(e,t)}matches(e){return rr(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ft||(this.ft=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ft}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.dt(t=>t.isInequality());return null!==e?e.field:null}dt(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function rr(n){return"and"===n.op}function eu(n){return"or"===n.op}function tu(n){return Oh(n)&&rr(n)}function Oh(n){for(const e of n.filters)if(e instanceof ne)return!1;return!0}function nu(n){if(n instanceof Q)return n.field.canonicalString()+n.op.toString()+sr(n.value);if(tu(n))return n.filters.map(e=>nu(e)).join(",");{const e=n.filters.map(t=>nu(t)).join(",");return`${n.op}(${e})`}}function Lh(n,e){return n instanceof Q?(t=n,(s=e)instanceof Q&&t.op===s.op&&t.field.isEqual(s.field)&&Et(t.value,s.value)):n instanceof ne?function(t,s){return s instanceof ne&&t.op===s.op&&t.filters.length===s.filters.length&&t.filters.reduce((r,i,o)=>r&&Lh(i,s.filters[o]),!0)}(n,e):void M();var t,s}function Fh(n,e){const t=n.filters.concat(e);return ne.create(t,n.op)}function Rh(n){return n instanceof Q?`${(e=n).field.canonicalString()} ${e.op} ${sr(e.value)}`:n instanceof ne?function(e){return e.op.toString()+" {"+e.getFilters().map(Rh).join(" ,")+"}"}(n):"Filter";var e}class vm extends Q{constructor(e,t,s){super(e,t,s),this.key=A.fromName(s.referenceValue)}matches(e){const t=A.comparator(e.key,this.key);return this.matchesComparison(t)}}class bm extends Q{constructor(e,t){super(e,"in",t),this.keys=Vh(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class xm extends Q{constructor(e,t){super(e,"not-in",t),this.keys=Vh(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Vh(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(s=>A.fromName(s.referenceValue))}class _m extends Q{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ai(t)&&Si(t.arrayValue,this.value)}}class Bh extends Q{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Si(this.value.arrayValue,t)}}class Tm extends Q{constructor(e,t){super(e,"not-in",t)}matches(e){if(Si(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Si(this.value.arrayValue,t)}}class Im extends Q{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ai(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>Si(this.value.arrayValue,s))}}class ir{constructor(e,t="asc"){this.field=e,this.dir=t}}function Cm(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class ge{constructor(e,t){this.comparator=e,this.root=t||Be.EMPTY}insert(e,t){return new ge(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Be.BLACK,null,null))}remove(e){return new ge(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Be.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(0===s)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(0===r)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ha(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ha(this.root,e,this.comparator,!1)}getReverseIterator(){return new ha(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ha(this.root,e,this.comparator,!0)}}class ha{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?s(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Be{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??Be.RED,this.left=r??Be.EMPTY,this.right=i??Be.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,i){return new Be(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,s),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Be.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Be.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Be.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Be.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw M();const e=this.left.check();if(e!==this.right.check())throw M();return e+(this.isRed()?0:1)}}Be.EMPTY=null,Be.RED=!0,Be.BLACK=!1,Be.EMPTY=new class{constructor(){this.size=0}get key(){throw M()}get value(){throw M()}get color(){throw M()}get left(){throw M()}get right(){throw M()}copy(n,e,t,s,r){return this}insert(n,e,t){return new Be(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class re{constructor(e){this.comparator=e,this.data=new ge(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new qh(this.data.getIterator())}getIteratorFrom(e){return new qh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof re)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(0!==this.comparator(r,i))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new re(this.comparator);return t.data=e,t}}class qh{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function or(n){return n.hasNext()?n.getNext():void 0}class Ye{constructor(e){this.fields=e,e.sort(pe.comparator)}static empty(){return new Ye([])}unionWith(e){let t=new re(pe.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Ye(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return nr(this.fields,e.fields,(t,s)=>t.isEqual(s))}}class Le{constructor(e){this.value=e}static empty(){return new Le({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!la(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ki(t)}setAll(e){let t=pe.emptyPath(),s={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,s,r),s={},r=[],t=a.popLast()}o?s[a.lastSegment()]=ki(o):r.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,s,r)}delete(e){const t=this.field(e.popLast());la(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Et(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];la(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){Yn(t,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new Le(ki(this.value))}}function Uh(n){const e=[];return Yn(n.fields,(t,s)=>{const r=new pe([t]);if(la(s)){const i=Uh(s.mapValue).fields;if(0===i.length)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new Ye(e)}class ae{constructor(e,t,s,r,i,o,a){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ae(e,0,R.min(),R.min(),R.min(),Le.empty(),0)}static newFoundDocument(e,t,s,r){return new ae(e,1,t,R.min(),s,r,0)}static newNoDocument(e,t){return new ae(e,2,t,R.min(),R.min(),Le.empty(),0)}static newUnknownDocument(e,t){return new ae(e,3,t,R.min(),R.min(),Le.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(R.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Le.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Le.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=R.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ae&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ae(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Em{constructor(e,t=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this._t=null}}function su(n,e=null,t=[],s=[],r=null,i=null,o=null){return new Em(n,e,t,s,r,i,o)}function ns(n){const e=D(n);if(null===e._t){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>nu(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>{return(r=s).field.canonicalString()+r.dir;var r}).join(","),Ii(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>sr(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>sr(s)).join(",")),e._t=t}return e._t}function Di(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Cm(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Lh(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Nh(n.startAt,e.startAt)&&Nh(n.endAt,e.endAt)}function da(n){return A.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function fa(n,e){return n.filters.filter(t=>t instanceof Q&&t.field.isEqual(e))}function jh(n,e,t){let s=ua,r=!0;for(const i of fa(n,e)){let o=ua,a=!0;switch(i.op){case"<":case"<=":o=ym(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=ua}kh({value:s,inclusive:r},{value:o,inclusive:a})<0&&(s=o,r=a)}if(null!==t)for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];kh({value:s,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(s=o,r=t.inclusive);break}return{value:s,inclusive:r}}function $h(n,e,t){let s=un,r=!0;for(const i of fa(n,e)){let o=un,a=!0;switch(i.op){case">=":case">":o=wm(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=un}Dh({value:s,inclusive:r},{value:o,inclusive:a})>0&&(s=o,r=a)}if(null!==t)for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Dh({value:s,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(s=o,r=t.inclusive);break}return{value:s,inclusive:r}}class Bt{constructor(e,t=null,s=[],r=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.wt=null,this.gt=null}}function Kh(n,e,t,s,r,i,o,a){return new Bt(n,e,t,s,r,i,o,a)}function ar(n){return new Bt(n)}function Gh(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function ru(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function pa(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function iu(n){return null!==n.collectionGroup}function ss(n){const e=D(n);if(null===e.wt){e.wt=[];const t=pa(e),s=ru(e);if(null!==t&&null===s)t.isKeyField()||e.wt.push(new ir(t)),e.wt.push(new ir(pe.keyField(),"asc"));else{let r=!1;for(const i of e.explicitOrderBy)e.wt.push(i),i.field.isKeyField()&&(r=!0);if(!r){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new ir(pe.keyField(),i))}}}return e.wt}function ze(n){const e=D(n);if(!e.gt)if("F"===e.limitType)e.gt=su(e.path,e.collectionGroup,ss(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const i of ss(e))t.push(new ir(i.field,"desc"===i.dir?"asc":"desc"));const s=e.endAt?new hn(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new hn(e.startAt.position,e.startAt.inclusive):null;e.gt=su(e.path,e.collectionGroup,t,e.filters,e.limit,s,r)}return e.gt}function ou(n,e){e.getFirstInequalityField(),pa(n);const t=n.filters.concat([e]);return new Bt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ma(n,e,t){return new Bt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Mi(n,e){return Di(ze(n),ze(e))&&n.limitType===e.limitType}function zh(n){return`${ns(ze(n))}|lt:${n.limitType}`}function au(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(s=>Rh(s)).join(", ")}]`),Ii(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(s=>{return`${(r=s).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>sr(s)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>sr(s)).join(",")),`Target(${t})`}(ze(n))}; limitType=${n.limitType})`}function Ni(n,e){return e.isFoundDocument()&&function(t,s){const r=s.key.path;return null!==t.collectionGroup?s.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(r):A.isDocumentKey(t.path)?t.path.isEqual(r):t.path.isImmediateParentOf(r)}(n,e)&&function(t,s){for(const r of ss(t))if(!r.field.isKeyField()&&null===s.data.field(r.field))return!1;return!0}(n,e)&&function(t,s){for(const r of t.filters)if(!r.matches(s))return!1;return!0}(n,e)&&(s=e,!((t=n).startAt&&!function(r,i,o){const a=Mh(r,i,o);return r.inclusive?a<=0:a<0}(t.startAt,ss(t),s)||t.endAt&&!function(r,i,o){const a=Mh(r,i,o);return r.inclusive?a>=0:a>0}(t.endAt,ss(t),s)));var t,s}function Hh(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Qh(n){return(e,t)=>{let s=!1;for(const r of ss(n)){const i=Sm(r,e,t);if(0!==i)return i;s=s||r.field.isKeyField()}return 0}}function Sm(n,e,t){const s=n.field.isKeyField()?A.comparator(e.key,t.key):function(r,i,o){const a=i.data.field(r),l=o.data.field(r);return null!==a&&null!==l?ln(a,l):M()}(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return M()}}function Zh(n,e){if(n.yt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ci(e)?"-0":e}}function Wh(n){return{integerValue:""+n}}function Xh(n,e){return Th(e)?Wh(e):Zh(n,e)}class ga{constructor(){this._=void 0}}function Am(n,e,t){return n instanceof cr?function(s,r){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&(i.fields.__previous_value__=r),{mapValue:i}}(t,e):n instanceof rs?Jh(n,e):n instanceof is?ed(n,e):function(s,r){const i=Yh(s,r),o=td(i)+td(s.It);return Jc(i)&&Jc(s.It)?Wh(o):Zh(s.Tt,o)}(n,e)}function km(n,e,t){return n instanceof rs?Jh(n,e):n instanceof is?ed(n,e):t}function Yh(n,e){return n instanceof ur?Jc(t=e)||(s=t)&&"doubleValue"in s?e:{integerValue:0}:null;var s,t}class cr extends ga{}class rs extends ga{constructor(e){super(),this.elements=e}}function Jh(n,e){const t=nd(e);for(const s of n.elements)t.some(r=>Et(r,s))||t.push(s);return{arrayValue:{values:t}}}class is extends ga{constructor(e){super(),this.elements=e}}function ed(n,e){let t=nd(e);for(const s of n.elements)t=t.filter(r=>!Et(r,s));return{arrayValue:{values:t}}}class ur extends ga{constructor(e,t){super(),this.Tt=e,this.It=t}}function td(n){return me(n.integerValue||n.doubleValue)}function nd(n){return Ai(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Pi{constructor(e,t){this.field=e,this.transform=t}}class Mm{constructor(e,t){this.version=e,this.transformResults=t}}class fe{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new fe}static exists(e){return new fe(void 0,e)}static updateTime(e){return new fe(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ya(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class wa{}function sd(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new hr(n.key,fe.none()):new lr(n.key,n.data,fe.none());{const t=n.data,s=Le.empty();let r=new re(pe.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);null===o&&i.length>1&&(i=i.popLast(),o=t.field(i)),null===o?s.delete(i):s.set(i,o),r=r.add(i)}return new qt(n.key,s,new Ye(r.toArray()),fe.none())}}function Nm(n,e,t){n instanceof lr?function(s,r,i){const o=s.value.clone(),a=od(s.fieldTransforms,r,i.transformResults);o.setAll(a),r.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(n,e,t):n instanceof qt?function(s,r,i){if(!ya(s.precondition,r))return void r.convertToUnknownDocument(i.version);const o=od(s.fieldTransforms,r,i.transformResults),a=r.data;a.setAll(id(s)),a.setAll(o),r.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Oi(n,e,t,s){return n instanceof lr?function(r,i,o,a){if(!ya(r.precondition,i))return o;const l=r.value.clone(),h=ad(r.fieldTransforms,a,i);return l.setAll(h),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),null}(n,e,t,s):n instanceof qt?function(r,i,o,a){if(!ya(r.precondition,i))return o;const l=ad(r.fieldTransforms,a,i),h=i.data;return h.setAll(id(r)),h.setAll(l),i.convertToFoundDocument(i.version,h).setHasLocalMutations(),null===o?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(f=>f.field))}(n,e,t,s):(o=t,ya(n.precondition,i=e)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o);var i,o}function Pm(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),i=Yh(s.transform,r||null);null!=i&&(null===t&&(t=Le.empty()),t.set(s.field,i))}return t||null}function rd(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(s=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===s||t&&s&&nr(t,s,(r,i)=>function Dm(n,e){return n.field.isEqual(e.field)&&(s=e.transform,(t=n.transform)instanceof rs&&s instanceof rs||t instanceof is&&s instanceof is?nr(t.elements,s.elements,Et):t instanceof ur&&s instanceof ur?Et(t.It,s.It):t instanceof cr&&s instanceof cr);var t,s}(r,i))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,s}class lr extends wa{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class qt extends wa{constructor(e,t,s,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function id(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}}),e}function od(n,e,t){const s=new Map;O(n.length===t.length);for(let r=0;r<t.length;r++){const i=n[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,km(o,a,t[r]))}return s}function ad(n,e,t){const s=new Map;for(const r of n){const i=r.transform,o=t.data.field(r.field);s.set(r.field,Am(i,o,e))}return s}class hr extends wa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class cu extends wa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Om{constructor(e){this.count=e}}var Te,Y;function cd(n){switch(n){default:return M();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0}}function ud(n){if(void 0===n)return ye("GRPC error has no .code"),b.UNKNOWN;switch(n){case Te.OK:return b.OK;case Te.CANCELLED:return b.CANCELLED;case Te.UNKNOWN:return b.UNKNOWN;case Te.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Te.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Te.INTERNAL:return b.INTERNAL;case Te.UNAVAILABLE:return b.UNAVAILABLE;case Te.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Te.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Te.NOT_FOUND:return b.NOT_FOUND;case Te.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Te.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Te.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Te.ABORTED:return b.ABORTED;case Te.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Te.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Te.DATA_LOSS:return b.DATA_LOSS;default:return M()}}(Y=Te||(Te={}))[Y.OK=0]="OK",Y[Y.CANCELLED=1]="CANCELLED",Y[Y.UNKNOWN=2]="UNKNOWN",Y[Y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Y[Y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Y[Y.NOT_FOUND=5]="NOT_FOUND",Y[Y.ALREADY_EXISTS=6]="ALREADY_EXISTS",Y[Y.PERMISSION_DENIED=7]="PERMISSION_DENIED",Y[Y.UNAUTHENTICATED=16]="UNAUTHENTICATED",Y[Y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Y[Y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Y[Y.ABORTED=10]="ABORTED",Y[Y.OUT_OF_RANGE=11]="OUT_OF_RANGE",Y[Y.UNIMPLEMENTED=12]="UNIMPLEMENTED",Y[Y.INTERNAL=13]="INTERNAL",Y[Y.UNAVAILABLE=14]="UNAVAILABLE",Y[Y.DATA_LOSS=15]="DATA_LOSS";class dn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(void 0!==s)for(const[r,i]of s)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(void 0===r)return this.inner[s]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(void 0===s)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return 1===s.length?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Yn(this.inner,(t,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return _h(this.inner)}size(){return this.innerSize}}const Lm=new ge(A.comparator);function Je(){return Lm}const ld=new ge(A.comparator);function Li(...n){let e=ld;for(const t of n)e=e.insert(t.key,t);return e}function hd(n){let e=ld;return n.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function St(){return Fi()}function dd(){return Fi()}function Fi(){return new dn(n=>n.toString(),(n,e)=>n.isEqual(e))}const Fm=new ge(A.comparator),Rm=new re(A.comparator);function j(...n){let e=Rm;for(const t of n)e=e.add(t);return e}const Vm=new re(U);function va(){return Vm}class Ri{constructor(e,t,s,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,Vi.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Ri(R.min(),r,va(),Je(),j())}}class Vi{constructor(e,t,s,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Vi(s,t,j(),j(),j())}}class ba{constructor(e,t,s,r){this.Et=e,this.removedTargetIds=t,this.key=s,this.At=r}}class fd{constructor(e,t){this.targetId=e,this.Rt=t}}class pd{constructor(e,t,s=Ee.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class md{constructor(){this.bt=0,this.vt=yd(),this.Pt=Ee.EMPTY_BYTE_STRING,this.Vt=!1,this.St=!0}get current(){return this.Vt}get resumeToken(){return this.Pt}get Dt(){return 0!==this.bt}get Ct(){return this.St}xt(e){e.approximateByteSize()>0&&(this.St=!0,this.Pt=e)}Nt(){let e=j(),t=j(),s=j();return this.vt.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:M()}}),new Vi(this.Pt,this.Vt,e,t,s)}kt(){this.St=!1,this.vt=yd()}Ot(e,t){this.St=!0,this.vt=this.vt.insert(e,t)}Mt(e){this.St=!0,this.vt=this.vt.remove(e)}Ft(){this.bt+=1}$t(){this.bt-=1}Bt(){this.St=!0,this.Vt=!0}}class Bm{constructor(e){this.Lt=e,this.qt=new Map,this.Ut=Je(),this.Kt=gd(),this.Gt=new re(U)}Qt(e){for(const t of e.Et)e.At&&e.At.isFoundDocument()?this.jt(t,e.At):this.zt(t,e.key,e.At);for(const t of e.removedTargetIds)this.zt(t,e.key,e.At)}Wt(e){this.forEachTarget(e,t=>{const s=this.Ht(t);switch(e.state){case 0:this.Jt(t)&&s.xt(e.resumeToken);break;case 1:s.$t(),s.Dt||s.kt(),s.xt(e.resumeToken);break;case 2:s.$t(),s.Dt||this.removeTarget(t);break;case 3:this.Jt(t)&&(s.Bt(),s.xt(e.resumeToken));break;case 4:this.Jt(t)&&(this.Yt(t),s.xt(e.resumeToken));break;default:M()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qt.forEach((s,r)=>{this.Jt(r)&&t(r)})}Zt(e){const t=e.targetId,s=e.Rt.count,r=this.Xt(t);if(r){const i=r.target;if(da(i))if(0===s){const o=new A(i.path);this.zt(t,o,ae.newNoDocument(o,R.min()))}else O(1===s);else this.te(t)!==s&&(this.Yt(t),this.Gt=this.Gt.add(t))}}ee(e){const t=new Map;this.qt.forEach((i,o)=>{const a=this.Xt(o);if(a){if(i.current&&da(a.target)){const l=new A(a.target.path);null!==this.Ut.get(l)||this.ne(o,l)||this.zt(o,l,ae.newNoDocument(l,e))}i.Ct&&(t.set(o,i.Nt()),i.kt())}});let s=j();this.Kt.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const h=this.Xt(l);return!h||2===h.purpose||(a=!1,!1)}),a&&(s=s.add(i))}),this.Ut.forEach((i,o)=>o.setReadTime(e));const r=new Ri(e,t,this.Gt,this.Ut,s);return this.Ut=Je(),this.Kt=gd(),this.Gt=new re(U),r}jt(e,t){if(!this.Jt(e))return;const s=this.ne(e,t.key)?2:0;this.Ht(e).Ot(t.key,s),this.Ut=this.Ut.insert(t.key,t),this.Kt=this.Kt.insert(t.key,this.se(t.key).add(e))}zt(e,t,s){if(!this.Jt(e))return;const r=this.Ht(e);this.ne(e,t)?r.Ot(t,1):r.Mt(t),this.Kt=this.Kt.insert(t,this.se(t).delete(e)),s&&(this.Ut=this.Ut.insert(t,s))}removeTarget(e){this.qt.delete(e)}te(e){const t=this.Ht(e).Nt();return this.Lt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ft(e){this.Ht(e).Ft()}Ht(e){let t=this.qt.get(e);return t||(t=new md,this.qt.set(e,t)),t}se(e){let t=this.Kt.get(e);return t||(t=new re(U),this.Kt=this.Kt.insert(e,t)),t}Jt(e){const t=null!==this.Xt(e);return t||E("WatchChangeAggregator","Detected inactive target",e),t}Xt(e){const t=this.qt.get(e);return t&&t.Dt?null:this.Lt.ie(e)}Yt(e){this.qt.set(e,new md),this.Lt.getRemoteKeysForTarget(e).forEach(t=>{this.zt(e,t,null)})}ne(e,t){return this.Lt.getRemoteKeysForTarget(e).has(t)}}function gd(){return new ge(A.comparator)}function yd(){return new ge(A.comparator)}const qm={asc:"ASCENDING",desc:"DESCENDING"},Um={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jm={and:"AND",or:"OR"};class $m{constructor(e,t){this.databaseId=e,this.yt=t}}function dr(n,e){return n.yt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function wd(n,e){return n.yt?e.toBase64():e.toUint8Array()}function Km(n,e){return dr(n,e.toTimestamp())}function we(n){return O(!!n),R.fromTimestamp(function(e){const t=cn(e);return new de(t.seconds,t.nanos)}(n))}function uu(n,e){return(t=n,new X(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function vd(n){const e=X.fromString(n);return O(Ad(e)),e}function Bi(n,e){return uu(n.databaseId,e.path)}function At(n,e){const t=vd(e);if(t.get(1)!==n.databaseId.projectId)throw new C(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new C(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new A(xd(t))}function lu(n,e){return uu(n.databaseId,e)}function bd(n){const e=vd(n);return 4===e.length?X.emptyPath():xd(e)}function qi(n){return new X(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function xd(n){return O(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function _d(n,e,t){return{name:Bi(n,e),fields:t.value.mapValue.fields}}function Td(n,e,t){const s=At(n,e.name),r=we(e.updateTime),i=e.createTime?we(e.createTime):R.min(),o=new Le({mapValue:{fields:e.fields}}),a=ae.newFoundDocument(s,r,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function Ui(n,e){let t;if(e instanceof lr)t={update:_d(n,e.key,e.value)};else if(e instanceof hr)t={delete:Bi(n,e.key)};else if(e instanceof qt)t={update:_d(n,e.key,e.data),updateMask:Ym(e.fieldMask)};else{if(!(e instanceof cu))return M();t={verify:Bi(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(r,i){const o=i.transform;if(o instanceof cr)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof rs)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof is)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof ur)return{fieldPath:i.field.canonicalString(),increment:o.It};throw M()}(0,s))),e.precondition.isNone||(t.currentDocument=void 0!==(r=e.precondition).updateTime?{updateTime:Km(n,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:M()),t;var r}function hu(n,e){const t=e.currentDocument?void 0!==(r=e.currentDocument).updateTime?fe.updateTime(we(r.updateTime)):void 0!==r.exists?fe.exists(r.exists):fe.none():fe.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(i,o){let a=null;"setToServerValue"in o?(O("REQUEST_TIME"===o.setToServerValue),a=new cr):"appendMissingElements"in o?a=new rs(o.appendMissingElements.values||[]):"removeAllFromArray"in o?a=new is(o.removeAllFromArray.values||[]):"increment"in o?a=new ur(i,o.increment):M();const l=pe.fromServerFormat(o.fieldPath);return new Pi(l,a)}(n,r)):[];var r;if(e.update){const r=At(n,e.update.name),i=new Le({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new Ye((e.updateMask.fieldPaths||[]).map(h=>pe.fromServerFormat(h)));return new qt(r,i,o,t,s)}return new lr(r,i,t,s)}if(e.delete){const r=At(n,e.delete);return new hr(r,t)}if(e.verify){const r=At(n,e.verify);return new cu(r,t)}return M()}function Id(n,e){return{documents:[lu(n,e.path)]}}function du(n,e){const t={structuredQuery:{}},s=e.path;null!==e.collectionGroup?(t.parent=lu(n,s),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=lu(n,s.popLast()),t.structuredQuery.from=[{collectionId:s.lastSegment()}]);const r=function(l){if(0!==l.length)return Sd(ne.create(l,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const i=function(l){if(0!==l.length)return l.map(h=>{return{field:fn((f=h).field),direction:Zm(f.dir)};var f})}(e.orderBy);i&&(t.structuredQuery.orderBy=i);const o=(h=e.limit,n.yt||Ii(h)?h:{value:h});var h,a,l;return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt={before:!(l=e.endAt).inclusive,values:l.position}),t}function Cd(n){let e=bd(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){O(1===s);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let i=[];t.where&&(i=function(f){const p=Ed(f);return p instanceof ne&&tu(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(f=>{return new ir(fr((p=f).field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction));var p}));let a=null;t.limit&&(a=function(f){let p;return p="object"==typeof f?f.value:f,Ii(p)?null:p}(t.limit));let l=null;var f;t.startAt&&(l=new hn((f=t.startAt).values||[],!!f.before));let h=null;return t.endAt&&(h=function(f){return new hn(f.values||[],!f.before)}(t.endAt)),Kh(e,r,o,i,a,"F",l,h)}function Ed(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=fr(e.unaryFilter.field);return Q.create(t,"==",{doubleValue:NaN});case"IS_NULL":const s=fr(e.unaryFilter.field);return Q.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=fr(e.unaryFilter.field);return Q.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=fr(e.unaryFilter.field);return Q.create(i,"!=",{nullValue:"NULL_VALUE"});default:return M()}}(n):void 0!==n.fieldFilter?Q.create(fr((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return M()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return ne.create(e.compositeFilter.filters.map(t=>Ed(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return M()}}(e.compositeFilter.op))}(n):M();var e}function Zm(n){return qm[n]}function Wm(n){return Um[n]}function Xm(n){return jm[n]}function fn(n){return{fieldPath:n.canonicalString()}}function fr(n){return pe.fromServerFormat(n.fieldPath)}function Sd(n){return n instanceof Q?function(e){if("=="===e.op){if(Sh(e.value))return{unaryFilter:{field:fn(e.field),op:"IS_NAN"}};if(Eh(e.value))return{unaryFilter:{field:fn(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Sh(e.value))return{unaryFilter:{field:fn(e.field),op:"IS_NOT_NAN"}};if(Eh(e.value))return{unaryFilter:{field:fn(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fn(e.field),op:Wm(e.op),value:e.value}}}(n):n instanceof ne?function(e){const t=e.getFilters().map(s=>Sd(s));return 1===t.length?t[0]:{compositeFilter:{op:Xm(e.op),filters:t}}}(n):M()}function Ym(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Ad(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function He(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=kd(e)),e=Jm(n.get(t),e);return kd(e)}function Jm(n,e){let t=e;const s=n.length;for(let r=0;r<s;r++){const i=n.charAt(r);switch(i){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=i}}return t}function kd(n){return n+"\x01\x01"}function kt(n){const e=n.length;if(O(e>=2),2===e)return O("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),X.emptyPath();const t=e-2,s=[];let r="";for(let i=0;i<e;){const o=n.indexOf("\x01",i);switch((o<0||o>t)&&M(),n.charAt(o+1)){case"\x01":const a=n.substring(i,o);let l;0===r.length?l=a:(r+=a,l=r,r=""),s.push(l);break;case"\x10":r+=n.substring(i,o),r+="\0";break;case"\x11":r+=n.substring(i,o+1);break;default:M()}i=o+2}return new X(s)}const Dd=["userId","batchId"];function xa(n,e){return[n,He(e)]}function Md(n,e,t){return[n,He(e),t]}const eg={},tg=["prefixPath","collectionGroup","readTime","documentId"],ng=["prefixPath","collectionGroup","documentId"],sg=["collectionGroup","readTime","prefixPath","documentId"],rg=["canonicalId","targetId"],ig=["targetId","path"],og=["path","targetId"],ag=["collectionId","parent"],cg=["indexId","uid"],ug=["uid","sequenceNumber"],lg=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],hg=["indexId","uid","orderedDocumentKey"],dg=["userId","collectionPath","documentId"],fg=["userId","collectionPath","largestBatchId"],pg=["userId","collectionGroup","largestBatchId"],Nd=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],mg=[...Nd,"documentOverlays"],Pd=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Od=Pd,gg=[...Od,"indexConfiguration","indexState","indexEntries"];class fu extends vh{constructor(e,t){super(),this.re=e,this.currentSequenceNumber=t}}function Fe(n,e){const t=D(n);return wt.M(t.re,e)}class pu{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&Nm(i,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Oi(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Oi(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=dd();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(r.key)?null:a;const l=sd(o,a);null!==l&&s.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(R.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),j())}isEqual(e){return this.batchId===e.batchId&&nr(this.mutations,e.mutations,(t,s)=>rd(t,s))&&nr(this.baseMutations,e.baseMutations,(t,s)=>rd(t,s))}}class mu{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){O(e.mutations.length===s.length);let r=Fm;const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new mu(e,t,s,r)}}class gu{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class pn{constructor(e,t,s,r,i=R.min(),o=R.min(),a=Ee.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new pn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new pn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new pn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Ld{constructor(e){this.oe=e}}function Fd(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:_a(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document={name:Bi(r=n.oe,(i=e).key),fields:i.data.value.mapValue.fields,updateTime:dr(r,i.version.toTimestamp()),createTime:dr(r,i.createTime.toTimestamp())};else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:os(e.version)};else{if(!e.isUnknownDocument())return M();s.unknownDocument={path:t.path.toArray(),version:os(e.version)}}var r,i;return s}function _a(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function os(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function as(n){const e=new de(n.seconds,n.nanoseconds);return R.fromTimestamp(e)}function cs(n,e){const t=(e.baseMutations||[]).map(i=>hu(n.oe,i));for(let i=0;i<e.mutations.length-1;++i)i+1<e.mutations.length&&void 0!==e.mutations[i+1].transform&&(e.mutations[i].updateTransforms=e.mutations[i+1].transform.fieldTransforms,e.mutations.splice(i+1,1),++i);const s=e.mutations.map(i=>hu(n.oe,i)),r=de.fromMillis(e.localWriteTimeMs);return new pu(e.batchId,r,t,s)}function ji(n){const e=as(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?as(n.lastLimboFreeSnapshotVersion):R.min();let s;var r;return void 0!==n.query.documents?(O(1===(r=n.query).documents.length),s=ze(ar(bd(r.documents[0])))):s=ze(Cd(n.query)),new pn(s,n.targetId,0,n.lastListenSequenceNumber,e,t,Ee.fromBase64String(n.resumeToken))}function Rd(n,e){const t=os(e.snapshotVersion),s=os(e.lastLimboFreeSnapshotVersion);let r;r=da(e.target)?Id(n.oe,e.target):du(n.oe,e.target);const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ns(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function yu(n){const e=Cd({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?ma(e,e.limit,"L"):e}function wu(n,e){return new gu(e.largestBatchId,hu(n.oe,e.overlayMutation))}function Vd(n,e){const t=e.path.lastSegment();return[n,He(e.path.popLast()),t]}function Bd(n,e,t,s){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:os(s.readTime),documentKey:He(s.documentKey.path),largestBatchId:s.largestBatchId}}class wg{getBundleMetadata(e,t){return qd(e).get(t).next(s=>{if(s)return{id:(r=s).bundleId,createTime:as(r.createTime),version:r.version};var r})}saveBundleMetadata(e,t){return qd(e).put({bundleId:(s=t).id,createTime:os(we(s.createTime)),version:s.version});var s}getNamedQuery(e,t){return Ud(e).get(t).next(s=>{if(s)return{name:(r=s).name,query:yu(r.bundledQuery),readTime:as(r.readTime)};var r})}saveNamedQuery(e,t){return Ud(e).put({name:(s=t).name,readTime:os(we(s.readTime)),bundledQuery:s.bundledQuery});var s}}function qd(n){return Fe(n,"bundles")}function Ud(n){return Fe(n,"namedQueries")}class Ta{constructor(e,t){this.Tt=e,this.userId=t}static ue(e,t){return new Ta(e,t.uid||"")}getOverlay(e,t){return $i(e).get(Vd(this.userId,t)).next(s=>s?wu(this.Tt,s):null)}getOverlays(e,t){const s=St();return v.forEach(t,r=>this.getOverlay(e,r).next(i=>{null!==i&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){const r=[];return s.forEach((i,o)=>{const a=new gu(t,o);r.push(this.ce(e,a))}),v.waitFor(r)}removeOverlaysForBatchId(e,t,s){const r=new Set;t.forEach(o=>r.add(He(o.getCollectionPath())));const i=[];return r.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push($i(e).Y("collectionPathOverlayIndex",a))}),v.waitFor(i)}getOverlaysForCollection(e,t,s){const r=St(),i=He(t),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return $i(e).W("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const h=wu(this.Tt,l);r.set(h.getKey(),h)}return r})}getOverlaysForCollectionGroup(e,t,s,r){const i=St();let o;const a=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return $i(e).X({index:"collectionGroupOverlayIndex",range:a},(l,h,f)=>{const p=wu(this.Tt,h);i.size()<r||p.largestBatchId===o?(i.set(p.getKey(),p),o=p.largestBatchId):f.done()}).next(()=>i)}ce(e,t){return $i(e).put(function(s,r,i){const[o,a,l]=Vd(r,i.mutation.key);return{userId:r,collectionPath:a,documentId:l,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:Ui(s.oe,i.mutation)}}(this.Tt,this.userId,t))}}function $i(n){return Fe(n,"documentOverlays")}class us{constructor(){}ae(e,t){this.he(e,t),t.le()}he(e,t){if("nullValue"in e)this.fe(t,5);else if("booleanValue"in e)this.fe(t,10),t.de(e.booleanValue?1:0);else if("integerValue"in e)this.fe(t,15),t.de(me(e.integerValue));else if("doubleValue"in e){const s=me(e.doubleValue);isNaN(s)?this.fe(t,13):(this.fe(t,15),Ci(s)?t.de(0):t.de(s))}else if("timestampValue"in e){const s=e.timestampValue;this.fe(t,20),"string"==typeof s?t._e(s):(t._e(`${s.seconds||""}`),t.de(s.nanos||0))}else if("stringValue"in e)this.we(e.stringValue,t),this.me(t);else if("bytesValue"in e)this.fe(t,30),t.ge(Jn(e.bytesValue)),this.me(t);else if("referenceValue"in e)this.ye(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.fe(t,45),t.de(s.latitude||0),t.de(s.longitude||0)}else"mapValue"in e?Ah(e)?this.fe(t,Number.MAX_SAFE_INTEGER):(this.pe(e.mapValue,t),this.me(t)):"arrayValue"in e?(this.Ie(e.arrayValue,t),this.me(t)):M()}we(e,t){this.fe(t,25),this.Te(e,t)}Te(e,t){t._e(e)}pe(e,t){const s=e.fields||{};this.fe(t,55);for(const r of Object.keys(s))this.we(r,t),this.he(s[r],t)}Ie(e,t){const s=e.values||[];this.fe(t,50);for(const r of s)this.he(r,t)}ye(e,t){this.fe(t,37),A.fromName(e).path.forEach(s=>{this.fe(t,60),this.Te(s,t)})}fe(e,t){e.de(t)}me(e){e.de(2)}}function vg(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function jd(n){const e=64-function(t){let s=0;for(let r=0;r<8;++r){const i=vg(255&t[r]);if(s+=i,8!==i)break}return s}(n);return Math.ceil(e/8)}us.Ee=new us;class bg{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ae(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Re(s.value),s=t.next();this.be()}ve(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Pe(s.value),s=t.next();this.Ve()}Se(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Re(s);else if(s<2048)this.Re(960|s>>>6),this.Re(128|63&s);else if(t<"\ud800"||"\udbff"<t)this.Re(480|s>>>12),this.Re(128|63&s>>>6),this.Re(128|63&s);else{const r=t.codePointAt(0);this.Re(240|r>>>18),this.Re(128|63&r>>>12),this.Re(128|63&r>>>6),this.Re(128|63&r)}}this.be()}De(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Pe(s);else if(s<2048)this.Pe(960|s>>>6),this.Pe(128|63&s);else if(t<"\ud800"||"\udbff"<t)this.Pe(480|s>>>12),this.Pe(128|63&s>>>6),this.Pe(128|63&s);else{const r=t.codePointAt(0);this.Pe(240|r>>>18),this.Pe(128|63&r>>>12),this.Pe(128|63&r>>>6),this.Pe(128|63&r)}}this.Ve()}Ce(e){const t=this.xe(e),s=jd(t);this.Ne(1+s),this.buffer[this.position++]=255&s;for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=255&t[r]}ke(e){const t=this.xe(e),s=jd(t);this.Ne(1+s),this.buffer[this.position++]=~(255&s);for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}Oe(){this.Me(255),this.Me(255)}Fe(){this.$e(255),this.$e(255)}reset(){this.position=0}seed(e){this.Ne(e.length),this.buffer.set(e,this.position),this.position+=e.length}Be(){return this.buffer.slice(0,this.position)}xe(e){const t=function(r){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,r,!1),new Uint8Array(i.buffer)}(e),s=0!=(128&t[0]);t[0]^=s?255:128;for(let r=1;r<t.length;++r)t[r]^=s?255:0;return t}Re(e){const t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(t)}Pe(e){const t=255&e;0===t?(this.$e(0),this.$e(255)):255===t?(this.$e(255),this.$e(0)):this.$e(e)}be(){this.Me(0),this.Me(1)}Ve(){this.$e(0),this.$e(1)}Me(e){this.Ne(1),this.buffer[this.position++]=e}$e(e){this.Ne(1),this.buffer[this.position++]=~e}Ne(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class xg{constructor(e){this.Le=e}ge(e){this.Le.Ae(e)}_e(e){this.Le.Se(e)}de(e){this.Le.Ce(e)}le(){this.Le.Oe()}}class _g{constructor(e){this.Le=e}ge(e){this.Le.ve(e)}_e(e){this.Le.De(e)}de(e){this.Le.ke(e)}le(){this.Le.Fe()}}class Ki{constructor(){this.Le=new bg,this.qe=new xg(this.Le),this.Ue=new _g(this.Le)}seed(e){this.Le.seed(e)}Ke(e){return 0===e?this.qe:this.Ue}Be(){return this.Le.Be()}reset(){this.Le.reset()}}class ls{constructor(e,t,s,r){this.indexId=e,this.documentKey=t,this.arrayValue=s,this.directionalValue=r}Ge(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,s=new Uint8Array(t);return s.set(this.directionalValue,0),t!==e?s.set([0],this.directionalValue.length):++s[s.length-1],new ls(this.indexId,this.documentKey,this.arrayValue,s)}}function mn(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=$d(n.arrayValue,e.arrayValue),0!==t?t:(t=$d(n.directionalValue,e.directionalValue),0!==t?t:A.comparator(n.documentKey,e.documentKey)))}function $d(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(0!==s)return s}return n.length-e.length}class Tg{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Qe=e.orderBy,this.je=[];for(const t of e.filters){const s=t;s.isInequality()?this.ze=s:this.je.push(s)}}We(e){O(e.collectionGroup===this.collectionId);const t=zc(e);if(void 0!==t&&!this.He(t))return!1;const s=Wn(e);let r=0,i=0;for(;r<s.length&&this.He(s[r]);++r);if(r===s.length)return!0;if(void 0!==this.ze){const o=s[r];if(!this.Je(this.ze,o)||!this.Ye(this.Qe[i++],o))return!1;++r}for(;r<s.length;++r)if(i>=this.Qe.length||!this.Ye(this.Qe[i++],s[r]))return!1;return!0}He(e){for(const t of this.je)if(this.Je(t,e))return!0;return!1}Je(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}Ye(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Kd(n){var e,t;if(O(n instanceof Q||n instanceof ne),n instanceof Q){if(n instanceof Bh){const r=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(i=>Q.create(n.field,"==",i)))||[];return ne.create(r,"or")}return n}const s=n.filters.map(r=>Kd(r));return ne.create(s,n.op)}function Ig(n){if(0===n.getFilters().length)return[];const e=xu(Kd(n));return O(Gd(e)),vu(e)||bu(e)?[e]:e.getFilters()}function vu(n){return n instanceof Q}function bu(n){return n instanceof ne&&tu(n)}function Gd(n){return vu(n)||bu(n)||function(e){if(e instanceof ne&&eu(e)){for(const t of e.getFilters())if(!vu(t)&&!bu(t))return!1;return!0}return!1}(n)}function xu(n){if(O(n instanceof Q||n instanceof ne),n instanceof Q)return n;if(1===n.filters.length)return xu(n.filters[0]);const e=n.filters.map(s=>xu(s));let t=ne.create(e,n.op);return t=Ia(t),Gd(t)?t:(O(t instanceof ne),O(rr(t)),O(t.filters.length>1),t.filters.reduce((s,r)=>_u(s,r)))}function _u(n,e){let t;return O(n instanceof Q||n instanceof ne),O(e instanceof Q||e instanceof ne),t=n instanceof Q?e instanceof Q?ne.create([n,e],"and"):zd(n,e):e instanceof Q?zd(e,n):function(s,r){if(O(s.filters.length>0&&r.filters.length>0),rr(s)&&rr(r))return Fh(s,r.getFilters());const i=eu(s)?s:r,o=eu(s)?r:s,a=i.filters.map(l=>_u(l,o));return ne.create(a,"or")}(n,e),Ia(t)}function zd(n,e){if(rr(e))return Fh(e,n.getFilters());{const t=e.filters.map(s=>_u(n,s));return ne.create(t,"or")}}function Ia(n){if(O(n instanceof Q||n instanceof ne),n instanceof Q)return n;const e=n.getFilters();if(1===e.length)return Ia(e[0]);if(Oh(n))return n;const t=e.map(r=>Ia(r)),s=[];return t.forEach(r=>{r instanceof Q?s.push(r):r instanceof ne&&(r.op===n.op?s.push(...r.filters):s.push(r))}),1===s.length?s[0]:ne.create(s,n.op)}class Cg{constructor(){this.Ze=new Tu}addToCollectionParentIndex(e,t){return this.Ze.add(t),v.resolve()}getCollectionParents(e,t){return v.resolve(this.Ze.getEntries(t))}addFieldIndex(e,t){return v.resolve()}deleteFieldIndex(e,t){return v.resolve()}getDocumentsMatchingTarget(e,t){return v.resolve(null)}getIndexType(e,t){return v.resolve(0)}getFieldIndexes(e,t){return v.resolve([])}getNextCollectionGroupToUpdate(e){return v.resolve(null)}getMinOffset(e,t){return v.resolve(it.min())}getMinOffsetFromCollectionGroup(e,t){return v.resolve(it.min())}updateCollectionGroup(e,t,s){return v.resolve()}updateIndexEntries(e,t){return v.resolve()}}class Tu{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new re(X.comparator),i=!r.has(s);return this.index[t]=r.add(s),i}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new re(X.comparator)).toArray()}}const Ca=new Uint8Array(0);class Eg{constructor(e,t){this.user=e,this.databaseId=t,this.Xe=new Tu,this.tn=new dn(s=>ns(s),(s,r)=>Di(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Xe.has(t)){const s=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.Xe.add(t)});const i={collectionId:s,parent:He(r)};return Hd(e).put(i)}return v.resolve()}getCollectionParents(e,t){const s=[],r=IDBKeyRange.bound([t,""],[mh(t),""],!1,!0);return Hd(e).W(r).next(i=>{for(const o of i){if(o.collectionId!==t)break;s.push(kt(o.parent))}return s})}addFieldIndex(e,t){const s=Ea(e),r={indexId:(o=t).indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])};var o;delete r.indexId;const i=s.add(r);if(t.indexState){const o=zi(e);return i.next(a=>{o.put(Bd(a,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const s=Ea(e),r=zi(e),i=Gi(e);return s.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const s=Gi(e);let r=!0;const i=new Map;return v.forEach(this.en(t),o=>this.nn(e,o).next(a=>{r&&(r=!!a),i.set(o,a)})).next(()=>{if(r){let o=j();const a=[];return v.forEach(i,(l,h)=>{var f;E("IndexedDbIndexManager",`Using index ${f=l,`id=${f.indexId}|cg=${f.collectionGroup}|f=${f.fields.map(L=>`${L.fieldPath}:${L.kind}`).join(",")}`} to execute ${ns(t)}`);const p=function(L,le){const z=zc(le);if(void 0===z)return null;for(const J of fa(L,z.fieldPath))switch(J.op){case"array-contains-any":return J.value.arrayValue.values||[];case"array-contains":return[J.value]}return null}(h,l),g=function(L,le){const z=new Map;for(const J of Wn(le))for(const Se of fa(L,J.fieldPath))switch(Se.op){case"==":case"in":z.set(J.fieldPath.canonicalString(),Se.value);break;case"not-in":case"!=":return z.set(J.fieldPath.canonicalString(),Se.value),Array.from(z.values())}return null}(h,l),w=function(L,le){const z=[];let J=!0;for(const Se of Wn(le)){const lo=0===Se.kind?jh(L,Se.fieldPath,L.startAt):$h(L,Se.fieldPath,L.startAt);z.push(lo.value),J&&(J=lo.inclusive)}return new hn(z,J)}(h,l),T=function(L,le){const z=[];let J=!0;for(const Se of Wn(le)){const lo=0===Se.kind?$h(L,Se.fieldPath,L.endAt):jh(L,Se.fieldPath,L.endAt);z.push(lo.value),J&&(J=lo.inclusive)}return new hn(z,J)}(h,l),S=this.sn(l,h,w),P=this.sn(l,h,T),te=this.rn(l,h,g),N=this.on(l.indexId,p,S,w.inclusive,P,T.inclusive,te);return v.forEach(N,L=>s.J(L,t.limit).next(le=>{le.forEach(z=>{const J=A.fromSegments(z.documentKey);o.has(J)||(o=o.add(J),a.push(J))})}))}).next(()=>a)}return v.resolve(null)})}en(e){let t=this.tn.get(e);return t||(t=0===e.filters.length?[e]:Ig(ne.create(e.filters,"and")).map(s=>su(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt)),this.tn.set(e,t),t)}on(e,t,s,r,i,o,a){const l=(null!=t?t.length:1)*Math.max(s.length,i.length),h=l/(null!=t?t.length:1),f=[];for(let p=0;p<l;++p){const g=t?this.un(t[p/h]):Ca,w=this.cn(e,g,s[p%h],r),T=this.an(e,g,i[p%h],o),S=a.map(P=>this.cn(e,g,P,!0));f.push(...this.createRange(w,T,S))}return f}cn(e,t,s,r){const i=new ls(e,A.empty(),t,s);return r?i:i.Ge()}an(e,t,s,r){const i=new ls(e,A.empty(),t,s);return r?i.Ge():i}nn(e,t){const s=new Tg(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const a of i)s.We(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let s=2;const r=this.en(t);return v.forEach(r,i=>this.nn(e,i).next(o=>{o?0!==s&&o.fields.length<function(a){let l=new re(pe.comparator),h=!1;for(const f of a.filters)for(const p of f.getFlattenedFilters())p.field.isKeyField()||("array-contains"===p.op||"array-contains-any"===p.op?h=!0:l=l.add(p.field));for(const f of a.orderBy)f.field.isKeyField()||(l=l.add(f.field));return l.size+(h?1:0)}(i)&&(s=1):s=0})).next(()=>null!==t.limit&&r.length>1&&2===s?1:s)}hn(e,t){const s=new Ki;for(const r of Wn(e)){const i=t.data.field(r.fieldPath);if(null==i)return null;const o=s.Ke(r.kind);us.Ee.ae(i,o)}return s.Be()}un(e){const t=new Ki;return us.Ee.ae(e,t.Ke(0)),t.Be()}ln(e,t){const s=new Ki;return us.Ee.ae(ts(this.databaseId,t),s.Ke(function(r){const i=Wn(r);return 0===i.length?0:i[i.length-1].kind}(e))),s.Be()}rn(e,t,s){if(null===s)return[];let r=[];r.push(new Ki);let i=0;for(const o of Wn(e)){const a=s[i++];for(const l of r)if(this.fn(t,o.fieldPath)&&Ai(a))r=this.dn(r,o,a);else{const h=l.Ke(o.kind);us.Ee.ae(a,h)}}return this._n(r)}sn(e,t,s){return this.rn(e,t,s.position)}_n(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].Be();return t}dn(e,t,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const a of r){const l=new Ki;l.seed(a.Be()),us.Ee.ae(o,l.Ke(t.kind)),i.push(l)}return i}fn(e,t){return!!e.filters.find(s=>s instanceof Q&&s.field.isEqual(t)&&("in"===s.op||"not-in"===s.op))}getFieldIndexes(e,t){const s=Ea(e),r=zi(e);return(t?s.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):s.W()).next(i=>{const o=[];return v.forEach(i,a=>r.get([a.indexId,this.uid]).next(l=>{o.push(function(h,f){const p=f?new _i(f.sequenceNumber,new it(as(f.readTime),new A(kt(f.documentKey)),f.largestBatchId)):_i.empty(),g=h.fields.map(([w,T])=>new aa(pe.fromServerFormat(w),T));return new oa(h.indexId,h.collectionGroup,g,p)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==i?i:U(s.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,s){const r=Ea(e),i=zi(e);return this.wn(e).next(o=>r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>v.forEach(a,l=>i.put(Bd(l.indexId,this.user,o,s)))))}updateIndexEntries(e,t){const s=new Map;return v.forEach(t,(r,i)=>{const o=s.get(r.collectionGroup);return(o?v.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(a=>(s.set(r.collectionGroup,a),v.forEach(a,l=>this.mn(e,r,l).next(h=>{const f=this.gn(i,l);return h.isEqual(f)?v.resolve():this.yn(e,i,l,h,f)}))))})}pn(e,t,s,r){return Gi(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.ln(s,t.key),documentKey:t.key.path.toArray()})}In(e,t,s,r){return Gi(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.ln(s,t.key),t.key.path.toArray()])}mn(e,t,s){const r=Gi(e);let i=new re(mn);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([s.indexId,this.uid,this.ln(s,t)])},(o,a)=>{i=i.add(new ls(s.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}gn(e,t){let s=new re(mn);const r=this.hn(t,e);if(null==r)return s;const i=zc(t);if(null!=i){const o=e.data.field(i.fieldPath);if(Ai(o))for(const a of o.arrayValue.values||[])s=s.add(new ls(t.indexId,e.key,this.un(a),r))}else s=s.add(new ls(t.indexId,e.key,Ca,r));return s}yn(e,t,s,r,i){E("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(a,l,h,f,p){const g=a.getIterator(),w=l.getIterator();let T=or(g),S=or(w);for(;T||S;){let P=!1,te=!1;if(T&&S){const N=h(T,S);N<0?te=!0:N>0&&(P=!0)}else null!=T?te=!0:P=!0;P?(f(S),S=or(w)):te?(p(T),T=or(g)):(T=or(g),S=or(w))}}(r,i,mn,a=>{o.push(this.pn(e,t,s,a))},a=>{o.push(this.In(e,t,s,a))}),v.waitFor(o)}wn(e){let t=1;return zi(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,s){s=s.sort((o,a)=>mn(o,a)).filter((o,a,l)=>!a||0!==mn(o,l[a-1]));const r=[];r.push(e);for(const o of s){const a=mn(o,e),l=mn(o,t);if(0===a)r[0]=e.Ge();else if(a>0&&l<0)r.push(o),r.push(o.Ge());else if(l>0)break}r.push(t);const i=[];for(let o=0;o<r.length;o+=2){if(this.Tn(r[o],r[o+1]))return[];i.push(IDBKeyRange.bound([r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,Ca,[]],[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,Ca,[]]))}return i}Tn(e,t){return mn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Qd)}getMinOffset(e,t){return v.mapArray(this.en(t),s=>this.nn(e,s).next(r=>r||M())).next(Qd)}}function Hd(n){return Fe(n,"collectionParents")}function Gi(n){return Fe(n,"indexEntries")}function Ea(n){return Fe(n,"indexConfiguration")}function zi(n){return Fe(n,"indexState")}function Qd(n){O(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const r=n[s].indexState.offset;Hc(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new it(e.readTime,e.documentKey,t)}const Zd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class et{constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}static withCacheSize(e){return new et(e,et.DEFAULT_COLLECTION_PERCENTILE,et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Wd(n,e,t){const s=n.store("mutations"),r=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=s.X({range:o},(f,p,g)=>(a++,g.delete()));i.push(l.next(()=>{O(1===a)}));const h=[];for(const f of t.mutations){const p=Md(e,f.key.path,t.batchId);i.push(r.delete(p)),h.push(f.key)}return v.waitFor(i).next(()=>h)}function Sa(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw M();e=n.noDocument}return JSON.stringify(e).length}et.DEFAULT_COLLECTION_PERCENTILE=10,et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,et.DEFAULT=new et(41943040,et.DEFAULT_COLLECTION_PERCENTILE,et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),et.DISABLED=new et(-1,0,0);class Aa{constructor(e,t,s,r){this.userId=e,this.Tt=t,this.indexManager=s,this.referenceDelegate=r,this.En={}}static ue(e,t,s,r){O(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new Aa(i,t,s,r)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return gn(e).X({index:"userMutationsIndex",range:s},(r,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,s,r){const i=pr(e),o=gn(e);return o.add({}).next(a=>{O("number"==typeof a);const l=new pu(a,t,s,r),h=function(g,w,T){const S=T.baseMutations.map(te=>Ui(g.oe,te)),P=T.mutations.map(te=>Ui(g.oe,te));return{userId:w,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:S,mutations:P}}(this.Tt,this.userId,l),f=[];let p=new re((g,w)=>U(g.canonicalString(),w.canonicalString()));for(const g of r){const w=Md(this.userId,g.key.path,a);p=p.add(g.key.path.popLast()),f.push(o.put(h)),f.push(i.put(w,eg))}return p.forEach(g=>{f.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.En[a]=l.keys()}),v.waitFor(f).next(()=>l)})}lookupMutationBatch(e,t){return gn(e).get(t).next(s=>s?(O(s.userId===this.userId),cs(this.Tt,s)):null)}An(e,t){return this.En[t]?v.resolve(this.En[t]):this.lookupMutationBatch(e,t).next(s=>{if(s){const r=s.keys();return this.En[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return gn(e).X({index:"userMutationsIndex",range:r},(o,a,l)=>{a.userId===this.userId&&(O(a.batchId>=s),i=cs(this.Tt,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=-1;return gn(e).X({index:"userMutationsIndex",range:t,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return gn(e).W("userMutationsIndex",t).next(s=>s.map(r=>cs(this.Tt,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=xa(this.userId,t.path),r=IDBKeyRange.lowerBound(s),i=[];return pr(e).X({range:r},(o,a,l)=>{const[h,f,p]=o,g=kt(f);if(h===this.userId&&t.path.isEqual(g))return gn(e).get(p).next(w=>{if(!w)throw M();O(w.userId===this.userId),i.push(cs(this.Tt,w))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new re(U);const r=[];return t.forEach(i=>{const o=xa(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=pr(e).X({range:a},(h,f,p)=>{const[g,w,T]=h,S=kt(w);g===this.userId&&i.path.isEqual(S)?s=s.add(T):p.done()});r.push(l)}),v.waitFor(r).next(()=>this.Rn(e,s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1,i=xa(this.userId,s),o=IDBKeyRange.lowerBound(i);let a=new re(U);return pr(e).X({range:o},(l,h,f)=>{const[p,g,w]=l,T=kt(g);p===this.userId&&s.isPrefixOf(T)?T.length===r&&(a=a.add(w)):f.done()}).next(()=>this.Rn(e,a))}Rn(e,t){const s=[],r=[];return t.forEach(i=>{r.push(gn(e).get(i).next(o=>{if(null===o)throw M();O(o.userId===this.userId),s.push(cs(this.Tt,o))}))}),v.waitFor(r).next(()=>s)}removeMutationBatch(e,t){return Wd(e.re,this.userId,t).next(s=>(e.addOnCommittedListener(()=>{this.bn(t.batchId)}),v.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}bn(e){delete this.En[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return v.resolve();const s=IDBKeyRange.lowerBound([this.userId]),r=[];return pr(e).X({range:s},(i,o,a)=>{if(i[0]===this.userId){const l=kt(i[1]);r.push(l)}else a.done()}).next(()=>{O(0===r.length)})})}containsKey(e,t){return Xd(e,this.userId,t)}vn(e){return Yd(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Xd(n,e,t){const s=xa(e,t.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return pr(n).X({range:i,Z:!0},(a,l,h)=>{const[f,p,g]=a;f===e&&p===r&&(o=!0),h.done()}).next(()=>o)}function gn(n){return Fe(n,"mutations")}function pr(n){return Fe(n,"documentMutations")}function Yd(n){return Fe(n,"mutationQueues")}class hs{constructor(e){this.Pn=e}next(){return this.Pn+=2,this.Pn}static Vn(){return new hs(0)}static Sn(){return new hs(-1)}}class Sg{constructor(e,t){this.referenceDelegate=e,this.Tt=t}allocateTargetId(e){return this.Dn(e).next(t=>{const s=new hs(t.highestTargetId);return t.highestTargetId=s.next(),this.Cn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Dn(e).next(t=>R.fromTimestamp(new de(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Dn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,s){return this.Dn(e).next(r=>(r.highestListenSequenceNumber=t,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Cn(e,r)))}addTargetData(e,t){return this.xn(e,t).next(()=>this.Dn(e).next(s=>(s.targetCount+=1,this.Nn(t,s),this.Cn(e,s))))}updateTargetData(e,t){return this.xn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>mr(e).delete(t.targetId)).next(()=>this.Dn(e)).next(s=>(O(s.targetCount>0),s.targetCount-=1,this.Cn(e,s)))}removeTargets(e,t,s){let r=0;const i=[];return mr(e).X((o,a)=>{const l=ji(a);l.sequenceNumber<=t&&null===s.get(l.targetId)&&(r++,i.push(this.removeTargetData(e,l)))}).next(()=>v.waitFor(i)).next(()=>r)}forEachTarget(e,t){return mr(e).X((s,r)=>{const i=ji(r);t(i)})}Dn(e){return Jd(e).get("targetGlobalKey").next(t=>(O(null!==t),t))}Cn(e,t){return Jd(e).put("targetGlobalKey",t)}xn(e,t){return mr(e).put(Rd(this.Tt,t))}Nn(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.Dn(e).next(t=>t.targetCount)}getTargetData(e,t){const s=ns(t),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return mr(e).X({range:r,index:"queryTargetsIndex"},(o,a,l)=>{const h=ji(a);Di(t,h.target)&&(i=h,l.done())}).next(()=>i)}addMatchingKeys(e,t,s){const r=[],i=yn(e);return t.forEach(o=>{const a=He(o.path);r.push(i.put({targetId:s,path:a})),r.push(this.referenceDelegate.addReference(e,s,o))}),v.waitFor(r)}removeMatchingKeys(e,t,s){const r=yn(e);return v.forEach(t,i=>{const o=He(i.path);return v.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,t){const s=yn(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),r=yn(e);let i=j();return r.X({range:s,Z:!0},(o,a,l)=>{const h=kt(o[1]),f=new A(h);i=i.add(f)}).next(()=>i)}containsKey(e,t){const s=He(t.path),r=IDBKeyRange.bound([s],[mh(s)],!1,!0);let i=0;return yn(e).X({index:"documentTargetsIndex",Z:!0,range:r},([o,a],l,h)=>{0!==o&&(i++,h.done())}).next(()=>i>0)}ie(e,t){return mr(e).get(t).next(s=>s?ji(s):null)}}function mr(n){return Fe(n,"targets")}function Jd(n){return Fe(n,"targetGlobal")}function yn(n){return Fe(n,"targetDocuments")}function ef([n,e],[t,s]){const r=U(n,t);return 0===r?U(e,s):r}class Ag{constructor(e){this.kn=e,this.buffer=new re(ef),this.On=0}Mn(){return++this.On}Fn(e){const t=[e,this.Mn()];if(this.buffer.size<this.kn)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();ef(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class kg{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.$n=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Bn(6e4)}stop(){this.$n&&(this.$n.cancel(),this.$n=null)}get started(){return null!==this.$n}Bn(e){var t=this;E("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.$n=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,I.Z)(function*(){t.$n=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(s){on(s)?E("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",s):yield rn(s)}yield t.Bn(3e5)}))}}class Dg{constructor(e,t){this.Ln=e,this.params=t}calculateTargetCount(e,t){return this.Ln.qn(e).next(s=>Math.floor(t/100*s))}nthSequenceNumber(e,t){if(0===t)return v.resolve(ot.at);const s=new Ag(t);return this.Ln.forEachTarget(e,r=>s.Fn(r.sequenceNumber)).next(()=>this.Ln.Un(e,r=>s.Fn(r))).next(()=>s.maxValue)}removeTargets(e,t,s){return this.Ln.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Ln.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(E("LruGarbageCollector","Garbage collection skipped; disabled"),v.resolve(Zd)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(E("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Zd):this.Kn(e,t))}getCacheSize(e){return this.Ln.getCacheSize(e)}Kn(e,t){let s,r,i,o,a,l,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(E("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),r=this.params.maximumSequenceNumbersToCollect):r=p,o=Date.now(),this.nthSequenceNumber(e,r))).next(p=>(s=p,a=Date.now(),this.removeTargets(e,s,t))).next(p=>(i=p,l=Date.now(),this.removeOrphanedDocuments(e,s))).next(p=>(h=Date.now(),Kc()<=Ae.in.DEBUG&&E("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-f}ms\n\tDetermined least recently used ${r} in `+(a-o)+`ms\n\tRemoved ${i} targets in `+(l-a)+`ms\n\tRemoved ${p} documents in `+(h-l)+`ms\nTotal Duration: ${h-f}ms`),v.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:p})))}}class Mg{constructor(e,t){this.db=e,this.garbageCollector=new Dg(this,t)}qn(e){const t=this.Gn(e);return this.db.getTargetCache().getTargetCount(e).next(s=>t.next(r=>s+r))}Gn(e){let t=0;return this.Un(e,s=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Un(e,t){return this.Qn(e,(s,r)=>t(r))}addReference(e,t,s){return ka(e,s)}removeReference(e,t,s){return ka(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return ka(e,t)}jn(e,t){return function(s,r){let i=!1;return Yd(s).tt(o=>Xd(s,o,r).next(a=>(a&&(i=!0),v.resolve(!a)))).next(()=>i)}(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Qn(e,(o,a)=>{if(a<=t){const l=this.jn(e,o).next(h=>{if(!h)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,R.min()),yn(e).delete([0,He(o.path)])))});r.push(l)}}).next(()=>v.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return ka(e,t)}Qn(e,t){const s=yn(e);let r,i=ot.at;return s.X({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:h})=>{0===o?(i!==ot.at&&t(new A(kt(r)),i),i=h,r=l):i=ot.at}).next(()=>{i!==ot.at&&t(new A(kt(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ka(n,e){return yn(n).put((s=n.currentSequenceNumber,{targetId:0,path:He(e.path),sequenceNumber:s}));var s}class tf{constructor(){this.changes=new dn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ae.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return void 0!==s?v.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ng{constructor(e){this.Tt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return ds(e).put(s)}removeEntry(e,t,s){return ds(e).delete(function(r,i){const o=r.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],_a(i),o[o.length-1]]}(t,s))}updateMetadata(e,t){return this.getMetadata(e).next(s=>(s.byteSize+=t,this.zn(e,s)))}getEntry(e,t){let s=ae.newInvalidDocument(t);return ds(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Hi(t))},(r,i)=>{s=this.Wn(t,i)}).next(()=>s)}Hn(e,t){let s={size:0,document:ae.newInvalidDocument(t)};return ds(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Hi(t))},(r,i)=>{s={document:this.Wn(t,i),size:Sa(i)}}).next(()=>s)}getEntries(e,t){let s=Je();return this.Jn(e,t,(r,i)=>{const o=this.Wn(r,i);s=s.insert(r,o)}).next(()=>s)}Yn(e,t){let s=Je(),r=new ge(A.comparator);return this.Jn(e,t,(i,o)=>{const a=this.Wn(i,o);s=s.insert(i,a),r=r.insert(i,Sa(o))}).next(()=>({documents:s,Zn:r}))}Jn(e,t,s){if(t.isEmpty())return v.resolve();let r=new re(of);t.forEach(l=>r=r.add(l));const i=IDBKeyRange.bound(Hi(r.first()),Hi(r.last())),o=r.getIterator();let a=o.getNext();return ds(e).X({index:"documentKeyIndex",range:i},(l,h,f)=>{const p=A.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;a&&of(a,p)<0;)s(a,null),a=o.getNext();a&&a.isEqual(p)&&(s(a,h),a=o.hasNext()?o.getNext():null),a?f.j(Hi(a)):f.done()}).next(()=>{for(;a;)s(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,s,r){const i=t.path,o=[i.popLast().toArray(),i.lastSegment(),_a(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],a=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ds(e).W(IDBKeyRange.bound(o,a,!0)).next(l=>{let h=Je();for(const f of l){const p=this.Wn(A.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);p.isFoundDocument()&&(Ni(t,p)||r.has(p.key))&&(h=h.insert(p.key,p))}return h})}getAllFromCollectionGroup(e,t,s,r){let i=Je();const o=rf(t,s),a=rf(t,it.max());return ds(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,h,f)=>{const p=this.Wn(A.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);i=i.insert(p.key,p),i.size===r&&f.done()}).next(()=>i)}newChangeBuffer(e){return new Pg(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return sf(e).get("remoteDocumentGlobalKey").next(t=>(O(!!t),t))}zn(e,t){return sf(e).put("remoteDocumentGlobalKey",t)}Wn(e,t){if(t){const s=function yg(n,e){let t;if(e.document)t=Td(n.oe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=A.fromSegments(e.noDocument.path),r=as(e.noDocument.readTime);t=ae.newNoDocument(s,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return M();{const s=A.fromSegments(e.unknownDocument.path),r=as(e.unknownDocument.version);t=ae.newUnknownDocument(s,r)}}return e.readTime&&t.setReadTime(function(s){const r=new de(s[0],s[1]);return R.fromTimestamp(r)}(e.readTime)),t}(this.Tt,t);if(!s.isNoDocument()||!s.version.isEqual(R.min()))return s}return ae.newInvalidDocument(e)}}function nf(n){return new Ng(n)}class Pg extends tf{constructor(e,t){super(),this.Xn=e,this.trackRemovals=t,this.ts=new dn(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const t=[];let s=0,r=new re((i,o)=>U(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.ts.get(i);if(t.push(this.Xn.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=Fd(this.Xn.Tt,o);r=r.add(i.path.popLast());const h=Sa(l);s+=h-a.size,t.push(this.Xn.addEntry(e,i,l))}else if(s-=a.size,this.trackRemovals){const l=Fd(this.Xn.Tt,o.convertToNoDocument(R.min()));t.push(this.Xn.addEntry(e,i,l))}}),r.forEach(i=>{t.push(this.Xn.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.Xn.updateMetadata(e,s)),v.waitFor(t)}getFromCache(e,t){return this.Xn.Hn(e,t).next(s=>(this.ts.set(t,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,t){return this.Xn.Yn(e,t).next(({documents:s,Zn:r})=>(r.forEach((i,o)=>{this.ts.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function sf(n){return Fe(n,"remoteDocumentGlobal")}function ds(n){return Fe(n,"remoteDocumentsV14")}function Hi(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function rf(n,e){const t=e.documentKey.path.toArray();return[n,_a(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function of(n,e){const t=n.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<t.length-2&&i<s.length-2;++i)if(r=U(t[i],s[i]),r)return r;return r=U(t.length,s.length),r||(r=U(t[t.length-2],s[s.length-2]),r||U(t[t.length-1],s[s.length-1]))}class Og{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class af{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(null!==s&&Oi(s.mutation,r,Ye.empty(),de.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,j()).next(()=>s))}getLocalViewOfDocuments(e,t,s=j()){const r=St();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,s).next(i=>{let o=Li();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const s=St();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,j()))}populateOverlays(e,t,s){const r=[];return s.forEach(i=>{t.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,s,r){let i=Je();const o=Fi(),a=Fi();return t.forEach((l,h)=>{const f=s.get(h.key);r.has(h.key)&&(void 0===f||f.mutation instanceof qt)?i=i.insert(h.key,h):void 0!==f?(o.set(h.key,f.mutation.getFieldMask()),Oi(f.mutation,h,f.mutation.getFieldMask(),de.now())):o.set(h.key,Ye.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((h,f)=>o.set(h,f)),t.forEach((h,f)=>{var p;return a.set(h,new Og(f,null!==(p=o.get(h))&&void 0!==p?p:null))}),a))}recalculateAndSaveOverlays(e,t){const s=Fi();let r=new ge((o,a)=>o-a),i=j();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const h=t.get(l);if(null===h)return;let f=s.get(l)||Ye.empty();f=a.applyToLocalView(h,f),s.set(l,f);const p=(r.get(a.batchId)||j()).add(l);r=r.insert(a.batchId,p)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),h=l.key,f=l.value,p=dd();f.forEach(g=>{if(!i.has(g)){const w=sd(t.get(g),s.get(g));null!==w&&p.set(g,w),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return v.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s){return A.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):iu(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s):this.getDocumentsMatchingCollectionQuery(e,t,s);var r}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-i.size):v.resolve(St());let a=-1,l=i;return o.next(h=>v.forEach(h,(f,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),i.get(f)?v.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,l,h,j())).next(f=>({batchId:a,changes:hd(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new A(t)).next(s=>{let r=Li();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,s){const r=t.collectionGroup;let i=Li();return this.indexManager.getCollectionParents(e,r).next(o=>v.forEach(o,a=>{const l=(h=t,f=a.child(r),new Bt(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt));var h,f;return this.getDocumentsMatchingCollectionQuery(e,l,s).next(h=>{h.forEach((f,p)=>{i=i.insert(f,p)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,s){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(i=>(r=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,r))).next(i=>{r.forEach((a,l)=>{const h=l.getKey();null===i.get(h)&&(i=i.insert(h,ae.newInvalidDocument(h)))});let o=Li();return i.forEach((a,l)=>{const h=r.get(a);void 0!==h&&Oi(h.mutation,l,Ye.empty(),de.now()),Ni(t,l)&&(o=o.insert(a,l))}),o})}}class Lg{constructor(e){this.Tt=e,this.es=new Map,this.ns=new Map}getBundleMetadata(e,t){return v.resolve(this.es.get(t))}saveBundleMetadata(e,t){var s;return this.es.set(t.id,{id:(s=t).id,version:s.version,createTime:we(s.createTime)}),v.resolve()}getNamedQuery(e,t){return v.resolve(this.ns.get(t))}saveNamedQuery(e,t){return this.ns.set(t.name,{name:(s=t).name,query:yu(s.bundledQuery),readTime:we(s.readTime)}),v.resolve();var s}}class Fg{constructor(){this.overlays=new ge(A.comparator),this.ss=new Map}getOverlay(e,t){return v.resolve(this.overlays.get(t))}getOverlays(e,t){const s=St();return v.forEach(t,r=>this.getOverlay(e,r).next(i=>{null!==i&&s.set(r,i)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((r,i)=>{this.ce(e,t,i)}),v.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.ss.get(s);return void 0!==r&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.ss.delete(s)),v.resolve()}getOverlaysForCollection(e,t,s){const r=St(),i=t.length+1,o=new A(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>s&&r.set(l.getKey(),l)}return v.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let i=new ge((h,f)=>h-f);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>s){let f=i.get(h.largestBatchId);null===f&&(f=St(),i=i.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const a=St(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((h,f)=>a.set(h,f)),!(a.size()>=r)););return v.resolve(a)}ce(e,t,s){const r=this.overlays.get(s.key);if(null!==r){const o=this.ss.get(r.largestBatchId).delete(s.key);this.ss.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new gu(t,s));let i=this.ss.get(t);void 0===i&&(i=j(),this.ss.set(t,i)),this.ss.set(t,i.add(s.key))}}class Iu{constructor(){this.rs=new re(Re.os),this.us=new re(Re.cs)}isEmpty(){return this.rs.isEmpty()}addReference(e,t){const s=new Re(e,t);this.rs=this.rs.add(s),this.us=this.us.add(s)}hs(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.ls(new Re(e,t))}fs(e,t){e.forEach(s=>this.removeReference(s,t))}ds(e){const t=new A(new X([])),s=new Re(t,e),r=new Re(t,e+1),i=[];return this.us.forEachInRange([s,r],o=>{this.ls(o),i.push(o.key)}),i}_s(){this.rs.forEach(e=>this.ls(e))}ls(e){this.rs=this.rs.delete(e),this.us=this.us.delete(e)}ws(e){const t=new A(new X([])),s=new Re(t,e),r=new Re(t,e+1);let i=j();return this.us.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Re(e,0),s=this.rs.firstAfterOrEqual(t);return null!==s&&e.isEqual(s.key)}}class Re{constructor(e,t){this.key=e,this.gs=t}static os(e,t){return A.comparator(e.key,t.key)||U(e.gs,t.gs)}static cs(e,t){return U(e.gs,t.gs)||A.comparator(e.key,t.key)}}class Rg{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ys=1,this.ps=new re(Re.os)}checkEmpty(e){return v.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,s,r){const i=this.ys;this.ys++;const o=new pu(i,t,s,r);this.mutationQueue.push(o);for(const a of r)this.ps=this.ps.add(new Re(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return v.resolve(o)}lookupMutationBatch(e,t){return v.resolve(this.Is(t))}getNextMutationBatchAfterBatchId(e,t){const r=this.Ts(t+1),i=r<0?0:r;return v.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return v.resolve(0===this.mutationQueue.length?-1:this.ys-1)}getAllMutationBatches(e){return v.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Re(t,0),r=new Re(t,Number.POSITIVE_INFINITY),i=[];return this.ps.forEachInRange([s,r],o=>{const a=this.Is(o.gs);i.push(a)}),v.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new re(U);return t.forEach(r=>{const i=new Re(r,0),o=new Re(r,Number.POSITIVE_INFINITY);this.ps.forEachInRange([i,o],a=>{s=s.add(a.gs)})}),v.resolve(this.Es(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let i=s;A.isDocumentKey(i)||(i=i.child(""));const o=new Re(new A(i),0);let a=new re(U);return this.ps.forEachWhile(l=>{const h=l.key.path;return!!s.isPrefixOf(h)&&(h.length===r&&(a=a.add(l.gs)),!0)},o),v.resolve(this.Es(a))}Es(e){const t=[];return e.forEach(s=>{const r=this.Is(s);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){O(0===this.As(t.batchId,"removed")),this.mutationQueue.shift();let s=this.ps;return v.forEach(t.mutations,r=>{const i=new Re(r.key,t.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.ps=s})}bn(e){}containsKey(e,t){const s=new Re(t,0),r=this.ps.firstAfterOrEqual(s);return v.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return v.resolve()}As(e,t){return this.Ts(e)}Ts(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Is(e){const t=this.Ts(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Vg{constructor(e){this.Rs=e,this.docs=new ge(A.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),i=r?r.size:0,o=this.Rs(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return v.resolve(s?s.document.mutableCopy():ae.newInvalidDocument(t))}getEntries(e,t){let s=Je();return t.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():ae.newInvalidDocument(r))}),v.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let i=Je();const o=t.path,a=new A(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:h,value:{document:f}}=l.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||Hc(yh(f),s)<=0||(r.has(f.key)||Ni(t,f))&&(i=i.insert(f.key,f.mutableCopy()))}return v.resolve(i)}getAllFromCollectionGroup(e,t,s,r){M()}bs(e,t){return v.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new Bg(this)}getSize(e){return v.resolve(this.size)}}class Bg extends tf{constructor(e){super(),this.Xn=e}applyChanges(e){const t=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?t.push(this.Xn.addEntry(e,r)):this.Xn.removeEntry(s)}),v.waitFor(t)}getFromCache(e,t){return this.Xn.getEntry(e,t)}getAllFromCache(e,t){return this.Xn.getEntries(e,t)}}class qg{constructor(e){this.persistence=e,this.vs=new dn(t=>ns(t),Di),this.lastRemoteSnapshotVersion=R.min(),this.highestTargetId=0,this.Ps=0,this.Vs=new Iu,this.targetCount=0,this.Ss=hs.Vn()}forEachTarget(e,t){return this.vs.forEach((s,r)=>t(r)),v.resolve()}getLastRemoteSnapshotVersion(e){return v.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return v.resolve(this.Ps)}allocateTargetId(e){return this.highestTargetId=this.Ss.next(),v.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.Ps&&(this.Ps=t),v.resolve()}xn(e){this.vs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ss=new hs(t),this.highestTargetId=t),e.sequenceNumber>this.Ps&&(this.Ps=e.sequenceNumber)}addTargetData(e,t){return this.xn(t),this.targetCount+=1,v.resolve()}updateTargetData(e,t){return this.xn(t),v.resolve()}removeTargetData(e,t){return this.vs.delete(t.target),this.Vs.ds(t.targetId),this.targetCount-=1,v.resolve()}removeTargets(e,t,s){let r=0;const i=[];return this.vs.forEach((o,a)=>{a.sequenceNumber<=t&&null===s.get(a.targetId)&&(this.vs.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),v.waitFor(i).next(()=>r)}getTargetCount(e){return v.resolve(this.targetCount)}getTargetData(e,t){const s=this.vs.get(t)||null;return v.resolve(s)}addMatchingKeys(e,t,s){return this.Vs.hs(t,s),v.resolve()}removeMatchingKeys(e,t,s){this.Vs.fs(t,s);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),v.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Vs.ds(t),v.resolve()}getMatchingKeysForTargetId(e,t){const s=this.Vs.ws(t);return v.resolve(s)}containsKey(e,t){return v.resolve(this.Vs.containsKey(t))}}class cf{constructor(e,t){this.Ds={},this.overlays={},this.Cs=new ot(0),this.xs=!1,this.xs=!0,this.referenceDelegate=e(this),this.Ns=new qg(this),this.indexManager=new Cg,this.remoteDocumentCache=new Vg(s=>this.referenceDelegate.ks(s)),this.Tt=new Ld(t),this.Os=new Lg(this.Tt)}start(){return Promise.resolve()}shutdown(){return this.xs=!1,Promise.resolve()}get started(){return this.xs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Fg,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.Ds[e.toKey()];return s||(s=new Rg(t,this.referenceDelegate),this.Ds[e.toKey()]=s),s}getTargetCache(){return this.Ns}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Os}runTransaction(e,t,s){E("MemoryPersistence","Starting transaction:",e);const r=new Ug(this.Cs.next());return this.referenceDelegate.Ms(),s(r).next(i=>this.referenceDelegate.Fs(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}$s(e,t){return v.or(Object.values(this.Ds).map(s=>()=>s.containsKey(e,t)))}}class Ug extends vh{constructor(e){super(),this.currentSequenceNumber=e}}class Da{constructor(e){this.persistence=e,this.Bs=new Iu,this.Ls=null}static qs(e){return new Da(e)}get Us(){if(this.Ls)return this.Ls;throw M()}addReference(e,t,s){return this.Bs.addReference(s,t),this.Us.delete(s.toString()),v.resolve()}removeReference(e,t,s){return this.Bs.removeReference(s,t),this.Us.add(s.toString()),v.resolve()}markPotentiallyOrphaned(e,t){return this.Us.add(t.toString()),v.resolve()}removeTarget(e,t){this.Bs.ds(t.targetId).forEach(r=>this.Us.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(i=>this.Us.add(i.toString()))}).next(()=>s.removeTargetData(e,t))}Ms(){this.Ls=new Set}Fs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return v.forEach(this.Us,s=>{const r=A.fromPath(s);return this.Ks(e,r).next(i=>{i||t.removeEntry(r,R.min())})}).next(()=>(this.Ls=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ks(e,t).next(s=>{s?this.Us.delete(t.toString()):this.Us.add(t.toString())})}ks(e){return 0}Ks(e,t){return v.or([()=>v.resolve(this.Bs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.$s(e,t)])}}class jg{constructor(e){this.Tt=e}$(e,t,s,r){const i=new ca("createOrUpgrade",t);var a;s<1&&r>=1&&(e.createObjectStore("owner"),(a=e).createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Dd,{unique:!0}),a.createObjectStore("documentMutations"),uf(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=v.resolve();return s<3&&r>=3&&(0!==s&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),uf(e)),o=o.next(()=>function(a){const l=a.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:R.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",h)}(i))),s<4&&r>=4&&(0!==s&&(o=o.next(()=>function(a,l){return l.store("mutations").W().next(h=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Dd,{unique:!0});const f=l.store("mutations"),p=h.map(g=>f.put(g));return v.waitFor(p)})}(e,i))),o=o.next(()=>{!function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),s<5&&r>=5&&(o=o.next(()=>this.Gs(i))),s<6&&r>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Qs(i)))),s<7&&r>=7&&(o=o.next(()=>this.js(i))),s<8&&r>=8&&(o=o.next(()=>this.zs(e,i))),s<9&&r>=9&&(o=o.next(()=>{!function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")}(e)})),s<10&&r>=10&&(o=o.next(()=>this.Ws(i))),s<11&&r>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),s<12&&r>=12&&(o=o.next(()=>{!function(a){const l=a.createObjectStore("documentOverlays",{keyPath:dg});l.createIndex("collectionPathOverlayIndex",fg,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",pg,{unique:!1})}(e)})),s<13&&r>=13&&(o=o.next(()=>function(a){const l=a.createObjectStore("remoteDocumentsV14",{keyPath:tg});l.createIndex("documentKeyIndex",ng),l.createIndex("collectionGroupIndex",sg)}(e)).next(()=>this.Hs(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),s<14&&r>=14&&(o=o.next(()=>this.Js(e,i))),s<15&&r>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:cg}).createIndex("sequenceNumberIndex",ug,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:lg}).createIndex("documentKeyIndex",hg,{unique:!1})}(e))),o}Qs(e){let t=0;return e.store("remoteDocuments").X((s,r)=>{t+=Sa(r)}).next(()=>{const s={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",s)})}Gs(e){const t=e.store("mutationQueues"),s=e.store("mutations");return t.W().next(r=>v.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return s.W("userMutationsIndex",o).next(a=>v.forEach(a,l=>{O(l.userId===i.userId);const h=cs(this.Tt,l);return Wd(e,i.userId,h).next(()=>{})}))}))}js(e){const t=e.store("targetDocuments"),s=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const i=[];return s.X((o,a)=>{const l=new X(o),h=[0,He(l)];i.push(t.get(h).next(f=>f?v.resolve():t.put({targetId:0,path:He(l),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>v.waitFor(i))})}zs(e,t){e.createObjectStore("collectionParents",{keyPath:ag});const s=t.store("collectionParents"),r=new Tu,i=o=>{if(r.add(o)){const a=o.lastSegment(),l=o.popLast();return s.put({collectionId:a,parent:He(l)})}};return t.store("remoteDocuments").X({Z:!0},(o,a)=>{const l=new X(o);return i(l.popLast())}).next(()=>t.store("documentMutations").X({Z:!0},([o,a,l],h)=>{const f=kt(a);return i(f.popLast())}))}Ws(e){const t=e.store("targets");return t.X((s,r)=>{const i=ji(r),o=Rd(this.Tt,i);return t.put(o)})}Hs(e,t){const s=t.store("remoteDocuments"),r=[];return s.X((i,o)=>{const a=t.store("remoteDocumentsV14"),l=(h=o,h.document?new A(X.fromString(h.document.name).popFirst(5)):h.noDocument?A.fromSegments(h.noDocument.path):h.unknownDocument?A.fromSegments(h.unknownDocument.path):M()).path.toArray();var h;const f={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(f))}).next(()=>v.waitFor(r))}Js(e,t){const s=t.store("mutations"),r=nf(this.Tt),i=new cf(Da.qs,this.Tt.oe);return s.W().next(o=>{const a=new Map;return o.forEach(l=>{var h;let f=null!==(h=a.get(l.userId))&&void 0!==h?h:j();cs(this.Tt,l).keys().forEach(p=>f=f.add(p)),a.set(l.userId,f)}),v.forEach(a,(l,h)=>{const f=new Oe(h),p=Ta.ue(this.Tt,f),g=i.getIndexManager(f),w=Aa.ue(f,this.Tt,g,i.referenceDelegate);return new af(r,w,p,g).recalculateAndSaveOverlaysForDocumentKeys(new fu(t,ot.at),l).next()})})}}function uf(n){n.createObjectStore("targetDocuments",{keyPath:ig}).createIndex("documentTargetsIndex",og,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",rg,{unique:!0}),n.createObjectStore("targetGlobal")}const Cu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Eu{constructor(e,t,s,r,i,o,a,l,h,f,p=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Ys=i,this.window=o,this.document=a,this.Zs=h,this.Xs=f,this.ti=p,this.Cs=null,this.xs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ei=null,this.inForeground=!1,this.ni=null,this.si=null,this.ii=Number.NEGATIVE_INFINITY,this.ri=g=>Promise.resolve(),!Eu.C())throw new C(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Mg(this,r),this.oi=t+"main",this.Tt=new Ld(l),this.ui=new wt(this.oi,this.ti,new jg(this.Tt)),this.Ns=new Sg(this.referenceDelegate,this.Tt),this.remoteDocumentCache=nf(this.Tt),this.Os=new wg,this.window&&this.window.localStorage?this.ci=this.window.localStorage:(this.ci=null,!1===f&&ye("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new C(b.FAILED_PRECONDITION,Cu);return this.hi(),this.li(),this.fi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ns.getHighestSequenceNumber(e))}).then(e=>{this.Cs=new ot(e,this.Zs)}).then(()=>{this.xs=!0}).catch(e=>(this.ui&&this.ui.close(),Promise.reject(e)))}di(e){var t=this;return this.ri=function(){var s=(0,I.Z)(function*(r){if(t.started)return e(r)});return function(r){return s.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ui.L(function(){var t=(0,I.Z)(function*(s){null===s.newVersion&&(yield e())});return function(s){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Ys.enqueueAndForget((0,I.Z)(function*(){t.started&&(yield t.ai())})))}ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ma(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this._i(e).next(t=>{t||(this.isPrimary=!1,this.Ys.enqueueRetryable(()=>this.ri(!1)))})}).next(()=>this.wi(e)).next(t=>this.isPrimary&&!t?this.mi(e).next(()=>!1):!!t&&this.gi(e).next(()=>!0))).catch(e=>{if(on(e))return E("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return E("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ys.enqueueRetryable(()=>this.ri(e)),this.isPrimary=e})}_i(e){return Qi(e).get("owner").next(t=>v.resolve(this.yi(t)))}pi(e){return Ma(e).delete(this.clientId)}Ii(){var e=this;return(0,I.Z)(function*(){if(e.isPrimary&&!e.Ti(e.ii,18e5)){e.ii=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",s=>{const r=Fe(s,"clientMetadata");return r.W().next(i=>{const o=e.Ei(i,18e5),a=i.filter(l=>-1===o.indexOf(l));return v.forEach(a,l=>r.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(e.ci)for(const s of t)e.ci.removeItem(e.Ai(s.clientId))}})()}fi(){this.si=this.Ys.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ai().then(()=>this.Ii()).then(()=>this.fi()))}yi(e){return!!e&&e.ownerId===this.clientId}wi(e){return this.Xs?v.resolve(!0):Qi(e).get("owner").next(t=>{if(null!==t&&this.Ti(t.leaseTimestampMs,5e3)&&!this.Ri(t.ownerId)){if(this.yi(t)&&this.networkEnabled)return!0;if(!this.yi(t)){if(!t.allowTabSynchronization)throw new C(b.FAILED_PRECONDITION,Cu);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ma(e).W().next(s=>void 0===this.Ei(s,5e3).find(r=>!(this.clientId===r.clientId||!(!this.networkEnabled&&r.networkEnabled||!this.inForeground&&r.inForeground&&this.networkEnabled===r.networkEnabled))))}).next(t=>(this.isPrimary!==t&&E("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,I.Z)(function*(){e.xs=!1,e.bi(),e.si&&(e.si.cancel(),e.si=null),e.vi(),e.Pi(),yield e.ui.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const s=new fu(t,ot.at);return e.mi(s).next(()=>e.pi(s))}),e.ui.close(),e.Vi()})()}Ei(e,t){return e.filter(s=>this.Ti(s.updateTimeMs,t)&&!this.Ri(s.clientId))}Si(){return this.runTransaction("getActiveClients","readonly",e=>Ma(e).W().next(t=>this.Ei(t,18e5).map(s=>s.clientId)))}get started(){return this.xs}getMutationQueue(e,t){return Aa.ue(e,this.Tt,t,this.referenceDelegate)}getTargetCache(){return this.Ns}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Eg(e,this.Tt.oe.databaseId)}getDocumentOverlayCache(e){return Ta.ue(this.Tt,e)}getBundleCache(){return this.Os}runTransaction(e,t,s){E("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=15===(o=this.ti)?gg:14===o?Od:13===o?Pd:12===o?mg:11===o?Nd:void M();var o;let a;return this.ui.runTransaction(e,r,i,l=>(a=new fu(l,this.Cs?this.Cs.next():ot.at),"readwrite-primary"===t?this._i(a).next(h=>!!h||this.wi(a)).next(h=>{if(!h)throw ye(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ys.enqueueRetryable(()=>this.ri(!1)),new C(b.FAILED_PRECONDITION,wh);return s(a)}).next(h=>this.gi(a).next(()=>h)):this.Di(a).next(()=>s(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Di(e){return Qi(e).get("owner").next(t=>{if(null!==t&&this.Ti(t.leaseTimestampMs,5e3)&&!this.Ri(t.ownerId)&&!this.yi(t)&&!(this.Xs||this.allowTabSynchronization&&t.allowTabSynchronization))throw new C(b.FAILED_PRECONDITION,Cu)})}gi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Qi(e).put("owner",t)}static C(){return wt.C()}mi(e){const t=Qi(e);return t.get("owner").next(s=>this.yi(s)?(E("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):v.resolve())}Ti(e,t){const s=Date.now();return!(e<s-t||e>s&&(ye(`Detected an update time that is in the future: ${e} > ${s}`),1))}hi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ni=()=>{this.Ys.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ai()))},this.document.addEventListener("visibilitychange",this.ni),this.inForeground="visible"===this.document.visibilityState)}vi(){this.ni&&(this.document.removeEventListener("visibilitychange",this.ni),this.ni=null)}li(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ei=()=>{this.bi(),(0,H.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Ys.enterRestrictedMode(!0),this.Ys.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ei))}Pi(){this.ei&&(this.window.removeEventListener("pagehide",this.ei),this.ei=null)}Ri(e){var t;try{const s=null!==(null===(t=this.ci)||void 0===t?void 0:t.getItem(this.Ai(e)));return E("IndexedDbPersistence",`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return ye("IndexedDbPersistence","Failed to get zombied client id.",s),!1}}bi(){if(this.ci)try{this.ci.setItem(this.Ai(this.clientId),String(Date.now()))}catch(e){ye("Failed to set zombie client id.",e)}}Vi(){if(this.ci)try{this.ci.removeItem(this.Ai(this.clientId))}catch{}}Ai(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Qi(n){return Fe(n,"owner")}function Ma(n){return Fe(n,"clientMetadata")}function Su(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Au{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.Ci=s,this.xi=r}static Ni(e,t){let s=j(),r=j();for(const i of t.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Au(e,t.fromCache,s,r)}}class lf{constructor(){this.ki=!1}initialize(e,t){this.Oi=e,this.indexManager=t,this.ki=!0}getDocumentsMatchingQuery(e,t,s,r){return this.Mi(e,t).next(i=>i||this.Fi(e,t,r,s)).next(i=>i||this.$i(e,t))}Mi(e,t){if(Gh(t))return v.resolve(null);let s=ze(t);return this.indexManager.getIndexType(e,s).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=ma(t,null,"F"),s=ze(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=j(...i);return this.Oi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,s).next(l=>{const h=this.Bi(t,a);return this.Li(t,h,o,l.readTime)?this.Mi(e,ma(t,null,"F")):this.qi(e,h,t,l)}))})))}Fi(e,t,s,r){return Gh(t)||r.isEqual(R.min())?this.$i(e,t):this.Oi.getDocuments(e,s).next(i=>{const o=this.Bi(t,i);return this.Li(t,o,s,r)?this.$i(e,t):(Kc()<=Ae.in.DEBUG&&E("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),au(t)),this.qi(e,o,t,gh(r,-1)))})}Bi(e,t){let s=new re(Qh(e));return t.forEach((r,i)=>{Ni(e,i)&&(s=s.add(i))}),s}Li(e,t,s,r){if(null===e.limit)return!1;if(s.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}$i(e,t){return Kc()<=Ae.in.DEBUG&&E("QueryEngine","Using full collection scan to execute query:",au(t)),this.Oi.getDocumentsMatchingQuery(e,t,it.min())}qi(e,t,s,r){return this.Oi.getDocumentsMatchingQuery(e,s,r).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}class $g{constructor(e,t,s,r){this.persistence=e,this.Ui=t,this.Tt=r,this.Ki=new ge(U),this.Gi=new dn(i=>ns(i),Di),this.Qi=new Map,this.ji=e.getRemoteDocumentCache(),this.Ns=e.getTargetCache(),this.Os=e.getBundleCache(),this.zi(s)}zi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new af(this.ji,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ji.setIndexManager(this.indexManager),this.Ui.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ki))}}function hf(n,e,t,s){return new $g(n,e,t,s)}function df(n,e){return ku.apply(this,arguments)}function ku(){return ku=(0,I.Z)(function*(n,e){const t=D(n);return yield t.persistence.runTransaction("Handle user change","readonly",s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,t.zi(e),t.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],a=[];let l=j();for(const h of r){o.push(h.batchId);for(const f of h.mutations)l=l.add(f.key)}for(const h of i){a.push(h.batchId);for(const f of h.mutations)l=l.add(f.key)}return t.localDocuments.getDocuments(s,l).next(h=>({Wi:h,removedBatchIds:o,addedBatchIds:a}))})})}),ku.apply(this,arguments)}function ff(n){const e=D(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ns.getLastRemoteSnapshotVersion(t))}function pf(n,e,t){let s=j(),r=j();return t.forEach(i=>s=s.add(i)),e.getEntries(n,s).next(i=>{let o=Je();return t.forEach((a,l)=>{const h=i.get(a);l.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(R.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||0===l.version.compareTo(h.version)&&h.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):E("LocalStore","Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",l.version)}),{Hi:o,Ji:r}})}function zg(n,e){const t=D(n);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function gr(n,e){const t=D(n);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return t.Ns.getTargetData(s,e).next(i=>i?(r=i,v.resolve(r)):t.Ns.allocateTargetId(s).next(o=>(r=new pn(e,o,0,s.currentSequenceNumber),t.Ns.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=t.Ki.get(s.targetId);return(null===r||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ki=t.Ki.insert(s.targetId,s),t.Gi.set(e,s.targetId)),s})}function yr(n,e,t){return Du.apply(this,arguments)}function Du(){return Du=(0,I.Z)(function*(n,e,t){const s=D(n),r=s.Ki.get(e),i=t?"readwrite":"readwrite-primary";try{t||(yield s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!on(o))throw o;E("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ki=s.Ki.remove(e),s.Gi.delete(r.target)}),Du.apply(this,arguments)}function Na(n,e,t){const s=D(n);let r=R.min(),i=j();return s.persistence.runTransaction("Execute query","readonly",o=>function(a,l,h){const f=D(a),p=f.Gi.get(h);return void 0!==p?v.resolve(f.Ki.get(p)):f.Ns.getTargetData(l,h)}(s,o,ze(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.Ns.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>s.Ui.getDocumentsMatchingQuery(o,e,t?r:R.min(),t?i:j())).next(a=>(yf(s,Hh(e),a),{documents:a,Yi:i})))}function mf(n,e){const t=D(n),s=D(t.Ns),r=t.Ki.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",i=>s.ie(i,e).next(o=>o?o.target:null))}function gf(n,e){const t=D(n),s=t.Qi.get(e)||R.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.ji.getAllFromCollectionGroup(r,e,gh(s,-1),Number.MAX_SAFE_INTEGER)).then(r=>(yf(t,e,r),r))}function yf(n,e,t){let s=n.Qi.get(e)||R.min();t.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),n.Qi.set(e,s)}function Mu(){return Mu=(0,I.Z)(function*(n,e,t,s){const r=D(n);let i=j(),o=Je();for(const h of t){const f=e.Zi(h.metadata.name);h.document&&(i=i.add(f));const p=e.Xi(h);p.setReadTime(e.tr(h.metadata.readTime)),o=o.insert(f,p)}const a=r.ji.newChangeBuffer({trackRemovals:!0}),l=yield gr(r,(h=s,ze(ar(X.fromString(`__bundle__/docs/${h}`)))));var h;return r.persistence.runTransaction("Apply bundle documents","readwrite",h=>pf(h,a,o).next(f=>(a.apply(h),f)).next(f=>r.Ns.removeMatchingKeysForTargetId(h,l.targetId).next(()=>r.Ns.addMatchingKeys(h,i,l.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(h,f.Hi,f.Ji)).next(()=>f.Hi)))}),Mu.apply(this,arguments)}function Qg(n,e){return Nu.apply(this,arguments)}function Nu(){return Nu=(0,I.Z)(function*(n,e,t=j()){const s=yield gr(n,ze(yu(e.bundledQuery))),r=D(n);return r.persistence.runTransaction("Save named query","readwrite",i=>{const o=we(e.readTime);if(s.snapshotVersion.compareTo(o)>=0)return r.Os.saveNamedQuery(i,e);const a=s.withResumeToken(Ee.EMPTY_BYTE_STRING,o);return r.Ki=r.Ki.insert(a.targetId,a),r.Ns.updateTargetData(i,a).next(()=>r.Ns.removeMatchingKeysForTargetId(i,s.targetId)).next(()=>r.Ns.addMatchingKeys(i,t,s.targetId)).next(()=>r.Os.saveNamedQuery(i,e))})}),Nu.apply(this,arguments)}function wf(n,e){return`firestore_clients_${n}_${e}`}function vf(n,e,t){let s=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}function Pu(n,e){return`firestore_targets_${n}_${e}`}class Pa{constructor(e,t,s,r){this.user=e,this.batchId=t,this.state=s,this.error=r}static er(e,t,s){const r=JSON.parse(s);let i,o="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return o&&r.error&&(o="string"==typeof r.error.message&&"string"==typeof r.error.code,o&&(i=new C(r.error.code,r.error.message))),o?new Pa(e,t,r.state,i):(ye("SharedClientState",`Failed to parse mutation state for ID '${t}': ${s}`),null)}nr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Zi{constructor(e,t,s){this.targetId=e,this.state=t,this.error=s}static er(e,t){const s=JSON.parse(t);let r,i="object"==typeof s&&-1!==["not-current","current","rejected"].indexOf(s.state)&&(void 0===s.error||"object"==typeof s.error);return i&&s.error&&(i="string"==typeof s.error.message&&"string"==typeof s.error.code,i&&(r=new C(s.error.code,s.error.message))),i?new Zi(e,s.state,r):(ye("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}nr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Oa{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static er(e,t){const s=JSON.parse(t);let r="object"==typeof s&&s.activeTargetIds instanceof Array,i=va();for(let o=0;r&&o<s.activeTargetIds.length;++o)r=Th(s.activeTargetIds[o]),i=i.add(s.activeTargetIds[o]);return r?new Oa(e,i):(ye("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Ou{constructor(e,t){this.clientId=e,this.onlineState=t}static er(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Ou(t.clientId,t.onlineState):(ye("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Lu{constructor(){this.activeTargetIds=va()}sr(e){this.activeTargetIds=this.activeTargetIds.add(e)}ir(e){this.activeTargetIds=this.activeTargetIds.delete(e)}nr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Fu{constructor(e,t,s,r,i){this.window=e,this.Ys=t,this.persistenceKey=s,this.rr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ur=this.cr.bind(this),this.ar=new ge(U),this.started=!1,this.hr=[];const o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.lr=wf(this.persistenceKey,this.rr),this.dr=`firestore_sequence_number_${this.persistenceKey}`,this.ar=this.ar.insert(this.rr,new Lu),this._r=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.wr=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.mr=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.gr=`firestore_online_state_${this.persistenceKey}`,this.yr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.ur)}static C(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,I.Z)(function*(){const t=yield e.syncEngine.Si();for(const r of t){if(r===e.rr)continue;const i=e.getItem(wf(e.persistenceKey,r));if(i){const o=Oa.er(r,i);o&&(e.ar=e.ar.insert(o.clientId,o))}}e.pr();const s=e.storage.getItem(e.gr);if(s){const r=e.Ir(s);r&&e.Tr(r)}for(const r of e.hr)e.cr(r);e.hr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.dr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Er(this.ar)}isActiveQueryTarget(e){let t=!1;return this.ar.forEach((s,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ar(e,"pending")}updateMutationState(e,t,s){this.Ar(e,t,s),this.Rr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Pu(this.persistenceKey,e));if(s){const r=Zi.er(e,s);r&&(t=r.state)}}return this.br.sr(e),this.pr(),t}removeLocalQueryTarget(e){this.br.ir(e),this.pr()}isLocalQueryTarget(e){return this.br.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Pu(this.persistenceKey,e))}updateQueryState(e,t,s){this.vr(e,t,s)}handleUserChange(e,t,s){t.forEach(r=>{this.Rr(r)}),this.currentUser=e,s.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Pr(e)}notifyBundleLoaded(e){this.Vr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ur),this.removeItem(this.lr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return E("SharedClientState","READ",e,t),t}setItem(e,t){E("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){E("SharedClientState","REMOVE",e),this.storage.removeItem(e)}cr(e){var t=this;const s=e;if(s.storageArea===this.storage){if(E("SharedClientState","EVENT",s.key,s.newValue),s.key===this.lr)return void ye("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ys.enqueueRetryable((0,I.Z)(function*(){if(t.started){if(null!==s.key)if(t._r.test(s.key)){if(null==s.newValue){const r=t.Sr(s.key);return t.Dr(r,null)}{const r=t.Cr(s.key,s.newValue);if(r)return t.Dr(r.clientId,r)}}else if(t.wr.test(s.key)){if(null!==s.newValue){const r=t.Nr(s.key,s.newValue);if(r)return t.kr(r)}}else if(t.mr.test(s.key)){if(null!==s.newValue){const r=t.Or(s.key,s.newValue);if(r)return t.Mr(r)}}else if(s.key===t.gr){if(null!==s.newValue){const r=t.Ir(s.newValue);if(r)return t.Tr(r)}}else if(s.key===t.dr){const r=function(i){let o=ot.at;if(null!=i)try{const a=JSON.parse(i);O("number"==typeof a),o=a}catch(a){ye("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(s.newValue);r!==ot.at&&t.sequenceNumberHandler(r)}else if(s.key===t.yr){const r=t.Fr(s.newValue);yield Promise.all(r.map(i=>t.syncEngine.$r(i)))}}else t.hr.push(s)}))}}get br(){return this.ar.get(this.rr)}pr(){this.setItem(this.lr,this.br.nr())}Ar(e,t,s){const r=new Pa(this.currentUser,e,t,s),i=vf(this.persistenceKey,this.currentUser,e);this.setItem(i,r.nr())}Rr(e){const t=vf(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Pr(e){this.storage.setItem(this.gr,JSON.stringify({clientId:this.rr,onlineState:e}))}vr(e,t,s){const r=Pu(this.persistenceKey,e),i=new Zi(e,t,s);this.setItem(r,i.nr())}Vr(e){const t=JSON.stringify(Array.from(e));this.setItem(this.yr,t)}Sr(e){const t=this._r.exec(e);return t?t[1]:null}Cr(e,t){const s=this.Sr(e);return Oa.er(s,t)}Nr(e,t){const s=this.wr.exec(e),r=Number(s[1]);return Pa.er(new Oe(void 0!==s[2]?s[2]:null),r,t)}Or(e,t){const s=this.mr.exec(e),r=Number(s[1]);return Zi.er(r,t)}Ir(e){return Ou.er(e)}Fr(e){return JSON.parse(e)}kr(e){var t=this;return(0,I.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Br(e.batchId,e.state,e.error);E("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Mr(e){return this.syncEngine.Lr(e.targetId,e.state,e.error)}Dr(e,t){const s=t?this.ar.insert(e,t):this.ar.remove(e),r=this.Er(this.ar),i=this.Er(s),o=[],a=[];return i.forEach(l=>{r.has(l)||o.push(l)}),r.forEach(l=>{i.has(l)||a.push(l)}),this.syncEngine.qr(o,a).then(()=>{this.ar=s})}Tr(e){this.ar.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Er(e){let t=va();return e.forEach((s,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class bf{constructor(){this.Ur=new Lu,this.Kr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e){return this.Ur.sr(e),this.Kr[e]||"not-current"}updateQueryState(e,t,s){this.Kr[e]=t}removeLocalQueryTarget(e){this.Ur.ir(e)}isLocalQueryTarget(e){return this.Ur.activeTargetIds.has(e)}clearQueryState(e){delete this.Kr[e]}getAllActiveQueryTargets(){return this.Ur.activeTargetIds}isActiveQueryTarget(e){return this.Ur.activeTargetIds.has(e)}start(){return this.Ur=new Lu,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Zg{Gr(e){}shutdown(){}}class xf{constructor(){this.Qr=()=>this.jr(),this.zr=()=>this.Wr(),this.Hr=[],this.Jr()}Gr(e){this.Hr.push(e)}shutdown(){window.removeEventListener("online",this.Qr),window.removeEventListener("offline",this.zr)}Jr(){window.addEventListener("online",this.Qr),window.addEventListener("offline",this.zr)}jr(){E("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Hr)e(0)}Wr(){E("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Hr)e(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Wg={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Xg{constructor(e){this.Yr=e.Yr,this.Zr=e.Zr}Xr(e){this.eo=e}no(e){this.so=e}onMessage(e){this.io=e}close(){this.Zr()}send(e){this.Yr(e)}ro(){this.eo()}oo(e){this.so(e)}uo(e){this.io(e)}}class Yg extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.co=(e.ssl?"https":"http")+"://"+e.host,this.ao="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get ho(){return!1}lo(e,t,s,r,i){const o=this.fo(e,t);E("RestConnection","Sending: ",o,s);const a={};return this._o(a,r,i),this.wo(e,o,a,s).then(l=>(E("RestConnection","Received: ",l),l),l=>{throw Zn("RestConnection",`${e} failed with error: `,l,"url: ",o,"request:",s),l})}mo(e,t,s,r,i,o){return this.lo(e,t,s,r,i)}_o(e,t,s){e["X-Goog-Api-Client"]="gl-js/ fire/"+tr,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}fo(e,t){return`${this.co}/v1/${t}:${Wg[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}wo(e,t,s,r){return new Promise((i,o)=>{const a=new Qp;a.setWithCredentials(!0),a.listenOnce(Gp.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case $c.NO_ERROR:const h=a.getResponseJson();E("Connection","XHR received:",JSON.stringify(h)),i(h);break;case $c.TIMEOUT:E("Connection",'RPC "'+e+'" timed out'),o(new C(b.DEADLINE_EXCEEDED,"Request time out"));break;case $c.HTTP_ERROR:const f=a.getStatus();if(E("Connection",'RPC "'+e+'" failed with status:',f,"response text:",a.getResponseText()),f>0){let p=a.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p?.error;if(g&&g.status&&g.message){const w=function(T){const S=T.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(S)>=0?S:b.UNKNOWN}(g.status);o(new C(w,g.message))}else o(new C(b.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new C(b.UNAVAILABLE,"Connection failed."));break;default:M()}}finally{E("Connection",'RPC "'+e+'" completed.')}});const l=JSON.stringify(r);a.send(t,"POST",l,s,15)})}yo(e,t,s){const r=[this.co,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=$p(),o=Kp(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new Hp({})),this._o(a.initMessageHeaders,t,s),a.encodeInitMessageHeaders=!0;const l=r.join("");E("Connection","Creating WebChannel: "+l,a);const h=i.createWebChannel(l,a);let f=!1,p=!1;const g=new Xg({Yr:T=>{p?E("Connection","Not sending because WebChannel is closed:",T):(f||(E("Connection","Opening WebChannel transport."),h.open(),f=!0),E("Connection","WebChannel sending:",T),h.send(T))},Zr:()=>h.close()}),w=(T,S,P)=>{T.listen(S,te=>{try{P(te)}catch(N){setTimeout(()=>{throw N},0)}})};return w(h,ia.EventType.OPEN,()=>{p||E("Connection","WebChannel transport opened.")}),w(h,ia.EventType.CLOSE,()=>{p||(p=!0,E("Connection","WebChannel transport closed"),g.oo())}),w(h,ia.EventType.ERROR,T=>{p||(p=!0,Zn("Connection","WebChannel transport errored:",T),g.oo(new C(b.UNAVAILABLE,"The operation could not be completed")))}),w(h,ia.EventType.MESSAGE,T=>{var S;if(!p){const P=T.data[0];O(!!P);const N=P.error||(null===(S=P[0])||void 0===S?void 0:S.error);if(N){E("Connection","WebChannel received error:",N);const L=N.status;let le=function(J){const Se=Te[J];if(void 0!==Se)return ud(Se)}(L),z=N.message;void 0===le&&(le=b.INTERNAL,z="Unknown error status: "+L+" with message "+N.message),p=!0,g.oo(new C(le,z)),h.close()}else E("Connection","WebChannel received:",P),g.uo(P)}}),w(o,zp.STAT_EVENT,T=>{T.stat===lh.PROXY?E("Connection","Detected buffering proxy"):T.stat===lh.NOPROXY&&E("Connection","Detected no buffering proxy")}),setTimeout(()=>{g.ro()},0),g}}function _f(){return typeof window<"u"?window:null}function La(){return typeof document<"u"?document:null}function Wi(n){return new $m(n,!0)}class Ru{constructor(e,t,s=1e3,r=1.5,i=6e4){this.Ys=e,this.timerId=t,this.po=s,this.Io=r,this.To=i,this.Eo=0,this.Ao=null,this.Ro=Date.now(),this.reset()}reset(){this.Eo=0}bo(){this.Eo=this.To}vo(e){this.cancel();const t=Math.floor(this.Eo+this.Po()),s=Math.max(0,Date.now()-this.Ro),r=Math.max(0,t-s);r>0&&E("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Eo} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.Ao=this.Ys.enqueueAfterDelay(this.timerId,r,()=>(this.Ro=Date.now(),e())),this.Eo*=this.Io,this.Eo<this.po&&(this.Eo=this.po),this.Eo>this.To&&(this.Eo=this.To)}Vo(){null!==this.Ao&&(this.Ao.skipDelay(),this.Ao=null)}cancel(){null!==this.Ao&&(this.Ao.cancel(),this.Ao=null)}Po(){return(Math.random()-.5)*this.Eo}}class Tf{constructor(e,t,s,r,i,o,a,l){this.Ys=e,this.So=s,this.Do=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Co=0,this.xo=null,this.No=null,this.stream=null,this.ko=new Ru(e,t)}Oo(){return 1===this.state||5===this.state||this.Mo()}Mo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Fo()}stop(){var e=this;return(0,I.Z)(function*(){e.Oo()&&(yield e.close(0))})()}$o(){this.state=0,this.ko.reset()}Bo(){this.Mo()&&null===this.xo&&(this.xo=this.Ys.enqueueAfterDelay(this.So,6e4,()=>this.Lo()))}qo(e){this.Uo(),this.stream.send(e)}Lo(){var e=this;return(0,I.Z)(function*(){if(e.Mo())return e.close(0)})()}Uo(){this.xo&&(this.xo.cancel(),this.xo=null)}Ko(){this.No&&(this.No.cancel(),this.No=null)}close(e,t){var s=this;return(0,I.Z)(function*(){s.Uo(),s.Ko(),s.ko.cancel(),s.Co++,4!==e?s.ko.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(ye(t.toString()),ye("Using maximum backoff delay to prevent overloading the backend."),s.ko.bo()):t&&t.code===b.UNAUTHENTICATED&&3!==s.state&&(s.authCredentialsProvider.invalidateToken(),s.appCheckCredentialsProvider.invalidateToken()),null!==s.stream&&(s.Go(),s.stream.close(),s.stream=null),s.state=e,yield s.listener.no(t)})()}Go(){}auth(){this.state=1;const e=this.Qo(this.Co),t=this.Co;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.Co===t&&this.jo(s,r)},s=>{e(()=>{const r=new C(b.UNKNOWN,"Fetching auth token failed: "+s.message);return this.zo(r)})})}jo(e,t){const s=this.Qo(this.Co);this.stream=this.Wo(e,t),this.stream.Xr(()=>{s(()=>(this.state=2,this.No=this.Ys.enqueueAfterDelay(this.Do,1e4,()=>(this.Mo()&&(this.state=3),Promise.resolve())),this.listener.Xr()))}),this.stream.no(r=>{s(()=>this.zo(r))}),this.stream.onMessage(r=>{s(()=>this.onMessage(r))})}Fo(){var e=this;this.state=5,this.ko.vo((0,I.Z)(function*(){e.state=0,e.start()}))}zo(e){return E("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Qo(e){return t=>{this.Ys.enqueueAndForget(()=>this.Co===e?t():(E("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Jg extends Tf{constructor(e,t,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,o),this.Tt=i}Wo(e,t){return this.connection.yo("Listen",e,t)}onMessage(e){this.ko.reset();const t=function zm(n,e){let t;if("targetChange"in e){const s="NO_CHANGE"===(l=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===l?1:"REMOVE"===l?2:"CURRENT"===l?3:"RESET"===l?4:M(),r=e.targetChange.targetIds||[],i=function(l,h){return l.yt?(O(void 0===h||"string"==typeof h),Ee.fromBase64String(h||"")):(O(void 0===h||h instanceof Uint8Array),Ee.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const h=void 0===l.code?b.UNKNOWN:ud(l.code);return new C(h,l.message||"")}(o);t=new pd(s,r,i,a||null)}else if("documentChange"in e){const s=e.documentChange,r=At(n,s.document.name),i=we(s.document.updateTime),o=s.document.createTime?we(s.document.createTime):R.min(),a=new Le({mapValue:{fields:s.document.fields}}),l=ae.newFoundDocument(r,i,o,a);t=new ba(s.targetIds||[],s.removedTargetIds||[],l.key,l)}else if("documentDelete"in e){const s=e.documentDelete,r=At(n,s.document),i=s.readTime?we(s.readTime):R.min(),o=ae.newNoDocument(r,i);t=new ba([],s.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const s=e.documentRemove,r=At(n,s.document);t=new ba([],s.removedTargetIds||[],r,null)}else{if(!("filter"in e))return M();{const s=e.filter,i=new Om(s.count||0);t=new fd(s.targetId,i)}}var l;return t}(this.Tt,e),s=function(r){if(!("targetChange"in r))return R.min();const i=r.targetChange;return i.targetIds&&i.targetIds.length?R.min():i.readTime?we(i.readTime):R.min()}(e);return this.listener.Ho(t,s)}Jo(e){const t={};t.database=qi(this.Tt),t.addTarget=function(r,i){let o;const a=i.target;return o=da(a)?{documents:Id(r,a)}:{query:du(r,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=wd(r,i.resumeToken):i.snapshotVersion.compareTo(R.min())>0&&(o.readTime=dr(r,i.snapshotVersion.toTimestamp())),o}(this.Tt,e);const s=function Qm(n,e){const t=function(s,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return M()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);s&&(t.labels=s),this.qo(t)}Yo(e){const t={};t.database=qi(this.Tt),t.removeTarget=e,this.qo(t)}}class ey extends Tf{constructor(e,t,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,o),this.Tt=i,this.Zo=!1}get Xo(){return this.Zo}start(){this.Zo=!1,this.lastStreamToken=void 0,super.start()}Go(){this.Zo&&this.tu([])}Wo(e,t){return this.connection.yo("Write",e,t)}onMessage(e){if(O(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Zo){this.ko.reset();const t=function Hm(n,e){return n&&n.length>0?(O(void 0!==e),n.map(t=>function(s,r){let i=we(s.updateTime?s.updateTime:r);return i.isEqual(R.min())&&(i=we(r)),new Mm(i,s.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),s=we(e.commitTime);return this.listener.eu(s,t)}return O(!e.writeResults||0===e.writeResults.length),this.Zo=!0,this.listener.nu()}su(){const e={};e.database=qi(this.Tt),this.qo(e)}tu(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>Ui(this.Tt,s))};this.qo(t)}}class ty extends class{}{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.Tt=r,this.iu=!1}ru(){if(this.iu)throw new C(b.FAILED_PRECONDITION,"The client has already been terminated.")}lo(e,t,s){return this.ru(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.connection.lo(e,t,s,r,i)).catch(r=>{throw"FirebaseError"===r.name?(r.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new C(b.UNKNOWN,r.toString())})}mo(e,t,s,r){return this.ru(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.mo(e,t,s,i,o,r)).catch(i=>{throw"FirebaseError"===i.name?(i.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new C(b.UNKNOWN,i.toString())})}terminate(){this.iu=!0}}class sy{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.ou=0,this.uu=null,this.cu=!0}au(){0===this.ou&&(this.hu("Unknown"),this.uu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.uu=null,this.lu("Backend didn't respond within 10 seconds."),this.hu("Offline"),Promise.resolve())))}fu(e){"Online"===this.state?this.hu("Unknown"):(this.ou++,this.ou>=1&&(this.du(),this.lu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.hu("Offline")))}set(e){this.du(),this.ou=0,"Online"===e&&(this.cu=!1),this.hu(e)}hu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}lu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.cu?(ye(t),this.cu=!1):E("OnlineStateTracker",t)}du(){null!==this.uu&&(this.uu.cancel(),this.uu=null)}}class ry{constructor(e,t,s,r,i){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this._u=[],this.wu=new Map,this.mu=new Set,this.gu=[],this.yu=i,this.yu.Gr(a=>{s.enqueueAndForget((0,I.Z)(function*(){var l;Ut(o)&&(E("RemoteStore","Restarting streams for network reachability change."),yield(l=(0,I.Z)(function*(h){const f=D(h);f.mu.add(4),yield wr(f),f.pu.set("Unknown"),f.mu.delete(4),yield Xi(f)}),function(h){return l.apply(this,arguments)})(o))}))}),this.pu=new sy(s,r)}}function Xi(n){return Bu.apply(this,arguments)}function Bu(){return Bu=(0,I.Z)(function*(n){if(Ut(n))for(const e of n.gu)yield e(!0)}),Bu.apply(this,arguments)}function wr(n){return qu.apply(this,arguments)}function qu(){return qu=(0,I.Z)(function*(n){for(const e of n.gu)yield e(!1)}),qu.apply(this,arguments)}function Fa(n,e){const t=D(n);t.wu.has(e.targetId)||(t.wu.set(e.targetId,e),$u(t)?ju(t):br(t).Mo()&&Uu(t,e))}function Yi(n,e){const t=D(n),s=br(t);t.wu.delete(e),s.Mo()&&If(t,e),0===t.wu.size&&(s.Mo()?s.Bo():Ut(t)&&t.pu.set("Unknown"))}function Uu(n,e){n.Iu.Ft(e.targetId),br(n).Jo(e)}function If(n,e){n.Iu.Ft(e),br(n).Yo(e)}function ju(n){n.Iu=new Bm({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ie:e=>n.wu.get(e)||null}),br(n).start(),n.pu.au()}function $u(n){return Ut(n)&&!br(n).Oo()&&n.wu.size>0}function Ut(n){return 0===D(n).mu.size}function Cf(n){n.Iu=void 0}function iy(n){return Ku.apply(this,arguments)}function Ku(){return Ku=(0,I.Z)(function*(n){n.wu.forEach((e,t)=>{Uu(n,e)})}),Ku.apply(this,arguments)}function oy(n,e){return Gu.apply(this,arguments)}function Gu(){return Gu=(0,I.Z)(function*(n,e){Cf(n),$u(n)?(n.pu.fu(e),ju(n)):n.pu.set("Unknown")}),Gu.apply(this,arguments)}function ay(n,e,t){return zu.apply(this,arguments)}function zu(){return zu=(0,I.Z)(function*(n,e,t){if(n.pu.set("Online"),e instanceof pd&&2===e.state&&e.cause)try{yield(s=(0,I.Z)(function*(r,i){const o=i.cause;for(const a of i.targetIds)r.wu.has(a)&&(yield r.remoteSyncer.rejectListen(a,o),r.wu.delete(a),r.Iu.removeTarget(a))}),function(r,i){return s.apply(this,arguments)})(n,e)}catch(s){E("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),yield Ra(n,s)}else if(e instanceof ba?n.Iu.Qt(e):e instanceof fd?n.Iu.Zt(e):n.Iu.Wt(e),!t.isEqual(R.min()))try{const s=yield ff(n.localStore);t.compareTo(s)>=0&&(yield function(r,i){const o=r.Iu.ee(i);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const h=r.wu.get(l);h&&r.wu.set(l,h.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const l=r.wu.get(a);if(!l)return;r.wu.set(a,l.withResumeToken(Ee.EMPTY_BYTE_STRING,l.snapshotVersion)),If(r,a);const h=new pn(l.target,a,1,l.sequenceNumber);Uu(r,h)}),r.remoteSyncer.applyRemoteEvent(o)}(n,t))}catch(s){E("RemoteStore","Failed to raise snapshot:",s),yield Ra(n,s)}var s}),zu.apply(this,arguments)}function Ra(n,e,t){return Hu.apply(this,arguments)}function Hu(){return Hu=(0,I.Z)(function*(n,e,t){if(!on(e))throw e;n.mu.add(1),yield wr(n),n.pu.set("Offline"),t||(t=()=>ff(n.localStore)),n.asyncQueue.enqueueRetryable((0,I.Z)(function*(){E("RemoteStore","Retrying IndexedDB access"),yield t(),n.mu.delete(1),yield Xi(n)}))}),Hu.apply(this,arguments)}function Ef(n,e){return e().catch(t=>Ra(n,t,e))}function vr(n){return Qu.apply(this,arguments)}function Qu(){return Qu=(0,I.Z)(function*(n){const e=D(n),t=wn(e);let s=e._u.length>0?e._u[e._u.length-1].batchId:-1;for(;cy(e);)try{const r=yield zg(e.localStore,s);if(null===r){0===e._u.length&&t.Bo();break}s=r.batchId,uy(e,r)}catch(r){yield Ra(e,r)}Sf(e)&&Af(e)}),Qu.apply(this,arguments)}function cy(n){return Ut(n)&&n._u.length<10}function uy(n,e){n._u.push(e);const t=wn(n);t.Mo()&&t.Xo&&t.tu(e.mutations)}function Sf(n){return Ut(n)&&!wn(n).Oo()&&n._u.length>0}function Af(n){wn(n).start()}function ly(n){return Zu.apply(this,arguments)}function Zu(){return Zu=(0,I.Z)(function*(n){wn(n).su()}),Zu.apply(this,arguments)}function hy(n){return Wu.apply(this,arguments)}function Wu(){return Wu=(0,I.Z)(function*(n){const e=wn(n);for(const t of n._u)e.tu(t.mutations)}),Wu.apply(this,arguments)}function dy(n,e,t){return Xu.apply(this,arguments)}function Xu(){return Xu=(0,I.Z)(function*(n,e,t){const s=n._u.shift(),r=mu.from(s,e,t);yield Ef(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield vr(n)}),Xu.apply(this,arguments)}function fy(n,e){return Yu.apply(this,arguments)}function Yu(){return Yu=(0,I.Z)(function*(n,e){var t;e&&wn(n).Xo&&(yield(t=(0,I.Z)(function*(s,r){if(cd(i=r.code)&&i!==b.ABORTED){const o=s._u.shift();wn(s).$o(),yield Ef(s,()=>s.remoteSyncer.rejectFailedWrite(o.batchId,r)),yield vr(s)}var i}),function(s,r){return t.apply(this,arguments)})(n,e)),Sf(n)&&Af(n)}),Yu.apply(this,arguments)}function kf(n,e){return Ju.apply(this,arguments)}function Ju(){return Ju=(0,I.Z)(function*(n,e){const t=D(n);t.asyncQueue.verifyOperationInProgress(),E("RemoteStore","RemoteStore received new credentials");const s=Ut(t);t.mu.add(3),yield wr(t),s&&t.pu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.mu.delete(3),yield Xi(t)}),Ju.apply(this,arguments)}function el(n,e){return tl.apply(this,arguments)}function tl(){return tl=(0,I.Z)(function*(n,e){const t=D(n);e?(t.mu.delete(2),yield Xi(t)):e||(t.mu.add(2),yield wr(t),t.pu.set("Unknown"))}),tl.apply(this,arguments)}function br(n){return n.Tu||(n.Tu=function(e,t,s){const r=D(e);return r.ru(),new Jg(t,r.connection,r.authCredentials,r.appCheckCredentials,r.Tt,s)}(n.datastore,n.asyncQueue,{Xr:iy.bind(null,n),no:oy.bind(null,n),Ho:ay.bind(null,n)}),n.gu.push(function(){var e=(0,I.Z)(function*(t){t?(n.Tu.$o(),$u(n)?ju(n):n.pu.set("Unknown")):(yield n.Tu.stop(),Cf(n))});return function(t){return e.apply(this,arguments)}}())),n.Tu}function wn(n){return n.Eu||(n.Eu=function(e,t,s){const r=D(e);return r.ru(),new ey(t,r.connection,r.authCredentials,r.appCheckCredentials,r.Tt,s)}(n.datastore,n.asyncQueue,{Xr:ly.bind(null,n),no:fy.bind(null,n),nu:hy.bind(null,n),eu:dy.bind(null,n)}),n.gu.push(function(){var e=(0,I.Z)(function*(t){t?(n.Eu.$o(),yield vr(n)):(yield n.Eu.stop(),n._u.length>0&&(E("RemoteStore",`Stopping write stream with ${n._u.length} pending writes`),n._u=[]))});return function(t){return e.apply(this,arguments)}}())),n.Eu}class nl{constructor(e,t,s,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Ce,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,s,r,i){const o=Date.now()+s,a=new nl(e,t,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new C(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xr(n,e){if(ye("AsyncQueue",`${e}: ${n}`),on(n))return new C(b.UNAVAILABLE,`${e}: ${n}`);throw n}class _r{constructor(e){this.comparator=e?(t,s)=>e(t,s)||A.comparator(t.key,s.key):(t,s)=>A.comparator(t.key,s.key),this.keyedMap=Li(),this.sortedSet=new ge(this.comparator)}static emptySet(e){return new _r(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof _r)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const s=new _r;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}class Df{constructor(){this.Au=new ge(A.comparator)}track(e){const t=e.doc.key,s=this.Au.get(t);s?0!==e.type&&3===s.type?this.Au=this.Au.insert(t,e):3===e.type&&1!==s.type?this.Au=this.Au.insert(t,{type:s.type,doc:e.doc}):2===e.type&&2===s.type?this.Au=this.Au.insert(t,{type:2,doc:e.doc}):2===e.type&&0===s.type?this.Au=this.Au.insert(t,{type:0,doc:e.doc}):1===e.type&&0===s.type?this.Au=this.Au.remove(t):1===e.type&&2===s.type?this.Au=this.Au.insert(t,{type:1,doc:s.doc}):0===e.type&&1===s.type?this.Au=this.Au.insert(t,{type:2,doc:e.doc}):M():this.Au=this.Au.insert(t,e)}Ru(){const e=[];return this.Au.inorderTraversal((t,s)=>{e.push(s)}),e}}class Tr{constructor(e,t,s,r,i,o,a,l,h){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,s,r,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Tr(e,t,_r.emptySet(t),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Mi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}class py{constructor(){this.bu=void 0,this.listeners=[]}}class my{constructor(){this.queries=new dn(e=>zh(e),Mi),this.onlineState="Unknown",this.vu=new Set}}function sl(n,e){return rl.apply(this,arguments)}function rl(){return rl=(0,I.Z)(function*(n,e){const t=D(n),s=e.query;let r=!1,i=t.queries.get(s);if(i||(r=!0,i=new py),r)try{i.bu=yield t.onListen(s)}catch(o){const a=xr(o,`Initialization of query '${au(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.listeners.push(e),e.Pu(t.onlineState),i.bu&&e.Vu(i.bu)&&al(t)}),rl.apply(this,arguments)}function il(n,e){return ol.apply(this,arguments)}function ol(){return ol=(0,I.Z)(function*(n,e){const t=D(n),s=e.query;let r=!1;const i=t.queries.get(s);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),r=0===i.listeners.length)}if(r)return t.queries.delete(s),t.onUnlisten(s)}),ol.apply(this,arguments)}function gy(n,e){const t=D(n);let s=!1;for(const r of e){const o=t.queries.get(r.query);if(o){for(const a of o.listeners)a.Vu(r)&&(s=!0);o.bu=r}}s&&al(t)}function yy(n,e,t){const s=D(n),r=s.queries.get(e);if(r)for(const i of r.listeners)i.onError(t);s.queries.delete(e)}function al(n){n.vu.forEach(e=>{e.next()})}class cl{constructor(e,t,s){this.query=e,this.Su=t,this.Du=!1,this.Cu=null,this.onlineState="Unknown",this.options=s||{}}Vu(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)3!==r.type&&s.push(r);e=new Tr(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Du?this.xu(e)&&(this.Su.next(e),t=!0):this.Nu(e,this.onlineState)&&(this.ku(e),t=!0),this.Cu=e,t}onError(e){this.Su.error(e)}Pu(e){this.onlineState=e;let t=!1;return this.Cu&&!this.Du&&this.Nu(this.Cu,e)&&(this.ku(this.Cu),t=!0),t}Nu(e,t){return!e.fromCache||(!this.options.Ou||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}xu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Cu&&this.Cu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}ku(e){e=Tr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Du=!0,this.Su.next(e)}}class wy{constructor(e,t){this.Mu=e,this.byteLength=t}Fu(){return"metadata"in this.Mu}}class Mf{constructor(e){this.Tt=e}Zi(e){return At(this.Tt,e)}Xi(e){return e.metadata.exists?Td(this.Tt,e.document,!1):ae.newNoDocument(this.Zi(e.metadata.name),this.tr(e.metadata.readTime))}tr(e){return we(e)}}class vy{constructor(e,t,s){this.$u=e,this.localStore=t,this.Tt=s,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Nf(e)}Bu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Mu.namedQuery)this.queries.push(e.Mu.namedQuery);else if(e.Mu.documentMetadata){this.documents.push({metadata:e.Mu.documentMetadata}),e.Mu.documentMetadata.exists||++t;const s=X.fromString(e.Mu.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.Mu.document&&(this.documents[this.documents.length-1].document=e.Mu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Lu(e){const t=new Map,s=new Mf(this.Tt);for(const r of e)if(r.metadata.queries){const i=s.Zi(r.metadata.name);for(const o of r.metadata.queries){const a=(t.get(o)||j()).add(i);t.set(o,a)}}return t}complete(){var e=this;return(0,I.Z)(function*(){const t=yield function Hg(n,e,t,s){return Mu.apply(this,arguments)}(e.localStore,new Mf(e.Tt),e.documents,e.$u.id),s=e.Lu(e.documents);for(const r of e.queries)yield Qg(e.localStore,r,s.get(r.name));return e.progress.taskState="Success",{progress:e.progress,qu:e.collectionGroups,Uu:t}})()}}function Nf(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class Pf{constructor(e){this.key=e}}class Of{constructor(e){this.key=e}}class Lf{constructor(e,t){this.query=e,this.Ku=t,this.Gu=null,this.hasCachedResults=!1,this.current=!1,this.Qu=j(),this.mutatedKeys=j(),this.ju=Qh(e),this.zu=new _r(this.ju)}get Wu(){return this.Ku}Hu(e,t){const s=t?t.Ju:new Df,r=t?t.zu:this.zu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,h="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((f,p)=>{const g=r.get(f),w=Ni(this.query,p)?p:null,T=!!g&&this.mutatedKeys.has(g.key),S=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let P=!1;g&&w?g.data.isEqual(w.data)?T!==S&&(s.track({type:3,doc:w}),P=!0):this.Yu(g,w)||(s.track({type:2,doc:w}),P=!0,(l&&this.ju(w,l)>0||h&&this.ju(w,h)<0)&&(a=!0)):!g&&w?(s.track({type:0,doc:w}),P=!0):g&&!w&&(s.track({type:1,doc:g}),P=!0,(l||h)&&(a=!0)),P&&(w?(o=o.add(w),i=S?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const f="F"===this.query.limitType?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),s.track({type:1,doc:f})}return{zu:o,Ju:s,Li:a,mutatedKeys:i}}Yu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s){const r=this.zu;this.zu=e.zu,this.mutatedKeys=e.mutatedKeys;const i=e.Ju.Ru();i.sort((h,f)=>function(p,g){const w=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return M()}};return w(p)-w(g)}(h.type,f.type)||this.ju(h.doc,f.doc)),this.Zu(s);const o=t?this.Xu():[],a=0===this.Qu.size&&this.current?1:0,l=a!==this.Gu;return this.Gu=a,0!==i.length||l?{snapshot:new Tr(this.query,e.zu,r,i,e.mutatedKeys,0===a,l,!1,!!s&&s.resumeToken.approximateByteSize()>0),tc:o}:{tc:o}}Pu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({zu:this.zu,Ju:new Df,mutatedKeys:this.mutatedKeys,Li:!1},!1)):{tc:[]}}ec(e){return!this.Ku.has(e)&&!!this.zu.has(e)&&!this.zu.get(e).hasLocalMutations}Zu(e){e&&(e.addedDocuments.forEach(t=>this.Ku=this.Ku.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ku=this.Ku.delete(t)),this.current=e.current)}Xu(){if(!this.current)return[];const e=this.Qu;this.Qu=j(),this.zu.forEach(s=>{this.ec(s.key)&&(this.Qu=this.Qu.add(s.key))});const t=[];return e.forEach(s=>{this.Qu.has(s)||t.push(new Of(s))}),this.Qu.forEach(s=>{e.has(s)||t.push(new Pf(s))}),t}nc(e){this.Ku=e.Yi,this.Qu=j();const t=this.Hu(e.documents);return this.applyChanges(t,!0)}sc(){return Tr.fromInitialDocuments(this.query,this.zu,this.mutatedKeys,0===this.Gu,this.hasCachedResults)}}class by{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class xy{constructor(e){this.key=e,this.ic=!1}}class _y{constructor(e,t,s,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.rc={},this.oc=new dn(a=>zh(a),Mi),this.uc=new Map,this.cc=new Set,this.ac=new ge(A.comparator),this.hc=new Map,this.lc=new Iu,this.fc={},this.dc=new Map,this._c=hs.Sn(),this.onlineState="Unknown",this.wc=void 0}get isPrimaryClient(){return!0===this.wc}}function Ty(n,e){return ul.apply(this,arguments)}function ul(){return ul=(0,I.Z)(function*(n,e){const t=Nl(n);let s,r;const i=t.oc.get(e);if(i)s=i.targetId,t.sharedClientState.addLocalQueryTarget(s),r=i.view.sc();else{const o=yield gr(t.localStore,ze(e));t.isPrimaryClient&&Fa(t.remoteStore,o);const a=t.sharedClientState.addLocalQueryTarget(o.targetId);s=o.targetId,r=yield ll(t,e,s,"current"===a,o.resumeToken)}return r}),ul.apply(this,arguments)}function ll(n,e,t,s,r){return hl.apply(this,arguments)}function hl(){return hl=(0,I.Z)(function*(n,e,t,s,r){n.mc=(p,g,w)=>{return(T=(0,I.Z)(function*(S,P,te,N){let L=P.view.Hu(te);L.Li&&(L=yield Na(S.localStore,P.query,!1).then(({documents:J})=>P.view.Hu(J,L)));const le=N&&N.targetChanges.get(P.targetId),z=P.view.applyChanges(L,S.isPrimaryClient,le);return xl(S,P.targetId,z.tc),z.snapshot}),function(S,P,te,N){return T.apply(this,arguments)})(n,p,g,w);var T};const i=yield Na(n.localStore,e,!0),o=new Lf(e,i.Yi),a=o.Hu(i.documents),l=Vi.createSynthesizedTargetChangeForCurrentChange(t,s&&"Offline"!==n.onlineState,r),h=o.applyChanges(a,n.isPrimaryClient,l);xl(n,t,h.tc);const f=new by(e,t,o);return n.oc.set(e,f),n.uc.has(t)?n.uc.get(t).push(e):n.uc.set(t,[e]),h.snapshot}),hl.apply(this,arguments)}function Iy(n,e){return dl.apply(this,arguments)}function dl(){return dl=(0,I.Z)(function*(n,e){const t=D(n),s=t.oc.get(e),r=t.uc.get(s.targetId);if(r.length>1)return t.uc.set(s.targetId,r.filter(i=>!Mi(i,e))),void t.oc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(s.targetId),t.sharedClientState.isActiveQueryTarget(s.targetId)||(yield yr(t.localStore,s.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(s.targetId),Yi(t.remoteStore,s.targetId),Ir(t,s.targetId)}).catch(rn))):(Ir(t,s.targetId),yield yr(t.localStore,s.targetId,!0))}),dl.apply(this,arguments)}function fl(){return fl=(0,I.Z)(function*(n,e,t){const s=Pl(n);try{const r=yield function(i,o){const a=D(i),l=de.now(),h=o.reduce((g,w)=>g.add(w.key),j());let f,p;return a.persistence.runTransaction("Locally write mutations","readwrite",g=>{let w=Je(),T=j();return a.ji.getEntries(g,h).next(S=>{w=S,w.forEach((P,te)=>{te.isValidDocument()||(T=T.add(P))})}).next(()=>a.localDocuments.getOverlayedDocuments(g,w)).next(S=>{f=S;const P=[];for(const te of o){const N=Pm(te,f.get(te.key).overlayedDocument);null!=N&&P.push(new qt(te.key,N,Uh(N.value.mapValue),fe.exists(!0)))}return a.mutationQueue.addMutationBatch(g,l,P,o)}).next(S=>{p=S;const P=S.applyToLocalDocumentSet(f,T);return a.documentOverlayCache.saveOverlays(g,S.batchId,P)})}).then(()=>({batchId:p.batchId,changes:hd(f)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(i,o,a){let l=i.fc[i.currentUser.toKey()];l||(l=new ge(U)),l=l.insert(o,a),i.fc[i.currentUser.toKey()]=l}(s,r.batchId,t),yield jt(s,r.changes),yield vr(s.remoteStore)}catch(r){const i=xr(r,"Failed to persist write");t.reject(i)}}),fl.apply(this,arguments)}function Ff(n,e){return pl.apply(this,arguments)}function pl(){return pl=(0,I.Z)(function*(n,e){const t=D(n);try{const s=yield function Gg(n,e){const t=D(n),s=e.snapshotVersion;let r=t.Ki;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.ji.newChangeBuffer({trackRemovals:!0});r=t.Ki;const a=[];e.targetChanges.forEach((f,p)=>{const g=r.get(p);if(!g)return;a.push(t.Ns.removeMatchingKeys(i,f.removedDocuments,p).next(()=>t.Ns.addMatchingKeys(i,f.addedDocuments,p)));let w=g.withSequenceNumber(i.currentSequenceNumber);var T,S,P;e.targetMismatches.has(p)?w=w.withResumeToken(Ee.EMPTY_BYTE_STRING,R.min()).withLastLimboFreeSnapshotVersion(R.min()):f.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(f.resumeToken,s)),r=r.insert(p,w),S=w,P=f,(0===(T=g).resumeToken.approximateByteSize()||S.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=3e8||P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0)&&a.push(t.Ns.updateTargetData(i,w))});let l=Je(),h=j();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,f))}),a.push(pf(i,o,e.documentUpdates).next(f=>{l=f.Hi,h=f.Ji})),!s.isEqual(R.min())){const f=t.Ns.getLastRemoteSnapshotVersion(i).next(p=>t.Ns.setTargetsMetadata(i,i.currentSequenceNumber,s));a.push(f)}return v.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,h)).next(()=>l)}).then(i=>(t.Ki=r,i))}(t.localStore,e);e.targetChanges.forEach((r,i)=>{const o=t.hc.get(i);o&&(O(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.ic=!0:r.modifiedDocuments.size>0?O(o.ic):r.removedDocuments.size>0&&(O(o.ic),o.ic=!1))}),yield jt(t,s,e)}catch(s){yield rn(s)}}),pl.apply(this,arguments)}function Rf(n,e,t){const s=D(n);if(s.isPrimaryClient&&0===t||!s.isPrimaryClient&&1===t){const r=[];s.oc.forEach((i,o)=>{const a=o.view.Pu(e);a.snapshot&&r.push(a.snapshot)}),function(i,o){const a=D(i);a.onlineState=o;let l=!1;a.queries.forEach((h,f)=>{for(const p of f.listeners)p.Pu(o)&&(l=!0)}),l&&al(a)}(s.eventManager,e),r.length&&s.rc.Ho(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}function Ey(n,e,t){return ml.apply(this,arguments)}function ml(){return ml=(0,I.Z)(function*(n,e,t){const s=D(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.hc.get(e),i=r&&r.key;if(i){let o=new ge(A.comparator);o=o.insert(i,ae.newNoDocument(i,R.min()));const a=j().add(i),l=new Ri(R.min(),new Map,new re(U),o,a);yield Ff(s,l),s.ac=s.ac.remove(i),s.hc.delete(e),_l(s)}else yield yr(s.localStore,e,!1).then(()=>Ir(s,e,t)).catch(rn)}),ml.apply(this,arguments)}function Sy(n,e){return gl.apply(this,arguments)}function gl(){return gl=(0,I.Z)(function*(n,e){const t=D(n),s=e.batch.batchId;try{const r=yield function Kg(n,e){const t=D(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=t.ji.newChangeBuffer({trackRemovals:!0});return function(o,a,l,h){const f=l.batch,p=f.keys();let g=v.resolve();return p.forEach(w=>{g=g.next(()=>h.getEntry(a,w)).next(T=>{const S=l.docVersions.get(w);O(null!==S),T.version.compareTo(S)<0&&(f.applyToRemoteDocument(T,l),T.isValidDocument()&&(T.setReadTime(l.commitVersion),h.addEntry(T)))})}),g.next(()=>o.mutationQueue.removeMutationBatch(a,f))}(t,s,e,i).next(()=>i.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(o){let a=j();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(a=a.add(o.batch.mutations[l].key));return a}(e))).next(()=>t.localDocuments.getDocuments(s,r))})}(t.localStore,e);bl(t,s,null),vl(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),yield jt(t,r)}catch(r){yield rn(r)}}),gl.apply(this,arguments)}function Ay(n,e,t){return yl.apply(this,arguments)}function yl(){return yl=(0,I.Z)(function*(n,e,t){const s=D(n);try{const r=yield function(i,o){const a=D(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return a.mutationQueue.lookupMutationBatch(l,o).next(f=>(O(null!==f),h=f.keys(),a.mutationQueue.removeMutationBatch(l,f))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,h,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>a.localDocuments.getDocuments(l,h))})}(s.localStore,e);bl(s,e,t),vl(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),yield jt(s,r)}catch(r){yield rn(r)}}),yl.apply(this,arguments)}function wl(){return wl=(0,I.Z)(function*(n,e){const t=D(n);Ut(t.remoteStore)||E("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=yield function(i){const o=D(i);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(t.localStore);if(-1===s)return void e.resolve();const r=t.dc.get(s)||[];r.push(e),t.dc.set(s,r)}catch(s){const r=xr(s,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}),wl.apply(this,arguments)}function vl(n,e){(n.dc.get(e)||[]).forEach(t=>{t.resolve()}),n.dc.delete(e)}function bl(n,e,t){const s=D(n);let r=s.fc[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),s.fc[s.currentUser.toKey()]=r}}function Ir(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.uc.get(e))n.oc.delete(s),t&&n.rc.gc(s,t);n.uc.delete(e),n.isPrimaryClient&&n.lc.ds(e).forEach(s=>{n.lc.containsKey(s)||Vf(n,s)})}function Vf(n,e){n.cc.delete(e.path.canonicalString());const t=n.ac.get(e);null!==t&&(Yi(n.remoteStore,t),n.ac=n.ac.remove(e),n.hc.delete(t),_l(n))}function xl(n,e,t){for(const s of t)s instanceof Pf?(n.lc.addReference(s.key,e),Dy(n,s)):s instanceof Of?(E("SyncEngine","Document no longer in limbo: "+s.key),n.lc.removeReference(s.key,e),n.lc.containsKey(s.key)||Vf(n,s.key)):M()}function Dy(n,e){const t=e.key,s=t.path.canonicalString();n.ac.get(t)||n.cc.has(s)||(E("SyncEngine","New document in limbo: "+t),n.cc.add(s),_l(n))}function _l(n){for(;n.cc.size>0&&n.ac.size<n.maxConcurrentLimboResolutions;){const e=n.cc.values().next().value;n.cc.delete(e);const t=new A(X.fromString(e)),s=n._c.next();n.hc.set(s,new xy(t)),n.ac=n.ac.insert(t,s),Fa(n.remoteStore,new pn(ze(ar(t.path)),s,2,ot.at))}}function jt(n,e,t){return Tl.apply(this,arguments)}function Tl(){return Tl=(0,I.Z)(function*(n,e,t){const s=D(n),r=[],i=[],o=[];var a;s.oc.isEmpty()||(s.oc.forEach((a,l)=>{o.push(s.mc(l,e,t).then(h=>{if((h||t)&&s.isPrimaryClient&&s.sharedClientState.updateQueryState(l.targetId,h?.fromCache?"not-current":"current"),h){r.push(h);const f=Au.Ni(l.targetId,h);i.push(f)}}))}),yield Promise.all(o),s.rc.Ho(r),yield(a=(0,I.Z)(function*(l,h){const f=D(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>v.forEach(h,g=>v.forEach(g.Ci,w=>f.persistence.referenceDelegate.addReference(p,g.targetId,w)).next(()=>v.forEach(g.xi,w=>f.persistence.referenceDelegate.removeReference(p,g.targetId,w)))))}catch(p){if(!on(p))throw p;E("LocalStore","Failed to update sequence numbers: "+p)}for(const p of h){const g=p.targetId;if(!p.fromCache){const w=f.Ki.get(g),S=w.withLastLimboFreeSnapshotVersion(w.snapshotVersion);f.Ki=f.Ki.insert(g,S)}}}),function(l,h){return a.apply(this,arguments)})(s.localStore,i))}),Tl.apply(this,arguments)}function My(n,e){return Il.apply(this,arguments)}function Il(){return Il=(0,I.Z)(function*(n,e){const t=D(n);if(!t.currentUser.isEqual(e)){E("SyncEngine","User change. New user:",e.toKey());const s=yield df(t.localStore,e);t.currentUser=e,(r=t).dc.forEach(o=>{o.forEach(a=>{a.reject(new C(b.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.dc.clear(),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),yield jt(t,s.Wi)}var r}),Il.apply(this,arguments)}function Ny(n,e){const t=D(n),s=t.hc.get(e);if(s&&s.ic)return j().add(s.key);{let r=j();const i=t.uc.get(e);if(!i)return r;for(const o of i){const a=t.oc.get(o);r=r.unionWith(a.view.Wu)}return r}}function Py(n,e){return Cl.apply(this,arguments)}function Cl(){return Cl=(0,I.Z)(function*(n,e){const t=D(n),s=yield Na(t.localStore,e.query,!0),r=e.view.nc(s);return t.isPrimaryClient&&xl(t,e.targetId,r.tc),r}),Cl.apply(this,arguments)}function Oy(n,e){return El.apply(this,arguments)}function El(){return El=(0,I.Z)(function*(n,e){const t=D(n);return gf(t.localStore,e).then(s=>jt(t,s))}),El.apply(this,arguments)}function Ly(n,e,t,s){return Sl.apply(this,arguments)}function Sl(){return Sl=(0,I.Z)(function*(n,e,t,s){const r=D(n),i=yield function(o,a){const l=D(o),h=D(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",f=>h.An(f,a).next(p=>p?l.localDocuments.getDocuments(f,p):v.resolve(null)))}(r.localStore,e);var a;null!==i?("pending"===t?yield vr(r.remoteStore):"acknowledged"===t||"rejected"===t?(bl(r,e,s||null),vl(r,e),a=e,D(D(r.localStore).mutationQueue).bn(a)):M(),yield jt(r,i)):E("SyncEngine","Cannot apply mutation batch with id: "+e)}),Sl.apply(this,arguments)}function Al(){return Al=(0,I.Z)(function*(n,e){const t=D(n);if(Nl(t),Pl(t),!0===e&&!0!==t.wc){const s=t.sharedClientState.getAllActiveQueryTargets(),r=yield Bf(t,s.toArray());t.wc=!0,yield el(t.remoteStore,!0);for(const i of r)Fa(t.remoteStore,i)}else if(!1===e&&!1!==t.wc){const s=[];let r=Promise.resolve();t.uc.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?s.push(o):r=r.then(()=>(Ir(t,o),yr(t.localStore,o,!0))),Yi(t.remoteStore,o)}),yield r,yield Bf(t,s),function(i){const o=D(i);o.hc.forEach((a,l)=>{Yi(o.remoteStore,l)}),o.lc._s(),o.hc=new Map,o.ac=new ge(A.comparator)}(t),t.wc=!1,yield el(t.remoteStore,!1)}}),Al.apply(this,arguments)}function Bf(n,e,t){return kl.apply(this,arguments)}function kl(){return kl=(0,I.Z)(function*(n,e,t){const s=D(n),r=[],i=[];for(const o of e){let a;const l=s.uc.get(o);if(l&&0!==l.length){a=yield gr(s.localStore,ze(l[0]));for(const h of l){const f=s.oc.get(h),p=yield Py(s,f);p.snapshot&&i.push(p.snapshot)}}else{const h=yield mf(s.localStore,o);a=yield gr(s.localStore,h),yield ll(s,qf(h),o,!1,a.resumeToken)}r.push(a)}return s.rc.Ho(i),r}),kl.apply(this,arguments)}function qf(n){return Kh(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Ry(n){const e=D(n);return D(D(e.localStore).persistence).Si()}function Vy(n,e,t,s){return Dl.apply(this,arguments)}function Dl(){return Dl=(0,I.Z)(function*(n,e,t,s){const r=D(n);if(r.wc)return void E("SyncEngine","Ignoring unexpected query state notification.");const i=r.uc.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=yield gf(r.localStore,Hh(i[0])),a=Ri.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,Ee.EMPTY_BYTE_STRING);yield jt(r,o,a);break}case"rejected":yield yr(r.localStore,e,!0),Ir(r,e,s);break;default:M()}}),Dl.apply(this,arguments)}function By(n,e,t){return Ml.apply(this,arguments)}function Ml(){return Ml=(0,I.Z)(function*(n,e,t){const s=Nl(n);if(s.wc){for(const r of e){if(s.uc.has(r)){E("SyncEngine","Adding an already active target "+r);continue}const i=yield mf(s.localStore,r),o=yield gr(s.localStore,i);yield ll(s,qf(i),o.targetId,!1,o.resumeToken),Fa(s.remoteStore,o)}for(const r of t)s.uc.has(r)&&(yield yr(s.localStore,r,!1).then(()=>{Yi(s.remoteStore,r),Ir(s,r)}).catch(rn))}}),Ml.apply(this,arguments)}function Nl(n){const e=D(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ff.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ny.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Ey.bind(null,e),e.rc.Ho=gy.bind(null,e.eventManager),e.rc.gc=yy.bind(null,e.eventManager),e}function Pl(n){const e=D(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Sy.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ay.bind(null,e),e}class Uf{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,I.Z)(function*(){t.Tt=Wi(e.databaseInfo.databaseId),t.sharedClientState=t.Ic(e),t.persistence=t.Tc(e),yield t.persistence.start(),t.localStore=t.Ec(e),t.gcScheduler=t.Ac(e,t.localStore),t.indexBackfillerScheduler=t.Rc(e,t.localStore)})()}Ac(e,t){return null}Rc(e,t){return null}Ec(e){return hf(this.persistence,new lf,e.initialUser,this.Tt)}Tc(e){return new cf(Da.qs,this.Tt)}Ic(e){return new bf}terminate(){var e=this;return(0,I.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class jf extends Uf{constructor(e,t,s){super(),this.bc=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,s=this;return(0,I.Z)(function*(){yield t().call(s,e),yield s.bc.initialize(s,e),yield Pl(s.bc.syncEngine),yield vr(s.bc.remoteStore),yield s.persistence.di(()=>(s.gcScheduler&&!s.gcScheduler.started&&s.gcScheduler.start(),s.indexBackfillerScheduler&&!s.indexBackfillerScheduler.started&&s.indexBackfillerScheduler.start(),Promise.resolve()))})()}Ec(e){return hf(this.persistence,new lf,e.initialUser,this.Tt)}Ac(e,t){return new kg(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Rc(e,t){const s=new lm(t,this.persistence);return new um(e.asyncQueue,s)}Tc(e){const t=Su(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=void 0!==this.cacheSizeBytes?et.withCacheSize(this.cacheSizeBytes):et.DEFAULT;return new Eu(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,_f(),La(),this.Tt,this.sharedClientState,!!this.forceOwnership)}Ic(e){return new bf}}class Uy extends jf{constructor(e,t){super(e,t,!1),this.bc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,s=this;return(0,I.Z)(function*(){yield t().call(s,e);const r=s.bc.syncEngine;s.sharedClientState instanceof Fu&&(s.sharedClientState.syncEngine={Br:Ly.bind(null,r),Lr:Vy.bind(null,r),qr:By.bind(null,r),Si:Ry.bind(null,r),$r:Oy.bind(null,r)},yield s.sharedClientState.start()),yield s.persistence.di(function(){var i=(0,I.Z)(function*(o){yield function Fy(n,e){return Al.apply(this,arguments)}(s.bc.syncEngine,o),s.gcScheduler&&(o&&!s.gcScheduler.started?s.gcScheduler.start():o||s.gcScheduler.stop()),s.indexBackfillerScheduler&&(o&&!s.indexBackfillerScheduler.started?s.indexBackfillerScheduler.start():o||s.indexBackfillerScheduler.stop())});return function(o){return i.apply(this,arguments)}}())})()}Ic(e){const t=_f();if(!Fu.C(t))throw new C(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=Su(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Fu(t,e.asyncQueue,s,e.clientId,e.initialUser)}}class Ol{initialize(e,t){var s=this;return(0,I.Z)(function*(){s.localStore||(s.localStore=e.localStore,s.sharedClientState=e.sharedClientState,s.datastore=s.createDatastore(t),s.remoteStore=s.createRemoteStore(t),s.eventManager=s.createEventManager(t),s.syncEngine=s.createSyncEngine(t,!e.synchronizeTabs),s.sharedClientState.onlineStateHandler=r=>Rf(s.syncEngine,r,1),s.remoteStore.remoteSyncer.handleCredentialChange=My.bind(null,s.syncEngine),yield el(s.remoteStore,s.syncEngine.isPrimaryClient))})()}createEventManager(e){return new my}createDatastore(e){const t=Wi(e.databaseInfo.databaseId),s=new Yg(e.databaseInfo);return new ty(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return t=this.localStore,s=this.datastore,r=e.asyncQueue,i=a=>Rf(this.syncEngine,a,0),o=xf.C()?new xf:new Zg,new ry(t,s,r,i,o);var t,s,r,i,o}createSyncEngine(e,t){return function(s,r,i,o,a,l,h){const f=new _y(s,r,i,o,a,l);return h&&(f.wc=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,I.Z)(function*(t){const s=D(t);E("RemoteStore","RemoteStore shutting down."),s.mu.add(5),yield wr(s),s.yu.shutdown(),s.pu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function $f(n,e=10240){let t=0;return{read:()=>(0,I.Z)(function*(){if(t<n.byteLength){const s={value:n.slice(t,t+e),done:!1};return t+=e,s}return{done:!0}})(),cancel:()=>(0,I.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class Va{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.vc(this.observer.next,e)}error(e){this.observer.error?this.vc(this.observer.error,e):ye("Uncaught Error in snapshot listener:",e.toString())}Pc(){this.muted=!0}vc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class jy{constructor(e,t){this.Vc=e,this.Tt=t,this.metadata=new Ce,this.buffer=new Uint8Array,this.Sc=new TextDecoder("utf-8"),this.Dc().then(s=>{s&&s.Fu()?this.metadata.resolve(s.Mu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(s?.Mu)}`))},s=>this.metadata.reject(s))}close(){return this.Vc.cancel()}getMetadata(){var e=this;return(0,I.Z)(function*(){return e.metadata.promise})()}yc(){var e=this;return(0,I.Z)(function*(){return yield e.getMetadata(),e.Dc()})()}Dc(){var e=this;return(0,I.Z)(function*(){const t=yield e.Cc();if(null===t)return null;const s=e.Sc.decode(t),r=Number(s);isNaN(r)&&e.xc(`length string (${s}) is not valid number`);const i=yield e.Nc(r);return new wy(JSON.parse(i),t.length+r)})()}kc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Cc(){var e=this;return(0,I.Z)(function*(){for(;e.kc()<0&&!(yield e.Oc()););if(0===e.buffer.length)return null;const t=e.kc();t<0&&e.xc("Reached the end of bundle when a length string is expected.");const s=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),s})()}Nc(e){var t=this;return(0,I.Z)(function*(){for(;t.buffer.length<e;)(yield t.Oc())&&t.xc("Reached the end of bundle when more is expected.");const s=t.Sc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),s})()}xc(e){throw this.Vc.cancel(),new Error(`Invalid bundle format: ${e}`)}Oc(){var e=this;return(0,I.Z)(function*(){const t=yield e.Vc.read();if(!t.done){const s=new Uint8Array(e.buffer.length+t.value.length);s.set(e.buffer),s.set(t.value,e.buffer.length),e.buffer=s}return t.done})()}}class $y{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,I.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new C(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const s=yield(r=(0,I.Z)(function*(i,o){const a=D(i),l=qi(a.Tt)+"/documents",h={documents:o.map(w=>Bi(a.Tt,w))},f=yield a.mo("BatchGetDocuments",l,h,o.length),p=new Map;f.forEach(w=>{const T=function Gm(n,e){return"found"in e?function(t,s){O(!!s.found);const r=At(t,s.found.name),i=we(s.found.updateTime),o=s.found.createTime?we(s.found.createTime):R.min(),a=new Le({mapValue:{fields:s.found.fields}});return ae.newFoundDocument(r,i,o,a)}(n,e):"missing"in e?function(t,s){O(!!s.missing),O(!!s.readTime);const r=At(t,s.missing),i=we(s.readTime);return ae.newNoDocument(r,i)}(n,e):M()}(a.Tt,w);p.set(T.key.toString(),T)});const g=[];return o.forEach(w=>{const T=p.get(w.toString());O(!!T),g.push(T)}),g}),function(i,o){return r.apply(this,arguments)})(t.datastore,e);var r;return s.forEach(r=>t.recordVersion(r)),s})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastWriteError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new hr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,I.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var s;e.mutations.forEach(s=>{t.delete(s.key.toString())}),t.forEach((s,r)=>{const i=A.fromPath(r);e.mutations.push(new cu(i,e.precondition(i)))}),yield(s=(0,I.Z)(function*(r,i){const o=D(r),a=qi(o.Tt)+"/documents",l={writes:i.map(h=>Ui(o.Tt,h))};yield o.lo("Commit",a,l)}),function(r,i){return s.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw M();t=R.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!t.isEqual(s))throw new C(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(R.min())?fe.exists(!1):fe.updateTime(t):fe.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(R.min()))throw new C(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return fe.updateTime(t)}return fe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Ky{constructor(e,t,s,r,i){this.asyncQueue=e,this.datastore=t,this.options=s,this.updateFunction=r,this.deferred=i,this.Mc=s.maxAttempts,this.ko=new Ru(this.asyncQueue,"transaction_retry")}run(){this.Mc-=1,this.Fc()}Fc(){var e=this;this.ko.vo((0,I.Z)(function*(){const t=new $y(e.datastore),s=e.$c(t);s&&s.then(r=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(r)}).catch(i=>{e.Bc(i)}))}).catch(r=>{e.Bc(r)})}))}$c(e){try{const t=this.updateFunction(e);return!Ii(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Bc(e){this.Mc>0&&this.Lc(e)?(this.Mc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Fc(),Promise.resolve()))):this.deferred.reject(e)}Lc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!cd(t)}return!1}}class Gy{constructor(e,t,s,r){var i=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=Oe.UNAUTHENTICATED,this.clientId=ph.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(s,function(){var o=(0,I.Z)(function*(a){E("FirestoreClient","Received user=",a.uid),yield i.authCredentialListener(a),i.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(s,o=>(E("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return(0,I.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new C(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Ce;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,I.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(s){const r=xr(s,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}function Kf(n,e){return Ll.apply(this,arguments)}function Ll(){return Ll=(0,I.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),E("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener(function(){var r=(0,I.Z)(function*(i){s.isEqual(i)||(yield df(e.localStore,i),s=i)});return function(i){return r.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),Ll.apply(this,arguments)}function Gf(n,e){return Fl.apply(this,arguments)}function Fl(){return Fl=(0,I.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield Rl(n);E("FirestoreClient","Initializing OnlineComponentProvider");const s=yield n.getConfiguration();yield e.initialize(t,s),n.setCredentialChangeListener(r=>kf(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>kf(e.remoteStore,i)),n.onlineComponents=e}),Fl.apply(this,arguments)}function Rl(n){return Vl.apply(this,arguments)}function Vl(){return Vl=(0,I.Z)(function*(n){return n.offlineComponents||(E("FirestoreClient","Using default OfflineComponentProvider"),yield Kf(n,new Uf)),n.offlineComponents}),Vl.apply(this,arguments)}function Ba(n){return Bl.apply(this,arguments)}function Bl(){return Bl=(0,I.Z)(function*(n){return n.onlineComponents||(E("FirestoreClient","Using default OnlineComponentProvider"),yield Gf(n,new Ol)),n.onlineComponents}),Bl.apply(this,arguments)}function zf(n){return Rl(n).then(e=>e.persistence)}function qa(n){return Rl(n).then(e=>e.localStore)}function ql(n){return Ba(n).then(e=>e.remoteStore)}function Ul(n){return Ba(n).then(e=>e.syncEngine)}function Cr(n){return jl.apply(this,arguments)}function jl(){return jl=(0,I.Z)(function*(n){const e=yield Ba(n),t=e.eventManager;return t.onListen=Ty.bind(null,e.syncEngine),t.onUnlisten=Iy.bind(null,e.syncEngine),t}),jl.apply(this,arguments)}function Qf(n,e,t={}){const s=new Ce;return n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return function(r,i,o,a,l){const h=new Va({next:p=>{i.enqueueAndForget(()=>il(r,f));const g=p.docs.has(o);!g&&p.fromCache?l.reject(new C(b.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&a&&"server"===a.source?l.reject(new C(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),f=new cl(ar(o.path),h,{includeMetadataChanges:!0,Ou:!0});return sl(r,f)}(yield Cr(n),n.asyncQueue,e,t,s)})),s.promise}function Zf(n,e,t={}){const s=new Ce;return n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return function(r,i,o,a,l){const h=new Va({next:p=>{i.enqueueAndForget(()=>il(r,f)),p.fromCache&&"server"===a.source?l.reject(new C(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),f=new cl(o,h,{includeMetadataChanges:!0,Ou:!0});return sl(r,f)}(yield Cr(n),n.asyncQueue,e,t,s)})),s.promise}const Wf=new Map;function $l(n,e,t){if(!t)throw new C(b.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Xf(n,e,t,s){if(!0===e&&!0===s)throw new C(b.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Yf(n){if(!A.isDocumentKey(n))throw new C(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Jf(n){if(A.isDocumentKey(n))throw new C(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ua(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":M()}function Z(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new C(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ua(n);throw new C(b.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ep(n,e){if(e<=0)throw new C(b.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class tp{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new C(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new C(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,Xf("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ji{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new tp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new C(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new C(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new tp(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new Xp;switch(t.type){case"gapi":return new tm(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new C(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Wf.get(e);t&&(E("ComponentProvider","Removing Datastore"),Wf.delete(e),t.terminate())}(this),Promise.resolve()}}class ce{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ce(this.firestore,e,this._key)}}class qe{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new qe(this.firestore,e,this._query)}}class Dt extends qe{constructor(e,t,s){super(e,t,ar(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ce(this.firestore,null,new A(e))}withConverter(e){return new Dt(this.firestore,e,this._path)}}function sp(n,e,...t){if(n=(0,H.m9)(n),$l("collection","path",e),n instanceof Ji){const s=X.fromString(e,...t);return Jf(s),new Dt(n,null,s)}{if(!(n instanceof ce||n instanceof Dt))throw new C(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(X.fromString(e,...t));return Jf(s),new Dt(n.firestore,null,s)}}function ja(n,e,...t){if(n=(0,H.m9)(n),1===arguments.length&&(e=ph.R()),$l("doc","path",e),n instanceof Ji){const s=X.fromString(e,...t);return Yf(s),new ce(n,null,new A(s))}{if(!(n instanceof ce||n instanceof Dt))throw new C(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(X.fromString(e,...t));return Yf(s),new ce(n.firestore,n instanceof Dt?n.converter:null,new A(s))}}function rp(n,e){return n=(0,H.m9)(n),e=(0,H.m9)(e),(n instanceof ce||n instanceof Dt)&&(e instanceof ce||e instanceof Dt)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Kl(n,e){return n=(0,H.m9)(n),e=(0,H.m9)(e),n instanceof qe&&e instanceof qe&&n.firestore===e.firestore&&Mi(n._query,e._query)&&n.converter===e.converter}class ew{constructor(){this.qc=Promise.resolve(),this.Uc=[],this.Kc=!1,this.Gc=[],this.Qc=null,this.jc=!1,this.zc=!1,this.Wc=[],this.ko=new Ru(this,"async_queue_retry"),this.Hc=()=>{const t=La();t&&E("AsyncQueue","Visibility state changed to "+t.visibilityState),this.ko.Vo()};const e=La();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Hc)}get isShuttingDown(){return this.Kc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Jc(),this.Yc(e)}enterRestrictedMode(e){if(!this.Kc){this.Kc=!0,this.zc=e||!1;const t=La();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Hc)}}enqueue(e){if(this.Jc(),this.Kc)return new Promise(()=>{});const t=new Ce;return this.Yc(()=>this.Kc&&this.zc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Uc.push(e),this.Zc()))}Zc(){var e=this;return(0,I.Z)(function*(){if(0!==e.Uc.length){try{yield e.Uc[0](),e.Uc.shift(),e.ko.reset()}catch(t){if(!on(t))throw t;E("AsyncQueue","Operation failed with retryable error: "+t)}e.Uc.length>0&&e.ko.vo(()=>e.Zc())}})()}Yc(e){const t=this.qc.then(()=>(this.jc=!0,e().catch(s=>{throw this.Qc=s,this.jc=!1,ye("INTERNAL UNHANDLED ERROR: ",function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+"\n"+i.stack),o}(s)),s}).then(s=>(this.jc=!1,s))));return this.qc=t,t}enqueueAfterDelay(e,t,s){this.Jc(),this.Wc.indexOf(e)>-1&&(t=0);const r=nl.createAndSchedule(this,e,t,s,i=>this.Xc(i));return this.Gc.push(r),r}Jc(){this.Qc&&M()}verifyOperationInProgress(){}ta(){var e=this;return(0,I.Z)(function*(){let t;do{t=e.qc,yield t}while(t!==e.qc)})()}ea(e){for(const t of this.Gc)if(t.timerId===e)return!0;return!1}na(e){return this.ta().then(()=>{this.Gc.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.Gc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.ta()})}sa(e){this.Wc.push(e)}Xc(e){const t=this.Gc.indexOf(e);this.Gc.splice(t,1)}}function Gl(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const s=e;for(const r of["next","error","complete"])if(r in s&&"function"==typeof s[r])return!0;return!1}(n)}class tw{constructor(){this._progressObserver={},this._taskCompletionResolver=new Ce,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,s){this._progressObserver={next:e,error:t,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class ue extends Ji{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new ew,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||ip(this),this._firestoreClient.terminate()}}function ve(n){return n._firestoreClient||ip(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function ip(n){var e;const t=n._freezeSettings(),s=(i=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new fm(n._databaseId,i,n._persistenceKey,(a=t).host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams));var i,a;n._firestoreClient=new Gy(n._authCredentials,n._appCheckCredentials,n._queue,s)}function op(n,e,t){const s=new Ce;return n.asyncQueue.enqueue((0,I.Z)(function*(){try{yield Kf(n,t),yield Gf(n,e),s.resolve()}catch(r){const i=r;if(!("FirebaseError"===(o=i).name?o.code===b.FAILED_PRECONDITION||o.code===b.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||22===o.code||20===o.code||11===o.code))throw i;Zn("Error enabling offline persistence. Falling back to persistence disabled: "+i),s.reject(i)}var o})).then(()=>s.promise)}function ap(n){if(n._initialized||n._terminated)throw new C(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Mt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mt(Ee.fromBase64String(e))}catch(t){throw new C(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Mt(Ee.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class $t{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new C(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class fs{constructor(e){this._methodName=e}}class $a{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new C(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new C(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return U(this._lat,e._lat)||U(this._long,e._long)}}const dw=/^__.*__$/;class fw{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return null!==this.fieldMask?new qt(e,this.data,this.fieldMask,t,this.fieldTransforms):new lr(e,this.data,t,this.fieldTransforms)}}class cp{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new qt(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function up(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw M()}}class Ka{constructor(e,t,s,r,i,o){this.settings=e,this.databaseId=t,this.Tt=s,this.ignoreUndefinedProperties=r,void 0===i&&this.ia(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ra(){return this.settings.ra}oa(e){return new Ka(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.Tt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ua(e){var t;const s=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.oa({path:s,ca:!1});return r.aa(e),r}ha(e){var t;const s=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.oa({path:s,ca:!1});return r.ia(),r}la(e){return this.oa({path:void 0,ca:!0})}fa(e){return Ha(e,this.settings.methodName,this.settings.da||!1,this.path,this.settings._a)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ia(){if(this.path)for(let e=0;e<this.path.length;e++)this.aa(this.path.get(e))}aa(e){if(0===e.length)throw this.fa("Document fields must not be empty");if(up(this.ra)&&dw.test(e))throw this.fa('Document fields cannot begin and end with "__"')}}class pw{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.Tt=s||Wi(e)}wa(e,t,s,r=!1){return new Ka({ra:e,methodName:t,_a:s,path:pe.emptyPath(),ca:!1,da:r},this.databaseId,this.Tt,this.ignoreUndefinedProperties)}}function ps(n){const e=n._freezeSettings(),t=Wi(n._databaseId);return new pw(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ga(n,e,t,s,r,i={}){const o=n.wa(i.merge||i.mergeFields?2:0,e,t,r);Zl("Data must be an object, but it was:",o,s);const a=dp(s,o);let l,h;if(i.merge)l=new Ye(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const p of i.mergeFields){const g=no(e,p,t);if(!o.contains(g))throw new C(b.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);pp(f,g)||f.push(g)}l=new Ye(f),h=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,h=o.fieldTransforms;return new fw(new Le(a),l,h)}class to extends fs{_toFieldTransform(e){if(2!==e.ra)throw e.fa(1===e.ra?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof to}}function lp(n,e,t){return new Ka({ra:3,_a:e.settings._a,methodName:n._methodName,ca:t},e.databaseId,e.Tt,e.ignoreUndefinedProperties)}class zl extends fs{_toFieldTransform(e){return new Pi(e.path,new cr)}isEqual(e){return e instanceof zl}}class mw extends fs{constructor(e,t){super(e),this.ma=t}_toFieldTransform(e){const t=lp(this,e,!0),s=this.ma.map(i=>ms(i,t)),r=new rs(s);return new Pi(e.path,r)}isEqual(e){return this===e}}class gw extends fs{constructor(e,t){super(e),this.ma=t}_toFieldTransform(e){const t=lp(this,e,!0),s=this.ma.map(i=>ms(i,t)),r=new is(s);return new Pi(e.path,r)}isEqual(e){return this===e}}class yw extends fs{constructor(e,t){super(e),this.ga=t}_toFieldTransform(e){const t=new ur(e.Tt,Xh(e.Tt,this.ga));return new Pi(e.path,t)}isEqual(e){return this===e}}function Hl(n,e,t,s){const r=n.wa(1,e,t);Zl("Data must be an object, but it was:",r,s);const i=[],o=Le.empty();Yn(s,(l,h)=>{const f=za(e,l,t);h=(0,H.m9)(h);const p=r.ha(f);if(h instanceof to)i.push(f);else{const g=ms(h,p);null!=g&&(i.push(f),o.set(f,g))}});const a=new Ye(i);return new cp(o,a,r.fieldTransforms)}function Ql(n,e,t,s,r,i){const o=n.wa(1,e,t),a=[no(e,s,t)],l=[r];if(i.length%2!=0)throw new C(b.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)a.push(no(e,i[g])),l.push(i[g+1]);const h=[],f=Le.empty();for(let g=a.length-1;g>=0;--g)if(!pp(h,a[g])){const w=a[g];let T=l[g];T=(0,H.m9)(T);const S=o.ha(w);if(T instanceof to)h.push(w);else{const P=ms(T,S);null!=P&&(h.push(w),f.set(w,P))}}const p=new Ye(h);return new cp(f,p,o.fieldTransforms)}function hp(n,e,t,s=!1){return ms(t,n.wa(s?4:3,e))}function ms(n,e){if(fp(n=(0,H.m9)(n)))return Zl("Unsupported field value:",e,n),dp(n,e);if(n instanceof fs)return function(t,s){if(!up(s.ra))throw s.fa(`${t._methodName}() can only be used with update() and set()`);if(!s.path)throw s.fa(`${t._methodName}() is not currently supported inside arrays`);const r=t._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.ca&&4!==e.ra)throw e.fa("Nested arrays are not supported");return function(t,s){const r=[];let i=0;for(const o of t){let a=ms(o,s.la(i));null==a&&(a={nullValue:"NULL_VALUE"}),r.push(a),i++}return{arrayValue:{values:r}}}(n,e)}return function(t,s){if(null===(t=(0,H.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Xh(s.Tt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const r=de.fromDate(t);return{timestampValue:dr(s.Tt,r)}}if(t instanceof de){const r=new de(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:dr(s.Tt,r)}}if(t instanceof $a)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Mt)return{bytesValue:wd(s.Tt,t._byteString)};if(t instanceof ce){const r=s.databaseId,i=t.firestore._databaseId;if(!i.isEqual(r))throw s.fa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:uu(t.firestore._databaseId||s.databaseId,t._key.path)}}throw s.fa(`Unsupported field value: ${Ua(t)}`)}(n,e)}function dp(n,e){const t={};return _h(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yn(n,(s,r)=>{const i=ms(r,e.ua(s));null!=i&&(t[s]=i)}),{mapValue:{fields:t}}}function fp(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof de||n instanceof $a||n instanceof Mt||n instanceof ce||n instanceof fs)}function Zl(n,e,t){if(!fp(t)||"object"!=typeof(s=t)||null===s||Object.getPrototypeOf(s)!==Object.prototype&&null!==Object.getPrototypeOf(s)){const s=Ua(t);throw e.fa("an object"===s?n+" a custom object":n+" "+s)}var s}function no(n,e,t){if((e=(0,H.m9)(e))instanceof $t)return e._internalPath;if("string"==typeof e)return za(n,e);throw Ha("Field path arguments must be of type string or ",n,!1,void 0,t)}const ww=new RegExp("[~\\*/\\[\\]]");function za(n,e,t){if(e.search(ww)>=0)throw Ha(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new $t(...e.split("."))._internalPath}catch{throw Ha(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ha(n,e,t,s,r){const i=s&&!s.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${s}`),o&&(l+=` in document ${r}`),l+=")"),new C(b.INVALID_ARGUMENT,a+n+l)}function pp(n,e){return n.some(t=>t.isEqual(e))}class so{constructor(e,t,s,r,i){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ce(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new vw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Qa("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class vw extends so{data(){return super.data()}}function Qa(n,e){return"string"==typeof e?za(n,e):e instanceof $t?e._internalPath:e._delegate._internalPath}function mp(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new C(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Wl{}class ro extends Wl{}function vn(n,e,...t){let s=[];e instanceof Wl&&s.push(e),s=s.concat(t),function(r){const i=r.filter(a=>a instanceof Er).length,o=r.filter(a=>a instanceof io).length;if(i>1||i>0&&o>0)throw new C(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)n=r._apply(n);return n}class io extends ro{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new io(e,t,s)}_apply(e){const t=this._parse(e);return vp(e._query,t),new qe(e.firestore,e.converter,ou(e._query,t))}_parse(e){const t=ps(e.firestore);return function(r,i,o,a,l,h,f){let p;if(l.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new C(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){wp(f,h);const g=[];for(const w of f)g.push(yp(a,r,w));p={arrayValue:{values:g}}}else p=yp(a,r,f)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||wp(f,h),p=hp(o,"where",f,"in"===h||"not-in"===h);return Q.create(l,h,p)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class Er extends Wl{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Er(e,t)}_parse(e){const t=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return 1===t.length?t[0]:ne.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(s,r){let i=s;const o=r.getFlattenedFilters();for(const a of o)vp(i,a),i=ou(i,a)}(e._query,t),new qe(e.firestore,e.converter,ou(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Xl extends ro{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Xl(e,t)}_apply(e){const t=function(s,r,i){if(null!==s.startAt)throw new C(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==s.endAt)throw new C(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new ir(r,i);return function(a,l){if(null===ru(a)){const h=pa(a);null!==h&&bp(0,h,l.field)}}(s,o),o}(e._query,this._field,this._direction);return new qe(e.firestore,e.converter,function(s,r){const i=s.explicitOrderBy.concat([r]);return new Bt(s.path,s.collectionGroup,i,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}class Za extends ro{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new Za(e,t,s)}_apply(e){return new qe(e.firestore,e.converter,ma(e._query,this._limit,this._limitType))}}class Wa extends ro{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new Wa(e,t,s)}_apply(e){const t=gp(e,this.type,this._docOrFields,this._inclusive);return new qe(e.firestore,e.converter,(r=t,new Bt((s=e._query).path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,r,s.endAt)));var s,r}}class Xa extends ro{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new Xa(e,t,s)}_apply(e){const t=gp(e,this.type,this._docOrFields,this._inclusive);return new qe(e.firestore,e.converter,(r=t,new Bt((s=e._query).path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,r)));var s,r}}function gp(n,e,t,s){if(t[0]=(0,H.m9)(t[0]),t[0]instanceof so)return function(r,i,o,a,l){if(!a)throw new C(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const h=[];for(const f of ss(r))if(f.field.isKeyField())h.push(ts(i,a.key));else{const p=a.data.field(f.field);if(Xc(p))throw new C(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===p){const g=f.field.canonicalString();throw new C(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}h.push(p)}return new hn(h,l)}(n._query,n.firestore._databaseId,e,t[0]._document,s);{const r=ps(n.firestore);return function(i,o,a,l,h,f){const p=i.explicitOrderBy;if(h.length>p.length)throw new C(b.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const g=[];for(let w=0;w<h.length;w++){const T=h[w];if(p[w].field.isKeyField()){if("string"!=typeof T)throw new C(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof T}`);if(!iu(i)&&-1!==T.indexOf("/"))throw new C(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${T}' contains a slash.`);const S=i.path.child(X.fromString(T));if(!A.isDocumentKey(S))throw new C(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${S}' is not because it contains an odd number of segments.`);const P=new A(S);g.push(ts(o,P))}else{const S=hp(a,l,T);g.push(S)}}return new hn(g,f)}(n._query,n.firestore._databaseId,r,e,t,s)}}function yp(n,e,t){if("string"==typeof(t=(0,H.m9)(t))){if(""===t)throw new C(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!iu(e)&&-1!==t.indexOf("/"))throw new C(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(X.fromString(t));if(!A.isDocumentKey(s))throw new C(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return ts(n,new A(s))}if(t instanceof ce)return ts(n,t._key);throw new C(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ua(t)}.`)}function wp(n,e){if(!Array.isArray(n)||0===n.length)throw new C(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vp(n,e){if(e.isInequality()){const s=pa(n),r=e.field;if(null!==s&&!s.isEqual(r))throw new C(b.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${s.toString()}' and '${r.toString()}'`);const i=ru(n);null!==i&&bp(0,r,i)}const t=function(s,r){for(const i of s)for(const o of i.getFlattenedFilters())if(r.indexOf(o.op)>=0)return o.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new C(b.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function bp(n,e,t){if(!t.isEqual(e))throw new C(b.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class Yl{convertValue(e,t="none"){switch(es(e)){case 0:return null;case 1:return e.booleanValue;case 2:return me(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Jn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw M()}}convertObject(e,t){const s={};return Yn(e.fields,(r,i)=>{s[r]=this.convertValue(i,t)}),s}convertGeoPoint(e){return new $a(me(e.latitude),me(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=Ih(e);return null==s?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Ei(e));default:return null}}convertTimestamp(e){const t=cn(e);return new de(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=X.fromString(e);O(Ad(s));const r=new an(s.get(1),s.get(3)),i=new A(s.popFirst(5));return r.isEqual(t)||ye(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Ya(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Aw extends Yl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ce(this.firestore,null,t)}}class gs{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Kt extends so{constructor(e,t,s,r,i,o){super(e,t,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new oo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Qa("DocumentSnapshot.get",e));if(null!==s)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}}class oo extends Kt{data(e={}){return super.data(e)}}class bn{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new gs(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new oo(this._firestore,this._userDataWriter,s.key,s,new gs(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new C(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,r){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>({type:"added",doc:new oo(s._firestore,s._userDataWriter,o.doc.key,o.doc,new gs(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter),oldIndex:-1,newIndex:i++}))}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>r||3!==o.type).map(o=>{const a=new oo(s._firestore,s._userDataWriter,o.doc.key,o.doc,new gs(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let l=-1,h=-1;return 0!==o.type&&(l=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),1!==o.type&&(i=i.add(o.doc),h=i.indexOf(o.doc.key)),{type:Dw(o.type),doc:a,oldIndex:l,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Dw(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return M()}}function _p(n,e){return n instanceof Kt&&e instanceof Kt?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof bn&&e instanceof bn&&n._firestore===e._firestore&&Kl(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class xn extends Yl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ce(this.firestore,null,t)}}function Tp(n,e,t){n=Z(n,ce);const s=Z(n.firestore,ue),r=Ya(n.converter,e,t);return Sr(s,[Ga(ps(s),"setDoc",n._key,r,null!==n.converter,t).toMutation(n._key,fe.none())])}function Ip(n,e,t,...s){n=Z(n,ce);const r=Z(n.firestore,ue),i=ps(r);let o;return o="string"==typeof(e=(0,H.m9)(e))||e instanceof $t?Ql(i,"updateDoc",n._key,e,t,s):Hl(i,"updateDoc",n._key,e),Sr(r,[o.toMutation(n._key,fe.exists(!0))])}function Cp(n,...e){var t,s,r;n=(0,H.m9)(n);let i={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||Gl(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(Gl(e[o])){const p=e[o];e[o]=null===(t=p.next)||void 0===t?void 0:t.bind(p),e[o+1]=null===(s=p.error)||void 0===s?void 0:s.bind(p),e[o+2]=null===(r=p.complete)||void 0===r?void 0:r.bind(p)}let l,h,f;if(n instanceof ce)h=Z(n.firestore,ue),f=ar(n._key.path),l={next:p=>{e[o]&&e[o](Jl(h,n,p))},error:e[o+1],complete:e[o+2]};else{const p=Z(n,qe);h=Z(p.firestore,ue),f=p._query;const g=new xn(h);l={next:w=>{e[o]&&e[o](new bn(h,g,p,w))},error:e[o+1],complete:e[o+2]},mp(n._query)}return function(p,g,w,T){const S=new Va(T),P=new cl(g,S,w);return p.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return sl(yield Cr(p),P)})),()=>{S.Pc(),p.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return il(yield Cr(p),P)}))}}(ve(h),f,a,l)}function Sr(n,e){return function(t,s){const r=new Ce;return t.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return function Cy(n,e,t){return fl.apply(this,arguments)}(yield Ul(t),s,r)})),r.promise}(ve(n),e)}function Jl(n,e,t){const s=t.docs.get(e._key),r=new xn(n);return new Kt(n,r,e._key,s,new gs(t.hasPendingWrites,t.fromCache),e.converter)}const Uw={maxAttempts:5};class Ep{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ps(e)}set(e,t,s){this._verifyNotCommitted();const r=_n(e,this._firestore),i=Ya(r.converter,t,s),o=Ga(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,s);return this._mutations.push(o.toMutation(r._key,fe.none())),this}update(e,t,s,...r){this._verifyNotCommitted();const i=_n(e,this._firestore);let o;return o="string"==typeof(t=(0,H.m9)(t))||t instanceof $t?Ql(this._dataReader,"WriteBatch.update",i._key,t,s,r):Hl(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,fe.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=_n(e,this._firestore);return this._mutations=this._mutations.concat(new hr(t._key,fe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new C(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function _n(n,e){if((n=(0,H.m9)(n)).firestore!==e)throw new C(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class jw extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=ps(e)}get(e){const t=_n(e,this._firestore),s=new Aw(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||1!==r.length)return M();const i=r[0];if(i.isFoundDocument())return new so(this._firestore,s,i.key,i,t.converter);if(i.isNoDocument())return new so(this._firestore,s,t._key,null,t.converter);throw M()})}set(e,t,s){const r=_n(e,this._firestore),i=Ya(r.converter,t,s),o=Ga(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,s);return this._transaction.set(r._key,o),this}update(e,t,s,...r){const i=_n(e,this._firestore);let o;return o="string"==typeof(t=(0,H.m9)(t))||t instanceof $t?Ql(this._dataReader,"Transaction.update",i._key,t,s,r):Hl(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,o),this}delete(e){const t=_n(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=_n(e,this._firestore),s=new xn(this._firestore);return super.get(e).then(r=>new Kt(this._firestore,s,t._key,r._document,new gs(!1,!1),t.converter))}}!function(n,e=!0){tr=kn.SDK_VERSION,(0,kn._registerComponent)(new G.wA("firestore",(t,{instanceIdentifier:s,options:r})=>{const i=t.getProvider("app").getImmediate(),o=new ue(new Jp(t.getProvider("auth-internal")),new nm(t.getProvider("app-check-internal")),function(a,l){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new C(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new an(a.options.projectId,l)}(i,s),i);return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),(0,kn.registerVersion)(hh,"3.8.4",n),(0,kn.registerVersion)(hh,"3.8.4","esm2017")}();function eh(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new C("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function Ap(){if(typeof Uint8Array>"u")throw new C("unimplemented","Uint8Arrays are not available in this environment.")}function kp(){if(!function mm(){return typeof atob<"u"}())throw new C("unimplemented","Blobs are unavailable in Firestore in this environment.")}class ao{constructor(e){this._delegate=e}static fromBase64String(e){return kp(),new ao(Mt.fromBase64String(e))}static fromUint8Array(e){return Ap(),new ao(Mt.fromUint8Array(e))}toBase64(){return kp(),this._delegate.toBase64()}toUint8Array(){return Ap(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function th(n){return function Xw(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const s of e)if(s in t&&"function"==typeof t[s])return!0;return!1}(n,["next","error","complete"])}class Yw{enableIndexedDbPersistence(e,t){return function sw(n,e){ap(n=Z(n,ue));const t=ve(n),s=n._freezeSettings(),r=new Ol;return op(t,r,new jf(r,s.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function rw(n){ap(n=Z(n,ue));const e=ve(n),t=n._freezeSettings(),s=new Ol;return op(e,s,new Uy(s,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function iw(n){if(n._initialized&&!n._terminated)throw new C(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Ce;return n._queue.enqueueAndForgetEvenWhileRestricted((0,I.Z)(function*(){try{yield(t=(0,I.Z)(function*(s){if(!wt.C())return Promise.resolve();const r=s+"main";yield wt.delete(r)}),function(s){return t.apply(this,arguments)})(Su(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class Dp{constructor(e,t,s){this._delegate=t,this._persistenceProvider=s,this.INTERNAL={delete:()=>this.terminate()},e instanceof an||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Zn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,s={}){!function np(n,e,t,s={}){var r;const i=(n=Z(n,Ji))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Zn("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},i),{host:`${e}:${t}`,ssl:!1})),s.mockUserToken){let o,a;if("string"==typeof s.mockUserToken)o=s.mockUserToken,a=Oe.MOCK_USER;else{o=(0,H.Sg)(s.mockUserToken,null===(r=n._app)||void 0===r?void 0:r.options.projectId);const l=s.mockUserToken.sub||s.mockUserToken.user_id;if(!l)throw new C(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new Oe(l)}n._authCredentials=new Yp(new dh(o,a))}}(this._delegate,e,t,s)}enableNetwork(){return function aw(n){return function zy(n){return n.asyncQueue.enqueue((0,I.Z)(function*(){const e=yield zf(n),t=yield ql(n);return e.setNetworkEnabled(!0),function(s){const r=D(s);return r.mu.delete(0),Xi(r)}(t)}))}(ve(n=Z(n,ue)))}(this._delegate)}disableNetwork(){return function cw(n){return function Hy(n){return n.asyncQueue.enqueue((0,I.Z)(function*(){const e=yield zf(n),t=yield ql(n);return e.setNetworkEnabled(!1),(s=(0,I.Z)(function*(r){const i=D(r);i.mu.add(0),yield wr(i),i.pu.set("Offline")}),function(r){return s.apply(this,arguments)})(t);var s}))}(ve(n=Z(n,ue)))}(this._delegate)}enablePersistence(e){let t=!1,s=!1;return e&&(t=!!e.synchronizeTabs,s=!!e.experimentalForceOwningTab,Xf("synchronizeTabs",t,"experimentalForceOwningTab",s)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,s)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function ow(n){return function(e){const t=new Ce;return e.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return function ky(n,e){return wl.apply(this,arguments)}(yield Ul(e),t)})),t.promise}(ve(n=Z(n,ue)))}(this._delegate)}onSnapshotsInSync(e){return function Bw(n,e){return function Wy(n,e){const t=new Va(e);return n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return s=yield Cr(n),r=t,D(s).vu.add(r),void r.next();var s,r})),()=>{t.Pc(),n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return s=yield Cr(n),r=t,void D(s).vu.delete(r);var s,r}))}}(ve(n=Z(n,ue)),Gl(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new C("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ar(this,sp(this._delegate,e))}catch(t){throw Qe(t,"collection()","Firestore.collection()")}}doc(e){try{return new dt(this,ja(this._delegate,e))}catch(t){throw Qe(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ze(this,function Jy(n,e){if(n=Z(n,Ji),$l("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new C(b.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new qe(n,null,(t=e,new Bt(X.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Qe(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function $w(n,e,t){n=Z(n,ue);const s=Object.assign(Object.assign({},Uw),t);return function(r){if(r.maxAttempts<1)throw new C(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}(s),function(r,i,o){const a=new Ce;return r.asyncQueue.enqueueAndForget((0,I.Z)(function*(){const l=yield function Hf(n){return Ba(n).then(e=>e.datastore)}(r);new Ky(r.asyncQueue,l,o,i,a).run()})),a.promise}(ve(n),r=>e(new jw(n,r)),s)}(this._delegate,t=>e(new Mp(this,t)))}batch(){return ve(this._delegate),new Np(new Ep(this._delegate,e=>Sr(this._delegate,e)))}loadBundle(e){return function uw(n,e){const t=ve(n=Z(n,ue)),s=new tw;return function Xy(n,e,t,s){const r=function(i,o){let a;return a="string"==typeof i?(new TextEncoder).encode(i):i,l=function(l,h){if(l instanceof Uint8Array)return $f(l,h);if(l instanceof ArrayBuffer)return $f(new Uint8Array(l),h);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),new jy(l,o);var l}(t,Wi(e));n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){!function qy(n,e,t){const s=D(n);var r;(r=(0,I.Z)(function*(i,o,a){try{const l=yield o.getMetadata();if(yield function(g,w){const T=D(g),S=we(w.createTime);return T.persistence.runTransaction("hasNewerBundle","readonly",P=>T.Os.getBundleMetadata(P,w.id)).then(P=>!!P&&P.createTime.compareTo(S)>=0)}(i.localStore,l))return yield o.close(),a._completeWith({taskState:"Success",documentsLoaded:(g=l).totalDocuments,bytesLoaded:g.totalBytes,totalDocuments:g.totalDocuments,totalBytes:g.totalBytes}),Promise.resolve(new Set);a._updateProgress(Nf(l));const h=new vy(l,i.localStore,o.Tt);let f=yield o.yc();for(;f;){const g=yield h.Bu(f);g&&a._updateProgress(g),f=yield o.yc()}const p=yield h.complete();return yield jt(i,p.Uu,void 0),yield function(g,w){const T=D(g);return T.persistence.runTransaction("Save bundle","readwrite",S=>T.Os.saveBundleMetadata(S,w))}(i.localStore,l),a._completeWith(p.progress),Promise.resolve(p.qu)}catch(l){return Zn("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}var g}),function(i,o,a){return r.apply(this,arguments)})(s,e,t).then(r=>{s.sharedClientState.notifyBundleLoaded(r)})}(yield Ul(n),r,s)}))}(t,n._databaseId,e,s),s}(this._delegate,e)}namedQuery(e){return function lw(n,e){return function Yy(n,e){return n.asyncQueue.enqueue((0,I.Z)(function*(){return function(t,s){const r=D(t);return r.persistence.runTransaction("Get named query","readonly",i=>r.Os.getNamedQuery(i,s))}(yield qa(n),e)}))}(ve(n=Z(n,ue)),e).then(t=>t?new qe(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Ze(this,t):null)}}class Ja extends Yl{constructor(e){super(),this.firestore=e}convertBytes(e){return new ao(new Mt(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return dt.forKey(t,this.firestore,null)}}class Mp{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Ja(e)}get(e){const t=ws(e);return this._delegate.get(t).then(s=>new co(this._firestore,new Kt(this._firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,t.converter)))}set(e,t,s){const r=ws(e);return s?(eh("Transaction.set",s),this._delegate.set(r,t,s)):this._delegate.set(r,t),this}update(e,t,s,...r){const i=ws(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,s,...r),this}delete(e){const t=ws(e);return this._delegate.delete(t),this}}class Np{constructor(e){this._delegate=e}set(e,t,s){const r=ws(e);return s?(eh("WriteBatch.set",s),this._delegate.set(r,t,s)):this._delegate.set(r,t),this}update(e,t,s,...r){const i=ws(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,s,...r),this}delete(e){const t=ws(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class ys{constructor(e,t,s){this._firestore=e,this._userDataWriter=t,this._delegate=s}fromFirestore(e,t){const s=new oo(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new uo(this._firestore,s),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const s=ys.INSTANCES;let r=s.get(e);r||(r=new WeakMap,s.set(e,r));let i=r.get(t);return i||(i=new ys(e,new Ja(e),t),r.set(t,i)),i}}ys.INSTANCES=new WeakMap;class dt{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ja(e)}static forPath(e,t,s){if(e.length%2!=0)throw new C("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new dt(t,new ce(t._delegate,s,new A(e)))}static forKey(e,t,s){return new dt(t,new ce(t._delegate,s,e))}get id(){return this._delegate.id}get parent(){return new Ar(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ar(this.firestore,sp(this._delegate,e))}catch(t){throw Qe(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,H.m9)(e))instanceof ce&&rp(this._delegate,e)}set(e,t){t=eh("DocumentReference.set",t);try{return t?Tp(this._delegate,e,t):Tp(this._delegate,e)}catch(s){throw Qe(s,"setDoc()","DocumentReference.set()")}}update(e,t,...s){try{return 1===arguments.length?Ip(this._delegate,e):Ip(this._delegate,e,t,...s)}catch(r){throw Qe(r,"updateDoc()","DocumentReference.update()")}}delete(){return function Rw(n){return Sr(Z(n.firestore,ue),[new hr(n._key,fe.none())])}(this._delegate)}onSnapshot(...e){const t=Pp(e),s=Op(e,r=>new co(this.firestore,new Kt(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return Cp(this._delegate,t,s)}get(e){let t;return t="cache"===e?.source?function Nw(n){n=Z(n,ce);const e=Z(n.firestore,ue),t=ve(e),s=new xn(e);return function Qy(n,e){const t=new Ce;return n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return(s=(0,I.Z)(function*(r,i,o){try{const a=yield function(l,h){const f=D(l);return f.persistence.runTransaction("read document","readonly",p=>f.localDocuments.getDocument(p,h))}(r,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new C(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=xr(a,`Failed to get document '${i} from cache`);o.reject(l)}}),function(r,i,o){return s.apply(this,arguments)})(yield qa(n),e,t);var s})),t.promise}(t,n._key).then(r=>new Kt(e,s,n._key,r,new gs(null!==r&&r.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function Pw(n){n=Z(n,ce);const e=Z(n.firestore,ue);return Qf(ve(e),n._key,{source:"server"}).then(t=>Jl(e,n,t))}(this._delegate):function Mw(n){n=Z(n,ce);const e=Z(n.firestore,ue);return Qf(ve(e),n._key).then(t=>Jl(e,n,t))}(this._delegate),t.then(s=>new co(this.firestore,new Kt(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)))}withConverter(e){return new dt(this.firestore,this._delegate.withConverter(e?ys.getInstance(this.firestore,e):null))}}function Qe(n,e,t){return n.message=n.message.replace(e,t),n}function Pp(n){for(const e of n)if("object"==typeof e&&!th(e))return e;return{}}function Op(n,e){var t,s;let r;return r=th(n[0])?n[0]:th(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:i=>{r.next&&r.next(e(i))},error:null===(t=r.error)||void 0===t?void 0:t.bind(r),complete:null===(s=r.complete)||void 0===s?void 0:s.bind(r)}}class co{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new dt(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return _p(this._delegate,e._delegate)}}class uo extends co{data(e){const t=this._delegate.data(e);return function Wp(n,e){n||M()}(void 0!==t),t}}class Ze{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ja(e)}where(e,t,s){try{return new Ze(this.firestore,vn(this._delegate,function bw(n,e,t){const s=e,r=Qa("where",n);return io._create(r,s,t)}(e,t,s)))}catch(r){throw Qe(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Ze(this.firestore,vn(this._delegate,function xw(n,e="asc"){const t=e,s=Qa("orderBy",n);return Xl._create(s,t)}(e,t)))}catch(s){throw Qe(s,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ze(this.firestore,vn(this._delegate,function _w(n){return ep("limit",n),Za._create("limit",n,"F")}(e)))}catch(t){throw Qe(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Ze(this.firestore,vn(this._delegate,function Tw(n){return ep("limitToLast",n),Za._create("limitToLast",n,"L")}(e)))}catch(t){throw Qe(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ze(this.firestore,vn(this._delegate,function Iw(...n){return Wa._create("startAt",n,!0)}(...e)))}catch(t){throw Qe(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ze(this.firestore,vn(this._delegate,function Cw(...n){return Wa._create("startAfter",n,!1)}(...e)))}catch(t){throw Qe(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ze(this.firestore,vn(this._delegate,function Ew(...n){return Xa._create("endBefore",n,!1)}(...e)))}catch(t){throw Qe(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ze(this.firestore,vn(this._delegate,function Sw(...n){return Xa._create("endAt",n,!0)}(...e)))}catch(t){throw Qe(t,"endAt()","Query.endAt()")}}isEqual(e){return Kl(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function Lw(n){n=Z(n,qe);const e=Z(n.firestore,ue),t=ve(e),s=new xn(e);return function Zy(n,e){const t=new Ce;return n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return(s=(0,I.Z)(function*(r,i,o){try{const a=yield Na(r,i,!0),l=new Lf(i,a.Yi),h=l.Hu(a.documents),f=l.applyChanges(h,!1);o.resolve(f.snapshot)}catch(a){const l=xr(a,`Failed to execute query '${i} against cache`);o.reject(l)}}),function(r,i,o){return s.apply(this,arguments)})(yield qa(n),e,t);var s})),t.promise}(t,n._query).then(r=>new bn(e,s,n,r))}(this._delegate):"server"===e?.source?function Fw(n){n=Z(n,qe);const e=Z(n.firestore,ue),t=ve(e),s=new xn(e);return Zf(t,n._query,{source:"server"}).then(r=>new bn(e,s,n,r))}(this._delegate):function Ow(n){n=Z(n,qe);const e=Z(n.firestore,ue),t=ve(e),s=new xn(e);return mp(n._query),Zf(t,n._query).then(r=>new bn(e,s,n,r))}(this._delegate),t.then(s=>new nh(this.firestore,new bn(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)))}onSnapshot(...e){const t=Pp(e),s=Op(e,r=>new nh(this.firestore,new bn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return Cp(this._delegate,t,s)}withConverter(e){return new Ze(this.firestore,this._delegate.withConverter(e?ys.getInstance(this.firestore,e):null))}}class e0{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new uo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class nh{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ze(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new uo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new e0(this._firestore,t))}forEach(e,t){this._delegate.forEach(s=>{e.call(t,new uo(this._firestore,s))})}isEqual(e){return _p(this._delegate,e._delegate)}}class Ar extends Ze{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new dt(this.firestore,e):null}doc(e){try{return new dt(this.firestore,void 0===e?ja(this._delegate):ja(this._delegate,e))}catch(t){throw Qe(t,"doc()","CollectionReference.doc()")}}add(e){return function Vw(n,e){const t=Z(n.firestore,ue),s=ja(n),r=Ya(n.converter,e);return Sr(t,[Ga(ps(n.firestore),"addDoc",s._key,r,null!==n.converter,{}).toMutation(s._key,fe.exists(!1))]).then(()=>s)}(this._delegate,e).then(t=>new dt(this.firestore,t))}isEqual(e){return rp(this._delegate,e._delegate)}withConverter(e){return new Ar(this.firestore,this._delegate.withConverter(e?ys.getInstance(this.firestore,e):null))}}function ws(n){return Z(n,ce)}class sh{constructor(...e){this._delegate=new $t(...e)}static documentId(){return new sh(pe.keyField().canonicalString())}isEqual(e){return(e=(0,H.m9)(e))instanceof $t&&this._delegate._internalPath.isEqual(e._internalPath)}}class vs{constructor(e){this._delegate=e}static serverTimestamp(){const e=function Gw(){return new zl("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new vs(e)}static delete(){const e=function Kw(){return new to("deleteField")}();return e._methodName="FieldValue.delete",new vs(e)}static arrayUnion(...e){const t=function zw(...n){return new mw("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new vs(t)}static arrayRemove(...e){const t=function Hw(...n){return new gw("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new vs(t)}static increment(e){const t=function Qw(n){return new yw("increment",n)}(e);return t._methodName="FieldValue.increment",new vs(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const t0={Firestore:Dp,GeoPoint:$a,Timestamp:de,Blob:ao,Transaction:Mp,WriteBatch:Np,DocumentReference:dt,DocumentSnapshot:co,Query:Ze,QueryDocumentSnapshot:uo,QuerySnapshot:nh,CollectionReference:Ar,FieldPath:sh,FieldValue:vs,setLogLevel:function Jw(n){!function Zp(n){sn.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function s0(n){(function n0(n,e){n.INTERNAL.registerComponent(new G.wA("firestore-compat",t=>{const s=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(s,r)},"PUBLIC").setServiceProps(Object.assign({},t0)))})(n,(e,t)=>new Dp(e,t,new Yw)),n.registerVersion("@firebase/firestore-compat","0.3.4")}(Or.Z);var Tn=K(1205),r0=K(6217);function Lp(n,e){return function o0(n,e=Sn.z){return new fo.y(t=>{let s;return null!=e?e.schedule(()=>{s=n.onSnapshot({includeMetadataChanges:!0},t)}):s=n.onSnapshot({includeMetadataChanges:!0},t),()=>{s?.()}})}(n,e)}function rh(n,e){return Lp(n,e).pipe((0,Ke.U)(t=>({payload:t,type:"query"})))}function ec(n,e){return rh(n,e).pipe((0,An.O)(void 0),Pr(),(0,Ke.U)(([t,s])=>{const r=s.payload.docChanges(),i=r.map(o=>({type:o.type,payload:o}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(s.payload.metadata)&&s.payload.docs.forEach((o,a)=>{const l=r.find(f=>f.doc.ref.isEqual(o.ref)),h=t?.payload.docs.find(f=>f.ref.isEqual(o.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(o.metadata)||!l&&h&&JSON.stringify(h.metadata)===JSON.stringify(o.metadata)||i.push({type:"modified",payload:{oldIndex:a,newIndex:a,type:"modified",doc:o}})}),i}))}function Fp(n,e,t){return ec(n,t).pipe((0,_t.R)((s,r)=>function c0(n,e,t){return e.forEach(s=>{t.indexOf(s.type)>-1&&(n=function u0(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return ih(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return ih(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return ih(n,e.oldIndex,1)}return n}(n,s))}),n}(s,r.map(i=>i.payload),e),[]),(0,Ge.x)(),(0,Ke.U)(s=>s.map(r=>({type:r.type,payload:r}))))}function ih(n,e,t,...s){const r=n.slice();return r.splice(e,t,...s),r}function Rp(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}K(9260);class Vp{constructor(e,t,s){this.ref=e,this.query=t,this.afs=s}stateChanges(e){let t=ec(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,Ke.U)(s=>s.filter(r=>e.indexOf(r.type)>-1)))),t.pipe((0,An.O)(void 0),Pr(),(0,ut.h)(([s,r])=>r.length>0||!s),(0,Ke.U)(([s,r])=>r),Xe.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,_t.R)((t,s)=>[...t,...s],[]))}snapshotChanges(e){const t=Rp(e);return Fp(this.query,t,this.afs.schedulers.outsideAngular).pipe(Xe.iC)}valueChanges(e={}){return rh(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ke.U)(t=>t.payload.docs.map(s=>e.idField?Object.assign(Object.assign({},s.data()),{[e.idField]:s.id}):s.data())),Xe.iC)}get(e){return(0,Pt.D)(this.query.get(e)).pipe(Xe.iC)}add(e){return this.ref.add(e)}doc(e){return new Bp(this.ref.doc(e),this.afs)}}class Bp{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const s=this.ref.collection(e),{ref:r,query:i}=qp(s,t);return new Vp(r,i,this.afs)}snapshotChanges(){return function a0(n,e){return Lp(n,e).pipe((0,An.O)(void 0),Pr(),(0,Ke.U)(([t,s])=>s.exists?t?.exists?{payload:s,type:"modified"}:{payload:s,type:"added"}:{payload:s,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Xe.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,Ke.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,Pt.D)(this.ref.get(e)).pipe(Xe.iC)}}class l0{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?ec(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ke.U)(t=>t.filter(s=>e.indexOf(s.type)>-1)),(0,ut.h)(t=>t.length>0),Xe.iC):ec(this.query,this.afs.schedulers.outsideAngular).pipe(Xe.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,_t.R)((t,s)=>[...t,...s],[]))}snapshotChanges(e){const t=Rp(e);return Fp(this.query,t,this.afs.schedulers.outsideAngular).pipe(Xe.iC)}valueChanges(e={}){return rh(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ke.U)(s=>s.payload.docs.map(r=>e.idField?Object.assign({[e.idField]:r.id},r.data()):r.data())),Xe.iC)}get(e){return(0,Pt.D)(this.query.get(e)).pipe(Xe.iC)}}const h0=new y.OlP("angularfire2.enableFirestorePersistence"),d0=new y.OlP("angularfire2.firestore.persistenceSettings"),f0=new y.OlP("angularfire2.firestore.settings"),p0=new y.OlP("angularfire2.firestore.use-emulator");function qp(n,e=(t=>t)){return{query:e(n),ref:n}}let Up=(()=>{class n{constructor(t,s,r,i,o,a,l,h,f,p,g,w,T,S,P,te,N){this.schedulers=l;const L=(0,Ts.on)(t,a,s),le=f;p&&(0,Tn.nw)(L,a,g,T,S,P,w,te),[this.firestore,this.persistenceEnabled$]=(0,Ts.cc)(`${L.name}.firestore`,"AngularFirestore",L.name,()=>{const z=a.runOutsideAngular(()=>L.firestore());if(i&&z.settings(i),le&&z.useEmulator(...le),r&&!(0,$e.PM)(o)){const J=()=>{try{return(0,Pt.D)(z.enablePersistence(h||void 0).then(()=>!0,()=>!1))}catch(Se){return typeof console<"u"&&console.warn(Se),(0,xs.of)(!1)}};return[z,a.runOutsideAngular(J)]}return[z,(0,xs.of)(!1)]},[i,le,r])}collection(t,s){let r;r="string"==typeof t?this.firestore.collection(t):t;const{ref:i,query:o}=qp(r,s),a=this.schedulers.ngZone.run(()=>i);return new Vp(a,o,this)}collectionGroup(t,s){const r=s||(o=>o),i=this.firestore.collectionGroup(t);return new l0(r(i),this)}doc(t){let s;s="string"==typeof t?this.firestore.doc(t):t;const r=this.schedulers.ngZone.run(()=>s);return new Bp(r,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(y.LFG(Ts.Dh),y.LFG(Ts.xv,8),y.LFG(h0,8),y.LFG(f0,8),y.LFG(y.Lbi),y.LFG(y.R0b),y.LFG(Xe.HU),y.LFG(d0,8),y.LFG(p0,8),y.LFG(Tn.zQ,8),y.LFG(Tn.Qv,8),y.LFG(Tn.L6,8),y.LFG(Tn._Q,8),y.LFG(Tn.rT,8),y.LFG(Tn.lh,8),y.LFG(Tn.f7,8),y.LFG(r0.nm,8))},n.\u0275prov=y.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),jp=(()=>{class n extends xt{constructor(t){super(Gt,t,"calendarios")}}return n.\u0275fac=function(t){return new(t||n)(y.LFG(Up))},n.\u0275prov=y.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function m0(n,e){if(1&n){const t=y.EpF();y.ynx(0),y.TgZ(1,"div",12),y.NdJ("click",function(){y.CHM(t);const r=y.oxw().$implicit,i=y.oxw(3);return y.KtG(i.openImage(r.foto))}),y._UZ(2,"img",13),y.qZA(),y.BQk()}if(2&n){const t=y.oxw().$implicit;y.xp6(2),y.Q6J("src",t.foto,y.LSH)}}function g0(n,e){1&n&&(y.ynx(0),y._UZ(1,"div",14),y.BQk())}function y0(n,e){if(1&n){const t=y.EpF();y.TgZ(0,"div",10)(1,"button",7),y.NdJ("click",function(){const i=y.CHM(t).index,o=y.oxw().index,a=y.oxw(2);return y.KtG(a.deleteRefeicao(o,i))}),y._UZ(2,"i",11),y.qZA(),y.TgZ(3,"div")(4,"h4"),y._uU(5),y.qZA(),y.TgZ(6,"p"),y._uU(7),y.qZA()(),y.YNc(8,m0,3,1,"ng-container",0),y.YNc(9,g0,2,0,"ng-container",0),y.qZA()}if(2&n){const t=e.$implicit;y.xp6(5),y.Oqu(t.hora),y.xp6(2),y.Oqu(t.prato),y.xp6(1),y.Q6J("ngIf",t.foto),y.xp6(1),y.Q6J("ngIf",!t.foto)}}function w0(n,e){if(1&n){const t=y.EpF();y.TgZ(0,"div")(1,"header")(2,"h3"),y._uU(3),y.qZA(),y.TgZ(4,"button",7),y.NdJ("click",function(){const i=y.CHM(t).index,o=y.oxw(2);return y.KtG(o.deleteDia(i))}),y._UZ(5,"i",8),y.qZA()(),y.TgZ(6,"div"),y.YNc(7,y0,10,4,"div",9),y.qZA(),y.TgZ(8,"button",7),y.NdJ("click",function(){const i=y.CHM(t).index,o=y.oxw(2);return y.KtG(o.createRefeicao(i))}),y._UZ(9,"i",6),y._uU(10," Adicionar Refei\xe7\xe3o"),y.qZA()()}if(2&n){const t=e.$implicit;y.xp6(3),y.Oqu(t.nome),y.xp6(4),y.Q6J("ngForOf",t.refeicoes)}}function v0(n,e){if(1&n){const t=y.EpF();y.TgZ(0,"div")(1,"header",1)(2,"h2"),y._uU(3),y.qZA(),y.TgZ(4,"a",2),y._uU(5,"Voltar"),y.qZA()(),y.TgZ(6,"div",3),y.YNc(7,w0,11,2,"div",4),y.TgZ(8,"button",5),y.NdJ("click",function(){y.CHM(t);const r=y.oxw();return y.KtG(r.createDia())}),y._UZ(9,"i",6),y._uU(10," Adicionar Dia"),y.qZA()()()}if(2&n){const t=y.oxw();y.xp6(3),y.AsE("",t.calendario.nome," de ",t.calendario.ano," "),y.xp6(4),y.Q6J("ngForOf",t.calendario.dias)}}let b0=(()=>{class n{constructor(t,s,r){this.service=t,this.route=s,this.router=r,this.isload=!1,this.dias=[],this.id=""}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.params.id,this.updateList()})}createDia(){vt().fire({title:"Novo Dia",html:'\n        <label class="label-swal">\n          Dia:\n          <input id="dia-input" type="number" min="1" max="31" class="form-control" required>\n        </label>\n        ',confirmButtonText:"Salvar a Refei\xe7\xe3o",focusConfirm:!1,preConfirm:()=>{const t=document.querySelector("#dia-input");t.value?(this.calendario.dias.push({nome:t.value,refeicoes:[]}),this.calendario.dias=this.calendario.dias.sort((s,r)=>parseInt(s.nome)-parseInt(r.nome)),this.service.createOrUpdate(this.calendario).then(()=>{})):vt().showValidationMessage("Preencha todos os campos obrigat\xf3rios")}})}deleteDia(t){this.calendario.dias.splice(t,1),this.service.createOrUpdate(this.calendario).then(()=>{})}createRefeicao(t){vt().fire({title:"Nova Refei\xe7\xe3o",html:'\n        <label class="label-swal">\n          Horas:\n          <input id="hora-input" type="time" class="form-control" required>\n        </label>\n        <label class="label-swal">\n          Refei\xe7\xe3o:\n          <input id="comida-input" class="form-control" required>\n        </label>\n        <label class="label-swal">\n          Foto:\n          <input id="foto-input" type="file" accept="image/png, image/jpeg" class="form-control">\n        </label>\n        ',confirmButtonText:"Salvar a Refei\xe7\xe3o",focusConfirm:!1,preConfirm:()=>{const s=document.querySelector("#hora-input"),r=document.querySelector("#comida-input"),i=document.querySelector("#foto-input");s.value&&r.value?i.files[0]?this.getBase64(i.files[0]).then(o=>{this.calendario.dias[t].refeicoes.push({hora:s.value,prato:r.value,foto:o}),this.calendario.dias[t].refeicoes=this.calendario.dias[t].refeicoes.sort((a,l)=>parseInt(a.hora.replace(/[^0-9]/g,""))-parseInt(l.hora.replace(/[^0-9]/g,""))),this.service.createOrUpdate(this.calendario).then(()=>{})}):(this.calendario.dias[t].refeicoes.push({hora:s.value,prato:r.value,foto:""}),this.calendario.dias[t].refeicoes=this.calendario.dias[t].refeicoes.sort((o,a)=>parseInt(o.hora.replace(/[^0-9]/g,""))-parseInt(a.hora.replace(/[^0-9]/g,""))),this.service.createOrUpdate(this.calendario).then(()=>{})):vt().showValidationMessage("Preencha todos os campos obrigat\xf3rios")}})}deleteRefeicao(t,s){this.calendario.dias[t].refeicoes.splice(s,1),this.service.createOrUpdate(this.calendario).then(()=>{})}openImage(t){vt().fire({html:`<img src="${t}">`,showConfirmButton:!1})}getBase64(t){return new Promise((s,r)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=()=>s(i.result),i.onerror=o=>r(o)})}updateList(){this.isload=!1,this.service.get(this.id).subscribe(t=>{this.calendario=t,this.isload=!0})}}return n.\u0275fac=function(t){return new(t||n)(y.Y36(jp),y.Y36(x.gz),y.Y36(x.F0))},n.\u0275cmp=y.Xpm({type:n,selectors:[["app-mes"]],decls:1,vars:1,consts:[[4,"ngIf"],["id","header-detail"],["routerLink","/"],["id","list-dia"],[4,"ngFor","ngForOf"],["id","newCard",3,"click"],[1,"fa-solid","fa-plus"],[3,"click"],[1,"fa-solid","fa-delete-left"],["class","item",4,"ngFor","ngForOf"],[1,"item"],[1,"fa-solid","fa-delete-right"],[1,"foto",3,"click"],[3,"src"],[1,"foto"]],template:function(t,s){1&t&&y.YNc(0,v0,11,3,"div",0),2&t&&y.Q6J("ngIf",s.isload)},dependencies:[$e.sg,$e.O5,x.rH],styles:["#list-dia[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:flex-start}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:calc(33.33% - 20px);margin:10px;border-radius:10px;overflow:hidden;background-color:#fff;border:solid 1px #dddddd;box-shadow:1px 1px 2px 1px #ddd;display:table}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > header[_ngcontent-%COMP%]{width:100%;text-align:center;font-weight:700;font-size:28px;padding:5px 10px;background-color:#ffc901;box-shadow:#0000004d 2px 0 5px 1px;position:relative}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px;color:#fff;box-shadow:#0000004d 2px 0 5px 1px;padding:3px 5px;background-color:#d20404;border-radius:50%;top:10px;right:20px;position:absolute}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:auto}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{padding:10px;border-bottom:solid 1px #dddddd;display:flex;align-items:flex-start}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{display:flex;width:30px;height:30px;border-radius:50%;color:#fff;align-items:center;justify-content:center;background:#d20404;text-shadow:1px 1px 1px black;margin-right:10px}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:calc(100% - 100px)}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .foto[_ngcontent-%COMP%]{flex:100px;width:100px;height:100px;background-color:gray;display:flex;align-items:center;justify-content:center;cursor:pointer}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .foto[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{min-width:100%;min-height:100%;max-width:none;max-height:none;width:100%;height:100%}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{display:table;margin-top:10px;padding:15px 5px;background-color:#ffedad;border:solid #ffc901 1px;color:#dd7d02;width:100%}#header-detail[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}#header-detail[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:28px}#header-detail[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{background:#ffedad;border:solid 1px #ffc901;color:#dd7f02;padding:5px 30px;margin:20px;border-radius:10px;text-decoration:none}@media (max-width: 1000px){#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:calc(100% - 20px)}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:auto}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .foto[_ngcontent-%COMP%]{flex:50px;width:50px;height:50px}}"]}),n})(),x0=(()=>{class n extends xt{constructor(t){super(ic,t,"meses")}}return n.\u0275fac=function(t){return new(t||n)(y.LFG(Up))},n.\u0275prov=y.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const _0=function(n){return[n]};function T0(n,e){if(1&n){const t=y.EpF();y.TgZ(0,"div")(1,"header")(2,"h2"),y._uU(3),y.TgZ(4,"span"),y._uU(5),y.qZA()()(),y.TgZ(6,"div")(7,"a",4),y._uU(8,"Entrar"),y.qZA(),y.TgZ(9,"button",5),y.NdJ("click",function(){const i=y.CHM(t).$implicit,o=y.oxw();return y.KtG(o.deleteMes(i.id))}),y._uU(10,"Deletar"),y.qZA(),y.TgZ(11,"button"),y._UZ(12,"i",6),y._uU(13,"Visto"),y.qZA()()()}if(2&n){const t=e.$implicit,s=y.oxw();y.xp6(3),y.hij("",s.convertMes(t.nome)," "),y.xp6(2),y.Oqu(t.ano),y.xp6(2),y.Q6J("routerLink",y.VKq(3,_0,"mes/"+t.calendario))}}const I0=[{path:"",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=y.Xpm({type:n,selectors:[["app-panel"]],decls:6,vars:0,consts:[["id","panel"],[1,"container"],["src","/assets/svg/logo.svg","alt","Daily Food"]],template:function(t,s){1&t&&(y.TgZ(0,"div",0)(1,"div")(2,"div",1)(3,"h1"),y._UZ(4,"img",2),y.qZA(),y._UZ(5,"router-outlet"),y.qZA()()())},dependencies:[x.lC],styles:["#panel[_ngcontent-%COMP%]{background-color:#ffc901;background-image:url(/assets/img/bg-food-30.png);background-size:260px;padding-top:70px}#panel[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;min-height:calc(100vh - 70px);background-color:#f1f1f1;border-radius:20px 20px 0 0;box-shadow:#0003 0 -5px 5px}#panel[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{width:160px;transform:translateY(-60px);margin:0 auto -40px}"]}),n})(),children:[{path:"",component:(()=>{class n{constructor(t,s){this.service=t,this.serviceCalendario=s,this.meses=[],this.refCalendaro={nome:"",ano:"",dias:[]}}ngOnInit(){this.updateList()}createMes(){vt().fire({title:"Novo M\xeas",html:'\n        <label class="label-swal">\n          Dia:\n          <input id="mes-input" type="month" class="form-control">\n        </label>\n        ',confirmButtonText:"Salvar a Refei\xe7\xe3o",focusConfirm:!1,preConfirm:()=>{const t=document.querySelector("#mes-input");if(t.value){const s=t.value.split("-");this.refCalendaro.nome=s[1],this.refCalendaro.ano=s[0],this.serviceCalendario.createOrUpdate(this.refCalendaro).then(r=>{this.service.createOrUpdate({nome:s[1],ano:s[0],calendario:this.refCalendaro.id}).then(()=>{this.updateList()})})}else vt().showValidationMessage("Preencha todos os campos obrigat\xf3rios")}})}deleteMes(t){this.service.get(t).subscribe(s=>{this.serviceCalendario.delete(s.calendario).then(()=>{this.service.delete(t).then(()=>{this.updateList()})})})}convertMes(t){return["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][t-1]}updateList(){this.service.list().subscribe(t=>{this.meses=t})}}return n.\u0275fac=function(t){return new(t||n)(y.Y36(x0),y.Y36(jp))},n.\u0275cmp=y.Xpm({type:n,selectors:[["app-meses"]],decls:5,vars:1,consts:[["id","list-meses"],[4,"ngFor","ngForOf"],["id","newCard",3,"click"],[1,"fa-solid","fa-plus"],[3,"routerLink"],[3,"click"],[1,"fa-duotone","fa-toggle-large-on"]],template:function(t,s){1&t&&(y.TgZ(0,"div",0),y.YNc(1,T0,14,5,"div",1),y.TgZ(2,"button",2),y.NdJ("click",function(){return s.createMes()}),y._UZ(3,"i",3),y._uU(4," Adicionar Dia"),y.qZA()()),2&t&&(y.xp6(1),y.Q6J("ngForOf",s.meses))},dependencies:[$e.sg,x.rH],styles:["#list-meses[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:calc(25% - 20px);margin:10px;border-radius:10px;overflow:hidden;background-color:#fff;border:solid 1px #dddddd;box-shadow:1px 1px 2px 1px #ddd;display:table}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]{background-color:#ffc901;font-size:20px;padding:10px 15px;text-transform:uppercase;font-weight:700;box-shadow:#0000004d 0 2px 5px 1px}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.7em;opacity:.5}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], #list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;width:33.333%;height:50px;align-items:center;justify-content:center;border-top:solid 1px transparent;border-left:solid 1px #dddddd;border-right:solid 1px #f1f1f1;text-decoration:none;color:#313131}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:not(:last-child), #list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:last-child){background-color:#ffc901;color:#000;cursor:pointer;border-top:solid 1px white}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] > i[_ngcontent-%COMP%], #list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{font-size:2em;margin-right:10px;cursor:pointer}@media (max-width: 1000px){#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:calc(50% - 20px)}}@media (max-width: 700px){#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:calc(100% - 20px)}}"]}),n})()},{path:"mes/:id",component:b0}]},{path:"**",redirectTo:""}];let C0=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=y.oAB({type:n}),n.\u0275inj=y.cJS({imports:[x.Bz.forChild(I0),x.Bz]}),n})(),E0=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=y.oAB({type:n}),n.\u0275inj=y.cJS({imports:[$e.ez,C0]}),n})()},5226:function(oh){oh.exports=function(){"use strict";var q={awaitingPromise:new WeakMap,promise:new WeakMap,innerParams:new WeakMap,domCache:new WeakMap};const $e=c=>{const u={};for(const d in c)u[c[d]]="swal2-"+c[d];return u},x=$e(["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"]),In=$e(["success","warning","info","question","error"]),vt="SweetAlert2:",Ke=c=>c.charAt(0).toUpperCase()+c.slice(1),V=c=>{console.warn(`${vt} ${"object"==typeof c?c.join(" "):c}`)},Nt=c=>{console.error(`${vt} ${c}`)},Ve=[],nc=(c,u)=>{(c=>{Ve.includes(c)||(Ve.push(c),V(c))})(`"${c}" is deprecated and will be removed in the next major release. Please use "${u}" instead.`)},bs=c=>"function"==typeof c?c():c,bt=c=>c&&"function"==typeof c.toPromise,at=c=>bt(c)?c.toPromise():Promise.resolve(c),kr=c=>c&&Promise.resolve(c)===c,se=()=>document.body.querySelector(`.${x.container}`),Cn=c=>{const u=se();return u?u.querySelector(c):null},We=c=>Cn(`.${c}`),ee=()=>We(x.popup),En=()=>We(x.icon),sc=()=>We(x.title),Dr=()=>We(x["html-container"]),rc=()=>We(x.image),ho=()=>We(x["progress-steps"]),Mr=()=>We(x["validation-message"]),ct=()=>Cn(`.${x.actions} .${x.confirm}`),xt=()=>Cn(`.${x.actions} .${x.cancel}`),ft=()=>Cn(`.${x.actions} .${x.deny}`),Gt=()=>Cn(`.${x.loader}`),Sn=()=>We(x.actions),fo=()=>We(x.footer),Pt=()=>We(x["timer-progress-bar"]),xs=()=>We(x.close),An=()=>{const c=Array.from(ee().querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])')).sort((d,m)=>{const _=parseInt(d.getAttribute("tabindex")),F=parseInt(m.getAttribute("tabindex"));return _>F?1:_<F?-1:0}),u=Array.from(ee().querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n')).filter(d=>"-1"!==d.getAttribute("tabindex"));return(c=>{const u=[];for(let d=0;d<c.length;d++)-1===u.indexOf(c[d])&&u.push(c[d]);return u})(c.concat(u)).filter(d=>ke(d))},Nr=()=>ut(document.body,x.shown)&&!ut(document.body,x["toast-shown"])&&!ut(document.body,x["no-backdrop"]),_s=()=>ee()&&ut(ee(),x.toast),_t={previousBodyPadding:null},Ge=(c,u)=>{if(c.textContent="",u){const m=(new DOMParser).parseFromString(u,"text/html");Array.from(m.querySelector("head").childNodes).forEach(_=>{c.appendChild(_)}),Array.from(m.querySelector("body").childNodes).forEach(_=>{_ instanceof HTMLVideoElement||_ instanceof HTMLAudioElement?c.appendChild(_.cloneNode(!0)):c.appendChild(_)})}},ut=(c,u)=>{if(!u)return!1;const d=u.split(/\s+/);for(let m=0;m<d.length;m++)if(!c.classList.contains(d[m]))return!1;return!0},tt=(c,u,d)=>{if(((c,u)=>{Array.from(c.classList).forEach(d=>{!Object.values(x).includes(d)&&!Object.values(In).includes(d)&&!Object.values(u.showClass).includes(d)&&c.classList.remove(d)})})(c,u),u.customClass&&u.customClass[d]){if("string"!=typeof u.customClass[d]&&!u.customClass[d].forEach)return void V(`Invalid type of customClass.${d}! Expected string or iterable object, got "${typeof u.customClass[d]}"`);G(c,u.customClass[d])}},Or=(c,u)=>{if(!u)return null;switch(u){case"select":case"textarea":case"file":return c.querySelector(`.${x.popup} > .${x[u]}`);case"checkbox":return c.querySelector(`.${x.popup} > .${x.checkbox} input`);case"radio":return c.querySelector(`.${x.popup} > .${x.radio} input:checked`)||c.querySelector(`.${x.popup} > .${x.radio} input:first-child`);case"range":return c.querySelector(`.${x.popup} > .${x.range} input`);default:return c.querySelector(`.${x.popup} > .${x.input}`)}},I=c=>{if(c.focus(),"file"!==c.type){const u=c.value;c.value="",c.value=u}},kn=(c,u,d)=>{!c||!u||("string"==typeof u&&(u=u.split(/\s+/).filter(Boolean)),u.forEach(m=>{Array.isArray(c)?c.forEach(_=>{d?_.classList.add(m):_.classList.remove(m)}):d?c.classList.add(m):c.classList.remove(m)}))},G=(c,u)=>{kn(c,u,!0)},Ae=(c,u)=>{kn(c,u,!1)},H=(c,u)=>{const d=Array.from(c.children);for(let m=0;m<d.length;m++){const _=d[m];if(_ instanceof HTMLElement&&ut(_,u))return _}},zt=(c,u,d)=>{d===`${parseInt(d)}`&&(d=parseInt(d)),d||0===parseInt(d)?c.style[u]="number"==typeof d?`${d}px`:d:c.style.removeProperty(u)},ie=function(c){c.style.display=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex"},k=c=>{c.style.display="none"},Is=(c,u,d,m)=>{const _=c.querySelector(u);_&&(_.style[d]=m)},B=function(c,u){u?ie(c,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):k(c)},ke=c=>!(!c||!(c.offsetWidth||c.offsetHeight||c.getClientRects().length)),Ht=c=>c.scrollHeight>c.clientHeight,po=c=>{const u=window.getComputedStyle(c),d=parseFloat(u.getPropertyValue("animation-duration")||"0"),m=parseFloat(u.getPropertyValue("transition-duration")||"0");return d>0||m>0},Dn=function(c){let u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const d=Pt();ke(d)&&(u&&(d.style.transition="none",d.style.width="100%"),setTimeout(()=>{d.style.transition=`width ${c/1e3}s linear`,d.style.width="0%"},10))},$={},Es=c=>new Promise(u=>{if(!c)return u();const d=window.scrollX,m=window.scrollY;$.restoreFocusTimeout=setTimeout(()=>{$.previousActiveElement instanceof HTMLElement?($.previousActiveElement.focus(),$.previousActiveElement=null):document.body&&document.body.focus(),u()},100),window.scrollTo(d,m)}),be=()=>typeof window>"u"||typeof document>"u",Tt=`\n <div aria-labelledby="${x.title}" aria-describedby="${x["html-container"]}" class="${x.popup}" tabindex="-1">\n   <button type="button" class="${x.close}"></button>\n   <ul class="${x["progress-steps"]}"></ul>\n   <div class="${x.icon}"></div>\n   <img class="${x.image}" />\n   <h2 class="${x.title}" id="${x.title}"></h2>\n   <div class="${x["html-container"]}" id="${x["html-container"]}"></div>\n   <input class="${x.input}" />\n   <input type="file" class="${x.file}" />\n   <div class="${x.range}">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="${x.select}"></select>\n   <div class="${x.radio}"></div>\n   <label for="${x.checkbox}" class="${x.checkbox}">\n     <input type="checkbox" />\n     <span class="${x.label}"></span>\n   </label>\n   <textarea class="${x.textarea}"></textarea>\n   <div class="${x["validation-message"]}" id="${x["validation-message"]}"></div>\n   <div class="${x.actions}">\n     <div class="${x.loader}"></div>\n     <button type="button" class="${x.confirm}"></button>\n     <button type="button" class="${x.deny}"></button>\n     <button type="button" class="${x.cancel}"></button>\n   </div>\n   <div class="${x.footer}"></div>\n   <div class="${x["timer-progress-bar-container"]}">\n     <div class="${x["timer-progress-bar"]}"></div>\n   </div>\n </div>\n`.replace(/(^|\n)\s*/g,""),It=()=>{$.currentInstance.resetValidationMessage()},Ss=c=>{const u=(()=>{const c=se();return!!c&&(c.remove(),Ae([document.documentElement,document.body],[x["no-backdrop"],x["toast-shown"],x["has-column"]]),!0)})();if(be())return void Nt("SweetAlert2 requires document to initialize");const d=document.createElement("div");d.className=x.container,u&&G(d,x["no-transition"]),Ge(d,Tt);const m=(c=>"string"==typeof c?document.querySelector(c):c)(c.target);m.appendChild(d),(c=>{const u=ee();u.setAttribute("role",c.toast?"alert":"dialog"),u.setAttribute("aria-live",c.toast?"polite":"assertive"),c.toast||u.setAttribute("aria-modal","true")})(c),(c=>{"rtl"===window.getComputedStyle(c).direction&&G(se(),x.rtl)})(m),(()=>{const c=ee(),u=H(c,x.input),d=H(c,x.file),m=c.querySelector(`.${x.range} input`),_=c.querySelector(`.${x.range} output`),F=H(c,x.select),W=c.querySelector(`.${x.checkbox} input`),je=H(c,x.textarea);u.oninput=It,d.onchange=It,F.onchange=It,W.onchange=It,je.oninput=It,m.oninput=()=>{It(),_.value=m.value},m.onchange=()=>{It(),_.value=m.value}})()},As=(c,u)=>{c instanceof HTMLElement?u.appendChild(c):"object"==typeof c?Fr(c,u):c&&Ge(u,c)},Fr=(c,u)=>{c.jquery?ks(u,c):Ge(u,c.toString())},ks=(c,u)=>{if(c.textContent="",0 in u)for(let d=0;d in u;d++)c.appendChild(u[d].cloneNode(!0));else c.appendChild(u.cloneNode(!0))},Ue=(()=>{if(be())return!1;const c=document.createElement("div"),u={WebkitAnimation:"webkitAnimationEnd",animation:"animationend"};for(const d in u)if(Object.prototype.hasOwnProperty.call(u,d)&&typeof c.style[d]<"u")return u[d];return!1})(),lc=(c,u)=>{const d=Sn(),m=Gt();u.showConfirmButton||u.showDenyButton||u.showCancelButton?ie(d):k(d),tt(d,u,"actions"),function hc(c,u,d){const m=ct(),_=ft(),F=xt();Ds(m,"confirm",d),Ds(_,"deny",d),Ds(F,"cancel",d),function Qt(c,u,d,m){m.buttonsStyling?(G([c,u,d],x.styled),m.confirmButtonColor&&(c.style.backgroundColor=m.confirmButtonColor,G(c,x["default-outline"])),m.denyButtonColor&&(u.style.backgroundColor=m.denyButtonColor,G(u,x["default-outline"])),m.cancelButtonColor&&(d.style.backgroundColor=m.cancelButtonColor,G(d,x["default-outline"]))):Ae([c,u,d],x.styled)}(m,_,F,d),d.reverseButtons&&(d.toast?(c.insertBefore(F,m),c.insertBefore(_,m)):(c.insertBefore(F,u),c.insertBefore(_,u),c.insertBefore(m,u)))}(d,m,u),Ge(m,u.loaderHtml),tt(m,u,"loader")};function Ds(c,u,d){B(c,d[`show${Ke(u)}Button`],"inline-block"),Ge(c,d[`${u}ButtonText`]),c.setAttribute("aria-label",d[`${u}ButtonAriaLabel`]),c.className=x[u],tt(c,d,`${u}Button`),G(c,d[`${u}ButtonClass`])}const go=(c,u)=>{const d=se();d&&(function dc(c,u){"string"==typeof u?c.style.background=u:u||G([document.documentElement,document.body],x["no-backdrop"])}(d,u.backdrop),function yo(c,u){u in x?G(c,x[u]):(V('The "position" parameter is not valid, defaulting to "center"'),G(c,x.center))}(d,u.position),function Ms(c,u){if(u&&"string"==typeof u){const d=`grow-${u}`;d in x&&G(c,x[d])}}(d,u.grow),tt(d,u,"container"))};const Br=["input","file","range","select","radio","checkbox","textarea"],Ur=c=>{if(!xe[c.input])return void Nt(`Unexpected type of input! Expected "text", "email", "password", "number", "tel", "select", "radio", "checkbox", "textarea", "file" or "url", got "${c.input}"`);const u=Zt(c.input),d=xe[c.input](u,c);ie(u),c.inputAutoFocus&&setTimeout(()=>{I(d)})},pc=(c,u)=>{const d=Or(ee(),c);if(d){(c=>{for(let u=0;u<c.attributes.length;u++){const d=c.attributes[u].name;["type","value","style"].includes(d)||c.removeAttribute(d)}})(d);for(const m in u)d.setAttribute(m,u[m])}},jr=c=>{const u=Zt(c.input);"object"==typeof c.customClass&&G(u,c.customClass.input)},Ns=(c,u)=>{(!c.placeholder||u.inputPlaceholder)&&(c.placeholder=u.inputPlaceholder)},Mn=(c,u,d)=>{if(d.inputLabel){c.id=x.input;const m=document.createElement("label"),_=x["input-label"];m.setAttribute("for",c.id),m.className=_,"object"==typeof d.customClass&&G(m,d.customClass.inputLabel),m.innerText=d.inputLabel,u.insertAdjacentElement("beforebegin",m)}},Zt=c=>H(ee(),x[c]||x.input),Ps=(c,u)=>{["string","number"].includes(typeof u)?c.value=`${u}`:kr(u)||V(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof u}"`)},xe={};xe.text=xe.email=xe.password=xe.number=xe.tel=xe.url=(c,u)=>(Ps(c,u.inputValue),Mn(c,c,u),Ns(c,u),c.type=u.input,c),xe.file=(c,u)=>(Mn(c,c,u),Ns(c,u),c),xe.range=(c,u)=>{const d=c.querySelector("input"),m=c.querySelector("output");return Ps(d,u.inputValue),d.type=u.input,Ps(m,u.inputValue),Mn(d,c,u),c},xe.select=(c,u)=>{if(c.textContent="",u.inputPlaceholder){const d=document.createElement("option");Ge(d,u.inputPlaceholder),d.value="",d.disabled=!0,d.selected=!0,c.appendChild(d)}return Mn(c,c,u),c},xe.radio=c=>(c.textContent="",c),xe.checkbox=(c,u)=>{const d=Or(ee(),"checkbox");d.value="1",d.id=x.checkbox,d.checked=Boolean(u.inputValue);const m=c.querySelector("span");return Ge(m,u.inputPlaceholder),d},xe.textarea=(c,u)=>{Ps(c,u.inputValue),Ns(c,u),Mn(c,c,u);return setTimeout(()=>{if("MutationObserver"in window){const m=parseInt(window.getComputedStyle(ee()).width);new MutationObserver(()=>{const F=c.offsetWidth+(m=>parseInt(window.getComputedStyle(m).marginLeft)+parseInt(window.getComputedStyle(m).marginRight))(c);ee().style.width=F>m?`${F}px`:null}).observe(c,{attributes:!0,attributeFilter:["style"]})}}),c};const mc=(c,u)=>{const d=Dr();tt(d,u,"htmlContainer"),u.html?(As(u.html,d),ie(d,"block")):u.text?(d.textContent=u.text,ie(d,"block")):k(d),((c,u)=>{const d=ee(),m=q.innerParams.get(c),_=!m||u.input!==m.input;Br.forEach(F=>{const W=H(d,x[F]);pc(F,u.inputAttributes),W.className=x[F],_&&k(W)}),u.input&&(_&&Ur(u),jr(u))})(c,u)},Ls=(c,u)=>{for(const d in In)u.icon!==d&&Ae(c,In[d]);G(c,In[u.icon]),$r(c,u),wo(),tt(c,u,"icon")},wo=()=>{const c=ee(),u=window.getComputedStyle(c).getPropertyValue("background-color"),d=c.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let m=0;m<d.length;m++)d[m].style.backgroundColor=u},Nn=(c,u)=>{let m,d=c.innerHTML;u.iconHtml?m=Fs(u.iconHtml):"success"===u.icon?(m='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',d=d.replace(/ style=".*?"/g,"")):m="error"===u.icon?'\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n':Fs({question:"?",warning:"!",info:"i"}[u.icon]),d.trim()!==m.trim()&&Ge(c,m)},$r=(c,u)=>{if(u.iconColor){c.style.color=u.iconColor,c.style.borderColor=u.iconColor;for(const d of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])Is(c,d,"backgroundColor",u.iconColor);Is(c,".swal2-success-ring","borderColor",u.iconColor)}},Fs=c=>`<div class="${x["icon-content"]}">${c}</div>`,xo=(c,u)=>{c.className=`${x.popup} ${ke(c)?u.showClass.popup:""}`,u.toast?(G([document.documentElement,document.body],x["toast-shown"]),G(c,x.toast)):G(c,x.modal),tt(c,u,"popup"),"string"==typeof u.customClass&&G(c,u.customClass),u.icon&&G(c,x[`icon-${u.icon}`])},yc=c=>{const u=document.createElement("li");return G(u,x["progress-step"]),Ge(u,c),u},To=c=>{const u=document.createElement("li");return G(u,x["progress-step-line"]),c.progressStepsDistance&&zt(u,"width",c.progressStepsDistance),u},Rs=(c,u)=>{((c,u)=>{const d=se(),m=ee();u.toast?(zt(d,"width",u.width),m.style.width="100%",m.insertBefore(Gt(),En())):zt(m,"width",u.width),zt(m,"padding",u.padding),u.color&&(m.style.color=u.color),u.background&&(m.style.background=u.background),k(Mr()),xo(m,u)})(0,u),go(0,u),((c,u)=>{const d=ho();u.progressSteps&&0!==u.progressSteps.length?(ie(d),d.textContent="",u.currentProgressStep>=u.progressSteps.length&&V("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),u.progressSteps.forEach((m,_)=>{const F=yc(m);if(d.appendChild(F),_===u.currentProgressStep&&G(F,x["active-progress-step"]),_!==u.progressSteps.length-1){const W=To(u);d.appendChild(W)}})):k(d)})(0,u),((c,u)=>{const d=q.innerParams.get(c),m=En();d&&u.icon===d.icon?(Nn(m,u),Ls(m,u)):u.icon||u.iconHtml?u.icon&&-1===Object.keys(In).indexOf(u.icon)?(Nt(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${u.icon}"`),k(m)):(ie(m),Nn(m,u),Ls(m,u),G(m,u.showClass.icon)):k(m)})(c,u),((c,u)=>{const d=rc();u.imageUrl?(ie(d,""),d.setAttribute("src",u.imageUrl),d.setAttribute("alt",u.imageAlt),zt(d,"width",u.imageWidth),zt(d,"height",u.imageHeight),d.className=x.image,tt(d,u,"image")):k(d)})(0,u),((c,u)=>{const d=sc();B(d,u.title||u.titleText,"block"),u.title&&As(u.title,d),u.titleText&&(d.innerText=u.titleText),tt(d,u,"title")})(0,u),((c,u)=>{const d=xs();Ge(d,u.closeButtonHtml),tt(d,u,"closeButton"),B(d,u.showCloseButton),d.setAttribute("aria-label",u.closeButtonAriaLabel)})(0,u),mc(c,u),lc(0,u),((c,u)=>{const d=fo();B(d,u.footer),u.footer&&As(u.footer,d),tt(d,u,"footer")})(0,u),"function"==typeof u.didRender&&u.didRender(ee())};function zr(){const c=q.innerParams.get(this);if(!c)return;const u=q.domCache.get(this);k(u.loader),_s()?c.icon&&ie(En()):wc(u),Ae([u.popup,u.actions],x.loading),u.popup.removeAttribute("aria-busy"),u.popup.removeAttribute("data-loading"),u.confirmButton.disabled=!1,u.denyButton.disabled=!1,u.cancelButton.disabled=!1}const wc=c=>{const u=c.popup.getElementsByClassName(c.loader.getAttribute("data-button-to-replace"));u.length?ie(u[0],"inline-block"):!ke(ct())&&!ke(ft())&&!ke(xt())&&k(c.actions)};const Vs=()=>ct()&&ct().click(),pt=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Bs=c=>{c.keydownTarget&&c.keydownHandlerAdded&&(c.keydownTarget.removeEventListener("keydown",c.keydownHandler,{capture:c.keydownListenerCapture}),c.keydownHandlerAdded=!1)},Zr=(c,u)=>{const d=An();if(d.length)return(c+=u)===d.length?c=0:-1===c&&(c=d.length-1),void d[c].focus();ee().focus()},Wr=["ArrowRight","ArrowDown"],bc=["ArrowLeft","ArrowUp"],xc=(c,u,d)=>{const m=q.innerParams.get(c);m&&(u.isComposing||229===u.keyCode||(m.stopKeydownPropagation&&u.stopPropagation(),"Enter"===u.key?Co(c,u,m):"Tab"===u.key?Xr(u):[...Wr,...bc].includes(u.key)?_c(u.key):"Escape"===u.key&&Yr(u,m,d)))},Co=(c,u,d)=>{if(bs(d.allowEnterKey)&&u.target&&c.getInput()&&u.target instanceof HTMLElement&&u.target.outerHTML===c.getInput().outerHTML){if(["textarea","file"].includes(d.input))return;Vs(),u.preventDefault()}},Xr=c=>{const u=c.target,d=An();let m=-1;for(let _=0;_<d.length;_++)if(u===d[_]){m=_;break}Zr(m,c.shiftKey?-1:1),c.stopPropagation(),c.preventDefault()},_c=c=>{const u=ct(),d=ft(),m=xt();if(document.activeElement instanceof HTMLElement&&![u,d,m].includes(document.activeElement))return;const F=Wr.includes(c)?"nextElementSibling":"previousElementSibling";let W=document.activeElement;for(let je=0;je<Sn().children.length;je++){if(W=W[F],!W)return;if(W instanceof HTMLButtonElement&&ke(W))break}W instanceof HTMLButtonElement&&W.focus()},Yr=(c,u,d)=>{bs(u.allowEscapeKey)&&(c.preventDefault(),d(pt.esc))};var Wt={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const Pn=()=>{Array.from(document.body.children).forEach(u=>{u.hasAttribute("data-previous-aria-hidden")?(u.setAttribute("aria-hidden",u.getAttribute("data-previous-aria-hidden")),u.removeAttribute("data-previous-aria-hidden")):u.removeAttribute("aria-hidden")})},ei=()=>{const c=navigator.userAgent,u=!!c.match(/iPad/i)||!!c.match(/iPhone/i),d=!!c.match(/WebKit/i);u&&d&&!c.match(/CriOS/i)&&ee().scrollHeight>window.innerHeight-44&&(se().style.paddingBottom="44px")},Eo=()=>{const c=se();let u;c.ontouchstart=d=>{u=Ic(d)},c.ontouchmove=d=>{u&&(d.preventDefault(),d.stopPropagation())}},Ic=c=>{const u=c.target,d=se();return!On(c)&&!So(c)&&(u===d||!Ht(d)&&u instanceof HTMLElement&&"INPUT"!==u.tagName&&"TEXTAREA"!==u.tagName&&!(Ht(Dr())&&Dr().contains(u)))},On=c=>c.touches&&c.touches.length&&"stylus"===c.touches[0].touchType,So=c=>c.touches&&c.touches.length>1,Ao=()=>{if(ut(document.body,x.iosfix)){const c=parseInt(document.body.style.top,10);Ae(document.body,x.iosfix),document.body.style.top="",document.body.scrollTop=-1*c}},ko=()=>{null===_t.previousBodyPadding&&document.body.scrollHeight>window.innerHeight&&(_t.previousBodyPadding=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${_t.previousBodyPadding+(()=>{const c=document.createElement("div");c.className=x["scrollbar-measure"],document.body.appendChild(c);const u=c.getBoundingClientRect().width-c.clientWidth;return document.body.removeChild(c),u})()}px`)},qs=()=>{null!==_t.previousBodyPadding&&(document.body.style.paddingRight=`${_t.previousBodyPadding}px`,_t.previousBodyPadding=null)};function Do(c,u,d,m){_s()?ti(c,m):(Es(d).then(()=>ti(c,m)),Bs($)),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?(u.setAttribute("style","display:none !important"),u.removeAttribute("class"),u.innerHTML=""):u.remove(),Nr()&&(qs(),Ao(),Pn()),function Cc(){Ae([document.documentElement,document.body],[x.shown,x["height-auto"],x["no-backdrop"],x["toast-shown"]])}()}function mt(c){c=Us(c);const u=Wt.swalPromiseResolve.get(this),d=Sc(this);this.isAwaitingPromise()?c.isDismissed||(Xt(this),u(c)):d&&u(c)}const Sc=c=>{const u=ee();if(!u)return!1;const d=q.innerParams.get(c);if(!d||ut(u,d.hideClass.popup))return!1;Ae(u,d.showClass.popup),G(u,d.hideClass.popup);const m=se();return Ae(m,d.showClass.backdrop),G(m,d.hideClass.backdrop),Mo(c,u,d),!0};const Xt=c=>{c.isAwaitingPromise()&&(q.awaitingPromise.delete(c),q.innerParams.get(c)||c._destroy())},Us=c=>typeof c>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},c),Mo=(c,u,d)=>{const m=se(),_=Ue&&po(u);"function"==typeof d.willClose&&d.willClose(u),_?Ln(c,u,m,d.returnFocus,d.didClose):Do(c,m,d.returnFocus,d.didClose)},Ln=(c,u,d,m,_)=>{$.swalCloseEventFinishedCallback=Do.bind(null,c,d,m,_),u.addEventListener(Ue,function(F){F.target===u&&($.swalCloseEventFinishedCallback(),delete $.swalCloseEventFinishedCallback)})},ti=(c,u)=>{setTimeout(()=>{"function"==typeof u&&u.bind(c.params)(),c._destroy()})};function Ne(c,u,d){const m=q.domCache.get(c);u.forEach(_=>{m[_].disabled=d})}function ni(c,u){if(c)if("radio"===c.type){const m=c.parentNode.parentNode.querySelectorAll("input");for(let _=0;_<m.length;_++)m[_].disabled=u}else c.disabled=u}const lt={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},ri=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],ii={},oi=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Rn=c=>Object.prototype.hasOwnProperty.call(lt,c),Yt=c=>-1!==ri.indexOf(c),$s=c=>ii[c],Ac=c=>{Rn(c)||V(`Unknown parameter "${c}"`)},ai=c=>{oi.includes(c)&&V(`The parameter "${c}" is incompatible with toasts`)},Ks=c=>{$s(c)&&nc(c,$s(c))};const Fo=c=>{const u={};return Object.keys(c).forEach(d=>{Yt(d)?u[d]=c[d]:V(`Invalid parameter to update: ${d}`)}),u};const kc=c=>{Jt(c),delete c.params,delete $.keydownHandler,delete $.keydownTarget,delete $.currentInstance},Jt=c=>{c.isAwaitingPromise()?(Gs(q,c),q.awaitingPromise.set(c,!0)):(Gs(Wt,c),Gs(q,c))},Gs=(c,u)=>{for(const d in c)c[d].delete(u)};var Vn=Object.freeze({__proto__:null,_destroy:function Ro(){const c=q.domCache.get(this),u=q.innerParams.get(this);u?(c.popup&&$.swalCloseEventFinishedCallback&&($.swalCloseEventFinishedCallback(),delete $.swalCloseEventFinishedCallback),"function"==typeof u.didDestroy&&u.didDestroy(),kc(this)):Jt(this)},close:mt,closeModal:mt,closePopup:mt,closeToast:mt,disableButtons:function js(){Ne(this,["confirmButton","denyButton","cancelButton"],!0)},disableInput:function si(){ni(this.getInput(),!0)},disableLoading:zr,enableButtons:function Fn(){Ne(this,["confirmButton","denyButton","cancelButton"],!1)},enableInput:function No(){ni(this.getInput(),!1)},getInput:function Hr(c){const u=q.innerParams.get(c||this),d=q.domCache.get(c||this);return d?Or(d.popup,u.input):null},handleAwaitingPromise:Xt,hideLoading:zr,isAwaitingPromise:function Ec(){return!!q.awaitingPromise.get(this)},rejectPromise:function Ot(c){const u=Wt.swalPromiseReject.get(this);Xt(this),u&&u(c)},resetValidationMessage:function Oo(){const c=q.domCache.get(this);c.validationMessage&&k(c.validationMessage);const u=this.getInput();u&&(u.removeAttribute("aria-invalid"),u.removeAttribute("aria-describedby"),Ae(u,x.inputerror))},showValidationMessage:function Po(c){const u=q.domCache.get(this),d=q.innerParams.get(this);Ge(u.validationMessage,c),u.validationMessage.className=x["validation-message"],d.customClass&&d.customClass.validationMessage&&G(u.validationMessage,d.customClass.validationMessage),ie(u.validationMessage);const m=this.getInput();m&&(m.setAttribute("aria-invalid",!0),m.setAttribute("aria-describedby",x["validation-message"]),I(m),G(m,x.inputerror))},update:function Lo(c){const u=ee(),d=q.innerParams.get(this);if(!u||ut(u,d.hideClass.popup))return void V("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");const m=Fo(c),_=Object.assign({},d,m);Rs(this,_),q.innerParams.set(this,_),Object.defineProperties(this,{params:{value:Object.assign({},this.params,c),writable:!1,enumerable:!0}})}});const ht=c=>{let u=ee();u||new Qn,u=ee();const d=Gt();_s()?k(En()):Lt(u,c),ie(d),u.setAttribute("data-loading","true"),u.setAttribute("aria-busy","true"),u.focus()},Lt=(c,u)=>{const d=Sn(),m=Gt();!u&&ke(ct())&&(u=ct()),ie(d),u&&(k(u),m.setAttribute("data-button-to-replace",u.className)),m.parentNode.insertBefore(m,u),G([c,d],x.loading)},Mc=c=>c.checked?1:0,Vo=c=>c.checked?c.value:null,Bo=c=>c.files.length?null!==c.getAttribute("multiple")?c.files:c.files[0]:null,Nc=(c,u)=>{const d=ee(),m=_=>{gt[u.input](d,en(_),u)};bt(u.inputOptions)||kr(u.inputOptions)?(ht(ct()),at(u.inputOptions).then(_=>{c.hideLoading(),m(_)})):"object"==typeof u.inputOptions?m(u.inputOptions):Nt("Unexpected type of inputOptions! Expected object, Map or Promise, got "+typeof u.inputOptions)},Ft=(c,u)=>{const d=c.getInput();k(d),at(u.inputValue).then(m=>{d.value="number"===u.input?`${parseFloat(m)||0}`:`${m}`,ie(d),d.focus(),c.hideLoading()}).catch(m=>{Nt(`Error in inputValue promise: ${m}`),d.value="",ie(d),d.focus(),c.hideLoading()})},gt={select:(c,u,d)=>{const m=H(c,x.select),_=(F,W,je)=>{const Pe=document.createElement("option");Pe.value=je,Ge(Pe,W),Pe.selected=Bn(je,d.inputValue),F.appendChild(Pe)};u.forEach(F=>{const W=F[0],je=F[1];if(Array.isArray(je)){const Pe=document.createElement("optgroup");Pe.label=W,Pe.disabled=!1,m.appendChild(Pe),je.forEach(Vt=>_(Pe,Vt[1],Vt[0]))}else _(m,je,W)}),m.focus()},radio:(c,u,d)=>{const m=H(c,x.radio);u.forEach(F=>{const W=F[0],je=F[1],Pe=document.createElement("input"),Vt=document.createElement("label");Pe.type="radio",Pe.name=x.radio,Pe.value=W,Bn(W,d.inputValue)&&(Pe.checked=!0);const Js=document.createElement("span");Ge(Js,je),Js.className=x.label,Vt.appendChild(Pe),Vt.appendChild(Js),m.appendChild(Vt)});const _=m.querySelectorAll("input");_.length&&_[0].focus()}},en=c=>{const u=[];return typeof Map<"u"&&c instanceof Map?c.forEach((d,m)=>{let _=d;"object"==typeof _&&(_=en(_)),u.push([m,_])}):Object.keys(c).forEach(d=>{let m=c[d];"object"==typeof m&&(m=en(m)),u.push([d,m])}),u},Bn=(c,u)=>u&&u.toString()===c.toString(),tn=(c,u)=>{const d=q.innerParams.get(c);if(!d.input)return void Nt(`The "input" parameter is needed to be set when using returnInputValueOn${Ke(u)}`);const m=((c,u)=>{const d=c.getInput();if(!d)return null;switch(u.input){case"checkbox":return Mc(d);case"radio":return Vo(d);case"file":return Bo(d);default:return u.inputAutoTrim?d.value.trim():d.value}})(c,d);d.inputValidator?qn(c,m,u):c.getInput().checkValidity()?"deny"===u?li(c,m):di(c,m):(c.enableButtons(),c.showValidationMessage(d.validationMessage))},qn=(c,u,d)=>{const m=q.innerParams.get(c);c.disableInput(),Promise.resolve().then(()=>at(m.inputValidator(u,m.validationMessage))).then(F=>{c.enableButtons(),c.enableInput(),F?c.showValidationMessage(F):"deny"===d?li(c,u):di(c,u)})},li=(c,u)=>{const d=q.innerParams.get(c||void 0);d.showLoaderOnDeny&&ht(ft()),d.preDeny?(q.awaitingPromise.set(c||void 0,!0),Promise.resolve().then(()=>at(d.preDeny(u,d.validationMessage))).then(_=>{!1===_?(c.hideLoading(),Xt(c)):c.close({isDenied:!0,value:typeof _>"u"?u:_})}).catch(_=>Uo(c||void 0,_))):c.close({isDenied:!0,value:u})},hi=(c,u)=>{c.close({isConfirmed:!0,value:u})},Uo=(c,u)=>{c.rejectPromise(u)},di=(c,u)=>{const d=q.innerParams.get(c||void 0);d.showLoaderOnConfirm&&ht(),d.preConfirm?(c.resetValidationMessage(),q.awaitingPromise.set(c||void 0,!0),Promise.resolve().then(()=>at(d.preConfirm(u,d.validationMessage))).then(_=>{ke(Mr())||!1===_?(c.hideLoading(),Xt(c)):hi(c,typeof _>"u"?u:_)}).catch(_=>Uo(c||void 0,_))):hi(c,u)},Oc=(c,u,d)=>{u.popup.onclick=()=>{const m=q.innerParams.get(c);m&&(Un(m)||m.timer||m.input)||d(pt.close)}},Un=c=>c.showConfirmButton||c.showDenyButton||c.showCancelButton||c.showCloseButton;let nt=!1;const jo=c=>{c.popup.onmousedown=()=>{c.container.onmouseup=function(u){c.container.onmouseup=void 0,u.target===c.container&&(nt=!0)}}},$o=c=>{c.container.onmousedown=()=>{c.popup.onmouseup=function(u){c.popup.onmouseup=void 0,(u.target===c.popup||c.popup.contains(u.target))&&(nt=!0)}}},Ko=(c,u,d)=>{u.container.onclick=m=>{const _=q.innerParams.get(c);nt?nt=!1:m.target===u.container&&bs(_.allowOutsideClick)&&d(pt.backdrop)}},Go=c=>c instanceof Element||(c=>"object"==typeof c&&c.jquery)(c);const fi=()=>{if($.timeout)return(()=>{const c=Pt(),u=parseInt(window.getComputedStyle(c).width);c.style.removeProperty("transition"),c.style.width="100%";const d=parseInt(window.getComputedStyle(c).width);c.style.width=u/d*100+"%"})(),$.timeout.stop()},Hs=()=>{if($.timeout){const c=$.timeout.start();return Dn(c),c}};let Qs=!1;const mi={};const Vc=c=>{for(let u=c.target;u&&u!==document;u=u.parentNode)for(const d in mi){const m=u.getAttribute(d);if(m)return void mi[d].fire({template:m})}};var Zs=Object.freeze({__proto__:null,argsToParams:c=>{const u={};return"object"!=typeof c[0]||Go(c[0])?["title","html","icon"].forEach((d,m)=>{const _=c[m];"string"==typeof _||Go(_)?u[d]=_:void 0!==_&&Nt(`Unexpected type of ${d}! Expected "string" or "Element", got ${typeof _}`)}):Object.assign(u,c[0]),u},bindClickHandler:function Rc(){mi[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,Qs||(document.body.addEventListener("click",Vc),Qs=!0)},clickCancel:()=>xt()&&xt().click(),clickConfirm:Vs,clickDeny:()=>ft()&&ft().click(),enableLoading:ht,fire:function zo(){for(var u=arguments.length,d=new Array(u),m=0;m<u;m++)d[m]=arguments[m];return new this(...d)},getActions:Sn,getCancelButton:xt,getCloseButton:xs,getConfirmButton:ct,getContainer:se,getDenyButton:ft,getFocusableElements:An,getFooter:fo,getHtmlContainer:Dr,getIcon:En,getIconContent:()=>We(x["icon-content"]),getImage:rc,getInputLabel:()=>We(x["input-label"]),getLoader:Gt,getPopup:ee,getProgressSteps:ho,getTimerLeft:()=>$.timeout&&$.timeout.getTimerLeft(),getTimerProgressBar:Pt,getTitle:sc,getValidationMessage:Mr,increaseTimer:c=>{if($.timeout){const u=$.timeout.increase(c);return Dn(u,!0),u}},isDeprecatedParameter:$s,isLoading:()=>ee().hasAttribute("data-loading"),isTimerRunning:()=>$.timeout&&$.timeout.isRunning(),isUpdatableParameter:Yt,isValidParameter:Rn,isVisible:()=>ke(ee()),mixin:function Fc(c){return class u extends(this){_main(m,_){return super._main(m,Object.assign({},c,_))}}},resumeTimer:Hs,showLoading:ht,stopTimer:fi,toggleTimer:()=>{const c=$.timeout;return c&&(c.running?fi():Hs())}});class jn{constructor(u,d){this.callback=u,this.remaining=d,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}increase(u){const d=this.running;return d&&this.stop(),this.remaining+=u,d&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const $n=["swal-title","swal-html","swal-footer"],Wo=c=>{const u={};return Array.from(c.querySelectorAll("swal-param")).forEach(m=>{Rt(m,["name","value"]);const _=m.getAttribute("name"),F=m.getAttribute("value");u[_]="boolean"==typeof lt[_]?"false"!==F:"object"==typeof lt[_]?JSON.parse(F):F}),u},Kn=c=>{const u={};return Array.from(c.querySelectorAll("swal-function-param")).forEach(m=>{const _=m.getAttribute("name"),F=m.getAttribute("value");u[_]=new Function(`return ${F}`)()}),u},Gn=c=>{const u={};return Array.from(c.querySelectorAll("swal-button")).forEach(m=>{Rt(m,["type","color","aria-label"]);const _=m.getAttribute("type");u[`${_}ButtonText`]=m.innerHTML,u[`show${Ke(_)}Button`]=!0,m.hasAttribute("color")&&(u[`${_}ButtonColor`]=m.getAttribute("color")),m.hasAttribute("aria-label")&&(u[`${_}ButtonAriaLabel`]=m.getAttribute("aria-label"))}),u},Bc=c=>{const u={},d=c.querySelector("swal-image");return d&&(Rt(d,["src","width","height","alt"]),d.hasAttribute("src")&&(u.imageUrl=d.getAttribute("src")),d.hasAttribute("width")&&(u.imageWidth=d.getAttribute("width")),d.hasAttribute("height")&&(u.imageHeight=d.getAttribute("height")),d.hasAttribute("alt")&&(u.imageAlt=d.getAttribute("alt"))),u},he=c=>{const u={},d=c.querySelector("swal-icon");return d&&(Rt(d,["type","color"]),d.hasAttribute("type")&&(u.icon=d.getAttribute("type")),d.hasAttribute("color")&&(u.iconColor=d.getAttribute("color")),u.iconHtml=d.innerHTML),u},Xo=c=>{const u={},d=c.querySelector("swal-input");d&&(Rt(d,["type","label","placeholder","value"]),u.input=d.getAttribute("type")||"text",d.hasAttribute("label")&&(u.inputLabel=d.getAttribute("label")),d.hasAttribute("placeholder")&&(u.inputPlaceholder=d.getAttribute("placeholder")),d.hasAttribute("value")&&(u.inputValue=d.getAttribute("value")));const m=Array.from(c.querySelectorAll("swal-input-option"));return m.length&&(u.inputOptions={},m.forEach(_=>{Rt(_,["value"]);const F=_.getAttribute("value");u.inputOptions[F]=_.innerHTML})),u},qc=(c,u)=>{const d={};for(const m in u){const _=u[m],F=c.querySelector(_);F&&(Rt(F,[]),d[_.replace(/^swal-/,"")]=F.innerHTML.trim())}return d},Uc=c=>{const u=$n.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(c.children).forEach(d=>{const m=d.tagName.toLowerCase();u.includes(m)||V(`Unrecognized element <${m}>`)})},Rt=(c,u)=>{Array.from(c.attributes).forEach(d=>{-1===u.indexOf(d.name)&&V([`Unrecognized attribute "${d.name}" on <${c.tagName.toLowerCase()}>.`,u.length?`Allowed attributes are: ${u.join(", ")}`:"To set the value, use HTML within the element."])})},Yo=c=>{const u=se(),d=ee();"function"==typeof c.willOpen&&c.willOpen(d);const _=window.getComputedStyle(document.body).overflowY;yt(u,d,c),setTimeout(()=>{Ws(u,d)},10),Nr()&&(Jo(u,c.scrollbarPadding,_),Array.from(document.body.children).forEach(u=>{u===se()||u.contains(se())||(u.hasAttribute("aria-hidden")&&u.setAttribute("data-previous-aria-hidden",u.getAttribute("aria-hidden")),u.setAttribute("aria-hidden","true"))})),!_s()&&!$.previousActiveElement&&($.previousActiveElement=document.activeElement),"function"==typeof c.didOpen&&setTimeout(()=>c.didOpen(d)),Ae(u,x["no-transition"])},wi=c=>{const u=ee();if(c.target!==u)return;const d=se();u.removeEventListener(Ue,wi),d.style.overflowY="auto"},Ws=(c,u)=>{Ue&&po(u)?(c.style.overflowY="hidden",u.addEventListener(Ue,wi)):c.style.overflowY="auto"},Jo=(c,u,d)=>{(()=>{if((/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!ut(document.body,x.iosfix)){const u=document.body.scrollTop;document.body.style.top=-1*u+"px",G(document.body,x.iosfix),Eo(),ei()}})(),u&&"hidden"!==d&&ko(),setTimeout(()=>{c.scrollTop=0})},yt=(c,u,d)=>{G(c,d.showClass.backdrop),u.style.setProperty("opacity","0","important"),ie(u,"grid"),setTimeout(()=>{G(u,d.showClass.popup),u.style.removeProperty("opacity")},10),G([document.documentElement,document.body],x.shown),d.heightAuto&&d.backdrop&&!d.toast&&G([document.documentElement,document.body],x["height-auto"])};var vi={email:(c,u)=>/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(c)?Promise.resolve():Promise.resolve(u||"Invalid email address"),url:(c,u)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(c)?Promise.resolve():Promise.resolve(u||"Invalid URL")};function zn(c){(function ea(c){c.inputValidator||Object.keys(vi).forEach(u=>{c.input===u&&(c.inputValidator=vi[u])})})(c),c.showLoaderOnConfirm&&!c.preConfirm&&V("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),function bi(c){(!c.target||"string"==typeof c.target&&!document.querySelector(c.target)||"string"!=typeof c.target&&!c.target.appendChild)&&(V('Target parameter is not valid, defaulting to "body"'),c.target="body")}(c),"string"==typeof c.title&&(c.title=c.title.split("\n").join("<br />")),Ss(c)}let st;class Ct{constructor(){if(typeof window>"u")return;st=this;for(var u=arguments.length,d=new Array(u),m=0;m<u;m++)d[m]=arguments[m];const _=Object.freeze(this.constructor.argsToParams(d));Object.defineProperties(this,{params:{value:_,writable:!1,enumerable:!0,configurable:!0}});const F=st._main(st.params);q.promise.set(this,F)}_main(u){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(c=>{!1===c.backdrop&&c.allowOutsideClick&&V('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`');for(const u in c)Ac(u),c.toast&&ai(u),Ks(u)})(Object.assign({},d,u)),$.currentInstance&&($.currentInstance._destroy(),Nr()&&Pn()),$.currentInstance=st;const m=ta(u,d);zn(m),Object.freeze(m),$.timeout&&($.timeout.stop(),delete $.timeout),clearTimeout($.restoreFocusTimeout);const _=Ys(st);return Rs(st,m),q.innerParams.set(st,m),Xs(st,_,m)}then(u){return q.promise.get(this).then(u)}finally(u){return q.promise.get(this).finally(u)}}const Xs=(c,u,d)=>new Promise((m,_)=>{const F=W=>{c.close({isDismissed:!0,dismiss:W})};Wt.swalPromiseResolve.set(c,m),Wt.swalPromiseReject.set(c,_),u.confirmButton.onclick=()=>{(c=>{const u=q.innerParams.get(c);c.disableButtons(),u.input?tn(c,"confirm"):di(c,!0)})(c)},u.denyButton.onclick=()=>{(c=>{const u=q.innerParams.get(c);c.disableButtons(),u.returnInputValueOnDeny?tn(c,"deny"):li(c,!1)})(c)},u.cancelButton.onclick=()=>{((c,u)=>{c.disableButtons(),u(pt.cancel)})(c,F)},u.closeButton.onclick=()=>{F(pt.close)},((c,u,d)=>{q.innerParams.get(c).toast?Oc(c,u,d):(jo(u),$o(u),Ko(c,u,d))})(c,u,F),((c,u,d,m)=>{Bs(u),d.toast||(u.keydownHandler=_=>xc(c,_,m),u.keydownTarget=d.keydownListenerCapture?window:ee(),u.keydownListenerCapture=d.keydownListenerCapture,u.keydownTarget.addEventListener("keydown",u.keydownHandler,{capture:u.keydownListenerCapture}),u.keydownHandlerAdded=!0)})(c,$,d,F),((c,u)=>{"select"===u.input||"radio"===u.input?Nc(c,u):["text","email","number","tel","textarea"].includes(u.input)&&(bt(u.inputValue)||kr(u.inputValue))&&(ht(ct()),Ft(c,u))})(c,d),Yo(d),jc($,d,F),na(u,d),setTimeout(()=>{u.container.scrollTop=0})}),ta=(c,u)=>{const d=(c=>{const u="string"==typeof c.template?document.querySelector(c.template):c.template;if(!u)return{};const d=u.content;return Uc(d),Object.assign(Wo(d),Kn(d),Gn(d),Bc(d),he(d),Xo(d),qc(d,$n))})(c),m=Object.assign({},lt,u,d,c);return m.showClass=Object.assign({},lt.showClass,m.showClass),m.hideClass=Object.assign({},lt.hideClass,m.hideClass),m},Ys=c=>{const u={popup:ee(),container:se(),actions:Sn(),confirmButton:ct(),denyButton:ft(),cancelButton:xt(),loader:Gt(),closeButton:xs(),validationMessage:Mr(),progressSteps:ho()};return q.domCache.set(c,u),u},jc=(c,u,d)=>{const m=Pt();k(m),u.timer&&(c.timeout=new jn(()=>{d("timer"),delete c.timeout},u.timer),u.timerProgressBar&&(ie(m),tt(m,u,"timerProgressBar"),setTimeout(()=>{c.timeout&&c.timeout.running&&Dn(u.timer)})))},na=(c,u)=>{if(!u.toast){if(!bs(u.allowEnterKey))return void sa();Hn(c,u)||Zr(-1,1)}},Hn=(c,u)=>u.focusDeny&&ke(c.denyButton)?(c.denyButton.focus(),!0):u.focusCancel&&ke(c.cancelButton)?(c.cancelButton.focus(),!0):!(!u.focusConfirm||!ke(c.confirmButton)||(c.confirmButton.focus(),0)),sa=()=>{document.activeElement instanceof HTMLElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|xn--p1ai)$/)){const c=new Date,u=localStorage.getItem("swal-initiation");u?(c.getTime()-Date.parse(u))/864e5>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const d=document.createElement("audio");d.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",d.loop=!0,document.body.appendChild(d),setTimeout(()=>{d.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${c}`)}Object.assign(Ct.prototype,Vn),Object.assign(Ct,Zs),Object.keys(Vn).forEach(c=>{Ct[c]=function(){if(st)return st[c](...arguments)}}),Ct.DismissReason=pt,Ct.version="11.7.3";const Qn=Ct;return Qn.default=Qn,Qn}(),typeof this<"u"&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),typeof document<"u"&&function(q,K){var $e=q.createElement("style");if(q.getElementsByTagName("head")[0].appendChild($e),$e.styleSheet)$e.styleSheet.disabled||($e.styleSheet.cssText=K);else try{$e.innerHTML=K}catch{$e.innerText=K}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;transform:rotate(45deg);border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}.swal2-container{display:grid;position:fixed;z-index:1060;top:0;right:0;bottom:0;left:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}.swal2-container.swal2-backdrop-show,.swal2-container.swal2-noanimation{background:rgba(0,0,0,.4)}.swal2-container.swal2-backdrop-hide{background:rgba(0,0,0,0) !important}.swal2-container.swal2-top-start,.swal2-container.swal2-center-start,.swal2-container.swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}.swal2-container.swal2-top,.swal2-container.swal2-center,.swal2-container.swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}.swal2-container.swal2-top-end,.swal2-container.swal2-center-end,.swal2-container.swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}.swal2-container.swal2-top-start>.swal2-popup{align-self:start}.swal2-container.swal2-top>.swal2-popup{grid-column:2;align-self:start;justify-self:center}.swal2-container.swal2-top-end>.swal2-popup,.swal2-container.swal2-top-right>.swal2-popup{grid-column:3;align-self:start;justify-self:end}.swal2-container.swal2-center-start>.swal2-popup,.swal2-container.swal2-center-left>.swal2-popup{grid-row:2;align-self:center}.swal2-container.swal2-center>.swal2-popup{grid-column:2;grid-row:2;align-self:center;justify-self:center}.swal2-container.swal2-center-end>.swal2-popup,.swal2-container.swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;align-self:center;justify-self:end}.swal2-container.swal2-bottom-start>.swal2-popup,.swal2-container.swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}.swal2-container.swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;justify-self:center;align-self:end}.swal2-container.swal2-bottom-end>.swal2-popup,.swal2-container.swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;align-self:end;justify-self:end}.swal2-container.swal2-grow-row>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}.swal2-container.swal2-grow-column>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}.swal2-container.swal2-no-transition{transition:none !important}.swal2-popup{display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}.swal2-popup:focus{outline:none}.swal2-popup.swal2-loading{overflow-y:hidden}.swal2-title{position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}.swal2-actions{display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}.swal2-actions:not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}.swal2-actions:not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}.swal2-actions:not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}.swal2-loader{display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}.swal2-styled{margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}.swal2-styled:not([disabled]){cursor:pointer}.swal2-styled.swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}.swal2-styled.swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}.swal2-styled.swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}.swal2-styled.swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}.swal2-styled.swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}.swal2-styled.swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}.swal2-styled.swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}.swal2-styled:focus{outline:none}.swal2-styled::-moz-focus-inner{border:0}.swal2-footer{justify-content:center;margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em}.swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}.swal2-timer-progress-bar{width:100%;height:.25em;background:rgba(0,0,0,.2)}.swal2-image{max-width:100%;margin:2em auto 1em}.swal2-close{z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:serif;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}.swal2-close:hover{transform:none;background:rgba(0,0,0,0);color:#f27474}.swal2-close:focus{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}.swal2-close::-moz-focus-inner{border:0}.swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}.swal2-input,.swal2-file,.swal2-textarea,.swal2-select,.swal2-radio,.swal2-checkbox{margin:1em 2em 3px}.swal2-input,.swal2-file,.swal2-textarea{box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}.swal2-input.swal2-inputerror,.swal2-file.swal2-inputerror,.swal2-textarea.swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}.swal2-input:focus,.swal2-file:focus,.swal2-textarea:focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}.swal2-input::placeholder,.swal2-file::placeholder,.swal2-textarea::placeholder{color:#ccc}.swal2-range{margin:1em 2em 3px;background:#fff}.swal2-range input{width:80%}.swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}.swal2-range input,.swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}.swal2-input{height:2.625em;padding:0 .75em}.swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}.swal2-textarea{height:6.75em;padding:.75em}.swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}.swal2-radio,.swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}.swal2-radio label,.swal2-checkbox label{margin:0 .6em;font-size:1.125em}.swal2-radio input,.swal2-checkbox input{flex-shrink:0;margin:0 .4em}.swal2-input-label{display:flex;justify-content:center;margin:1em auto 0}.swal2-validation-message{align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}.swal2-validation-message::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}.swal2-icon{position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}.swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}.swal2-icon.swal2-error{border-color:#f27474;color:#f27474}.swal2-icon.swal2-error .swal2-x-mark{position:relative;flex-grow:1}.swal2-icon.swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}.swal2-icon.swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}.swal2-icon.swal2-warning{border-color:#facea8;color:#f8bb86}.swal2-icon.swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}.swal2-icon.swal2-info{border-color:#9de0f6;color:#3fc3ee}.swal2-icon.swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}.swal2-icon.swal2-question{border-color:#c9dae1;color:#87adbd}.swal2-icon.swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}.swal2-icon.swal2-success{border-color:#a5dc86;color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;transform:rotate(45deg);border-radius:50%}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}.swal2-icon.swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}.swal2-icon.swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}.swal2-icon.swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}.swal2-icon.swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}.swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}.swal2-progress-steps li{display:inline-block;position:relative}.swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}.swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{top:0;right:auto;bottom:auto;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{top:0;right:0;bottom:auto;left:auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{top:0;right:auto;bottom:auto;left:0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{top:50%;right:auto;bottom:auto;left:0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{top:50%;right:auto;bottom:auto;left:50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{top:50%;right:0;bottom:auto;left:auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{top:auto;right:auto;bottom:0;left:0}body.swal2-toast-shown .swal2-container.swal2-bottom{top:auto;right:auto;bottom:0;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{top:auto;right:0;bottom:0;left:auto}')}}]);