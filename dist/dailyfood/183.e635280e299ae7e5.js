(self.webpackChunkdailyfood=self.webpackChunkdailyfood||[]).push([[183],{8183:(Jh,B,G)=>{"use strict";G.r(B),G.d(B,{PanelModule:()=>Rb});var Le=G(6895),C=G(9051),_t=G(9751),Ao=G(5698),Dl=G(5226),Me=G.n(Dl),d=G(4650),be=G(4004),j=(()=>{return(n=j||(j={}))[n.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",n[n.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",n[n.CLASS_TO_CLASS=2]="CLASS_TO_CLASS",j;var n})();const je=new class Ml{constructor(){this._typeMetadatas=new Map,this._transformMetadatas=new Map,this._exposeMetadatas=new Map,this._excludeMetadatas=new Map,this._ancestorsMap=new Map}addTypeMetadata(e){this._typeMetadatas.has(e.target)||this._typeMetadatas.set(e.target,new Map),this._typeMetadatas.get(e.target).set(e.propertyName,e)}addTransformMetadata(e){this._transformMetadatas.has(e.target)||this._transformMetadatas.set(e.target,new Map),this._transformMetadatas.get(e.target).has(e.propertyName)||this._transformMetadatas.get(e.target).set(e.propertyName,[]),this._transformMetadatas.get(e.target).get(e.propertyName).push(e)}addExposeMetadata(e){this._exposeMetadatas.has(e.target)||this._exposeMetadatas.set(e.target,new Map),this._exposeMetadatas.get(e.target).set(e.propertyName,e)}addExcludeMetadata(e){this._excludeMetadatas.has(e.target)||this._excludeMetadatas.set(e.target,new Map),this._excludeMetadatas.get(e.target).set(e.propertyName,e)}findTransformMetadatas(e,t,r){return this.findMetadatas(this._transformMetadatas,e,t).filter(s=>!s.options||!0===s.options.toClassOnly&&!0===s.options.toPlainOnly||(!0===s.options.toClassOnly?r===j.CLASS_TO_CLASS||r===j.PLAIN_TO_CLASS:!0!==s.options.toPlainOnly||r===j.CLASS_TO_PLAIN))}findExcludeMetadata(e,t){return this.findMetadata(this._excludeMetadatas,e,t)}findExposeMetadata(e,t){return this.findMetadata(this._exposeMetadatas,e,t)}findExposeMetadataByCustomName(e,t){return this.getExposedMetadatas(e).find(r=>r.options&&r.options.name===t)}findTypeMetadata(e,t){return this.findMetadata(this._typeMetadatas,e,t)}getStrategy(e){const t=this._excludeMetadatas.get(e),r=t&&t.get(void 0),s=this._exposeMetadatas.get(e),i=s&&s.get(void 0);return r&&i||!r&&!i?"none":r?"excludeAll":"exposeAll"}getExposedMetadatas(e){return this.getMetadata(this._exposeMetadatas,e)}getExcludedMetadatas(e){return this.getMetadata(this._excludeMetadatas,e)}getExposedProperties(e,t){return this.getExposedMetadatas(e).filter(r=>!r.options||!0===r.options.toClassOnly&&!0===r.options.toPlainOnly||(!0===r.options.toClassOnly?t===j.CLASS_TO_CLASS||t===j.PLAIN_TO_CLASS:!0!==r.options.toPlainOnly||t===j.CLASS_TO_PLAIN)).map(r=>r.propertyName)}getExcludedProperties(e,t){return this.getExcludedMetadatas(e).filter(r=>!r.options||!0===r.options.toClassOnly&&!0===r.options.toPlainOnly||(!0===r.options.toClassOnly?t===j.CLASS_TO_CLASS||t===j.PLAIN_TO_CLASS:!0!==r.options.toPlainOnly||t===j.CLASS_TO_PLAIN)).map(r=>r.propertyName)}clear(){this._typeMetadatas.clear(),this._exposeMetadatas.clear(),this._excludeMetadatas.clear(),this._ancestorsMap.clear()}getMetadata(e,t){const r=e.get(t);let s;r&&(s=Array.from(r.values()).filter(o=>void 0!==o.propertyName));const i=[];for(const o of this.getAncestors(t)){const a=e.get(o);if(a){const c=Array.from(a.values()).filter(h=>void 0!==h.propertyName);i.push(...c)}}return i.concat(s||[])}findMetadata(e,t,r){const s=e.get(t);if(s){const i=s.get(r);if(i)return i}for(const i of this.getAncestors(t)){const o=e.get(i);if(o){const a=o.get(r);if(a)return a}}}findMetadatas(e,t,r){const s=e.get(t);let i;s&&(i=s.get(r));const o=[];for(const a of this.getAncestors(t)){const c=e.get(a);c&&c.has(r)&&o.push(...c.get(r))}return o.slice().reverse().concat((i||[]).slice().reverse())}getAncestors(e){if(!e)return[];if(!this._ancestorsMap.has(e)){const t=[];for(let r=Object.getPrototypeOf(e.prototype.constructor);typeof r.prototype<"u";r=Object.getPrototypeOf(r.prototype.constructor))t.push(r);this._ancestorsMap.set(e,t)}return this._ancestorsMap.get(e)}};class bt{constructor(e,t){this.transformationType=e,this.options=t,this.recursionStack=new Set}transform(e,t,r,s,i,o=0){if(Array.isArray(t)||t instanceof Set){const a=s&&this.transformationType===j.PLAIN_TO_CLASS?function Mn(n){const e=new n;return e instanceof Set||"push"in e?e:[]}(s):[];return t.forEach((c,h)=>{const p=e?e[h]:void 0;if(this.options.enableCircularCheck&&this.isCircular(c))this.transformationType===j.CLASS_TO_CLASS&&(a instanceof Set?a.add(c):a.push(c));else{let m;if("function"!=typeof r&&r&&r.options&&r.options.discriminator&&r.options.discriminator.property&&r.options.discriminator.subTypes){if(this.transformationType===j.PLAIN_TO_CLASS){m=r.options.discriminator.subTypes.find(I=>I.name===c[r.options.discriminator.property]);const E=r.typeFunction({newObject:a,object:c,property:void 0});m=void 0===m?E:m.value,r.options.keepDiscriminatorProperty||delete c[r.options.discriminator.property]}this.transformationType===j.CLASS_TO_CLASS&&(m=c.constructor),this.transformationType===j.CLASS_TO_PLAIN&&(c[r.options.discriminator.property]=r.options.discriminator.subTypes.find(v=>v.value===c.constructor).name)}else m=r;const y=this.transform(p,c,m,void 0,c instanceof Map,o+1);a instanceof Set?a.add(y):a.push(y)}}),a}if(r===String&&!i)return null==t?t:String(t);if(r===Number&&!i)return null==t?t:Number(t);if(r===Boolean&&!i)return null==t?t:Boolean(t);if((r===Date||t instanceof Date)&&!i)return t instanceof Date?new Date(t.valueOf()):null==t?t:new Date(t);if(function Er(){return typeof globalThis<"u"?globalThis:typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:void 0}().Buffer&&(r===Buffer||t instanceof Buffer)&&!i)return null==t?t:Buffer.from(t);if(function Os(n){return null!==n&&"object"==typeof n&&"function"==typeof n.then}(t)&&!i)return new Promise((a,c)=>{t.then(h=>a(this.transform(void 0,h,r,void 0,void 0,o+1)),c)});if(!i&&null!==t&&"object"==typeof t&&"function"==typeof t.then)return t;if("object"==typeof t&&null!==t){!r&&t.constructor!==Object&&(!Array.isArray(t)&&t.constructor===Array||(r=t.constructor)),!r&&e&&(r=e.constructor),this.options.enableCircularCheck&&this.recursionStack.add(t);const a=this.getKeys(r,t,i);let c=e||{};!e&&(this.transformationType===j.PLAIN_TO_CLASS||this.transformationType===j.CLASS_TO_CLASS)&&(c=i?new Map:r?new r:{});for(const h of a){if("__proto__"===h||"constructor"===h)continue;const p=h;let v,m=h,y=h;if(!this.options.ignoreDecorators&&r)if(this.transformationType===j.PLAIN_TO_CLASS){const k=je.findExposeMetadataByCustomName(r,h);k&&(y=k.propertyName,m=k.propertyName)}else if(this.transformationType===j.CLASS_TO_PLAIN||this.transformationType===j.CLASS_TO_CLASS){const k=je.findExposeMetadata(r,h);k&&k.options&&k.options.name&&(m=k.options.name)}v=this.transformationType===j.PLAIN_TO_CLASS?t[p]:t instanceof Map?t.get(p):t[p]instanceof Function?t[p]():t[p];let E,I=v instanceof Map;if(r&&i)E=r;else if(r){const k=je.findTypeMetadata(r,y);if(k){const ue=k.typeFunction?k.typeFunction({newObject:c,object:t,property:y}):k.reflectedType;k.options&&k.options.discriminator&&k.options.discriminator.property&&k.options.discriminator.subTypes?t[p]instanceof Array?E=k:(this.transformationType===j.PLAIN_TO_CLASS&&(E=k.options.discriminator.subTypes.find(z=>{if(v&&v instanceof Object&&k.options.discriminator.property in v)return z.name===v[k.options.discriminator.property]}),E=void 0===E?ue:E.value,k.options.keepDiscriminatorProperty||v&&v instanceof Object&&k.options.discriminator.property in v&&delete v[k.options.discriminator.property]),this.transformationType===j.CLASS_TO_CLASS&&(E=v.constructor),this.transformationType===j.CLASS_TO_PLAIN&&v&&(v[k.options.discriminator.property]=k.options.discriminator.subTypes.find(z=>z.value===v.constructor).name)):E=ue,I=I||k.reflectedType===Map}else if(this.options.targetMaps)this.options.targetMaps.filter(P=>P.target===r&&!!P.properties[y]).forEach(P=>E=P.properties[y]);else if(this.options.enableImplicitConversion&&this.transformationType===j.PLAIN_TO_CLASS){const P=Reflect.getMetadata("design:type",r.prototype,y);P&&(E=P)}}const O=Array.isArray(t[p])?this.getReflectedType(r,y):void 0,J=e?e[p]:void 0;if(c.constructor.prototype){const k=Object.getOwnPropertyDescriptor(c.constructor.prototype,m);if((this.transformationType===j.PLAIN_TO_CLASS||this.transformationType===j.CLASS_TO_CLASS)&&(k&&!k.set||c[m]instanceof Function))continue}if(this.options.enableCircularCheck&&this.isCircular(v)){if(this.transformationType===j.CLASS_TO_CLASS){let k=v;k=this.applyCustomTransformations(k,r,h,t,this.transformationType),(void 0!==k||this.options.exposeUnsetFields)&&(c instanceof Map?c.set(m,k):c[m]=k)}}else{const k=this.transformationType===j.PLAIN_TO_CLASS?m:h;let P;this.transformationType===j.CLASS_TO_PLAIN?(P=t[k],P=this.applyCustomTransformations(P,r,k,t,this.transformationType),P=t[k]===P?v:P,P=this.transform(J,P,E,O,I,o+1)):void 0===v&&this.options.exposeDefaultValues?P=c[m]:(P=this.transform(J,v,E,O,I,o+1),P=this.applyCustomTransformations(P,r,k,t,this.transformationType)),(void 0!==P||this.options.exposeUnsetFields)&&(c instanceof Map?c.set(m,P):c[m]=P)}}return this.options.enableCircularCheck&&this.recursionStack.delete(t),c}return t}applyCustomTransformations(e,t,r,s,i){let o=je.findTransformMetadatas(t,r,this.transformationType);return void 0!==this.options.version&&(o=o.filter(a=>!a.options||this.checkVersion(a.options.since,a.options.until))),o=o.filter(this.options.groups&&this.options.groups.length?a=>!a.options||this.checkGroups(a.options.groups):a=>!a.options||!a.options.groups||!a.options.groups.length),o.forEach(a=>{e=a.transformFn({value:e,key:r,obj:s,type:i,options:this.options})}),e}isCircular(e){return this.recursionStack.has(e)}getReflectedType(e,t){if(!e)return;const r=je.findTypeMetadata(e,t);return r?r.reflectedType:void 0}getKeys(e,t,r){let s=je.getStrategy(e);"none"===s&&(s=this.options.strategy||"exposeAll");let i=[];if(("exposeAll"===s||r)&&(i=t instanceof Map?Array.from(t.keys()):Object.keys(t)),r)return i;if(this.options.ignoreDecorators&&this.options.excludeExtraneousValues&&e&&(i=[...je.getExposedProperties(e,this.transformationType),...je.getExcludedProperties(e,this.transformationType)]),!this.options.ignoreDecorators&&e){let o=je.getExposedProperties(e,this.transformationType);this.transformationType===j.PLAIN_TO_CLASS&&(o=o.map(c=>{const h=je.findExposeMetadata(e,c);return h&&h.options&&h.options.name?h.options.name:c})),i=this.options.excludeExtraneousValues?o:i.concat(o);const a=je.getExcludedProperties(e,this.transformationType);a.length>0&&(i=i.filter(c=>!a.includes(c))),void 0!==this.options.version&&(i=i.filter(c=>{const h=je.findExposeMetadata(e,c);return!h||!h.options||this.checkVersion(h.options.since,h.options.until)})),i=i.filter(this.options.groups&&this.options.groups.length?c=>{const h=je.findExposeMetadata(e,c);return!h||!h.options||this.checkGroups(h.options.groups)}:c=>{const h=je.findExposeMetadata(e,c);return!(h&&h.options&&h.options.groups&&h.options.groups.length)})}return this.options.excludePrefixes&&this.options.excludePrefixes.length&&(i=i.filter(o=>this.options.excludePrefixes.every(a=>o.substr(0,a.length)!==a))),i=i.filter((o,a,c)=>c.indexOf(o)===a),i}checkVersion(e,t){let r=!0;return r&&e&&(r=this.options.version>=e),r&&t&&(r=this.options.version<t),r}checkGroups(e){return!e||this.options.groups.some(t=>e.includes(t))}}const fe={enableCircularCheck:!1,enableImplicitConversion:!1,excludeExtraneousValues:!1,excludePrefixes:void 0,exposeDefaultValues:!1,exposeUnsetFields:!0,groups:void 0,ignoreDecorators:!1,strategy:void 0,targetMaps:void 0,version:void 0},se=new class kn{instanceToPlain(e,t){return new bt(j.CLASS_TO_PLAIN,{...fe,...t}).transform(void 0,e,void 0,void 0,void 0,void 0)}classToPlainFromExist(e,t,r){return new bt(j.CLASS_TO_PLAIN,{...fe,...r}).transform(t,e,void 0,void 0,void 0,void 0)}plainToInstance(e,t,r){return new bt(j.PLAIN_TO_CLASS,{...fe,...r}).transform(void 0,t,e,void 0,void 0,void 0)}plainToClassFromExist(e,t,r){return new bt(j.PLAIN_TO_CLASS,{...fe,...r}).transform(e,t,void 0,void 0,void 0,void 0)}instanceToInstance(e,t){return new bt(j.CLASS_TO_CLASS,{...fe,...t}).transform(void 0,e,void 0,void 0,void 0,void 0)}classToClassFromExist(e,t,r){return new bt(j.CLASS_TO_CLASS,{...fe,...r}).transform(t,e,void 0,void 0,void 0,void 0)}serialize(e,t){return JSON.stringify(this.instanceToPlain(e,t))}deserialize(e,t,r){const s=JSON.parse(t);return this.plainToInstance(e,s,r)}deserializeArray(e,t,r){const s=JSON.parse(t);return this.plainToInstance(e,s,r)}};class Fs{constructor(e,t,r){this.type=e,this.firestore=t,this.caminho=r,this.ref=this.firestore.collection(this.caminho)}get(e){return this.ref.doc(e).get().pipe((0,be.U)(r=>this.docToClass(r)))}list(){return this.ref.valueChanges()}createOrUpdate(e){let t=e.id;if(!e)return null;let r=null;return r=e instanceof this.type?e.toObject():e,t?this.ref.doc(t).set(r,{merge:!0}):this.ref.add(r).then(s=>{r.id=s.id,this.ref.doc(s.id).set(r,{merge:!0})})}delete(e){return this.ref.doc(e).delete()}docToClass(e){let t={id:e.id,...e.data()};return function Io(n,e,t){return se.plainToInstance(n,e,t)}(this.type,t)}}class Ct{toObject(){let e=function Y(n,e){return se.instanceToPlain(n,e)}(this);return delete e.id,e}}class Nn extends Ct{}class Do extends Ct{}class Ar extends Ct{}var Ls=G(4986),On=G(8996),Ir=G(9646),$e=G(2122),Yt=G(8675),Nl=G(4482),Ot=G(5403);function Re(){return(0,Nl.e)((n,e)=>{let t,r=!1;n.subscribe((0,Ot.x)(e,s=>{const i=t;t=s,r&&e.next([i,s]),r=!0}))})}var N,ot=G(5026),Ol=G(1884),We=G(9300),Xt=G(2011),Mo=(G(4217),G(3942)),w=G(5861),Qe=G(9681),gt=G(4859),tt=G(1877),U=G(2090),ke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ht={},Be=Be||{},R=ke||self;function Vn(){}function Pn(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Vt(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Rs="closure_uid_"+(1e9*Math.random()>>>0),K=0;function Fl(n,e,t){return n.call.apply(n.bind,arguments)}function Ll(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),n.apply(e,s)}}return function(){return n.apply(e,arguments)}}function Te(n,e,t){return(Te=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Fl:Ll).apply(null,arguments)}function Sr(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Ae(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function Ke(){this.s=this.s,this.o=this.o}Ke.prototype.s=!1,Ke.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function Pl(n){Object.prototype.hasOwnProperty.call(n,Rs)&&n[Rs]||(n[Rs]=++K)}(this)},Ke.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const ko=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function Bs(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function No(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(Pn(r)){const s=n.length||0,i=r.length||0;n.length=s+i;for(let o=0;o<i;o++)n[s+o]=r[o]}else n.push(r)}}function Ne(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Ne.prototype.h=function(){this.defaultPrevented=!0};var Us=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{R.addEventListener("test",Vn,e),R.removeEventListener("test",Vn,e)}catch{}return n}();function Dr(n){return/^[\s\xa0]*$/.test(n)}var Oo=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function Pt(n,e){return n<e?-1:n>e?1:0}function Mr(){var n=R.navigator;return n&&(n=n.userAgent)?n:""}function dt(n){return-1!=Mr().indexOf(n)}function qs(n){return qs[" "](n),n}qs[" "]=Vn;var kr,n,Gs=dt("Opera"),Jt=dt("Trident")||dt("MSIE"),Vo=dt("Edge"),js=Vo||Jt,Po=dt("Gecko")&&!(-1!=Mr().toLowerCase().indexOf("webkit")&&!dt("Edge"))&&!(dt("Trident")||dt("MSIE"))&&!dt("Edge"),Ul=-1!=Mr().toLowerCase().indexOf("webkit")&&!dt("Edge");function Fo(){var n=R.document;return n?n.documentMode:void 0}e:{var $s="",Ks=(n=Mr(),Po?/rv:([^\);]+)(\)|;)/.exec(n):Vo?/Edge\/([\d\.]+)/.exec(n):Jt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Ul?/WebKit\/(\S+)/.exec(n):Gs?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(Ks&&($s=Ks?Ks[1]:""),Jt){var zs=Fo();if(null!=zs&&zs>parseFloat($s)){kr=String(zs);break e}}kr=$s}var ql={};var Nr=R.document&&Jt&&(Fo()||parseInt(kr,10))||void 0;function Ce(n,e){if(Ne.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(Po){e:{try{qs(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Gl[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Ce.X.h.call(this)}}Ae(Ce,Ne);var Gl={2:"touch",3:"pen",4:"mouse"};Ce.prototype.h=function(){Ce.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Fn="closure_listenable_"+(1e6*Math.random()|0),jl=0;function Lo(n,e,t,r,s){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ha=s,this.key=++jl,this.ba=this.ea=!1}function Or(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function Qs(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function Ro(n){const e={};for(const t in n)e[t]=n[t];return e}const Zs="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Bo(n,e){let t,r;for(let s=1;s<arguments.length;s++){for(t in r=arguments[s],r)n[t]=r[t];for(let i=0;i<Zs.length;i++)t=Zs[i],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Ln(n){this.src=n,this.g={},this.h=0}function Ys(n,e){var t=e.type;if(t in n.g){var i,r=n.g[t],s=ko(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Or(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Xs(n,e,t,r){for(var s=0;s<n.length;++s){var i=n[s];if(!i.ba&&i.listener==e&&i.capture==!!t&&i.ha==r)return s}return-1}Ln.prototype.add=function(n,e,t,r,s){var i=n.toString();(n=this.g[i])||(n=this.g[i]=[],this.h++);var o=Xs(n,e,r,s);return-1<o?(e=n[o],t||(e.ea=!1)):((e=new Lo(e,this.src,i,!!r,s)).ea=t,n.push(e)),e};var Js="closure_lm_"+(1e6*Math.random()|0),ei={};function Uo(n,e,t,r,s){if(r&&r.once)return ti(n,e,t,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)Uo(n,e[i],t,r,s);return null}return t=ii(t),n&&n[Fn]?n.N(e,t,Vt(r)?!!r.capture:!!r,s):qo(n,e,t,!1,r,s)}function qo(n,e,t,r,s,i){if(!e)throw Error("Invalid event type");var o=Vt(s)?!!s.capture:!!s,a=Vr(n);if(a||(n[Js]=a=new Ln(n)),(t=a.add(e,t,r,o,i)).proxy)return t;if(r=function $l(){const e=Kl;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)Us||(s=o),void 0===s&&(s=!1),n.addEventListener(e.toString(),r,s);else if(n.attachEvent)n.attachEvent(Go(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function ti(n,e,t,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)ti(n,e[i],t,r,s);return null}return t=ii(t),n&&n[Fn]?n.O(e,t,Vt(r)?!!r.capture:!!r,s):qo(n,e,t,!0,r,s)}function ni(n,e,t,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)ni(n,e[i],t,r,s);else r=Vt(r)?!!r.capture:!!r,t=ii(t),n&&n[Fn]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Xs(i=n.g[e],t,r,s))&&(Or(i[t]),Array.prototype.splice.call(i,t,1),0==i.length&&(delete n.g[e],n.h--))):n&&(n=Vr(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Xs(e,t,r,s)),(t=-1<n?e[n]:null)&&ri(t))}function ri(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[Fn])Ys(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(Go(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Vr(e))?(Ys(t,n),0==t.h&&(t.src=null,e[Js]=null)):Or(n)}}}function Go(n){return n in ei?ei[n]:ei[n]="on"+n}function Kl(n,e){if(n.ba)n=!0;else{e=new Ce(e,this);var t=n.listener,r=n.ha||n.src;n.ea&&ri(n),n=t.call(r,e)}return n}function Vr(n){return(n=n[Js])instanceof Ln?n:null}var si="__closure_events_fn_"+(1e9*Math.random()>>>0);function ii(n){return"function"==typeof n?n:(n[si]||(n[si]=function(e){return n.handleEvent(e)}),n[si])}function ie(){Ke.call(this),this.i=new Ln(this),this.P=this,this.I=null}function xe(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new Ne(e,n);else if(e instanceof Ne)e.target=e.target||n;else{var s=e;Bo(e=new Ne(r,n),s)}if(s=!0,t)for(var i=t.length-1;0<=i;i--){var o=e.g=t[i];s=Pr(o,r,!0,e)&&s}if(s=Pr(o=e.g=n,r,!0,e)&&s,s=Pr(o,r,!1,e)&&s,t)for(i=0;i<t.length;i++)s=Pr(o=e.g=t[i],r,!1,e)&&s}function Pr(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ba&&o.capture==t){var a=o.listener,c=o.ha||o.src;o.ea&&Ys(n.i,o),s=!1!==a.call(c,r)&&s}}return s&&!r.defaultPrevented}Ae(ie,Ke),ie.prototype[Fn]=!0,ie.prototype.removeEventListener=function(n,e,t,r){ni(this,n,e,t,r)},ie.prototype.M=function(){if(ie.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Or(t[r]);delete n.g[e],n.h--}}this.I=null},ie.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},ie.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var Rn=R.JSON.stringify;function jo(){var n=li;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var oi,$o=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new Hl,n=>n.reset());class Hl{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Wl(n){R.setTimeout(()=>{throw n},0)}function Ko(n,e){oi||function Bn(){var n=R.Promise.resolve(void 0);oi=function(){n.then(Ql)}}(),ai||(oi(),ai=!0),li.add(n,e)}var ai=!1,li=new class zl{constructor(){this.h=this.g=null}add(e,t){const r=$o.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function Ql(){for(var n;n=jo();){try{n.h.call(n.g)}catch(t){Wl(t)}var e=$o;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}ai=!1}function Fr(n,e){ie.call(this),this.h=n||1,this.g=e||R,this.j=Te(this.lb,this),this.l=Date.now()}function ui(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function ci(n,e,t){if("function"==typeof n)t&&(n=Te(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Te(n.handleEvent,n)}return 2147483647<Number(e)?-1:R.setTimeout(n,e||0)}function zo(n){n.g=ci(()=>{n.g=null,n.i&&(n.i=!1,zo(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Ae(Fr,ie),(N=Fr.prototype).ca=!1,N.R=null,N.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),xe(this,"tick"),this.ca&&(ui(this),this.start()))}},N.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},N.M=function(){Fr.X.M.call(this),ui(this),delete this.g};class Zl extends Ke{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:zo(this)}M(){super.M(),this.g&&(R.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Un(n){Ke.call(this),this.h=n,this.g={}}Ae(Un,Ke);var Ho=[];function Wo(n,e,t,r){Array.isArray(t)||(t&&(Ho[0]=t.toString()),t=Ho);for(var s=0;s<t.length;s++){var i=Uo(e,t[s],r||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function hi(n){Qs(n.g,function(e,t){this.g.hasOwnProperty(t)&&ri(e)},n),n.g={}}function Lr(){this.g=!0}function en(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function qn(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<s.length;o++)s[o]=""}}}return Rn(t)}catch{return e}}(n,t)+(r?" "+r:"")})}Un.prototype.M=function(){Un.X.M.call(this),hi(this)},Un.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Lr.prototype.Aa=function(){this.g=!1},Lr.prototype.info=function(){};var Lt={},Qo=null;function Br(){return Qo=Qo||new ie}function di(n){Ne.call(this,Lt.Pa,n)}function tn(n){const e=Br();xe(e,new di(e))}function fi(n,e){Ne.call(this,Lt.STAT_EVENT,n),this.stat=e}function Ue(n){const e=Br();xe(e,new fi(e,n))}function Zo(n,e){Ne.call(this,Lt.Qa,n),this.size=e}function Gn(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){n()},e)}Lt.Pa="serverreachability",Ae(di,Ne),Lt.STAT_EVENT="statevent",Ae(fi,Ne),Lt.Qa="timingevent",Ae(Zo,Ne);var Ur={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},Yo={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function pi(){}function Xo(){}pi.prototype.h=null;var Gr,jn={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function mi(){Ne.call(this,"d")}function qr(){Ne.call(this,"c")}function nn(){}function $n(n,e,t,r){this.l=n,this.j=e,this.m=t,this.U=r||1,this.S=new Un(this),this.O=Jl,this.T=new Fr(n=js?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Jo}function Jo(){this.i=null,this.g="",this.h=!1}Ae(mi,Ne),Ae(qr,Ne),Ae(nn,pi),nn.prototype.g=function(){return new XMLHttpRequest},nn.prototype.i=function(){return{}},Gr=new nn;var Jl=45e3,gi={},jr={};function yi(n,e,t){n.K=1,n.v=Hr(ft(e)),n.s=t,n.P=!0,ea(n,null)}function ea(n,e){n.F=Date.now(),rn(n),n.A=ft(n.v);var t=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),bi(t.i,"t",r),n.C=0,t=n.l.H,n.h=new Jo,n.g=td(n.l,t?e:null,!n.s),0<n.N&&(n.L=new Zl(Te(n.La,n,n.g),n.N)),Wo(n.S,n.g,"readystatechange",n.ib),e=n.H?Ro(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),tn(),function Rr(n,e,t,r,s,i){n.info(function(){if(n.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var h=a[c].split("=");if(1<h.length){var p=h[0];h=h[1];var m=p.split("_");o=2<=m.length&&"type"==m[1]?o+(p+"=")+h+"&":o+(p+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+"\n"+t+"\n"+o})}(n.j,n.u,n.A,n.m,n.U,n.s)}function ta(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function wi(n,e,t){let s,r=!0;for(;!n.I&&n.C<t.length;){if(s=vi(n,t),s==jr){4==e&&(n.o=4,Ue(14),r=!1),en(n.j,n.m,null,"[Incomplete Response]");break}if(s==gi){n.o=4,Ue(15),en(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}en(n.j,n.m,s,null),_i(n,s)}ta(n)&&s!=jr&&s!=gi&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Ue(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),g(e),e.K=!0,Ue(11))):(en(n.j,n.m,t,"[Invalid Chunked Response]"),Ut(n),Kn(n))}function vi(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?jr:(t=Number(e.substring(t,r)),isNaN(t)?gi:(r+=1)+t>e.length?jr:(e=e.substr(r,t),n.C=r+t,e))}function rn(n){n.V=Date.now()+n.O,Bt(n,n.O)}function Bt(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Gn(Te(n.gb,n),e)}function $r(n){n.B&&(R.clearTimeout(n.B),n.B=null)}function Kn(n){0==n.l.G||n.I||ee(n.l,n)}function Ut(n){$r(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,ui(n.T),hi(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function _i(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||xi(t.h,n)))if(!n.J&&xi(t.h,n)&&3==t.G){try{var r=t.Fa.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;F(t),Jr(t)}f(t),Ue(18)}}else t.Ba=s[1],0<t.Ba-t.T&&37500>s[2]&&t.L&&0==t.A&&!t.v&&(t.v=Gn(Te(t.cb,t),6e3));if(1>=ca(t.h)&&t.ja){try{t.ja()}catch{}t.ja=void 0}}else pe(t,11)}else if((n.J||t.g==n)&&F(t),!Dr(e))for(s=t.Fa.g.parse(e),e=0;e<s.length;e++){let h=s[e];if(t.T=h[0],h=h[1],2==t.G)if("c"==h[0]){t.I=h[1],t.ka=h[2];const p=h[3];null!=p&&(t.ma=p,t.j.info("VER="+t.ma));const m=h[4];null!=m&&(t.Ca=m,t.j.info("SVER="+t.Ca));const y=h[5];null!=y&&"number"==typeof y&&0<y&&(t.J=r=1.5*y,t.j.info("backChannelRequestTimeoutMs_="+r)),r=t;const v=n.g;if(v){const E=v.g?v.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(E){var i=r.h;i.g||-1==E.indexOf("spdy")&&-1==E.indexOf("quic")&&-1==E.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(Ei(i,i.h),i.h=null))}if(r.D){const I=v.g?v.g.getResponseHeader("X-HTTP-Session-Id"):null;I&&(r.za=I,re(r.F,r.D,I))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var o=n;if((r=t).sa=ts(r,r.H?r.ka:null,r.V),o.J){Ti(r.h,o);var a=o,c=r.J;c&&a.setTimeout(c),a.B&&($r(a),rn(a)),r.g=o}else u(r);0<t.i.length&&es(t)}else"stop"!=h[0]&&"close"!=h[0]||pe(t,7);else 3==t.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?pe(t,7):Mi(t):"noop"!=h[0]&&t.l&&t.l.wa(h),t.A=0)}tn()}catch{}}function na(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(Pn(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function tu(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Pn(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function eu(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(Pn(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],t&&t[i],n)}(N=$n.prototype).setTimeout=function(n){this.O=n},N.ib=function(n){n=n.target;const e=this.L;e&&3==wt(n)?e.l():this.La(n)},N.La=function(n){try{if(n==this.g)e:{const p=wt(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>p)&&(3!=p||js||this.g&&(this.h.h||this.g.fa()||ga(this.g)))){this.I||4!=p||7==e||tn(),$r(this);var t=this.g.aa();this.Y=t;t:if(ta(this)){var r=ga(this.g);n="";var s=r.length,i=4==wt(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Ut(this),Kn(this);var o="";break t}this.h.i=new R.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==t,function Yl(n,e,t,r,s,i,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+"\n"+t+"\n"+i+" "+o})}(this.j,this.u,this.A,this.m,this.U,p,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Dr(a)){var h=a;break t}}h=null}if(!(t=h)){this.i=!1,this.o=3,Ue(12),Ut(this),Kn(this);break e}en(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,_i(this,t)}this.P?(wi(this,p,o),js&&this.i&&3==p&&(Wo(this.S,this.T,"tick",this.hb),this.T.start())):(en(this.j,this.m,o,null),_i(this,o)),4==p&&Ut(this),this.i&&!this.I&&(4==p?ee(this.l,this):(this.i=!1,rn(this)))}else 400==t&&0<o.indexOf("Unknown SID")?(this.o=3,Ue(12)):(this.o=0,Ue(13)),Ut(this),Kn(this)}}}catch{}},N.hb=function(){if(this.g){var n=wt(this.g),e=this.g.fa();this.C<e.length&&($r(this),wi(this,n,e),this.i&&4!=n&&rn(this))}},N.cancel=function(){this.I=!0,Ut(this)},N.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function Xl(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(tn(),Ue(17)),Ut(this),this.o=2,Kn(this)):Bt(this,this.V-n)};var ra=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yt(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof yt){this.h=void 0!==e?e:n.h,Kr(this,n.j),this.s=n.s,this.g=n.g,zr(this,n.m),this.l=n.l,e=n.i;var t=new zn;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),sa(this,t),this.o=n.o}else n&&(t=String(n).match(ra))?(this.h=!!e,Kr(this,t[1]||"",!0),this.s=qt(t[2]||""),this.g=qt(t[3]||"",!0),zr(this,t[4]),this.l=qt(t[5]||"",!0),sa(this,t[6]||"",!0),this.o=qt(t[7]||"")):(this.h=!!e,this.i=new zn(null,this.h))}function ft(n){return new yt(n)}function Kr(n,e,t){n.j=t?qt(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function zr(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function sa(n,e,t){e instanceof zn?(n.i=e,function ou(n,e){e&&!n.j&&(xt(n),n.i=null,n.g.forEach(function(t,r){var s=r.toLowerCase();r!=s&&(oa(this,r),bi(this,s,t))},n)),n.j=e}(n.i,n.h)):(t||(e=sn(e,iu)),n.i=new zn(e,n.h))}function re(n,e,t){n.i.set(e,t)}function Hr(n){return re(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function qt(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function sn(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,ia),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function ia(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}yt.prototype.toString=function(){var n=[],e=this.j;e&&n.push(sn(e,Wr,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(sn(e,Wr,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(sn(t,"/"==t.charAt(0)?su:ru,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",sn(t,Qr)),n.join("")};var Wr=/[#\/\?@]/g,ru=/[#\?:]/g,su=/[#\?]/g,iu=/[#\?@]/g,Qr=/#/g;function zn(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function xt(n){n.g||(n.g=new Map,n.h=0,n.i&&function nu(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),s=null;if(0<=r){var i=n[t].substring(0,r);s=n[t].substring(r+1)}else i=n[t];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function oa(n,e){xt(n),e=on(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function aa(n,e){return xt(n),e=on(n,e),n.g.has(e)}function bi(n,e,t){oa(n,e),0<t.length&&(n.i=null,n.g.set(on(n,e),Bs(t)),n.h+=t.length)}function on(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function la(n){this.l=n||ua,n=R.PerformanceNavigationTiming?0<(n=R.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(R.g&&R.g.Ga&&R.g.Ga()&&R.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(N=zn.prototype).add=function(n,e){xt(this),this.i=null,n=on(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},N.forEach=function(n,e){xt(this),this.g.forEach(function(t,r){t.forEach(function(s){n.call(e,s,r,this)},this)},this)},N.oa=function(){xt(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const s=n[r];for(let i=0;i<s.length;i++)t.push(e[r])}return t},N.W=function(n){xt(this);let e=[];if("string"==typeof n)aa(this,n)&&(e=e.concat(this.g.get(on(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},N.set=function(n,e){return xt(this),this.i=null,aa(this,n=on(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},N.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},N.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const i=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var s=i;""!==o[r]&&(s+="="+encodeURIComponent(String(o[r]))),n.push(s)}}return this.i=n.join("&")};var ua=10;function Ci(n){return!!n.h||!!n.g&&n.g.size>=n.j}function ca(n){return n.h?1:n.g?n.g.size:0}function xi(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function Ei(n,e){n.g?n.g.add(e):n.h=e}function Ti(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function Zr(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return Bs(n.i)}function Ai(){}function lu(){this.g=new Ai}function uu(n,e,t){const r=t||"";try{na(n,function(s,i){let o=s;Vt(s)&&(o=Rn(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function Hn(n,e,t,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function Wn(n){this.l=n.ac||null,this.j=n.jb||!1}function Yr(n,e){ie.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=Ii,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}la.prototype.cancel=function(){if(this.i=Zr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},Ai.prototype.stringify=function(n){return R.JSON.stringify(n,void 0)},Ai.prototype.parse=function(n){return R.JSON.parse(n,void 0)},Ae(Wn,pi),Wn.prototype.g=function(){return new Yr(this.l,this.j)},Wn.prototype.i=function(n){return function(){return n}}({}),Ae(Yr,ie);var Ii=0;function ha(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function Qn(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Zn(n)}function Zn(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(N=Yr.prototype).open=function(n,e){if(this.readyState!=Ii)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Zn(this)},N.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||R).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},N.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Qn(this)),this.readyState=Ii},N.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Zn(this)),this.g&&(this.readyState=3,Zn(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof R.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ha(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},N.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Qn(this):Zn(this),3==this.readyState&&ha(this)}},N.Va=function(n){this.g&&(this.response=this.responseText=n,Qn(this))},N.Ua=function(n){this.g&&(this.response=n,Qn(this))},N.ga=function(){this.g&&Qn(this)},N.setRequestHeader=function(n,e){this.v.append(n,e)},N.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},N.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(Yr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var hu=R.JSON.parse;function ce(n){ie.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=da,this.K=this.L=!1}Ae(ce,ie);var da="",Gt=/^https?$/i,fa=["POST","PUT"];function Si(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,pa(n),Xr(n)}function pa(n){n.D||(n.D=!0,xe(n,"complete"),xe(n,"error"))}function ma(n){if(n.h&&typeof Be<"u"&&(!n.C[1]||4!=wt(n)||2!=n.aa()))if(n.v&&4==wt(n))ci(n.Ha,0,n);else if(xe(n,"readystatechange"),4==wt(n)){n.h=!1;try{const a=n.aa();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===a){var s=String(n.H).match(ra)[1]||null;if(!s&&R.self&&R.self.location){var i=R.self.location.protocol;s=i.substr(0,i.length-1)}r=!Gt.test(s?s.toLowerCase():"")}t=r}if(t)xe(n,"complete"),xe(n,"success");else{n.m=6;try{var o=2<wt(n)?n.g.statusText:""}catch{o=""}n.j=o+" ["+n.aa()+"]",pa(n)}}finally{Xr(n)}}}function Xr(n,e){if(n.g){Di(n);const t=n.g,r=n.C[0]?Vn:null;n.g=null,n.C=null,e||xe(n,"ready");try{t.onreadystatechange=r}catch{}}}function Di(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(R.clearTimeout(n.A),n.A=null)}function wt(n){return n.g?n.g.readyState:0}function ga(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case da:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function ya(n){let e="";return Qs(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function nt(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=ya(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):re(n,e,t))}function pt(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function wa(n){this.Ca=0,this.i=[],this.j=new Lr,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=pt("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=pt("baseRetryDelayMs",5e3,n),this.bb=pt("retryDelaySeedMs",1e4,n),this.$a=pt("forwardChannelMaxRetries",2,n),this.ta=pt("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new la(n&&n.concurrentRequestLimit),this.Fa=new lu,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Mi(n){if(va(n),3==n.G){var e=n.U++,t=ft(n.F);re(t,"SID",n.I),re(t,"RID",e),re(t,"TYPE","terminate"),Et(n,t),(e=new $n(n,n.j,e,void 0)).K=2,e.v=Hr(ft(t)),t=!1,R.navigator&&R.navigator.sendBeacon&&(t=R.navigator.sendBeacon(e.v.toString(),"")),!t&&R.Image&&((new Image).src=e.v,t=!0),t||(e.g=td(e.l,null),e.g.da(e.v)),e.F=Date.now(),rn(e)}jt(n)}function Jr(n){n.g&&(g(n),n.g.cancel(),n.g=null)}function va(n){Jr(n),n.u&&(R.clearTimeout(n.u),n.u=null),F(n),n.h.cancel(),n.m&&("number"==typeof n.m&&R.clearTimeout(n.m),n.m=null)}function es(n){Ci(n.h)||n.m||(n.m=!0,Ko(n.Ja,n),n.C=0)}function _a(n,e){var t;t=e?e.m:n.U++;const r=ft(n.F);re(r,"SID",n.I),re(r,"RID",t),re(r,"AID",n.T),Et(n,r),n.o&&n.s&&nt(r,n.o,n.s),t=new $n(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=l(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),Ei(n.h,t),yi(t,r,e)}function Et(n,e){n.ia&&Qs(n.ia,function(t,r){re(e,r,t)}),n.l&&na({},function(t,r){re(e,r,t)})}function l(n,e,t){t=Math.min(n.i.length,t);var r=n.l?Te(n.l.Ra,n.l,n):null;e:{var s=n.i;let i=-1;for(;;){const o=["count="+t];-1==i?0<t?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<t;c++){let h=s[c].h;const p=s[c].g;if(h-=i,0>h)i=Math.max(0,s[c].h-100),a=!1;else try{uu(p,o,"req"+h+"_")}catch{r&&r(p)}}if(a){r=o.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,r}function u(n){n.g||n.u||(n.Z=1,Ko(n.Ia,n),n.A=0)}function f(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Gn(Te(n.Ia,n),ze(n,n.A)),n.A++,0))}function g(n){null!=n.B&&(R.clearTimeout(n.B),n.B=null)}function x(n){n.g=new $n(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=ft(n.sa);re(e,"RID","rpc"),re(e,"SID",n.I),re(e,"CI",n.L?"0":"1"),re(e,"AID",n.T),re(e,"TYPE","xmlhttp"),Et(n,e),n.o&&n.s&&nt(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=Hr(ft(e)),t.s=null,t.P=!0,ea(t,n)}function F(n){null!=n.v&&(R.clearTimeout(n.v),n.v=null)}function ee(n,e){var t=null;if(n.g==e){F(n),g(n),n.g=null;var r=2}else{if(!xi(n.h,e))return;t=e.D,Ti(n.h,e),r=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var s=n.C;xe(r=Br(),new Zo(r,t)),es(n)}else u(n);else if(3==(s=e.o)||0==s&&0<n.pa||!(1==r&&function fu(n,e){return!(ca(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=Gn(Te(n.Ja,n,e),ze(n,n.C)),n.C++,0)))}(n,e)||2==r&&f(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),s){case 1:pe(n,5);break;case 4:pe(n,10);break;case 3:pe(n,6);break;default:pe(n,2)}}function ze(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function pe(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var r=Te(n.kb,n);t||(t=new yt("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||Kr(t,"https"),Hr(t)),function cu(n,e){const t=new Lr;if(R.Image){const r=new Image;r.onload=Sr(Hn,t,r,"TestLoadImage: loaded",!0,e),r.onerror=Sr(Hn,t,r,"TestLoadImage: error",!1,e),r.onabort=Sr(Hn,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=Sr(Hn,t,r,"TestLoadImage: timeout",!1,e),R.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else Ue(2);n.G=0,n.l&&n.l.va(e),jt(n),va(n)}function jt(n){if(n.G=0,n.la=[],n.l){const e=Zr(n.h);(0!=e.length||0!=n.i.length)&&(No(n.la,e),No(n.la,n.i),n.h.i.length=0,Bs(n.i),n.i.length=0),n.l.ua()}}function ts(n,e,t){var r=t instanceof yt?ft(t):new yt(t,void 0);if(""!=r.g)e&&(r.g=e+"."+r.g),zr(r,r.m);else{var s=R.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new yt(null,void 0);r&&Kr(i,r),e&&(i.g=e),s&&zr(i,s),t&&(i.l=t),r=i}return e=n.za,(t=n.D)&&e&&re(r,t,e),re(r,"VER",n.ma),Et(n,r),r}function td(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new ce(t&&n.Da&&!n.ra?new Wn({jb:!0}):n.ra)).Ka(n.H),e}function nd(){}function ba(){if(Jt&&!(10<=Number(Nr)))throw Error("Environmental error: no available transport.")}function at(n,e){ie.call(this),this.g=new wa(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!Dr(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Dr(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new ns(this)}function rd(n){mi.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function sd(){qr.call(this),this.status=1}function ns(n){this.g=n}(N=ce.prototype).Ka=function(n){this.L=n},N.da=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Gr.g(),this.C=function Rt(n){return n.h||(n.h=n.i())}(this.u?this.u:Gr),this.g.onreadystatechange=Te(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(i){return void Si(this,i)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)t.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const i of r.keys())t.set(i,r.get(i))}r=Array.from(t.keys()).find(i=>"content-type"==i.toLowerCase()),s=R.FormData&&n instanceof R.FormData,!(0<=ko(fa,e))||r||s||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of t)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Di(this),0<this.B&&((this.K=function du(n){return Jt&&function Hs(){return function Bl(n){var e=ql;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=Oo(String(kr)).split("."),t=Oo("9").split("."),r=Math.max(e.length,t.length);for(let o=0;0==n&&o<r;o++){var s=e[o]||"",i=t[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],0==s[0].length&&0==i[0].length)break;n=Pt(0==s[1].length?0:parseInt(s[1],10),0==i[1].length?0:parseInt(i[1],10))||Pt(0==s[2].length,0==i[2].length)||Pt(s[2],i[2]),s=s[3],i=i[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Te(this.qa,this)):this.A=ci(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){Si(this,i)}},N.qa=function(){typeof Be<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,xe(this,"timeout"),this.abort(8))},N.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,xe(this,"complete"),xe(this,"abort"),Xr(this))},N.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Xr(this,!0)),ce.X.M.call(this)},N.Ha=function(){this.s||(this.F||this.v||this.l?ma(this):this.fb())},N.fb=function(){ma(this)},N.aa=function(){try{return 2<wt(this)?this.g.status:-1}catch{return-1}},N.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},N.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),hu(e)}},N.Ea=function(){return this.m},N.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(N=wa.prototype).ma=8,N.G=1,N.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const s=new $n(this,this.j,n,void 0);let i=this.s;if(this.S&&(i?(i=Ro(i),Bo(i,this.S)):i=this.S),null!==this.o||this.N||(s.H=i,i=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var r=this.i[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=l(this,s,e),re(t=ft(this.F),"RID",n),re(t,"CVER",22),this.D&&re(t,"X-HTTP-Session-Id",this.D),Et(this,t),i&&(this.N?e="headers="+encodeURIComponent(String(ya(i)))+"&"+e:this.o&&nt(t,this.o,i)),Ei(this.h,s),this.Ya&&re(t,"TYPE","init"),this.O?(re(t,"$req",e),re(t,"SID","null"),s.Z=!0,yi(s,t,null)):yi(s,t,e),this.G=2}}else 3==this.G&&(n?_a(this,n):0==this.i.length||Ci(this.h)||_a(this))},N.Ia=function(){if(this.u=null,x(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Gn(Te(this.eb,this),n)}},N.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Ue(10),Jr(this),x(this))},N.cb=function(){null!=this.v&&(this.v=null,Jr(this),f(this),Ue(19))},N.kb=function(n){n?(this.j.info("Successfully pinged google.com"),Ue(2)):(this.j.info("Failed to ping google.com"),Ue(1))},(N=nd.prototype).xa=function(){},N.wa=function(){},N.va=function(){},N.ua=function(){},N.Ra=function(){},ba.prototype.g=function(n,e){return new at(n,e)},Ae(at,ie),at.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;Ue(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=ts(n,null,n.V),es(n)},at.prototype.close=function(){Mi(this.g)},at.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=Rn(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.ab++,n)),3==e.G&&es(e)},at.prototype.M=function(){this.g.l=null,delete this.j,Mi(this.g),delete this.g,at.X.M.call(this)},Ae(rd,mi),Ae(sd,qr),Ae(ns,nd),ns.prototype.xa=function(){xe(this.g,"a")},ns.prototype.wa=function(n){xe(this.g,new rd(n))},ns.prototype.va=function(n){xe(this.g,new sd)},ns.prototype.ua=function(){xe(this.g,"b")},ba.prototype.createWebChannel=ba.prototype.g,at.prototype.send=at.prototype.u,at.prototype.open=at.prototype.m,at.prototype.close=at.prototype.close,Ur.NO_ERROR=0,Ur.TIMEOUT=8,Ur.HTTP_ERROR=6,Yo.COMPLETE="complete",Xo.EventType=jn,jn.OPEN="a",jn.CLOSE="b",jn.ERROR="c",jn.MESSAGE="d",ie.prototype.listen=ie.prototype.N,ce.prototype.listenOnce=ce.prototype.O,ce.prototype.getLastError=ce.prototype.Oa,ce.prototype.getLastErrorCode=ce.prototype.Ea,ce.prototype.getStatus=ce.prototype.aa,ce.prototype.getResponseJson=ce.prototype.Sa,ce.prototype.getResponseText=ce.prototype.fa,ce.prototype.send=ce.prototype.da,ce.prototype.setWithCredentials=ce.prototype.Ka;var jg=ht.createWebChannelTransport=function(){return new ba},$g=ht.getStatEventTarget=function(){return Br()},pu=ht.ErrorCode=Ur,Kg=ht.EventType=Yo,zg=ht.Event=Lt,id=ht.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Hg=ht.FetchXmlHttpFactory=Wn,Ca=ht.WebChannel=Xo,Wg=ht.XhrIo=ce;const od="@firebase/firestore";class Oe{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Oe.UNAUTHENTICATED=new Oe(null),Oe.GOOGLE_CREDENTIALS=new Oe("google-credentials-uid"),Oe.FIRST_PARTY=new Oe("first-party-uid"),Oe.MOCK_USER=new Oe("mock-user");let rs="9.17.2";const an=new tt.Yd("@firebase/firestore");function mu(){return an.logLevel}function A(n,...e){if(an.logLevel<=tt.in.DEBUG){const t=e.map(gu);an.debug(`Firestore (${rs}): ${n}`,...t)}}function we(n,...e){if(an.logLevel<=tt.in.ERROR){const t=e.map(gu);an.error(`Firestore (${rs}): ${n}`,...t)}}function Yn(n,...e){if(an.logLevel<=tt.in.WARN){const t=e.map(gu);an.warn(`Firestore (${rs}): ${n}`,...t)}}function gu(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function M(n="Unexpected state"){const e=`FIRESTORE (${rs}) INTERNAL ASSERTION FAILED: `+n;throw we(e),new Error(e)}function V(n,e){n||M()}function D(n,e){return n}const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class T extends U.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ie{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class ad{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Yg{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Oe.UNAUTHENTICATED))}shutdown(){}}class Xg{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Jg{constructor(e){this.t=e,this.currentUser=Oe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let s=this.i;const i=h=>this.i!==s?(s=this.i,t(h)):Promise.resolve();let o=new Ie;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ie,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const h=o;e.enqueueRetryable((0,w.Z)(function*(){yield h.promise,yield i(r.currentUser)}))},c=h=>{A("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>c(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?c(h):(A("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ie)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(A("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(V("string"==typeof r.accessToken),new ad(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return V(null===e||"string"==typeof e),new Oe(e)}}class ey{constructor(e,t,r,s){this.h=e,this.l=t,this.m=r,this.g=s,this.type="FirstParty",this.user=Oe.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(V(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class ty{constructor(e,t,r,s){this.h=e,this.l=t,this.m=r,this.g=s}getToken(){return Promise.resolve(new ey(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(Oe.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ld{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ny{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const r=i=>{null!=i.error&&A("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,A("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{A("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?s(i):A("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(V("string"==typeof t.token),this.A=t.token,new ld(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function ry(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class ud{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=ry(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function q(n,e){return n<e?-1:n>e?1:0}function ss(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function cd(n){return n+"\0"}class he{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new T(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new T(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new T(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new T(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return he.fromMillis(Date.now())}static fromDate(e){return he.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new he(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?q(this.nanoseconds,e.nanoseconds):q(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class L{constructor(e){this.timestamp=e}static fromTimestamp(e){return new L(e)}static min(){return new L(new he(0,0))}static max(){return new L(new he(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class ki{constructor(e,t,r){void 0===t?t=0:t>e.length&&M(),void 0===r?r=e.length-t:r>e.length-t&&M(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===ki.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ki?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Q extends ki{construct(e,t,r){return new Q(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new T(b.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new Q(t)}static emptyPath(){return new Q([])}}const sy=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class me extends ki{construct(e,t,r){return new me(e,t,r)}static isValidIdentifier(e){return sy.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),me.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new me(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(0===r.length)throw new T(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if("\\"===a){if(s+1===e.length)throw new T(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new T(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else"`"===a?(o=!o,s++):"."!==a||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new T(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new me(t)}static emptyPath(){return new me([])}}class S{constructor(e){this.path=e}static fromPath(e){return new S(Q.fromString(e))}static fromName(e){return new S(Q.fromString(e).popFirst(5))}static empty(){return new S(Q.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Q.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Q.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new S(new Q(e.slice()))}}class xa{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function yu(n){return n.fields.find(e=>2===e.kind)}function Xn(n){return n.fields.filter(e=>2!==e.kind)}xa.UNKNOWN_ID=-1;class Ea{constructor(e,t){this.fieldPath=e,this.kind=t}}class Ni{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ni(0,lt.min())}}function hd(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=L.fromTimestamp(1e9===r?new he(t+1,0):new he(t,r));return new lt(s,S.empty(),e)}function dd(n){return new lt(n.readTime,n.key,-1)}class lt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new lt(L.min(),S.empty(),-1)}static max(){return new lt(L.max(),S.empty(),-1)}}function wu(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=S.comparator(n.documentKey,e.documentKey),0!==t?t:q(n.largestBatchId,e.largestBatchId))}const fd="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class pd{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function ln(n){return vu.apply(this,arguments)}function vu(){return vu=(0,w.Z)(function*(n){if(n.code!==b.FAILED_PRECONDITION||n.message!==fd)throw n;A("LocalStore","Unexpectedly lost primary lease")}),vu.apply(this,arguments)}class _{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&M(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new _((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof _?t:_.resolve(t)}catch(t){return _.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):_.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):_.reject(t)}static resolve(e){return new _((t,r)=>{t(e)})}static reject(e){return new _((t,r)=>{r(e)})}static waitFor(e){return new _((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},c=>r(c))}),o=!0,i===s&&t()})}static or(e){let t=_.resolve(!1);for(const r of e)t=t.next(s=>s?_.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new _((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const h=c;t(e[h]).next(p=>{o[h]=p,++a,a===i&&r(o)},p=>s(p))}})}static doWhile(e,t){return new _((r,s)=>{const i=()=>{!0===e()?t().next(()=>{i()},s):r()};i()})}}class Ta{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.v=new Ie,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{t.error?this.v.reject(new Oi(e,t.error)):this.v.resolve()},this.transaction.onerror=r=>{const s=_u(r.target.error);this.v.reject(new Oi(e,s))}}static open(e,t,r,s){try{return new Ta(t,e.transaction(s,r))}catch(i){throw new Oi(t,i)}}get P(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(A("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new ly(t)}}class vt{constructor(e,t,r){this.name=e,this.version=t,this.S=r,12.2===vt.D((0,U.z$)())&&we("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return A("SimpleDb","Removing database:",e),Jn(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!(0,U.hl)())return!1;if(vt.N())return!0;const e=(0,U.z$)(),t=vt.D(e),r=0<t&&t<10,s=vt.k(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static N(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.O)}static M(e,t){return e.store(t)}static D(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static k(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}F(e){var t=this;return(0,w.Z)(function*(){return t.db||(A("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,s)=>{const i=indexedDB.open(t.name,t.version);i.onsuccess=o=>{r(o.target.result)},i.onblocked=()=>{s(new Oi(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const a=o.target.error;s("VersionError"===a.name?new T(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new T(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new Oi(e,a))},i.onupgradeneeded=o=>{A("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',o.oldVersion),t.S.$(o.target.result,i.transaction,o.oldVersion,t.version).next(()=>{A("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,s){var i=this;return(0,w.Z)(function*(){const o="readonly"===t;let a=0;for(;;){++a;try{i.db=yield i.F(e);const c=Ta.open(i.db,e,o?"readonly":"readwrite",r),h=s(c).next(p=>(c.V(),p)).catch(p=>(c.abort(p),_.reject(p))).toPromise();return h.catch(()=>{}),yield c.P,h}catch(c){const h=c,p="FirebaseError"!==h.name&&a<3;if(A("SimpleDb","Transaction failed with error:",h.message,"Retrying:",p),i.close(),!p)return Promise.reject(h)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class ay{constructor(e){this.q=e,this.U=!1,this.K=null}get isDone(){return this.U}get G(){return this.K}set cursor(e){this.q=e}done(){this.U=!0}j(e){this.K=e}delete(){return Jn(this.q.delete())}}class Oi extends T{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function un(n){return"IndexedDbTransactionError"===n.name}class ly{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(A("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(A("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Jn(r)}add(e){return A("SimpleDb","ADD",this.store.name,e,e),Jn(this.store.add(e))}get(e){return Jn(this.store.get(e)).next(t=>(void 0===t&&(t=null),A("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return A("SimpleDb","DELETE",this.store.name,e),Jn(this.store.delete(e))}count(){return A("SimpleDb","COUNT",this.store.name),Jn(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const s=this.cursor(r),i=[];return this.H(s,(o,a)=>{i.push(a)}).next(()=>i)}{const s=this.store.getAll(r.range);return new _((i,o)=>{s.onerror=a=>{o(a.target.error)},s.onsuccess=a=>{i(a.target.result)}})}}J(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new _((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Y(e,t){A("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.Z=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}X(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.H(s,t)}tt(e){const t=this.cursor({});return new _((r,s)=>{t.onerror=i=>{const o=_u(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,t){const r=[];return new _((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new ay(a),h=t(a.primaryKey,a.value,c);if(h instanceof _){const p=h.catch(m=>(c.done(),_.reject(m)));r.push(p)}c.isDone?s():null===c.G?a.continue():a.continue(c.G)}}).next(()=>_.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Z?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Jn(n){return new _((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const s=_u(r.target.error);t(s)}})}let md=!1;function _u(n){const e=vt.D((0,U.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new T("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return md||(md=!0,setTimeout(()=>{throw r},0)),r}}return n}class uy{constructor(e,t){this.asyncQueue=e,this.et=t,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}nt(e){var t=this;A("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,w.Z)(function*(){t.task=null;try{A("IndexBackiller",`Documents written: ${yield t.et.st()}`)}catch(r){un(r)?A("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield ln(r)}yield t.nt(6e4)}))}}class cy{constructor(e,t){this.localStore=e,this.persistence=t}st(e=50){var t=this;return(0,w.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.it(r,e))})()}it(e,t){const r=new Set;let s=t,i=!0;return _.doWhile(()=>!0===i&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!r.has(o))return A("IndexBackiller",`Processing collection: ${o}`),this.rt(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}rt(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ot(s,i)).next(a=>(A("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}ot(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=dd(i);wu(o,r)>0&&(r=o)}),new lt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}let ut=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=s=>this.ut(s),this.ct=s=>r.writeSequenceNumber(s))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}return n.at=-1,n})();class fy{constructor(e,t,r,s,i,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=c}}class cn{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new cn("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof cn&&e.projectId===this.projectId&&e.database===this.database}}function gd(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function er(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function yd(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Vi(n){return null==n}function Pi(n){return 0===n&&1/n==-1/0}function wd(n){return"number"==typeof n&&Number.isInteger(n)&&!Pi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}class py extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Se{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(s){throw s instanceof DOMException?new py("Invalid base64 string: "+s):s}}(e);return new Se(t)}static fromUint8Array(e){const t=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new Se(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return q(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Se.EMPTY_BYTE_STRING=new Se("");const gy=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hn(n){if(V(!!n),"string"==typeof n){let e=0;const t=gy.exec(n);if(V(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ge(n.seconds),nanos:ge(n.nanos)}}function ge(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function tr(n){return"string"==typeof n?Se.fromBase64String(n):Se.fromUint8Array(n)}function Cu(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function vd(n){const e=n.mapValue.fields.__previous_value__;return Cu(e)?vd(e):e}function Fi(n){const e=hn(n.mapValue.fields.__local_write_time__.timestampValue);return new he(e.seconds,e.nanos)}const dn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Aa={nullValue:"NULL_VALUE"};function nr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Cu(n)?4:xd(n)?9007199254740991:10:M()}function Tt(n,e){if(n===e)return!0;const t=nr(n);if(t!==nr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Fi(n).isEqual(Fi(e));case 3:return function(r,s){if("string"==typeof r.timestampValue&&"string"==typeof s.timestampValue&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=hn(r.timestampValue),o=hn(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return s=e,tr(n.bytesValue).isEqual(tr(s.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return ge(r.geoPointValue.latitude)===ge(s.geoPointValue.latitude)&&ge(r.geoPointValue.longitude)===ge(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return ge(r.integerValue)===ge(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=ge(r.doubleValue),o=ge(s.doubleValue);return i===o?Pi(i)===Pi(o):isNaN(i)&&isNaN(o)}return!1}(n,e);case 9:return ss(n.arrayValue.values||[],e.arrayValue.values||[],Tt);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(gd(i)!==gd(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(void 0===o[a]||!Tt(i[a],o[a])))return!1;return!0}(n,e);default:return M()}var s}function Li(n,e){return void 0!==(n.values||[]).find(t=>Tt(t,e))}function fn(n,e){if(n===e)return 0;const t=nr(n),r=nr(e);if(t!==r)return q(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return q(n.booleanValue,e.booleanValue);case 2:return function(s,i){const o=ge(s.integerValue||s.doubleValue),a=ge(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(n,e);case 3:return _d(n.timestampValue,e.timestampValue);case 4:return _d(Fi(n),Fi(e));case 5:return q(n.stringValue,e.stringValue);case 6:return function(s,i){const o=tr(s),a=tr(i);return o.compareTo(a)}(n.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const h=q(o[c],a[c]);if(0!==h)return h}return q(o.length,a.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,i){const o=q(ge(s.latitude),ge(i.latitude));return 0!==o?o:q(ge(s.longitude),ge(i.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let c=0;c<o.length&&c<a.length;++c){const h=fn(o[c],a[c]);if(h)return h}return q(o.length,a.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===dn.mapValue&&i===dn.mapValue)return 0;if(s===dn.mapValue)return 1;if(i===dn.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),c=i.fields||{},h=Object.keys(c);a.sort(),h.sort();for(let p=0;p<a.length&&p<h.length;++p){const m=q(a[p],h[p]);if(0!==m)return m;const y=fn(o[a[p]],c[h[p]]);if(0!==y)return y}return q(a.length,h.length)}(n.mapValue,e.mapValue);default:throw M()}}function _d(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return q(n,e);const t=hn(n),r=hn(e),s=q(t.seconds,r.seconds);return 0!==s?s:q(t.nanos,r.nanos)}function is(n){return xu(n)}function xu(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const s=hn(r);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?tr(n.bytesValue).toBase64():"referenceValue"in n?S.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=xu(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of s)o?o=!1:i+=",",i+=`${a}:${xu(r.fields[a])}`;return i+"}"}(n.mapValue):M();var e}function rr(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Eu(n){return!!n&&"integerValue"in n}function Ri(n){return!!n&&"arrayValue"in n}function bd(n){return!!n&&"nullValue"in n}function Cd(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ia(n){return!!n&&"mapValue"in n}function Bi(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return er(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Bi(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Bi(n.arrayValue.values[t]);return e}return Object.assign({},n)}function xd(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function yy(n){return"nullValue"in n?Aa:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?rr(cn.empty(),S.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:M()}function wy(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?rr(cn.empty(),S.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?dn:M()}function Ed(n,e){const t=fn(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Td(n,e){const t=fn(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class pn{constructor(e,t){this.position=e,this.inclusive=t}}function Ad(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(r=i.field.isKeyField()?S.comparator(S.fromName(o.referenceValue),t.key):fn(o,t.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function Id(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Tt(n.position[t],e.position[t]))return!1;return!0}class Sd{}class H extends Sd{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new vy(e,t,r):"array-contains"===t?new Cy(e,r):"in"===t?new Vd(e,r):"not-in"===t?new xy(e,r):"array-contains-any"===t?new Ey(e,r):new H(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new _y(e,r):new by(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(fn(t,this.value)):null!==t&&nr(this.value)===nr(t)&&this.matchesComparison(fn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return M()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class te extends Sd{constructor(e,t){super(),this.filters=e,this.op=t,this.ft=null}static create(e,t){return new te(e,t)}matches(e){return os(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ft||(this.ft=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ft}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.dt(t=>t.isInequality());return null!==e?e.field:null}dt(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function os(n){return"and"===n.op}function Tu(n){return"or"===n.op}function Au(n){return Dd(n)&&os(n)}function Dd(n){for(const e of n.filters)if(e instanceof te)return!1;return!0}function Iu(n){if(n instanceof H)return n.field.canonicalString()+n.op.toString()+is(n.value);if(Au(n))return n.filters.map(e=>Iu(e)).join(",");{const e=n.filters.map(t=>Iu(t)).join(",");return`${n.op}(${e})`}}function Md(n,e){return n instanceof H?(t=n,(r=e)instanceof H&&t.op===r.op&&t.field.isEqual(r.field)&&Tt(t.value,r.value)):n instanceof te?function(t,r){return r instanceof te&&t.op===r.op&&t.filters.length===r.filters.length&&t.filters.reduce((s,i,o)=>s&&Md(i,r.filters[o]),!0)}(n,e):void M();var t,r}function kd(n,e){const t=n.filters.concat(e);return te.create(t,n.op)}function Nd(n){return n instanceof H?`${(e=n).field.canonicalString()} ${e.op} ${is(e.value)}`:n instanceof te?function(e){return e.op.toString()+" {"+e.getFilters().map(Nd).join(" ,")+"}"}(n):"Filter";var e}class vy extends H{constructor(e,t,r){super(e,t,r),this.key=S.fromName(r.referenceValue)}matches(e){const t=S.comparator(e.key,this.key);return this.matchesComparison(t)}}class _y extends H{constructor(e,t){super(e,"in",t),this.keys=Od(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class by extends H{constructor(e,t){super(e,"not-in",t),this.keys=Od(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Od(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>S.fromName(r.referenceValue))}class Cy extends H{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ri(t)&&Li(t.arrayValue,this.value)}}class Vd extends H{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Li(this.value.arrayValue,t)}}class xy extends H{constructor(e,t){super(e,"not-in",t)}matches(e){if(Li(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Li(this.value.arrayValue,t)}}class Ey extends H{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ri(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Li(this.value.arrayValue,r))}}class as{constructor(e,t="asc"){this.field=e,this.dir=t}}function Ty(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class ye{constructor(e,t){this.comparator=e,this.root=t||qe.EMPTY}insert(e,t){return new ye(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,qe.BLACK,null,null))}remove(e){return new ye(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qe.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(0===s)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sa(this.root,e,this.comparator,!0)}}class Sa{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qe{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??qe.RED,this.left=s??qe.EMPTY,this.right=i??qe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new qe(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):0===i?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return qe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===t(e,s.key)){if(s.right.isEmpty())return qe.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw M();const e=this.left.check();if(e!==this.right.check())throw M();return e+(this.isRed()?0:1)}}qe.EMPTY=null,qe.RED=!0,qe.BLACK=!1,qe.EMPTY=new class{constructor(){this.size=0}get key(){throw M()}get value(){throw M()}get color(){throw M()}get left(){throw M()}get right(){throw M()}copy(n,e,t,r,s){return this}insert(n,e,t){return new qe(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ne{constructor(e){this.comparator=e,this.data=new ye(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Pd(this.data.getIterator())}getIteratorFrom(e){return new Pd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof ne)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(0!==this.comparator(s,i))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ne(this.comparator);return t.data=e,t}}class Pd{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ls(n){return n.hasNext()?n.getNext():void 0}class rt{constructor(e){this.fields=e,e.sort(me.comparator)}static empty(){return new rt([])}unionWith(e){let t=new ne(me.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new rt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ss(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class Ve{constructor(e){this.value=e}static empty(){return new Ve({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ia(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bi(t)}setAll(e){let t=me.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=Bi(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Ia(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Tt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Ia(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){er(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Ve(Bi(this.value))}}function Fd(n){const e=[];return er(n.fields,(t,r)=>{const s=new me([t]);if(Ia(r)){const i=Fd(r.mapValue).fields;if(0===i.length)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new rt(e)}class oe{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new oe(e,0,L.min(),L.min(),L.min(),Ve.empty(),0)}static newFoundDocument(e,t,r,s){return new oe(e,1,t,L.min(),r,s,0)}static newNoDocument(e,t){return new oe(e,2,t,L.min(),L.min(),Ve.empty(),0)}static newUnknownDocument(e,t){return new oe(e,3,t,L.min(),L.min(),Ve.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(L.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ve.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ve.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=L.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof oe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new oe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ay{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this._t=null}}function Su(n,e=null,t=[],r=[],s=null,i=null,o=null){return new Ay(n,e,t,r,s,i,o)}function sr(n){const e=D(n);if(null===e._t){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Iu(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),Vi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>is(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>is(r)).join(",")),e._t=t}return e._t}function Ui(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Ty(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Md(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Id(n.startAt,e.startAt)&&Id(n.endAt,e.endAt)}function Da(n){return S.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function Ma(n,e){return n.filters.filter(t=>t instanceof H&&t.field.isEqual(e))}function Ld(n,e,t){let r=Aa,s=!0;for(const i of Ma(n,e)){let o=Aa,a=!0;switch(i.op){case"<":case"<=":o=yy(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Aa}Ed({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(null!==t)for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Ed({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}return{value:r,inclusive:s}}function Rd(n,e,t){let r=dn,s=!0;for(const i of Ma(n,e)){let o=dn,a=!0;switch(i.op){case">=":case">":o=wy(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=dn}Td({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(null!==t)for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Td({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}return{value:r,inclusive:s}}class $t{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.wt=null,this.gt=null}}function Bd(n,e,t,r,s,i,o,a){return new $t(n,e,t,r,s,i,o,a)}function us(n){return new $t(n)}function Ud(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function Du(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function ka(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function Mu(n){return null!==n.collectionGroup}function ir(n){const e=D(n);if(null===e.wt){e.wt=[];const t=ka(e),r=Du(e);if(null!==t&&null===r)t.isKeyField()||e.wt.push(new as(t)),e.wt.push(new as(me.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.wt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new as(me.keyField(),i))}}}return e.wt}function Ze(n){const e=D(n);if(!e.gt)if("F"===e.limitType)e.gt=Su(e.path,e.collectionGroup,ir(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const i of ir(e))t.push(new as(i.field,"desc"===i.dir?"asc":"desc"));const r=e.endAt?new pn(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new pn(e.startAt.position,e.startAt.inclusive):null;e.gt=Su(e.path,e.collectionGroup,t,e.filters,e.limit,r,s)}return e.gt}function ku(n,e){e.getFirstInequalityField(),ka(n);const t=n.filters.concat([e]);return new $t(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Na(n,e,t){return new $t(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function qi(n,e){return Ui(Ze(n),Ze(e))&&n.limitType===e.limitType}function qd(n){return`${sr(Ze(n))}|lt:${n.limitType}`}function Nu(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(r=>Nd(r)).join(", ")}]`),Vi(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(r=>{return`${(s=r).field.canonicalString()} (${s.dir})`;var s}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>is(r)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>is(r)).join(",")),`Target(${t})`}(Ze(n))}; limitType=${n.limitType})`}function Gi(n,e){return e.isFoundDocument()&&function(t,r){const s=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(s):S.isDocumentKey(t.path)?t.path.isEqual(s):t.path.isImmediateParentOf(s)}(n,e)&&function(t,r){for(const s of ir(t))if(!s.field.isKeyField()&&null===r.data.field(s.field))return!1;return!0}(n,e)&&function(t,r){for(const s of t.filters)if(!s.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(s,i,o){const a=Ad(s,i,o);return s.inclusive?a<=0:a<0}(t.startAt,ir(t),r)||t.endAt&&!function(s,i,o){const a=Ad(s,i,o);return s.inclusive?a>=0:a>0}(t.endAt,ir(t),r)));var t,r}function Gd(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function jd(n){return(e,t)=>{let r=!1;for(const s of ir(n)){const i=Iy(s,e,t);if(0!==i)return i;r=r||s.field.isKeyField()}return 0}}function Iy(n,e,t){const r=n.field.isKeyField()?S.comparator(e.key,t.key):function(s,i,o){const a=i.data.field(s),c=o.data.field(s);return null!==a&&null!==c?fn(a,c):M()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return M()}}function $d(n,e){if(n.yt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pi(e)?"-0":e}}function Kd(n){return{integerValue:""+n}}function zd(n,e){return wd(e)?Kd(e):$d(n,e)}class Oa{constructor(){this._=void 0}}function Sy(n,e,t){return n instanceof cs?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(t,e):n instanceof or?Wd(n,e):n instanceof ar?Qd(n,e):function(r,s){const i=Hd(r,s),o=Zd(i)+Zd(r.It);return Eu(i)&&Eu(r.It)?Kd(o):$d(r.Tt,o)}(n,e)}function Dy(n,e,t){return n instanceof or?Wd(n,e):n instanceof ar?Qd(n,e):t}function Hd(n,e){return n instanceof hs?Eu(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class cs extends Oa{}class or extends Oa{constructor(e){super(),this.elements=e}}function Wd(n,e){const t=Yd(e);for(const r of n.elements)t.some(s=>Tt(s,r))||t.push(r);return{arrayValue:{values:t}}}class ar extends Oa{constructor(e){super(),this.elements=e}}function Qd(n,e){let t=Yd(e);for(const r of n.elements)t=t.filter(s=>!Tt(s,r));return{arrayValue:{values:t}}}class hs extends Oa{constructor(e,t){super(),this.Tt=e,this.It=t}}function Zd(n){return ge(n.integerValue||n.doubleValue)}function Yd(n){return Ri(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class ji{constructor(e,t){this.field=e,this.transform=t}}class ky{constructor(e,t){this.version=e,this.transformResults=t}}class de{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new de}static exists(e){return new de(void 0,e)}static updateTime(e){return new de(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Va(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Pa{}function Xd(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new fs(n.key,de.none()):new ds(n.key,n.data,de.none());{const t=n.data,r=Ve.empty();let s=new ne(me.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);null===o&&i.length>1&&(i=i.popLast(),o=t.field(i)),null===o?r.delete(i):r.set(i,o),s=s.add(i)}return new Kt(n.key,r,new rt(s.toArray()),de.none())}}function Ny(n,e,t){n instanceof ds?function(r,s,i){const o=r.value.clone(),a=tf(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(n,e,t):n instanceof Kt?function(r,s,i){if(!Va(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=tf(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(ef(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function $i(n,e,t,r){return n instanceof ds?function(s,i,o,a){if(!Va(s.precondition,i))return o;const c=s.value.clone(),h=nf(s.fieldTransforms,a,i);return c.setAll(h),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Kt?function(s,i,o,a){if(!Va(s.precondition,i))return o;const c=nf(s.fieldTransforms,a,i),h=i.data;return h.setAll(ef(s)),h.setAll(c),i.convertToFoundDocument(i.version,h).setHasLocalMutations(),null===o?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,e,t,r):(o=t,Va(n.precondition,i=e)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o);var i,o}function Oy(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Hd(r.transform,s||null);null!=i&&(null===t&&(t=Ve.empty()),t.set(r.field,i))}return t||null}function Jd(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&ss(t,r,(s,i)=>function My(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof or&&r instanceof or||t instanceof ar&&r instanceof ar?ss(t.elements,r.elements,Tt):t instanceof hs&&r instanceof hs?Tt(t.It,r.It):t instanceof cs&&r instanceof cs);var t,r}(s,i))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class ds extends Pa{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Kt extends Pa{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ef(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function tf(n,e,t){const r=new Map;V(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,Dy(o,a,t[s]))}return r}function nf(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,Sy(i,o,e))}return r}class fs extends Pa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ou extends Pa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Vy{constructor(e){this.count=e}}var Ee,Z;function rf(n){switch(n){default:return M();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0}}function sf(n){if(void 0===n)return we("GRPC error has no .code"),b.UNKNOWN;switch(n){case Ee.OK:return b.OK;case Ee.CANCELLED:return b.CANCELLED;case Ee.UNKNOWN:return b.UNKNOWN;case Ee.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Ee.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Ee.INTERNAL:return b.INTERNAL;case Ee.UNAVAILABLE:return b.UNAVAILABLE;case Ee.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Ee.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Ee.NOT_FOUND:return b.NOT_FOUND;case Ee.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Ee.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Ee.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Ee.ABORTED:return b.ABORTED;case Ee.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Ee.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Ee.DATA_LOSS:return b.DATA_LOSS;default:return M()}}(Z=Ee||(Ee={}))[Z.OK=0]="OK",Z[Z.CANCELLED=1]="CANCELLED",Z[Z.UNKNOWN=2]="UNKNOWN",Z[Z.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Z[Z.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Z[Z.NOT_FOUND=5]="NOT_FOUND",Z[Z.ALREADY_EXISTS=6]="ALREADY_EXISTS",Z[Z.PERMISSION_DENIED=7]="PERMISSION_DENIED",Z[Z.UNAUTHENTICATED=16]="UNAUTHENTICATED",Z[Z.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Z[Z.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Z[Z.ABORTED=10]="ABORTED",Z[Z.OUT_OF_RANGE=11]="OUT_OF_RANGE",Z[Z.UNIMPLEMENTED=12]="UNIMPLEMENTED",Z[Z.INTERNAL=13]="INTERNAL",Z[Z.UNAVAILABLE=14]="UNAVAILABLE",Z[Z.DATA_LOSS=15]="DATA_LOSS";class mn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[s,i]of r)if(this.equalsFn(s,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(void 0===s)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return 1===r.length?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){er(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return yd(this.inner)}size(){return this.innerSize}}const Py=new ye(S.comparator);function st(){return Py}const of=new ye(S.comparator);function Ki(...n){let e=of;for(const t of n)e=e.insert(t.key,t);return e}function af(n){let e=of;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function At(){return zi()}function lf(){return zi()}function zi(){return new mn(n=>n.toString(),(n,e)=>n.isEqual(e))}const Fy=new ye(S.comparator),Ly=new ne(S.comparator);function $(...n){let e=Ly;for(const t of n)e=e.add(t);return e}const Ry=new ne(q);function Fa(){return Ry}class Hi{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Wi.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Hi(L.min(),s,Fa(),st(),$())}}class Wi{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Wi(r,t,$(),$(),$())}}class La{constructor(e,t,r,s){this.Et=e,this.removedTargetIds=t,this.key=r,this.At=s}}class uf{constructor(e,t){this.targetId=e,this.Rt=t}}class cf{constructor(e,t,r=Se.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class hf{constructor(){this.bt=0,this.vt=ff(),this.Pt=Se.EMPTY_BYTE_STRING,this.Vt=!1,this.St=!0}get current(){return this.Vt}get resumeToken(){return this.Pt}get Dt(){return 0!==this.bt}get Ct(){return this.St}xt(e){e.approximateByteSize()>0&&(this.St=!0,this.Pt=e)}Nt(){let e=$(),t=$(),r=$();return this.vt.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:M()}}),new Wi(this.Pt,this.Vt,e,t,r)}kt(){this.St=!1,this.vt=ff()}Ot(e,t){this.St=!0,this.vt=this.vt.insert(e,t)}Mt(e){this.St=!0,this.vt=this.vt.remove(e)}Ft(){this.bt+=1}$t(){this.bt-=1}Bt(){this.St=!0,this.Vt=!0}}class By{constructor(e){this.Lt=e,this.qt=new Map,this.Ut=st(),this.Kt=df(),this.Gt=new ne(q)}Qt(e){for(const t of e.Et)e.At&&e.At.isFoundDocument()?this.jt(t,e.At):this.zt(t,e.key,e.At);for(const t of e.removedTargetIds)this.zt(t,e.key,e.At)}Wt(e){this.forEachTarget(e,t=>{const r=this.Ht(t);switch(e.state){case 0:this.Jt(t)&&r.xt(e.resumeToken);break;case 1:r.$t(),r.Dt||r.kt(),r.xt(e.resumeToken);break;case 2:r.$t(),r.Dt||this.removeTarget(t);break;case 3:this.Jt(t)&&(r.Bt(),r.xt(e.resumeToken));break;case 4:this.Jt(t)&&(this.Yt(t),r.xt(e.resumeToken));break;default:M()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qt.forEach((r,s)=>{this.Jt(s)&&t(s)})}Zt(e){const t=e.targetId,r=e.Rt.count,s=this.Xt(t);if(s){const i=s.target;if(Da(i))if(0===r){const o=new S(i.path);this.zt(t,o,oe.newNoDocument(o,L.min()))}else V(1===r);else this.te(t)!==r&&(this.Yt(t),this.Gt=this.Gt.add(t))}}ee(e){const t=new Map;this.qt.forEach((i,o)=>{const a=this.Xt(o);if(a){if(i.current&&Da(a.target)){const c=new S(a.target.path);null!==this.Ut.get(c)||this.ne(o,c)||this.zt(o,c,oe.newNoDocument(c,e))}i.Ct&&(t.set(o,i.Nt()),i.kt())}});let r=$();this.Kt.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const h=this.Xt(c);return!h||2===h.purpose||(a=!1,!1)}),a&&(r=r.add(i))}),this.Ut.forEach((i,o)=>o.setReadTime(e));const s=new Hi(e,t,this.Gt,this.Ut,r);return this.Ut=st(),this.Kt=df(),this.Gt=new ne(q),s}jt(e,t){if(!this.Jt(e))return;const r=this.ne(e,t.key)?2:0;this.Ht(e).Ot(t.key,r),this.Ut=this.Ut.insert(t.key,t),this.Kt=this.Kt.insert(t.key,this.se(t.key).add(e))}zt(e,t,r){if(!this.Jt(e))return;const s=this.Ht(e);this.ne(e,t)?s.Ot(t,1):s.Mt(t),this.Kt=this.Kt.insert(t,this.se(t).delete(e)),r&&(this.Ut=this.Ut.insert(t,r))}removeTarget(e){this.qt.delete(e)}te(e){const t=this.Ht(e).Nt();return this.Lt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ft(e){this.Ht(e).Ft()}Ht(e){let t=this.qt.get(e);return t||(t=new hf,this.qt.set(e,t)),t}se(e){let t=this.Kt.get(e);return t||(t=new ne(q),this.Kt=this.Kt.insert(e,t)),t}Jt(e){const t=null!==this.Xt(e);return t||A("WatchChangeAggregator","Detected inactive target",e),t}Xt(e){const t=this.qt.get(e);return t&&t.Dt?null:this.Lt.ie(e)}Yt(e){this.qt.set(e,new hf),this.Lt.getRemoteKeysForTarget(e).forEach(t=>{this.zt(e,t,null)})}ne(e,t){return this.Lt.getRemoteKeysForTarget(e).has(t)}}function df(){return new ye(S.comparator)}function ff(){return new ye(S.comparator)}const Uy={asc:"ASCENDING",desc:"DESCENDING"},qy={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Gy={and:"AND",or:"OR"};class jy{constructor(e,t){this.databaseId=e,this.yt=t}}function ps(n,e){return n.yt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pf(n,e){return n.yt?e.toBase64():e.toUint8Array()}function $y(n,e){return ps(n,e.toTimestamp())}function ve(n){return V(!!n),L.fromTimestamp(function(e){const t=hn(e);return new he(t.seconds,t.nanos)}(n))}function Vu(n,e){return(t=n,new Q(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function mf(n){const e=Q.fromString(n);return V(Ef(e)),e}function Qi(n,e){return Vu(n.databaseId,e.path)}function It(n,e){const t=mf(e);if(t.get(1)!==n.databaseId.projectId)throw new T(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new T(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new S(yf(t))}function Pu(n,e){return Vu(n.databaseId,e)}function gf(n){const e=mf(n);return 4===e.length?Q.emptyPath():yf(e)}function Zi(n){return new Q(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function yf(n){return V(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function wf(n,e,t){return{name:Qi(n,e),fields:t.value.mapValue.fields}}function vf(n,e,t){const r=It(n,e.name),s=ve(e.updateTime),i=e.createTime?ve(e.createTime):L.min(),o=new Ve({mapValue:{fields:e.fields}}),a=oe.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function Yi(n,e){let t;if(e instanceof ds)t={update:wf(n,e.key,e.value)};else if(e instanceof fs)t={delete:Qi(n,e.key)};else if(e instanceof Kt)t={update:wf(n,e.key,e.data),updateMask:Xy(e.fieldMask)};else{if(!(e instanceof Ou))return M();t={verify:Qi(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof cs)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof or)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof ar)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof hs)return{fieldPath:i.field.canonicalString(),increment:o.It};throw M()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:$y(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:M()),t;var s}function Fu(n,e){const t=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?de.updateTime(ve(s.updateTime)):void 0!==s.exists?de.exists(s.exists):de.none():de.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(i,o){let a=null;"setToServerValue"in o?(V("REQUEST_TIME"===o.setToServerValue),a=new cs):"appendMissingElements"in o?a=new or(o.appendMissingElements.values||[]):"removeAllFromArray"in o?a=new ar(o.removeAllFromArray.values||[]):"increment"in o?a=new hs(i,o.increment):M();const c=me.fromServerFormat(o.fieldPath);return new ji(c,a)}(n,s)):[];var s;if(e.update){const s=It(n,e.update.name),i=new Ve({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new rt((e.updateMask.fieldPaths||[]).map(h=>me.fromServerFormat(h)));return new Kt(s,i,o,t,r)}return new ds(s,i,t,r)}if(e.delete){const s=It(n,e.delete);return new fs(s,t)}if(e.verify){const s=It(n,e.verify);return new Ou(s,t)}return M()}function _f(n,e){return{documents:[Pu(n,e.path)]}}function Lu(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=Pu(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Pu(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(c){if(0!==c.length)return xf(te.create(c,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const i=function(c){if(0!==c.length)return c.map(h=>{return{field:gn((p=h).field),direction:Qy(p.dir)};var p})}(e.orderBy);i&&(t.structuredQuery.orderBy=i);const o=(h=e.limit,n.yt||Vi(h)?h:{value:h});var h,a,c;return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt={before:!(c=e.endAt).inclusive,values:c.position}),t}function bf(n){let e=gf(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){V(1===r);const p=t.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];t.where&&(i=function(p){const m=Cf(p);return m instanceof te&&Au(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(p=>{return new as(ms((m=p).field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction));var m}));let a=null;t.limit&&(a=function(p){let m;return m="object"==typeof p?p.value:p,Vi(m)?null:m}(t.limit));let c=null;var p;t.startAt&&(c=new pn((p=t.startAt).values||[],!!p.before));let h=null;return t.endAt&&(h=function(p){return new pn(p.values||[],!p.before)}(t.endAt)),Bd(e,s,o,i,a,"F",c,h)}function Cf(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=ms(e.unaryFilter.field);return H.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=ms(e.unaryFilter.field);return H.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ms(e.unaryFilter.field);return H.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ms(e.unaryFilter.field);return H.create(i,"!=",{nullValue:"NULL_VALUE"});default:return M()}}(n):void 0!==n.fieldFilter?H.create(ms((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return M()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return te.create(e.compositeFilter.filters.map(t=>Cf(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return M()}}(e.compositeFilter.op))}(n):M();var e}function Qy(n){return Uy[n]}function Zy(n){return qy[n]}function Yy(n){return Gy[n]}function gn(n){return{fieldPath:n.canonicalString()}}function ms(n){return me.fromServerFormat(n.fieldPath)}function xf(n){return n instanceof H?function(e){if("=="===e.op){if(Cd(e.value))return{unaryFilter:{field:gn(e.field),op:"IS_NAN"}};if(bd(e.value))return{unaryFilter:{field:gn(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Cd(e.value))return{unaryFilter:{field:gn(e.field),op:"IS_NOT_NAN"}};if(bd(e.value))return{unaryFilter:{field:gn(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gn(e.field),op:Zy(e.op),value:e.value}}}(n):n instanceof te?function(e){const t=e.getFilters().map(r=>xf(r));return 1===t.length?t[0]:{compositeFilter:{op:Yy(e.op),filters:t}}}(n):M()}function Xy(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Ef(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function Ye(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Tf(e)),e=Jy(n.get(t),e);return Tf(e)}function Jy(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=i}}return t}function Tf(n){return n+"\x01\x01"}function St(n){const e=n.length;if(V(e>=2),2===e)return V("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Q.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("\x01",i);switch((o<0||o>t)&&M(),n.charAt(o+1)){case"\x01":const a=n.substring(i,o);let c;0===s.length?c=a:(s+=a,c=s,s=""),r.push(c);break;case"\x10":s+=n.substring(i,o),s+="\0";break;case"\x11":s+=n.substring(i,o+1);break;default:M()}i=o+2}return new Q(r)}const Af=["userId","batchId"];function Ra(n,e){return[n,Ye(e)]}function If(n,e,t){return[n,Ye(e),t]}const ew={},tw=["prefixPath","collectionGroup","readTime","documentId"],nw=["prefixPath","collectionGroup","documentId"],rw=["collectionGroup","readTime","prefixPath","documentId"],sw=["canonicalId","targetId"],iw=["targetId","path"],ow=["path","targetId"],aw=["collectionId","parent"],lw=["indexId","uid"],uw=["uid","sequenceNumber"],cw=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],hw=["indexId","uid","orderedDocumentKey"],dw=["userId","collectionPath","documentId"],fw=["userId","collectionPath","largestBatchId"],pw=["userId","collectionGroup","largestBatchId"],Sf=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],mw=[...Sf,"documentOverlays"],Df=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Mf=Df,gw=[...Mf,"indexConfiguration","indexState","indexEntries"];class Ru extends pd{constructor(e,t){super(),this.re=e,this.currentSequenceNumber=t}}function Pe(n,e){const t=D(n);return vt.M(t.re,e)}class Bu{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Ny(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=$i(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=$i(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=lf();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const c=Xd(o,a);null!==c&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(L.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),$())}isEqual(e){return this.batchId===e.batchId&&ss(this.mutations,e.mutations,(t,r)=>Jd(t,r))&&ss(this.baseMutations,e.baseMutations,(t,r)=>Jd(t,r))}}class Uu{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){V(e.mutations.length===r.length);let s=Fy;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Uu(e,t,r,s)}}class qu{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class yn{constructor(e,t,r,s,i=L.min(),o=L.min(),a=Se.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new yn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new yn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new yn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class kf{constructor(e){this.oe=e}}function Nf(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Ba(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:Qi(s=n.oe,(i=e).key),fields:i.data.value.mapValue.fields,updateTime:ps(s,i.version.toTimestamp()),createTime:ps(s,i.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:lr(e.version)};else{if(!e.isUnknownDocument())return M();r.unknownDocument={path:t.path.toArray(),version:lr(e.version)}}var s,i;return r}function Ba(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function lr(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ur(n){const e=new he(n.seconds,n.nanoseconds);return L.fromTimestamp(e)}function cr(n,e){const t=(e.baseMutations||[]).map(i=>Fu(n.oe,i));for(let i=0;i<e.mutations.length-1;++i)i+1<e.mutations.length&&void 0!==e.mutations[i+1].transform&&(e.mutations[i].updateTransforms=e.mutations[i+1].transform.fieldTransforms,e.mutations.splice(i+1,1),++i);const r=e.mutations.map(i=>Fu(n.oe,i)),s=he.fromMillis(e.localWriteTimeMs);return new Bu(e.batchId,s,t,r)}function Xi(n){const e=ur(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?ur(n.lastLimboFreeSnapshotVersion):L.min();let r;var s;return void 0!==n.query.documents?(V(1===(s=n.query).documents.length),r=Ze(us(gf(s.documents[0])))):r=Ze(bf(n.query)),new yn(r,n.targetId,0,n.lastListenSequenceNumber,e,t,Se.fromBase64String(n.resumeToken))}function Of(n,e){const t=lr(e.snapshotVersion),r=lr(e.lastLimboFreeSnapshotVersion);let s;s=Da(e.target)?_f(n.oe,e.target):Lu(n.oe,e.target);const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:sr(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Gu(n){const e=bf({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Na(e,e.limit,"L"):e}function ju(n,e){return new qu(e.largestBatchId,Fu(n.oe,e.overlayMutation))}function Vf(n,e){const t=e.path.lastSegment();return[n,Ye(e.path.popLast()),t]}function Pf(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:lr(r.readTime),documentKey:Ye(r.documentKey.path),largestBatchId:r.largestBatchId}}class ww{getBundleMetadata(e,t){return Ff(e).get(t).next(r=>{if(r)return{id:(s=r).bundleId,createTime:ur(s.createTime),version:s.version};var s})}saveBundleMetadata(e,t){return Ff(e).put({bundleId:(r=t).id,createTime:lr(ve(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return Lf(e).get(t).next(r=>{if(r)return{name:(s=r).name,query:Gu(s.bundledQuery),readTime:ur(s.readTime)};var s})}saveNamedQuery(e,t){return Lf(e).put({name:(r=t).name,readTime:lr(ve(r.readTime)),bundledQuery:r.bundledQuery});var r}}function Ff(n){return Pe(n,"bundles")}function Lf(n){return Pe(n,"namedQueries")}class Ua{constructor(e,t){this.Tt=e,this.userId=t}static ue(e,t){return new Ua(e,t.uid||"")}getOverlay(e,t){return Ji(e).get(Vf(this.userId,t)).next(r=>r?ju(this.Tt,r):null)}getOverlays(e,t){const r=At();return _.forEach(t,s=>this.getOverlay(e,s).next(i=>{null!==i&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new qu(t,o);s.push(this.ce(e,a))}),_.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(Ye(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Ji(e).Y("collectionPathOverlayIndex",a))}),_.waitFor(i)}getOverlaysForCollection(e,t,r){const s=At(),i=Ye(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Ji(e).W("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const h=ju(this.Tt,c);s.set(h.getKey(),h)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=At();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ji(e).X({index:"collectionGroupOverlayIndex",range:a},(c,h,p)=>{const m=ju(this.Tt,h);i.size()<s||m.largestBatchId===o?(i.set(m.getKey(),m),o=m.largestBatchId):p.done()}).next(()=>i)}ce(e,t){return Ji(e).put(function(r,s,i){const[o,a,c]=Vf(s,i.mutation.key);return{userId:s,collectionPath:a,documentId:c,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:Yi(r.oe,i.mutation)}}(this.Tt,this.userId,t))}}function Ji(n){return Pe(n,"documentOverlays")}class hr{constructor(){}ae(e,t){this.he(e,t),t.le()}he(e,t){if("nullValue"in e)this.fe(t,5);else if("booleanValue"in e)this.fe(t,10),t.de(e.booleanValue?1:0);else if("integerValue"in e)this.fe(t,15),t.de(ge(e.integerValue));else if("doubleValue"in e){const r=ge(e.doubleValue);isNaN(r)?this.fe(t,13):(this.fe(t,15),Pi(r)?t.de(0):t.de(r))}else if("timestampValue"in e){const r=e.timestampValue;this.fe(t,20),"string"==typeof r?t._e(r):(t._e(`${r.seconds||""}`),t.de(r.nanos||0))}else if("stringValue"in e)this.we(e.stringValue,t),this.me(t);else if("bytesValue"in e)this.fe(t,30),t.ge(tr(e.bytesValue)),this.me(t);else if("referenceValue"in e)this.ye(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.fe(t,45),t.de(r.latitude||0),t.de(r.longitude||0)}else"mapValue"in e?xd(e)?this.fe(t,Number.MAX_SAFE_INTEGER):(this.pe(e.mapValue,t),this.me(t)):"arrayValue"in e?(this.Ie(e.arrayValue,t),this.me(t)):M()}we(e,t){this.fe(t,25),this.Te(e,t)}Te(e,t){t._e(e)}pe(e,t){const r=e.fields||{};this.fe(t,55);for(const s of Object.keys(r))this.we(s,t),this.he(r[s],t)}Ie(e,t){const r=e.values||[];this.fe(t,50);for(const s of r)this.he(s,t)}ye(e,t){this.fe(t,37),S.fromName(e).path.forEach(r=>{this.fe(t,60),this.Te(r,t)})}fe(e,t){e.de(t)}me(e){e.de(2)}}function vw(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Rf(n){const e=64-function(t){let r=0;for(let s=0;s<8;++s){const i=vw(255&t[s]);if(r+=i,8!==i)break}return r}(n);return Math.ceil(e/8)}hr.Ee=new hr;class _w{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ae(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Re(r.value),r=t.next();this.be()}ve(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Pe(r.value),r=t.next();this.Ve()}Se(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Re(r);else if(r<2048)this.Re(960|r>>>6),this.Re(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Re(480|r>>>12),this.Re(128|63&r>>>6),this.Re(128|63&r);else{const s=t.codePointAt(0);this.Re(240|s>>>18),this.Re(128|63&s>>>12),this.Re(128|63&s>>>6),this.Re(128|63&s)}}this.be()}De(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Pe(r);else if(r<2048)this.Pe(960|r>>>6),this.Pe(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Pe(480|r>>>12),this.Pe(128|63&r>>>6),this.Pe(128|63&r);else{const s=t.codePointAt(0);this.Pe(240|s>>>18),this.Pe(128|63&s>>>12),this.Pe(128|63&s>>>6),this.Pe(128|63&s)}}this.Ve()}Ce(e){const t=this.xe(e),r=Rf(t);this.Ne(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}ke(e){const t=this.xe(e),r=Rf(t);this.Ne(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}Oe(){this.Me(255),this.Me(255)}Fe(){this.$e(255),this.$e(255)}reset(){this.position=0}seed(e){this.Ne(e.length),this.buffer.set(e,this.position),this.position+=e.length}Be(){return this.buffer.slice(0,this.position)}xe(e){const t=function(s){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,s,!1),new Uint8Array(i.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Re(e){const t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(t)}Pe(e){const t=255&e;0===t?(this.$e(0),this.$e(255)):255===t?(this.$e(255),this.$e(0)):this.$e(e)}be(){this.Me(0),this.Me(1)}Ve(){this.$e(0),this.$e(1)}Me(e){this.Ne(1),this.buffer[this.position++]=e}$e(e){this.Ne(1),this.buffer[this.position++]=~e}Ne(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class bw{constructor(e){this.Le=e}ge(e){this.Le.Ae(e)}_e(e){this.Le.Se(e)}de(e){this.Le.Ce(e)}le(){this.Le.Oe()}}class Cw{constructor(e){this.Le=e}ge(e){this.Le.ve(e)}_e(e){this.Le.De(e)}de(e){this.Le.ke(e)}le(){this.Le.Fe()}}class eo{constructor(){this.Le=new _w,this.qe=new bw(this.Le),this.Ue=new Cw(this.Le)}seed(e){this.Le.seed(e)}Ke(e){return 0===e?this.qe:this.Ue}Be(){return this.Le.Be()}reset(){this.Le.reset()}}class dr{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Ge(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new dr(this.indexId,this.documentKey,this.arrayValue,r)}}function wn(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=Bf(n.arrayValue,e.arrayValue),0!==t?t:(t=Bf(n.directionalValue,e.directionalValue),0!==t?t:S.comparator(n.documentKey,e.documentKey)))}function Bf(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class xw{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Qe=e.orderBy,this.je=[];for(const t of e.filters){const r=t;r.isInequality()?this.ze=r:this.je.push(r)}}We(e){V(e.collectionGroup===this.collectionId);const t=yu(e);if(void 0!==t&&!this.He(t))return!1;const r=Xn(e);let s=0,i=0;for(;s<r.length&&this.He(r[s]);++s);if(s===r.length)return!0;if(void 0!==this.ze){const o=r[s];if(!this.Je(this.ze,o)||!this.Ye(this.Qe[i++],o))return!1;++s}for(;s<r.length;++s)if(i>=this.Qe.length||!this.Ye(this.Qe[i++],r[s]))return!1;return!0}He(e){for(const t of this.je)if(this.Je(t,e))return!0;return!1}Je(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}Ye(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Uf(n){var e,t;if(V(n instanceof H||n instanceof te),n instanceof H){if(n instanceof Vd){const s=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(i=>H.create(n.field,"==",i)))||[];return te.create(s,"or")}return n}const r=n.filters.map(s=>Uf(s));return te.create(r,n.op)}function Ew(n){if(0===n.getFilters().length)return[];const e=zu(Uf(n));return V(qf(e)),$u(e)||Ku(e)?[e]:e.getFilters()}function $u(n){return n instanceof H}function Ku(n){return n instanceof te&&Au(n)}function qf(n){return $u(n)||Ku(n)||function(e){if(e instanceof te&&Tu(e)){for(const t of e.getFilters())if(!$u(t)&&!Ku(t))return!1;return!0}return!1}(n)}function zu(n){if(V(n instanceof H||n instanceof te),n instanceof H)return n;if(1===n.filters.length)return zu(n.filters[0]);const e=n.filters.map(r=>zu(r));let t=te.create(e,n.op);return t=qa(t),qf(t)?t:(V(t instanceof te),V(os(t)),V(t.filters.length>1),t.filters.reduce((r,s)=>Hu(r,s)))}function Hu(n,e){let t;return V(n instanceof H||n instanceof te),V(e instanceof H||e instanceof te),t=n instanceof H?e instanceof H?te.create([n,e],"and"):Gf(n,e):e instanceof H?Gf(e,n):function(r,s){if(V(r.filters.length>0&&s.filters.length>0),os(r)&&os(s))return kd(r,s.getFilters());const i=Tu(r)?r:s,o=Tu(r)?s:r,a=i.filters.map(c=>Hu(c,o));return te.create(a,"or")}(n,e),qa(t)}function Gf(n,e){if(os(e))return kd(e,n.getFilters());{const t=e.filters.map(r=>Hu(n,r));return te.create(t,"or")}}function qa(n){if(V(n instanceof H||n instanceof te),n instanceof H)return n;const e=n.getFilters();if(1===e.length)return qa(e[0]);if(Dd(n))return n;const t=e.map(s=>qa(s)),r=[];return t.forEach(s=>{s instanceof H?r.push(s):s instanceof te&&(s.op===n.op?r.push(...s.filters):r.push(s))}),1===r.length?r[0]:te.create(r,n.op)}class Tw{constructor(){this.Ze=new Wu}addToCollectionParentIndex(e,t){return this.Ze.add(t),_.resolve()}getCollectionParents(e,t){return _.resolve(this.Ze.getEntries(t))}addFieldIndex(e,t){return _.resolve()}deleteFieldIndex(e,t){return _.resolve()}getDocumentsMatchingTarget(e,t){return _.resolve(null)}getIndexType(e,t){return _.resolve(0)}getFieldIndexes(e,t){return _.resolve([])}getNextCollectionGroupToUpdate(e){return _.resolve(null)}getMinOffset(e,t){return _.resolve(lt.min())}getMinOffsetFromCollectionGroup(e,t){return _.resolve(lt.min())}updateCollectionGroup(e,t,r){return _.resolve()}updateIndexEntries(e,t){return _.resolve()}}class Wu{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new ne(Q.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ne(Q.comparator)).toArray()}}const Ga=new Uint8Array(0);class Aw{constructor(e,t){this.user=e,this.databaseId=t,this.Xe=new Wu,this.tn=new mn(r=>sr(r),(r,s)=>Ui(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Xe.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.Xe.add(t)});const i={collectionId:r,parent:Ye(s)};return jf(e).put(i)}return _.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[cd(t),""],!1,!0);return jf(e).W(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(St(o.parent))}return r})}addFieldIndex(e,t){const r=ja(e),s={indexId:(o=t).indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])};var o;delete s.indexId;const i=r.add(s);if(t.indexState){const o=no(e);return i.next(a=>{o.put(Pf(a,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=ja(e),s=no(e),i=to(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=to(e);let s=!0;const i=new Map;return _.forEach(this.en(t),o=>this.nn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=$();const a=[];return _.forEach(i,(c,h)=>{var p;A("IndexedDbIndexManager",`Using index ${p=c,`id=${p.indexId}|cg=${p.collectionGroup}|f=${p.fields.map(P=>`${P.fieldPath}:${P.kind}`).join(",")}`} to execute ${sr(t)}`);const m=function(P,ue){const z=yu(ue);if(void 0===z)return null;for(const X of Ma(P,z.fieldPath))switch(X.op){case"array-contains-any":return X.value.arrayValue.values||[];case"array-contains":return[X.value]}return null}(h,c),y=function(P,ue){const z=new Map;for(const X of Xn(ue))for(const De of Ma(P,X.fieldPath))switch(De.op){case"==":case"in":z.set(X.fieldPath.canonicalString(),De.value);break;case"not-in":case"!=":return z.set(X.fieldPath.canonicalString(),De.value),Array.from(z.values())}return null}(h,c),v=function(P,ue){const z=[];let X=!0;for(const De of Xn(ue)){const To=0===De.kind?Ld(P,De.fieldPath,P.startAt):Rd(P,De.fieldPath,P.startAt);z.push(To.value),X&&(X=To.inclusive)}return new pn(z,X)}(h,c),E=function(P,ue){const z=[];let X=!0;for(const De of Xn(ue)){const To=0===De.kind?Rd(P,De.fieldPath,P.endAt):Ld(P,De.fieldPath,P.endAt);z.push(To.value),X&&(X=To.inclusive)}return new pn(z,X)}(h,c),I=this.sn(c,h,v),O=this.sn(c,h,E),J=this.rn(c,h,y),k=this.on(c.indexId,m,I,v.inclusive,O,E.inclusive,J);return _.forEach(k,P=>r.J(P,t.limit).next(ue=>{ue.forEach(z=>{const X=S.fromSegments(z.documentKey);o.has(X)||(o=o.add(X),a.push(X))})}))}).next(()=>a)}return _.resolve(null)})}en(e){let t=this.tn.get(e);return t||(t=0===e.filters.length?[e]:Ew(te.create(e.filters,"and")).map(r=>Su(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.tn.set(e,t),t)}on(e,t,r,s,i,o,a){const c=(null!=t?t.length:1)*Math.max(r.length,i.length),h=c/(null!=t?t.length:1),p=[];for(let m=0;m<c;++m){const y=t?this.un(t[m/h]):Ga,v=this.cn(e,y,r[m%h],s),E=this.an(e,y,i[m%h],o),I=a.map(O=>this.cn(e,y,O,!0));p.push(...this.createRange(v,E,I))}return p}cn(e,t,r,s){const i=new dr(e,S.empty(),t,r);return s?i:i.Ge()}an(e,t,r,s){const i=new dr(e,S.empty(),t,r);return s?i.Ge():i}nn(e,t){const r=new xw(t),s=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.We(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.en(t);return _.forEach(s,i=>this.nn(e,i).next(o=>{o?0!==r&&o.fields.length<function(a){let c=new ne(me.comparator),h=!1;for(const p of a.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||("array-contains"===m.op||"array-contains-any"===m.op?h=!0:c=c.add(m.field));for(const p of a.orderBy)p.field.isKeyField()||(c=c.add(p.field));return c.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>null!==t.limit&&s.length>1&&2===r?1:r)}hn(e,t){const r=new eo;for(const s of Xn(e)){const i=t.data.field(s.fieldPath);if(null==i)return null;const o=r.Ke(s.kind);hr.Ee.ae(i,o)}return r.Be()}un(e){const t=new eo;return hr.Ee.ae(e,t.Ke(0)),t.Be()}ln(e,t){const r=new eo;return hr.Ee.ae(rr(this.databaseId,t),r.Ke(function(s){const i=Xn(s);return 0===i.length?0:i[i.length-1].kind}(e))),r.Be()}rn(e,t,r){if(null===r)return[];let s=[];s.push(new eo);let i=0;for(const o of Xn(e)){const a=r[i++];for(const c of s)if(this.fn(t,o.fieldPath)&&Ri(a))s=this.dn(s,o,a);else{const h=c.Ke(o.kind);hr.Ee.ae(a,h)}}return this._n(s)}sn(e,t,r){return this.rn(e,t,r.position)}_n(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Be();return t}dn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new eo;c.seed(a.Be()),hr.Ee.ae(o,c.Ke(t.kind)),i.push(c)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof H&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=ja(e),s=no(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(i=>{const o=[];return _.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(h,p){const m=p?new Ni(p.sequenceNumber,new lt(ur(p.readTime),new S(St(p.documentKey)),p.largestBatchId)):Ni.empty(),y=h.fields.map(([v,E])=>new Ea(me.fromServerFormat(v),E));return new xa(h.indexId,h.collectionGroup,y,m)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return 0!==i?i:q(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=ja(e),i=no(e);return this.wn(e).next(o=>s.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>_.forEach(a,c=>i.put(Pf(c.indexId,this.user,o,r)))))}updateIndexEntries(e,t){const r=new Map;return _.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?_.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),_.forEach(a,c=>this.mn(e,s,c).next(h=>{const p=this.gn(i,c);return h.isEqual(p)?_.resolve():this.yn(e,i,c,h,p)}))))})}pn(e,t,r,s){return to(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.ln(r,t.key),documentKey:t.key.path.toArray()})}In(e,t,r,s){return to(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.ln(r,t.key),t.key.path.toArray()])}mn(e,t,r){const s=to(e);let i=new ne(wn);return s.X({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.ln(r,t)])},(o,a)=>{i=i.add(new dr(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}gn(e,t){let r=new ne(wn);const s=this.hn(t,e);if(null==s)return r;const i=yu(t);if(null!=i){const o=e.data.field(i.fieldPath);if(Ri(o))for(const a of o.arrayValue.values||[])r=r.add(new dr(t.indexId,e.key,this.un(a),s))}else r=r.add(new dr(t.indexId,e.key,Ga,s));return r}yn(e,t,r,s,i){A("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(a,c,h,p,m){const y=a.getIterator(),v=c.getIterator();let E=ls(y),I=ls(v);for(;E||I;){let O=!1,J=!1;if(E&&I){const k=h(E,I);k<0?J=!0:k>0&&(O=!0)}else null!=E?J=!0:O=!0;O?(p(I),I=ls(v)):J?(m(E),E=ls(y)):(E=ls(y),I=ls(v))}}(s,i,wn,a=>{o.push(this.pn(e,t,r,a))},a=>{o.push(this.In(e,t,r,a))}),_.waitFor(o)}wn(e){let t=1;return no(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>wn(o,a)).filter((o,a,c)=>!a||0!==wn(o,c[a-1]));const s=[];s.push(e);for(const o of r){const a=wn(o,e),c=wn(o,t);if(0===a)s[0]=e.Ge();else if(a>0&&c<0)s.push(o),s.push(o.Ge());else if(c>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Tn(s[o],s[o+1]))return[];i.push(IDBKeyRange.bound([s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Ga,[]],[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Ga,[]]))}return i}Tn(e,t){return wn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next($f)}getMinOffset(e,t){return _.mapArray(this.en(t),r=>this.nn(e,r).next(s=>s||M())).next($f)}}function jf(n){return Pe(n,"collectionParents")}function to(n){return Pe(n,"indexEntries")}function ja(n){return Pe(n,"indexConfiguration")}function no(n){return Pe(n,"indexState")}function $f(n){V(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;wu(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new lt(e.readTime,e.documentKey,t)}const Kf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class it{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new it(e,it.DEFAULT_COLLECTION_PERCENTILE,it.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function zf(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const c=r.X({range:o},(p,m,y)=>(a++,y.delete()));i.push(c.next(()=>{V(1===a)}));const h=[];for(const p of t.mutations){const m=If(e,p.key.path,t.batchId);i.push(s.delete(m)),h.push(p.key)}return _.waitFor(i).next(()=>h)}function $a(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw M();e=n.noDocument}return JSON.stringify(e).length}it.DEFAULT_COLLECTION_PERCENTILE=10,it.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,it.DEFAULT=new it(41943040,it.DEFAULT_COLLECTION_PERCENTILE,it.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),it.DISABLED=new it(-1,0,0);class Ka{constructor(e,t,r,s){this.userId=e,this.Tt=t,this.indexManager=r,this.referenceDelegate=s,this.En={}}static ue(e,t,r,s){V(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new Ka(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return vn(e).X({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=gs(e),o=vn(e);return o.add({}).next(a=>{V("number"==typeof a);const c=new Bu(a,t,r,s),h=function(y,v,E){const I=E.baseMutations.map(J=>Yi(y.oe,J)),O=E.mutations.map(J=>Yi(y.oe,J));return{userId:v,batchId:E.batchId,localWriteTimeMs:E.localWriteTime.toMillis(),baseMutations:I,mutations:O}}(this.Tt,this.userId,c),p=[];let m=new ne((y,v)=>q(y.canonicalString(),v.canonicalString()));for(const y of s){const v=If(this.userId,y.key.path,a);m=m.add(y.key.path.popLast()),p.push(o.put(h)),p.push(i.put(v,ew))}return m.forEach(y=>{p.push(this.indexManager.addToCollectionParentIndex(e,y))}),e.addOnCommittedListener(()=>{this.En[a]=c.keys()}),_.waitFor(p).next(()=>c)})}lookupMutationBatch(e,t){return vn(e).get(t).next(r=>r?(V(r.userId===this.userId),cr(this.Tt,r)):null)}An(e,t){return this.En[t]?_.resolve(this.En[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.En[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return vn(e).X({index:"userMutationsIndex",range:s},(o,a,c)=>{a.userId===this.userId&&(V(a.batchId>=r),i=cr(this.Tt,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return vn(e).X({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return vn(e).W("userMutationsIndex",t).next(r=>r.map(s=>cr(this.Tt,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Ra(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return gs(e).X({range:s},(o,a,c)=>{const[h,p,m]=o,y=St(p);if(h===this.userId&&t.path.isEqual(y))return vn(e).get(m).next(v=>{if(!v)throw M();V(v.userId===this.userId),i.push(cr(this.Tt,v))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ne(q);const s=[];return t.forEach(i=>{const o=Ra(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=gs(e).X({range:a},(h,p,m)=>{const[y,v,E]=h,I=St(v);y===this.userId&&i.path.isEqual(I)?r=r.add(E):m.done()});s.push(c)}),_.waitFor(s).next(()=>this.Rn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=Ra(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new ne(q);return gs(e).X({range:o},(c,h,p)=>{const[m,y,v]=c,E=St(y);m===this.userId&&r.isPrefixOf(E)?E.length===s&&(a=a.add(v)):p.done()}).next(()=>this.Rn(e,a))}Rn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(vn(e).get(i).next(o=>{if(null===o)throw M();V(o.userId===this.userId),r.push(cr(this.Tt,o))}))}),_.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return zf(e.re,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.bn(t.batchId)}),_.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}bn(e){delete this.En[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return _.resolve();const r=IDBKeyRange.lowerBound([this.userId]),s=[];return gs(e).X({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=St(i[1]);s.push(c)}else a.done()}).next(()=>{V(0===s.length)})})}containsKey(e,t){return Hf(e,this.userId,t)}vn(e){return Wf(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Hf(n,e,t){const r=Ra(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return gs(n).X({range:i,Z:!0},(a,c,h)=>{const[p,m,y]=a;p===e&&m===s&&(o=!0),h.done()}).next(()=>o)}function vn(n){return Pe(n,"mutations")}function gs(n){return Pe(n,"documentMutations")}function Wf(n){return Pe(n,"mutationQueues")}class fr{constructor(e){this.Pn=e}next(){return this.Pn+=2,this.Pn}static Vn(){return new fr(0)}static Sn(){return new fr(-1)}}class Iw{constructor(e,t){this.referenceDelegate=e,this.Tt=t}allocateTargetId(e){return this.Dn(e).next(t=>{const r=new fr(t.highestTargetId);return t.highestTargetId=r.next(),this.Cn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Dn(e).next(t=>L.fromTimestamp(new he(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Dn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Dn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Cn(e,s)))}addTargetData(e,t){return this.xn(e,t).next(()=>this.Dn(e).next(r=>(r.targetCount+=1,this.Nn(t,r),this.Cn(e,r))))}updateTargetData(e,t){return this.xn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ys(e).delete(t.targetId)).next(()=>this.Dn(e)).next(r=>(V(r.targetCount>0),r.targetCount-=1,this.Cn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return ys(e).X((o,a)=>{const c=Xi(a);c.sequenceNumber<=t&&null===r.get(c.targetId)&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>_.waitFor(i)).next(()=>s)}forEachTarget(e,t){return ys(e).X((r,s)=>{const i=Xi(s);t(i)})}Dn(e){return Qf(e).get("targetGlobalKey").next(t=>(V(null!==t),t))}Cn(e,t){return Qf(e).put("targetGlobalKey",t)}xn(e,t){return ys(e).put(Of(this.Tt,t))}Nn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Dn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=sr(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return ys(e).X({range:s,index:"queryTargetsIndex"},(o,a,c)=>{const h=Xi(a);Ui(t,h.target)&&(i=h,c.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=_n(e);return t.forEach(o=>{const a=Ye(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),_.waitFor(s)}removeMatchingKeys(e,t,r){const s=_n(e);return _.forEach(t,i=>{const o=Ye(i.path);return _.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=_n(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=_n(e);let i=$();return s.X({range:r,Z:!0},(o,a,c)=>{const h=St(o[1]),p=new S(h);i=i.add(p)}).next(()=>i)}containsKey(e,t){const r=Ye(t.path),s=IDBKeyRange.bound([r],[cd(r)],!1,!0);let i=0;return _n(e).X({index:"documentTargetsIndex",Z:!0,range:s},([o,a],c,h)=>{0!==o&&(i++,h.done())}).next(()=>i>0)}ie(e,t){return ys(e).get(t).next(r=>r?Xi(r):null)}}function ys(n){return Pe(n,"targets")}function Qf(n){return Pe(n,"targetGlobal")}function _n(n){return Pe(n,"targetDocuments")}function Zf([n,e],[t,r]){const s=q(n,t);return 0===s?q(e,r):s}class Sw{constructor(e){this.kn=e,this.buffer=new ne(Zf),this.On=0}Mn(){return++this.On}Fn(e){const t=[e,this.Mn()];if(this.buffer.size<this.kn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Zf(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Dw{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.$n=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Bn(6e4)}stop(){this.$n&&(this.$n.cancel(),this.$n=null)}get started(){return null!==this.$n}Bn(e){var t=this;A("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.$n=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,w.Z)(function*(){t.$n=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){un(r)?A("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield ln(r)}yield t.Bn(3e5)}))}}class Mw{constructor(e,t){this.Ln=e,this.params=t}calculateTargetCount(e,t){return this.Ln.qn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return _.resolve(ut.at);const r=new Sw(t);return this.Ln.forEachTarget(e,s=>r.Fn(s.sequenceNumber)).next(()=>this.Ln.Un(e,s=>r.Fn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Ln.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Ln.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector","Garbage collection skipped; disabled"),_.resolve(Kf)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Kf):this.Kn(e,t))}getCacheSize(e){return this.Ln.getCacheSize(e)}Kn(e,t){let r,s,i,o,a,c,h;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(A("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,t))).next(m=>(i=m,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(h=Date.now(),mu()<=tt.in.DEBUG&&A("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-p}ms\n\tDetermined least recently used ${s} in `+(a-o)+`ms\n\tRemoved ${i} targets in `+(c-a)+`ms\n\tRemoved ${m} documents in `+(h-c)+`ms\nTotal Duration: ${h-p}ms`),_.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}class kw{constructor(e,t){this.db=e,this.garbageCollector=new Mw(this,t)}qn(e){const t=this.Gn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}Gn(e){let t=0;return this.Un(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Un(e,t){return this.Qn(e,(r,s)=>t(s))}addReference(e,t,r){return za(e,r)}removeReference(e,t,r){return za(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return za(e,t)}jn(e,t){return function(r,s){let i=!1;return Wf(r).tt(o=>Hf(r,o,s).next(a=>(a&&(i=!0),_.resolve(!a)))).next(()=>i)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Qn(e,(o,a)=>{if(a<=t){const c=this.jn(e,o).next(h=>{if(!h)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,L.min()),_n(e).delete([0,Ye(o.path)])))});s.push(c)}}).next(()=>_.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return za(e,t)}Qn(e,t){const r=_n(e);let s,i=ut.at;return r.X({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:h})=>{0===o?(i!==ut.at&&t(new S(St(s)),i),i=h,s=c):i=ut.at}).next(()=>{i!==ut.at&&t(new S(St(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function za(n,e){return _n(n).put((r=n.currentSequenceNumber,{targetId:0,path:Ye(e.path),sequenceNumber:r}));var r}class Yf{constructor(){this.changes=new mn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,oe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?_.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Nw{constructor(e){this.Tt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return pr(e).put(r)}removeEntry(e,t,r){return pr(e).delete(function(s,i){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],Ba(i),o[o.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.zn(e,r)))}getEntry(e,t){let r=oe.newInvalidDocument(t);return pr(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(ro(t))},(s,i)=>{r=this.Wn(t,i)}).next(()=>r)}Hn(e,t){let r={size:0,document:oe.newInvalidDocument(t)};return pr(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(ro(t))},(s,i)=>{r={document:this.Wn(t,i),size:$a(i)}}).next(()=>r)}getEntries(e,t){let r=st();return this.Jn(e,t,(s,i)=>{const o=this.Wn(s,i);r=r.insert(s,o)}).next(()=>r)}Yn(e,t){let r=st(),s=new ye(S.comparator);return this.Jn(e,t,(i,o)=>{const a=this.Wn(i,o);r=r.insert(i,a),s=s.insert(i,$a(o))}).next(()=>({documents:r,Zn:s}))}Jn(e,t,r){if(t.isEmpty())return _.resolve();let s=new ne(tp);t.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(ro(s.first()),ro(s.last())),o=s.getIterator();let a=o.getNext();return pr(e).X({index:"documentKeyIndex",range:i},(c,h,p)=>{const m=S.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;a&&tp(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,h),a=o.hasNext()?o.getNext():null),a?p.j(ro(a)):p.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s){const i=t.path,o=[i.popLast().toArray(),i.lastSegment(),Ba(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return pr(e).W(IDBKeyRange.bound(o,a,!0)).next(c=>{let h=st();for(const p of c){const m=this.Wn(S.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Gi(t,m)||s.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,t,r,s){let i=st();const o=ep(t,r),a=ep(t,lt.max());return pr(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,h,p)=>{const m=this.Wn(S.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);i=i.insert(m.key,m),i.size===s&&p.done()}).next(()=>i)}newChangeBuffer(e){return new Ow(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Jf(e).get("remoteDocumentGlobalKey").next(t=>(V(!!t),t))}zn(e,t){return Jf(e).put("remoteDocumentGlobalKey",t)}Wn(e,t){if(t){const r=function yw(n,e){let t;if(e.document)t=vf(n.oe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=S.fromSegments(e.noDocument.path),s=ur(e.noDocument.readTime);t=oe.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return M();{const r=S.fromSegments(e.unknownDocument.path),s=ur(e.unknownDocument.version);t=oe.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(r){const s=new he(r[0],r[1]);return L.fromTimestamp(s)}(e.readTime)),t}(this.Tt,t);if(!r.isNoDocument()||!r.version.isEqual(L.min()))return r}return oe.newInvalidDocument(e)}}function Xf(n){return new Nw(n)}class Ow extends Yf{constructor(e,t){super(),this.Xn=e,this.trackRemovals=t,this.ts=new mn(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new ne((i,o)=>q(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.ts.get(i);if(t.push(this.Xn.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=Nf(this.Xn.Tt,o);s=s.add(i.path.popLast());const h=$a(c);r+=h-a.size,t.push(this.Xn.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=Nf(this.Xn.Tt,o.convertToNoDocument(L.min()));t.push(this.Xn.addEntry(e,i,c))}}),s.forEach(i=>{t.push(this.Xn.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.Xn.updateMetadata(e,r)),_.waitFor(t)}getFromCache(e,t){return this.Xn.Hn(e,t).next(r=>(this.ts.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Xn.Yn(e,t).next(({documents:r,Zn:s})=>(s.forEach((i,o)=>{this.ts.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function Jf(n){return Pe(n,"remoteDocumentGlobal")}function pr(n){return Pe(n,"remoteDocumentsV14")}function ro(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ep(n,e){const t=e.documentKey.path.toArray();return[n,Ba(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function tp(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=q(t[i],r[i]),s)return s;return s=q(t.length,r.length),s||(s=q(t[t.length-2],r[r.length-2]),s||q(t[t.length-1],r[r.length-1]))}class Vw{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class np{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(null!==r&&$i(r.mutation,s,rt.empty(),he.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,$()).next(()=>r))}getLocalViewOfDocuments(e,t,r=$()){const s=At();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Ki();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=At();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,$()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=st();const o=zi(),a=zi();return t.forEach((c,h)=>{const p=r.get(h.key);s.has(h.key)&&(void 0===p||p.mutation instanceof Kt)?i=i.insert(h.key,h):void 0!==p?(o.set(h.key,p.mutation.getFieldMask()),$i(p.mutation,h,p.mutation.getFieldMask(),he.now())):o.set(h.key,rt.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((h,p)=>o.set(h,p)),t.forEach((h,p)=>{var m;return a.set(h,new Vw(p,null!==(m=o.get(h))&&void 0!==m?m:null))}),a))}recalculateAndSaveOverlays(e,t){const r=zi();let s=new ye((o,a)=>o-a),i=$();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(c=>{const h=t.get(c);if(null===h)return;let p=r.get(c)||rt.empty();p=a.applyToLocalView(h,p),r.set(c,p);const m=(s.get(a.batchId)||$()).add(c);s=s.insert(a.batchId,m)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),h=c.key,p=c.value,m=lf();p.forEach(y=>{if(!i.has(y)){const v=Xd(t.get(y),r.get(y));null!==v&&m.set(y,v),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return _.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return S.isDocumentKey((s=t).path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Mu(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var s}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):_.resolve(At());let a=-1,c=i;return o.next(h=>_.forEach(h,(p,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),i.get(p)?_.resolve():this.remoteDocumentCache.getEntry(e,p).next(y=>{c=c.insert(p,y)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,c,h,$())).next(p=>({batchId:a,changes:af(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new S(t)).next(r=>{let s=Ki();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const s=t.collectionGroup;let i=Ki();return this.indexManager.getCollectionParents(e,s).next(o=>_.forEach(o,a=>{const c=(h=t,p=a.child(s),new $t(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt));var h,p;return this.getDocumentsMatchingCollectionQuery(e,c,r).next(h=>{h.forEach((p,m)=>{i=i.insert(p,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s))).next(i=>{s.forEach((a,c)=>{const h=c.getKey();null===i.get(h)&&(i=i.insert(h,oe.newInvalidDocument(h)))});let o=Ki();return i.forEach((a,c)=>{const h=s.get(a);void 0!==h&&$i(h.mutation,c,rt.empty(),he.now()),Gi(t,c)&&(o=o.insert(a,c))}),o})}}class Pw{constructor(e){this.Tt=e,this.es=new Map,this.ns=new Map}getBundleMetadata(e,t){return _.resolve(this.es.get(t))}saveBundleMetadata(e,t){var r;return this.es.set(t.id,{id:(r=t).id,version:r.version,createTime:ve(r.createTime)}),_.resolve()}getNamedQuery(e,t){return _.resolve(this.ns.get(t))}saveNamedQuery(e,t){return this.ns.set(t.name,{name:(r=t).name,query:Gu(r.bundledQuery),readTime:ve(r.readTime)}),_.resolve();var r}}class Fw{constructor(){this.overlays=new ye(S.comparator),this.ss=new Map}getOverlay(e,t){return _.resolve(this.overlays.get(t))}getOverlays(e,t){const r=At();return _.forEach(t,s=>this.getOverlay(e,s).next(i=>{null!==i&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ce(e,t,i)}),_.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.ss.get(r);return void 0!==s&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.ss.delete(r)),_.resolve()}getOverlaysForCollection(e,t,r){const s=At(),i=t.length+1,o=new S(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return _.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new ye((h,p)=>h-p);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let p=i.get(h.largestBatchId);null===p&&(p=At(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const a=At(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,p)=>a.set(h,p)),!(a.size()>=s)););return _.resolve(a)}ce(e,t,r){const s=this.overlays.get(r.key);if(null!==s){const o=this.ss.get(s.largestBatchId).delete(r.key);this.ss.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new qu(t,r));let i=this.ss.get(t);void 0===i&&(i=$(),this.ss.set(t,i)),this.ss.set(t,i.add(r.key))}}class Qu{constructor(){this.rs=new ne(Fe.os),this.us=new ne(Fe.cs)}isEmpty(){return this.rs.isEmpty()}addReference(e,t){const r=new Fe(e,t);this.rs=this.rs.add(r),this.us=this.us.add(r)}hs(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.ls(new Fe(e,t))}fs(e,t){e.forEach(r=>this.removeReference(r,t))}ds(e){const t=new S(new Q([])),r=new Fe(t,e),s=new Fe(t,e+1),i=[];return this.us.forEachInRange([r,s],o=>{this.ls(o),i.push(o.key)}),i}_s(){this.rs.forEach(e=>this.ls(e))}ls(e){this.rs=this.rs.delete(e),this.us=this.us.delete(e)}ws(e){const t=new S(new Q([])),r=new Fe(t,e),s=new Fe(t,e+1);let i=$();return this.us.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Fe(e,0),r=this.rs.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class Fe{constructor(e,t){this.key=e,this.gs=t}static os(e,t){return S.comparator(e.key,t.key)||q(e.gs,t.gs)}static cs(e,t){return q(e.gs,t.gs)||S.comparator(e.key,t.key)}}class Lw{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ys=1,this.ps=new ne(Fe.os)}checkEmpty(e){return _.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,s){const i=this.ys;this.ys++;const o=new Bu(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.ps=this.ps.add(new Fe(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return _.resolve(o)}lookupMutationBatch(e,t){return _.resolve(this.Is(t))}getNextMutationBatchAfterBatchId(e,t){const s=this.Ts(t+1),i=s<0?0:s;return _.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return _.resolve(0===this.mutationQueue.length?-1:this.ys-1)}getAllMutationBatches(e){return _.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Fe(t,0),s=new Fe(t,Number.POSITIVE_INFINITY),i=[];return this.ps.forEachInRange([r,s],o=>{const a=this.Is(o.gs);i.push(a)}),_.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ne(q);return t.forEach(s=>{const i=new Fe(s,0),o=new Fe(s,Number.POSITIVE_INFINITY);this.ps.forEachInRange([i,o],a=>{r=r.add(a.gs)})}),_.resolve(this.Es(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;S.isDocumentKey(i)||(i=i.child(""));const o=new Fe(new S(i),0);let a=new ne(q);return this.ps.forEachWhile(c=>{const h=c.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(a=a.add(c.gs)),!0)},o),_.resolve(this.Es(a))}Es(e){const t=[];return e.forEach(r=>{const s=this.Is(r);null!==s&&t.push(s)}),t}removeMutationBatch(e,t){V(0===this.As(t.batchId,"removed")),this.mutationQueue.shift();let r=this.ps;return _.forEach(t.mutations,s=>{const i=new Fe(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.ps=r})}bn(e){}containsKey(e,t){const r=new Fe(t,0),s=this.ps.firstAfterOrEqual(r);return _.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return _.resolve()}As(e,t){return this.Ts(e)}Ts(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Is(e){const t=this.Ts(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Rw{constructor(e){this.Rs=e,this.docs=new ye(S.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Rs(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return _.resolve(r?r.document.mutableCopy():oe.newInvalidDocument(t))}getEntries(e,t){let r=st();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():oe.newInvalidDocument(s))}),_.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=st();const o=t.path,a=new S(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:h,value:{document:p}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||wu(dd(p),r)<=0||(s.has(p.key)||Gi(t,p))&&(i=i.insert(p.key,p.mutableCopy()))}return _.resolve(i)}getAllFromCollectionGroup(e,t,r,s){M()}bs(e,t){return _.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Bw(this)}getSize(e){return _.resolve(this.size)}}class Bw extends Yf{constructor(e){super(),this.Xn=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.Xn.addEntry(e,s)):this.Xn.removeEntry(r)}),_.waitFor(t)}getFromCache(e,t){return this.Xn.getEntry(e,t)}getAllFromCache(e,t){return this.Xn.getEntries(e,t)}}class Uw{constructor(e){this.persistence=e,this.vs=new mn(t=>sr(t),Ui),this.lastRemoteSnapshotVersion=L.min(),this.highestTargetId=0,this.Ps=0,this.Vs=new Qu,this.targetCount=0,this.Ss=fr.Vn()}forEachTarget(e,t){return this.vs.forEach((r,s)=>t(s)),_.resolve()}getLastRemoteSnapshotVersion(e){return _.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _.resolve(this.Ps)}allocateTargetId(e){return this.highestTargetId=this.Ss.next(),_.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Ps&&(this.Ps=t),_.resolve()}xn(e){this.vs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ss=new fr(t),this.highestTargetId=t),e.sequenceNumber>this.Ps&&(this.Ps=e.sequenceNumber)}addTargetData(e,t){return this.xn(t),this.targetCount+=1,_.resolve()}updateTargetData(e,t){return this.xn(t),_.resolve()}removeTargetData(e,t){return this.vs.delete(t.target),this.Vs.ds(t.targetId),this.targetCount-=1,_.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.vs.forEach((o,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.vs.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),_.waitFor(i).next(()=>s)}getTargetCount(e){return _.resolve(this.targetCount)}getTargetData(e,t){const r=this.vs.get(t)||null;return _.resolve(r)}addMatchingKeys(e,t,r){return this.Vs.hs(t,r),_.resolve()}removeMatchingKeys(e,t,r){this.Vs.fs(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),_.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Vs.ds(t),_.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Vs.ws(t);return _.resolve(r)}containsKey(e,t){return _.resolve(this.Vs.containsKey(t))}}class rp{constructor(e,t){this.Ds={},this.overlays={},this.Cs=new ut(0),this.xs=!1,this.xs=!0,this.referenceDelegate=e(this),this.Ns=new Uw(this),this.indexManager=new Tw,this.remoteDocumentCache=new Rw(r=>this.referenceDelegate.ks(r)),this.Tt=new kf(t),this.Os=new Pw(this.Tt)}start(){return Promise.resolve()}shutdown(){return this.xs=!1,Promise.resolve()}get started(){return this.xs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Fw,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Ds[e.toKey()];return r||(r=new Lw(t,this.referenceDelegate),this.Ds[e.toKey()]=r),r}getTargetCache(){return this.Ns}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Os}runTransaction(e,t,r){A("MemoryPersistence","Starting transaction:",e);const s=new qw(this.Cs.next());return this.referenceDelegate.Ms(),r(s).next(i=>this.referenceDelegate.Fs(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}$s(e,t){return _.or(Object.values(this.Ds).map(r=>()=>r.containsKey(e,t)))}}class qw extends pd{constructor(e){super(),this.currentSequenceNumber=e}}class Ha{constructor(e){this.persistence=e,this.Bs=new Qu,this.Ls=null}static qs(e){return new Ha(e)}get Us(){if(this.Ls)return this.Ls;throw M()}addReference(e,t,r){return this.Bs.addReference(r,t),this.Us.delete(r.toString()),_.resolve()}removeReference(e,t,r){return this.Bs.removeReference(r,t),this.Us.add(r.toString()),_.resolve()}markPotentiallyOrphaned(e,t){return this.Us.add(t.toString()),_.resolve()}removeTarget(e,t){this.Bs.ds(t.targetId).forEach(s=>this.Us.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Us.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}Ms(){this.Ls=new Set}Fs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _.forEach(this.Us,r=>{const s=S.fromPath(r);return this.Ks(e,s).next(i=>{i||t.removeEntry(s,L.min())})}).next(()=>(this.Ls=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ks(e,t).next(r=>{r?this.Us.delete(t.toString()):this.Us.add(t.toString())})}ks(e){return 0}Ks(e,t){return _.or([()=>_.resolve(this.Bs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.$s(e,t)])}}class Gw{constructor(e){this.Tt=e}$(e,t,r,s){const i=new Ta("createOrUpgrade",t);var a;r<1&&s>=1&&(e.createObjectStore("owner"),(a=e).createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Af,{unique:!0}),a.createObjectStore("documentMutations"),sp(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=_.resolve();return r<3&&s>=3&&(0!==r&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),sp(e)),o=o.next(()=>function(a){const c=a.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:L.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",h)}(i))),r<4&&s>=4&&(0!==r&&(o=o.next(()=>function(a,c){return c.store("mutations").W().next(h=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Af,{unique:!0});const p=c.store("mutations"),m=h.map(y=>p.put(y));return _.waitFor(m)})}(e,i))),o=o.next(()=>{!function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&s>=5&&(o=o.next(()=>this.Gs(i))),r<6&&s>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Qs(i)))),r<7&&s>=7&&(o=o.next(()=>this.js(i))),r<8&&s>=8&&(o=o.next(()=>this.zs(e,i))),r<9&&s>=9&&(o=o.next(()=>{!function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&s>=10&&(o=o.next(()=>this.Ws(i))),r<11&&s>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{!function(a){const c=a.createObjectStore("documentOverlays",{keyPath:dw});c.createIndex("collectionPathOverlayIndex",fw,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",pw,{unique:!1})}(e)})),r<13&&s>=13&&(o=o.next(()=>function(a){const c=a.createObjectStore("remoteDocumentsV14",{keyPath:tw});c.createIndex("documentKeyIndex",nw),c.createIndex("collectionGroupIndex",rw)}(e)).next(()=>this.Hs(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.Js(e,i))),r<15&&s>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:lw}).createIndex("sequenceNumberIndex",uw,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:cw}).createIndex("documentKeyIndex",hw,{unique:!1})}(e))),o}Qs(e){let t=0;return e.store("remoteDocuments").X((r,s)=>{t+=$a(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Gs(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(s=>_.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>_.forEach(a,c=>{V(c.userId===i.userId);const h=cr(this.Tt,c);return zf(e,i.userId,h).next(()=>{})}))}))}js(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.X((o,a)=>{const c=new Q(o),h=[0,Ye(c)];i.push(t.get(h).next(p=>p?_.resolve():t.put({targetId:0,path:Ye(c),sequenceNumber:s.highestListenSequenceNumber})))}).next(()=>_.waitFor(i))})}zs(e,t){e.createObjectStore("collectionParents",{keyPath:aw});const r=t.store("collectionParents"),s=new Wu,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Ye(c)})}};return t.store("remoteDocuments").X({Z:!0},(o,a)=>{const c=new Q(o);return i(c.popLast())}).next(()=>t.store("documentMutations").X({Z:!0},([o,a,c],h)=>{const p=St(a);return i(p.popLast())}))}Ws(e){const t=e.store("targets");return t.X((r,s)=>{const i=Xi(s),o=Of(this.Tt,i);return t.put(o)})}Hs(e,t){const r=t.store("remoteDocuments"),s=[];return r.X((i,o)=>{const a=t.store("remoteDocumentsV14"),c=(h=o,h.document?new S(Q.fromString(h.document.name).popFirst(5)):h.noDocument?S.fromSegments(h.noDocument.path):h.unknownDocument?S.fromSegments(h.unknownDocument.path):M()).path.toArray();var h;const p={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(p))}).next(()=>_.waitFor(s))}Js(e,t){const r=t.store("mutations"),s=Xf(this.Tt),i=new rp(Ha.qs,this.Tt.oe);return r.W().next(o=>{const a=new Map;return o.forEach(c=>{var h;let p=null!==(h=a.get(c.userId))&&void 0!==h?h:$();cr(this.Tt,c).keys().forEach(m=>p=p.add(m)),a.set(c.userId,p)}),_.forEach(a,(c,h)=>{const p=new Oe(h),m=Ua.ue(this.Tt,p),y=i.getIndexManager(p),v=Ka.ue(p,this.Tt,y,i.referenceDelegate);return new np(s,v,m,y).recalculateAndSaveOverlaysForDocumentKeys(new Ru(t,ut.at),c).next()})})}}function sp(n){n.createObjectStore("targetDocuments",{keyPath:iw}).createIndex("documentTargetsIndex",ow,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",sw,{unique:!0}),n.createObjectStore("targetGlobal")}const Zu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Yu{constructor(e,t,r,s,i,o,a,c,h,p,m=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ys=i,this.window=o,this.document=a,this.Zs=h,this.Xs=p,this.ti=m,this.Cs=null,this.xs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ei=null,this.inForeground=!1,this.ni=null,this.si=null,this.ii=Number.NEGATIVE_INFINITY,this.ri=y=>Promise.resolve(),!Yu.C())throw new T(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new kw(this,s),this.oi=t+"main",this.Tt=new kf(c),this.ui=new vt(this.oi,this.ti,new Gw(this.Tt)),this.Ns=new Iw(this.referenceDelegate,this.Tt),this.remoteDocumentCache=Xf(this.Tt),this.Os=new ww,this.window&&this.window.localStorage?this.ci=this.window.localStorage:(this.ci=null,!1===p&&we("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new T(b.FAILED_PRECONDITION,Zu);return this.hi(),this.li(),this.fi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ns.getHighestSequenceNumber(e))}).then(e=>{this.Cs=new ut(e,this.Zs)}).then(()=>{this.xs=!0}).catch(e=>(this.ui&&this.ui.close(),Promise.reject(e)))}di(e){var t=this;return this.ri=function(){var r=(0,w.Z)(function*(s){if(t.started)return e(s)});return function(s){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ui.L(function(){var t=(0,w.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Ys.enqueueAndForget((0,w.Z)(function*(){t.started&&(yield t.ai())})))}ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Wa(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this._i(e).next(t=>{t||(this.isPrimary=!1,this.Ys.enqueueRetryable(()=>this.ri(!1)))})}).next(()=>this.wi(e)).next(t=>this.isPrimary&&!t?this.mi(e).next(()=>!1):!!t&&this.gi(e).next(()=>!0))).catch(e=>{if(un(e))return A("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return A("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ys.enqueueRetryable(()=>this.ri(e)),this.isPrimary=e})}_i(e){return so(e).get("owner").next(t=>_.resolve(this.yi(t)))}pi(e){return Wa(e).delete(this.clientId)}Ii(){var e=this;return(0,w.Z)(function*(){if(e.isPrimary&&!e.Ti(e.ii,18e5)){e.ii=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const s=Pe(r,"clientMetadata");return s.W().next(i=>{const o=e.Ei(i,18e5),a=i.filter(c=>-1===o.indexOf(c));return _.forEach(a,c=>s.delete(c.clientId)).next(()=>a)})}).catch(()=>[]);if(e.ci)for(const r of t)e.ci.removeItem(e.Ai(r.clientId))}})()}fi(){this.si=this.Ys.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ai().then(()=>this.Ii()).then(()=>this.fi()))}yi(e){return!!e&&e.ownerId===this.clientId}wi(e){return this.Xs?_.resolve(!0):so(e).get("owner").next(t=>{if(null!==t&&this.Ti(t.leaseTimestampMs,5e3)&&!this.Ri(t.ownerId)){if(this.yi(t)&&this.networkEnabled)return!0;if(!this.yi(t)){if(!t.allowTabSynchronization)throw new T(b.FAILED_PRECONDITION,Zu);return!1}}return!(!this.networkEnabled||!this.inForeground)||Wa(e).W().next(r=>void 0===this.Ei(r,5e3).find(s=>!(this.clientId===s.clientId||!(!this.networkEnabled&&s.networkEnabled||!this.inForeground&&s.inForeground&&this.networkEnabled===s.networkEnabled))))}).next(t=>(this.isPrimary!==t&&A("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,w.Z)(function*(){e.xs=!1,e.bi(),e.si&&(e.si.cancel(),e.si=null),e.vi(),e.Pi(),yield e.ui.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new Ru(t,ut.at);return e.mi(r).next(()=>e.pi(r))}),e.ui.close(),e.Vi()})()}Ei(e,t){return e.filter(r=>this.Ti(r.updateTimeMs,t)&&!this.Ri(r.clientId))}Si(){return this.runTransaction("getActiveClients","readonly",e=>Wa(e).W().next(t=>this.Ei(t,18e5).map(r=>r.clientId)))}get started(){return this.xs}getMutationQueue(e,t){return Ka.ue(e,this.Tt,t,this.referenceDelegate)}getTargetCache(){return this.Ns}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Aw(e,this.Tt.oe.databaseId)}getDocumentOverlayCache(e){return Ua.ue(this.Tt,e)}getBundleCache(){return this.Os}runTransaction(e,t,r){A("IndexedDbPersistence","Starting transaction:",e);const s="readonly"===t?"readonly":"readwrite",i=15===(o=this.ti)?gw:14===o?Mf:13===o?Df:12===o?mw:11===o?Sf:void M();var o;let a;return this.ui.runTransaction(e,s,i,c=>(a=new Ru(c,this.Cs?this.Cs.next():ut.at),"readwrite-primary"===t?this._i(a).next(h=>!!h||this.wi(a)).next(h=>{if(!h)throw we(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ys.enqueueRetryable(()=>this.ri(!1)),new T(b.FAILED_PRECONDITION,fd);return r(a)}).next(h=>this.gi(a).next(()=>h)):this.Di(a).next(()=>r(a)))).then(c=>(a.raiseOnCommittedEvent(),c))}Di(e){return so(e).get("owner").next(t=>{if(null!==t&&this.Ti(t.leaseTimestampMs,5e3)&&!this.Ri(t.ownerId)&&!this.yi(t)&&!(this.Xs||this.allowTabSynchronization&&t.allowTabSynchronization))throw new T(b.FAILED_PRECONDITION,Zu)})}gi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return so(e).put("owner",t)}static C(){return vt.C()}mi(e){const t=so(e);return t.get("owner").next(r=>this.yi(r)?(A("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):_.resolve())}Ti(e,t){const r=Date.now();return!(e<r-t||e>r&&(we(`Detected an update time that is in the future: ${e} > ${r}`),1))}hi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ni=()=>{this.Ys.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ai()))},this.document.addEventListener("visibilitychange",this.ni),this.inForeground="visible"===this.document.visibilityState)}vi(){this.ni&&(this.document.removeEventListener("visibilitychange",this.ni),this.ni=null)}li(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ei=()=>{this.bi(),(0,U.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Ys.enterRestrictedMode(!0),this.Ys.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ei))}Pi(){this.ei&&(this.window.removeEventListener("pagehide",this.ei),this.ei=null)}Ri(e){var t;try{const r=null!==(null===(t=this.ci)||void 0===t?void 0:t.getItem(this.Ai(e)));return A("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return we("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}bi(){if(this.ci)try{this.ci.setItem(this.Ai(this.clientId),String(Date.now()))}catch(e){we("Failed to set zombie client id.",e)}}Vi(){if(this.ci)try{this.ci.removeItem(this.Ai(this.clientId))}catch{}}Ai(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function so(n){return Pe(n,"owner")}function Wa(n){return Pe(n,"clientMetadata")}function Xu(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Ju{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Ci=r,this.xi=s}static Ni(e,t){let r=$(),s=$();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Ju(e,t.fromCache,r,s)}}class ip{constructor(){this.ki=!1}initialize(e,t){this.Oi=e,this.indexManager=t,this.ki=!0}getDocumentsMatchingQuery(e,t,r,s){return this.Mi(e,t).next(i=>i||this.Fi(e,t,s,r)).next(i=>i||this.$i(e,t))}Mi(e,t){if(Ud(t))return _.resolve(null);let r=Ze(t);return this.indexManager.getIndexType(e,r).next(s=>0===s?null:(null!==t.limit&&1===s&&(t=Na(t,null,"F"),r=Ze(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=$(...i);return this.Oi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const h=this.Bi(t,a);return this.Li(t,h,o,c.readTime)?this.Mi(e,Na(t,null,"F")):this.qi(e,h,t,c)}))})))}Fi(e,t,r,s){return Ud(t)||s.isEqual(L.min())?this.$i(e,t):this.Oi.getDocuments(e,r).next(i=>{const o=this.Bi(t,i);return this.Li(t,o,r,s)?this.$i(e,t):(mu()<=tt.in.DEBUG&&A("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Nu(t)),this.qi(e,o,t,hd(s,-1)))})}Bi(e,t){let r=new ne(jd(e));return t.forEach((s,i)=>{Gi(e,i)&&(r=r.add(i))}),r}Li(e,t,r,s){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}$i(e,t){return mu()<=tt.in.DEBUG&&A("QueryEngine","Using full collection scan to execute query:",Nu(t)),this.Oi.getDocumentsMatchingQuery(e,t,lt.min())}qi(e,t,r,s){return this.Oi.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}class jw{constructor(e,t,r,s){this.persistence=e,this.Ui=t,this.Tt=s,this.Ki=new ye(q),this.Gi=new mn(i=>sr(i),Ui),this.Qi=new Map,this.ji=e.getRemoteDocumentCache(),this.Ns=e.getTargetCache(),this.Os=e.getBundleCache(),this.zi(r)}zi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new np(this.ji,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ji.setIndexManager(this.indexManager),this.Ui.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ki))}}function op(n,e,t,r){return new jw(n,e,t,r)}function ap(n,e){return ec.apply(this,arguments)}function ec(){return ec=(0,w.Z)(function*(n,e){const t=D(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.zi(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=$();for(const h of s){o.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}for(const h of i){a.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}return t.localDocuments.getDocuments(r,c).next(h=>({Wi:h,removedBatchIds:o,addedBatchIds:a}))})})}),ec.apply(this,arguments)}function lp(n){const e=D(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ns.getLastRemoteSnapshotVersion(t))}function up(n,e,t){let r=$(),s=$();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=st();return t.forEach((a,c)=>{const h=i.get(a);c.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(L.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||0===c.version.compareTo(h.version)&&h.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):A("LocalStore","Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version)}),{Hi:o,Ji:s}})}function zw(n,e){const t=D(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ws(n,e){const t=D(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ns.getTargetData(r,e).next(i=>i?(s=i,_.resolve(s)):t.Ns.allocateTargetId(r).next(o=>(s=new yn(e,o,0,r.currentSequenceNumber),t.Ns.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.Ki.get(r.targetId);return(null===s||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ki=t.Ki.insert(r.targetId,r),t.Gi.set(e,r.targetId)),r})}function vs(n,e,t){return tc.apply(this,arguments)}function tc(){return tc=(0,w.Z)(function*(n,e,t){const r=D(n),s=r.Ki.get(e),i=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!un(o))throw o;A("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ki=r.Ki.remove(e),r.Gi.delete(s.target)}),tc.apply(this,arguments)}function Qa(n,e,t){const r=D(n);let s=L.min(),i=$();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,c,h){const p=D(a),m=p.Gi.get(h);return void 0!==m?_.resolve(p.Ki.get(m)):p.Ns.getTargetData(c,h)}(r,o,Ze(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ns.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Ui.getDocumentsMatchingQuery(o,e,t?s:L.min(),t?i:$())).next(a=>(dp(r,Gd(e),a),{documents:a,Yi:i})))}function cp(n,e){const t=D(n),r=D(t.Ns),s=t.Ki.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",i=>r.ie(i,e).next(o=>o?o.target:null))}function hp(n,e){const t=D(n),r=t.Qi.get(e)||L.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.ji.getAllFromCollectionGroup(s,e,hd(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(dp(t,e,s),s))}function dp(n,e,t){let r=n.Qi.get(e)||L.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Qi.set(e,r)}function nc(){return nc=(0,w.Z)(function*(n,e,t,r){const s=D(n);let i=$(),o=st();for(const h of t){const p=e.Zi(h.metadata.name);h.document&&(i=i.add(p));const m=e.Xi(h);m.setReadTime(e.tr(h.metadata.readTime)),o=o.insert(p,m)}const a=s.ji.newChangeBuffer({trackRemovals:!0}),c=yield ws(s,(h=r,Ze(us(Q.fromString(`__bundle__/docs/${h}`)))));var h;return s.persistence.runTransaction("Apply bundle documents","readwrite",h=>up(h,a,o).next(p=>(a.apply(h),p)).next(p=>s.Ns.removeMatchingKeysForTargetId(h,c.targetId).next(()=>s.Ns.addMatchingKeys(h,i,c.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(h,p.Hi,p.Ji)).next(()=>p.Hi)))}),nc.apply(this,arguments)}function Ww(n,e){return rc.apply(this,arguments)}function rc(){return rc=(0,w.Z)(function*(n,e,t=$()){const r=yield ws(n,Ze(Gu(e.bundledQuery))),s=D(n);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=ve(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Os.saveNamedQuery(i,e);const a=r.withResumeToken(Se.EMPTY_BYTE_STRING,o);return s.Ki=s.Ki.insert(a.targetId,a),s.Ns.updateTargetData(i,a).next(()=>s.Ns.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Ns.addMatchingKeys(i,t,r.targetId)).next(()=>s.Os.saveNamedQuery(i,e))})}),rc.apply(this,arguments)}function fp(n,e){return`firestore_clients_${n}_${e}`}function pp(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function sc(n,e){return`firestore_targets_${n}_${e}`}class Za{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static er(e,t,r){const s=JSON.parse(r);let i,o="object"==typeof s&&-1!==["pending","acknowledged","rejected"].indexOf(s.state)&&(void 0===s.error||"object"==typeof s.error);return o&&s.error&&(o="string"==typeof s.error.message&&"string"==typeof s.error.code,o&&(i=new T(s.error.code,s.error.message))),o?new Za(e,t,s.state,i):(we("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}nr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class io{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static er(e,t){const r=JSON.parse(t);let s,i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code,i&&(s=new T(r.error.code,r.error.message))),i?new io(e,r.state,s):(we("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}nr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ya{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static er(e,t){const r=JSON.parse(t);let s="object"==typeof r&&r.activeTargetIds instanceof Array,i=Fa();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=wd(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new Ya(e,i):(we("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class ic{constructor(e,t){this.clientId=e,this.onlineState=t}static er(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new ic(t.clientId,t.onlineState):(we("SharedClientState",`Failed to parse online state: ${e}`),null)}}class oc{constructor(){this.activeTargetIds=Fa()}sr(e){this.activeTargetIds=this.activeTargetIds.add(e)}ir(e){this.activeTargetIds=this.activeTargetIds.delete(e)}nr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ac{constructor(e,t,r,s,i){this.window=e,this.Ys=t,this.persistenceKey=r,this.rr=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ur=this.cr.bind(this),this.ar=new ye(q),this.started=!1,this.hr=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.lr=fp(this.persistenceKey,this.rr),this.dr=`firestore_sequence_number_${this.persistenceKey}`,this.ar=this.ar.insert(this.rr,new oc),this._r=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.wr=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.mr=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.gr=`firestore_online_state_${this.persistenceKey}`,this.yr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.ur)}static C(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,w.Z)(function*(){const t=yield e.syncEngine.Si();for(const s of t){if(s===e.rr)continue;const i=e.getItem(fp(e.persistenceKey,s));if(i){const o=Ya.er(s,i);o&&(e.ar=e.ar.insert(o.clientId,o))}}e.pr();const r=e.storage.getItem(e.gr);if(r){const s=e.Ir(r);s&&e.Tr(s)}for(const s of e.hr)e.cr(s);e.hr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.dr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Er(this.ar)}isActiveQueryTarget(e){let t=!1;return this.ar.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ar(e,"pending")}updateMutationState(e,t,r){this.Ar(e,t,r),this.Rr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(sc(this.persistenceKey,e));if(r){const s=io.er(e,r);s&&(t=s.state)}}return this.br.sr(e),this.pr(),t}removeLocalQueryTarget(e){this.br.ir(e),this.pr()}isLocalQueryTarget(e){return this.br.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(sc(this.persistenceKey,e))}updateQueryState(e,t,r){this.vr(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.Rr(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Pr(e)}notifyBundleLoaded(e){this.Vr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ur),this.removeItem(this.lr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return A("SharedClientState","READ",e,t),t}setItem(e,t){A("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){A("SharedClientState","REMOVE",e),this.storage.removeItem(e)}cr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(A("SharedClientState","EVENT",r.key,r.newValue),r.key===this.lr)return void we("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ys.enqueueRetryable((0,w.Z)(function*(){if(t.started){if(null!==r.key)if(t._r.test(r.key)){if(null==r.newValue){const s=t.Sr(r.key);return t.Dr(s,null)}{const s=t.Cr(r.key,r.newValue);if(s)return t.Dr(s.clientId,s)}}else if(t.wr.test(r.key)){if(null!==r.newValue){const s=t.Nr(r.key,r.newValue);if(s)return t.kr(s)}}else if(t.mr.test(r.key)){if(null!==r.newValue){const s=t.Or(r.key,r.newValue);if(s)return t.Mr(s)}}else if(r.key===t.gr){if(null!==r.newValue){const s=t.Ir(r.newValue);if(s)return t.Tr(s)}}else if(r.key===t.dr){const s=function(i){let o=ut.at;if(null!=i)try{const a=JSON.parse(i);V("number"==typeof a),o=a}catch(a){we("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(r.newValue);s!==ut.at&&t.sequenceNumberHandler(s)}else if(r.key===t.yr){const s=t.Fr(r.newValue);yield Promise.all(s.map(i=>t.syncEngine.$r(i)))}}else t.hr.push(r)}))}}get br(){return this.ar.get(this.rr)}pr(){this.setItem(this.lr,this.br.nr())}Ar(e,t,r){const s=new Za(this.currentUser,e,t,r),i=pp(this.persistenceKey,this.currentUser,e);this.setItem(i,s.nr())}Rr(e){const t=pp(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Pr(e){this.storage.setItem(this.gr,JSON.stringify({clientId:this.rr,onlineState:e}))}vr(e,t,r){const s=sc(this.persistenceKey,e),i=new io(e,t,r);this.setItem(s,i.nr())}Vr(e){const t=JSON.stringify(Array.from(e));this.setItem(this.yr,t)}Sr(e){const t=this._r.exec(e);return t?t[1]:null}Cr(e,t){const r=this.Sr(e);return Ya.er(r,t)}Nr(e,t){const r=this.wr.exec(e),s=Number(r[1]);return Za.er(new Oe(void 0!==r[2]?r[2]:null),s,t)}Or(e,t){const r=this.mr.exec(e),s=Number(r[1]);return io.er(s,t)}Ir(e){return ic.er(e)}Fr(e){return JSON.parse(e)}kr(e){var t=this;return(0,w.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Br(e.batchId,e.state,e.error);A("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Mr(e){return this.syncEngine.Lr(e.targetId,e.state,e.error)}Dr(e,t){const r=t?this.ar.insert(e,t):this.ar.remove(e),s=this.Er(this.ar),i=this.Er(r),o=[],a=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.qr(o,a).then(()=>{this.ar=r})}Tr(e){this.ar.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Er(e){let t=Fa();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class mp{constructor(){this.Ur=new oc,this.Kr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Ur.sr(e),this.Kr[e]||"not-current"}updateQueryState(e,t,r){this.Kr[e]=t}removeLocalQueryTarget(e){this.Ur.ir(e)}isLocalQueryTarget(e){return this.Ur.activeTargetIds.has(e)}clearQueryState(e){delete this.Kr[e]}getAllActiveQueryTargets(){return this.Ur.activeTargetIds}isActiveQueryTarget(e){return this.Ur.activeTargetIds.has(e)}start(){return this.Ur=new oc,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Qw{Gr(e){}shutdown(){}}class gp{constructor(){this.Qr=()=>this.jr(),this.zr=()=>this.Wr(),this.Hr=[],this.Jr()}Gr(e){this.Hr.push(e)}shutdown(){window.removeEventListener("online",this.Qr),window.removeEventListener("offline",this.zr)}Jr(){window.addEventListener("online",this.Qr),window.addEventListener("offline",this.zr)}jr(){A("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Hr)e(0)}Wr(){A("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Hr)e(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Zw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Yw{constructor(e){this.Yr=e.Yr,this.Zr=e.Zr}Xr(e){this.eo=e}no(e){this.so=e}onMessage(e){this.io=e}close(){this.Zr()}send(e){this.Yr(e)}ro(){this.eo()}oo(e){this.so(e)}uo(e){this.io(e)}}class Xw extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.co=(e.ssl?"https":"http")+"://"+e.host,this.ao="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get ho(){return!1}lo(e,t,r,s,i){const o=this.fo(e,t);A("RestConnection","Sending: ",o,r);const a={};return this._o(a,s,i),this.wo(e,o,a,r).then(c=>(A("RestConnection","Received: ",c),c),c=>{throw Yn("RestConnection",`${e} failed with error: `,c,"url: ",o,"request:",r),c})}mo(e,t,r,s,i,o){return this.lo(e,t,r,s,i)}_o(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+rs,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}fo(e,t){return`${this.co}/v1/${t}:${Zw[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}wo(e,t,r,s){return new Promise((i,o)=>{const a=new Wg;a.setWithCredentials(!0),a.listenOnce(Kg.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case pu.NO_ERROR:const h=a.getResponseJson();A("Connection","XHR received:",JSON.stringify(h)),i(h);break;case pu.TIMEOUT:A("Connection",'RPC "'+e+'" timed out'),o(new T(b.DEADLINE_EXCEEDED,"Request time out"));break;case pu.HTTP_ERROR:const p=a.getStatus();if(A("Connection",'RPC "'+e+'" failed with status:',p,"response text:",a.getResponseText()),p>0){let m=a.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m?.error;if(y&&y.status&&y.message){const v=function(E){const I=E.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(I)>=0?I:b.UNKNOWN}(y.status);o(new T(v,y.message))}else o(new T(b.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new T(b.UNAVAILABLE,"Connection failed."));break;default:M()}}finally{A("Connection",'RPC "'+e+'" completed.')}});const c=JSON.stringify(s);a.send(t,"POST",c,r,15)})}yo(e,t,r){const s=[this.co,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=jg(),o=$g(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new Hg({})),this._o(a.initMessageHeaders,t,r),a.encodeInitMessageHeaders=!0;const c=s.join("");A("Connection","Creating WebChannel: "+c,a);const h=i.createWebChannel(c,a);let p=!1,m=!1;const y=new Yw({Yr:E=>{m?A("Connection","Not sending because WebChannel is closed:",E):(p||(A("Connection","Opening WebChannel transport."),h.open(),p=!0),A("Connection","WebChannel sending:",E),h.send(E))},Zr:()=>h.close()}),v=(E,I,O)=>{E.listen(I,J=>{try{O(J)}catch(k){setTimeout(()=>{throw k},0)}})};return v(h,Ca.EventType.OPEN,()=>{m||A("Connection","WebChannel transport opened.")}),v(h,Ca.EventType.CLOSE,()=>{m||(m=!0,A("Connection","WebChannel transport closed"),y.oo())}),v(h,Ca.EventType.ERROR,E=>{m||(m=!0,Yn("Connection","WebChannel transport errored:",E),y.oo(new T(b.UNAVAILABLE,"The operation could not be completed")))}),v(h,Ca.EventType.MESSAGE,E=>{var I;if(!m){const O=E.data[0];V(!!O);const k=O.error||(null===(I=O[0])||void 0===I?void 0:I.error);if(k){A("Connection","WebChannel received error:",k);const P=k.status;let ue=function(X){const De=Ee[X];if(void 0!==De)return sf(De)}(P),z=k.message;void 0===ue&&(ue=b.INTERNAL,z="Unknown error status: "+P+" with message "+k.message),m=!0,y.oo(new T(ue,z)),h.close()}else A("Connection","WebChannel received:",O),y.uo(O)}}),v(o,zg.STAT_EVENT,E=>{E.stat===id.PROXY?A("Connection","Detected buffering proxy"):E.stat===id.NOPROXY&&A("Connection","Detected no buffering proxy")}),setTimeout(()=>{y.ro()},0),y}}function yp(){return typeof window<"u"?window:null}function Xa(){return typeof document<"u"?document:null}function oo(n){return new jy(n,!0)}class lc{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Ys=e,this.timerId=t,this.po=r,this.Io=s,this.To=i,this.Eo=0,this.Ao=null,this.Ro=Date.now(),this.reset()}reset(){this.Eo=0}bo(){this.Eo=this.To}vo(e){this.cancel();const t=Math.floor(this.Eo+this.Po()),r=Math.max(0,Date.now()-this.Ro),s=Math.max(0,t-r);s>0&&A("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Eo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Ao=this.Ys.enqueueAfterDelay(this.timerId,s,()=>(this.Ro=Date.now(),e())),this.Eo*=this.Io,this.Eo<this.po&&(this.Eo=this.po),this.Eo>this.To&&(this.Eo=this.To)}Vo(){null!==this.Ao&&(this.Ao.skipDelay(),this.Ao=null)}cancel(){null!==this.Ao&&(this.Ao.cancel(),this.Ao=null)}Po(){return(Math.random()-.5)*this.Eo}}class wp{constructor(e,t,r,s,i,o,a,c){this.Ys=e,this.So=r,this.Do=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Co=0,this.xo=null,this.No=null,this.stream=null,this.ko=new lc(e,t)}Oo(){return 1===this.state||5===this.state||this.Mo()}Mo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Fo()}stop(){var e=this;return(0,w.Z)(function*(){e.Oo()&&(yield e.close(0))})()}$o(){this.state=0,this.ko.reset()}Bo(){this.Mo()&&null===this.xo&&(this.xo=this.Ys.enqueueAfterDelay(this.So,6e4,()=>this.Lo()))}qo(e){this.Uo(),this.stream.send(e)}Lo(){var e=this;return(0,w.Z)(function*(){if(e.Mo())return e.close(0)})()}Uo(){this.xo&&(this.xo.cancel(),this.xo=null)}Ko(){this.No&&(this.No.cancel(),this.No=null)}close(e,t){var r=this;return(0,w.Z)(function*(){r.Uo(),r.Ko(),r.ko.cancel(),r.Co++,4!==e?r.ko.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(we(t.toString()),we("Using maximum backoff delay to prevent overloading the backend."),r.ko.bo()):t&&t.code===b.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Go(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.no(t)})()}Go(){}auth(){this.state=1;const e=this.Qo(this.Co),t=this.Co;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Co===t&&this.jo(r,s)},r=>{e(()=>{const s=new T(b.UNKNOWN,"Fetching auth token failed: "+r.message);return this.zo(s)})})}jo(e,t){const r=this.Qo(this.Co);this.stream=this.Wo(e,t),this.stream.Xr(()=>{r(()=>(this.state=2,this.No=this.Ys.enqueueAfterDelay(this.Do,1e4,()=>(this.Mo()&&(this.state=3),Promise.resolve())),this.listener.Xr()))}),this.stream.no(s=>{r(()=>this.zo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Fo(){var e=this;this.state=5,this.ko.vo((0,w.Z)(function*(){e.state=0,e.start()}))}zo(e){return A("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Qo(e){return t=>{this.Ys.enqueueAndForget(()=>this.Co===e?t():(A("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Jw extends wp{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.Tt=i}Wo(e,t){return this.connection.yo("Listen",e,t)}onMessage(e){this.ko.reset();const t=function zy(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(c=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===c?1:"REMOVE"===c?2:"CURRENT"===c?3:"RESET"===c?4:M(),s=e.targetChange.targetIds||[],i=function(c,h){return c.yt?(V(void 0===h||"string"==typeof h),Se.fromBase64String(h||"")):(V(void 0===h||h instanceof Uint8Array),Se.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const h=void 0===c.code?b.UNKNOWN:sf(c.code);return new T(h,c.message||"")}(o);t=new cf(r,s,i,a||null)}else if("documentChange"in e){const r=e.documentChange,s=It(n,r.document.name),i=ve(r.document.updateTime),o=r.document.createTime?ve(r.document.createTime):L.min(),a=new Ve({mapValue:{fields:r.document.fields}}),c=oe.newFoundDocument(s,i,o,a);t=new La(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if("documentDelete"in e){const r=e.documentDelete,s=It(n,r.document),i=r.readTime?ve(r.readTime):L.min(),o=oe.newNoDocument(s,i);t=new La([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const r=e.documentRemove,s=It(n,r.document);t=new La([],r.removedTargetIds||[],s,null)}else{if(!("filter"in e))return M();{const r=e.filter,i=new Vy(r.count||0);t=new uf(r.targetId,i)}}var c;return t}(this.Tt,e),r=function(s){if(!("targetChange"in s))return L.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?L.min():i.readTime?ve(i.readTime):L.min()}(e);return this.listener.Ho(t,r)}Jo(e){const t={};t.database=Zi(this.Tt),t.addTarget=function(s,i){let o;const a=i.target;return o=Da(a)?{documents:_f(s,a)}:{query:Lu(s,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=pf(s,i.resumeToken):i.snapshotVersion.compareTo(L.min())>0&&(o.readTime=ps(s,i.snapshotVersion.toTimestamp())),o}(this.Tt,e);const r=function Wy(n,e){const t=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return M()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.qo(t)}Yo(e){const t={};t.database=Zi(this.Tt),t.removeTarget=e,this.qo(t)}}class ev extends wp{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.Tt=i,this.Zo=!1}get Xo(){return this.Zo}start(){this.Zo=!1,this.lastStreamToken=void 0,super.start()}Go(){this.Zo&&this.tu([])}Wo(e,t){return this.connection.yo("Write",e,t)}onMessage(e){if(V(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Zo){this.ko.reset();const t=function Hy(n,e){return n&&n.length>0?(V(void 0!==e),n.map(t=>function(r,s){let i=ve(r.updateTime?r.updateTime:s);return i.isEqual(L.min())&&(i=ve(s)),new ky(i,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=ve(e.commitTime);return this.listener.eu(r,t)}return V(!e.writeResults||0===e.writeResults.length),this.Zo=!0,this.listener.nu()}su(){const e={};e.database=Zi(this.Tt),this.qo(e)}tu(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Yi(this.Tt,r))};this.qo(t)}}class tv extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.Tt=s,this.iu=!1}ru(){if(this.iu)throw new T(b.FAILED_PRECONDITION,"The client has already been terminated.")}lo(e,t,r){return this.ru(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.lo(e,t,r,s,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new T(b.UNKNOWN,s.toString())})}mo(e,t,r,s){return this.ru(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.mo(e,t,r,i,o,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new T(b.UNKNOWN,i.toString())})}terminate(){this.iu=!0}}class rv{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.ou=0,this.uu=null,this.cu=!0}au(){0===this.ou&&(this.hu("Unknown"),this.uu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.uu=null,this.lu("Backend didn't respond within 10 seconds."),this.hu("Offline"),Promise.resolve())))}fu(e){"Online"===this.state?this.hu("Unknown"):(this.ou++,this.ou>=1&&(this.du(),this.lu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.hu("Offline")))}set(e){this.du(),this.ou=0,"Online"===e&&(this.cu=!1),this.hu(e)}hu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}lu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.cu?(we(t),this.cu=!1):A("OnlineStateTracker",t)}du(){null!==this.uu&&(this.uu.cancel(),this.uu=null)}}class sv{constructor(e,t,r,s,i){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this._u=[],this.wu=new Map,this.mu=new Set,this.gu=[],this.yu=i,this.yu.Gr(a=>{r.enqueueAndForget((0,w.Z)(function*(){var c;zt(o)&&(A("RemoteStore","Restarting streams for network reachability change."),yield(c=(0,w.Z)(function*(h){const p=D(h);p.mu.add(4),yield _s(p),p.pu.set("Unknown"),p.mu.delete(4),yield ao(p)}),function(h){return c.apply(this,arguments)})(o))}))}),this.pu=new rv(r,s)}}function ao(n){return cc.apply(this,arguments)}function cc(){return cc=(0,w.Z)(function*(n){if(zt(n))for(const e of n.gu)yield e(!0)}),cc.apply(this,arguments)}function _s(n){return hc.apply(this,arguments)}function hc(){return hc=(0,w.Z)(function*(n){for(const e of n.gu)yield e(!1)}),hc.apply(this,arguments)}function Ja(n,e){const t=D(n);t.wu.has(e.targetId)||(t.wu.set(e.targetId,e),pc(t)?fc(t):Cs(t).Mo()&&dc(t,e))}function lo(n,e){const t=D(n),r=Cs(t);t.wu.delete(e),r.Mo()&&vp(t,e),0===t.wu.size&&(r.Mo()?r.Bo():zt(t)&&t.pu.set("Unknown"))}function dc(n,e){n.Iu.Ft(e.targetId),Cs(n).Jo(e)}function vp(n,e){n.Iu.Ft(e),Cs(n).Yo(e)}function fc(n){n.Iu=new By({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ie:e=>n.wu.get(e)||null}),Cs(n).start(),n.pu.au()}function pc(n){return zt(n)&&!Cs(n).Oo()&&n.wu.size>0}function zt(n){return 0===D(n).mu.size}function _p(n){n.Iu=void 0}function iv(n){return mc.apply(this,arguments)}function mc(){return mc=(0,w.Z)(function*(n){n.wu.forEach((e,t)=>{dc(n,e)})}),mc.apply(this,arguments)}function ov(n,e){return gc.apply(this,arguments)}function gc(){return gc=(0,w.Z)(function*(n,e){_p(n),pc(n)?(n.pu.fu(e),fc(n)):n.pu.set("Unknown")}),gc.apply(this,arguments)}function av(n,e,t){return yc.apply(this,arguments)}function yc(){return yc=(0,w.Z)(function*(n,e,t){if(n.pu.set("Online"),e instanceof cf&&2===e.state&&e.cause)try{yield(r=(0,w.Z)(function*(s,i){const o=i.cause;for(const a of i.targetIds)s.wu.has(a)&&(yield s.remoteSyncer.rejectListen(a,o),s.wu.delete(a),s.Iu.removeTarget(a))}),function(s,i){return r.apply(this,arguments)})(n,e)}catch(r){A("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield el(n,r)}else if(e instanceof La?n.Iu.Qt(e):e instanceof uf?n.Iu.Zt(e):n.Iu.Wt(e),!t.isEqual(L.min()))try{const r=yield lp(n.localStore);t.compareTo(r)>=0&&(yield function(s,i){const o=s.Iu.ee(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const h=s.wu.get(c);h&&s.wu.set(c,h.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const c=s.wu.get(a);if(!c)return;s.wu.set(a,c.withResumeToken(Se.EMPTY_BYTE_STRING,c.snapshotVersion)),vp(s,a);const h=new yn(c.target,a,1,c.sequenceNumber);dc(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(n,t))}catch(r){A("RemoteStore","Failed to raise snapshot:",r),yield el(n,r)}var r}),yc.apply(this,arguments)}function el(n,e,t){return wc.apply(this,arguments)}function wc(){return wc=(0,w.Z)(function*(n,e,t){if(!un(e))throw e;n.mu.add(1),yield _s(n),n.pu.set("Offline"),t||(t=()=>lp(n.localStore)),n.asyncQueue.enqueueRetryable((0,w.Z)(function*(){A("RemoteStore","Retrying IndexedDB access"),yield t(),n.mu.delete(1),yield ao(n)}))}),wc.apply(this,arguments)}function bp(n,e){return e().catch(t=>el(n,t,e))}function bs(n){return vc.apply(this,arguments)}function vc(){return vc=(0,w.Z)(function*(n){const e=D(n),t=bn(e);let r=e._u.length>0?e._u[e._u.length-1].batchId:-1;for(;lv(e);)try{const s=yield zw(e.localStore,r);if(null===s){0===e._u.length&&t.Bo();break}r=s.batchId,uv(e,s)}catch(s){yield el(e,s)}Cp(e)&&xp(e)}),vc.apply(this,arguments)}function lv(n){return zt(n)&&n._u.length<10}function uv(n,e){n._u.push(e);const t=bn(n);t.Mo()&&t.Xo&&t.tu(e.mutations)}function Cp(n){return zt(n)&&!bn(n).Oo()&&n._u.length>0}function xp(n){bn(n).start()}function cv(n){return _c.apply(this,arguments)}function _c(){return _c=(0,w.Z)(function*(n){bn(n).su()}),_c.apply(this,arguments)}function hv(n){return bc.apply(this,arguments)}function bc(){return bc=(0,w.Z)(function*(n){const e=bn(n);for(const t of n._u)e.tu(t.mutations)}),bc.apply(this,arguments)}function dv(n,e,t){return Cc.apply(this,arguments)}function Cc(){return Cc=(0,w.Z)(function*(n,e,t){const r=n._u.shift(),s=Uu.from(r,e,t);yield bp(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield bs(n)}),Cc.apply(this,arguments)}function fv(n,e){return xc.apply(this,arguments)}function xc(){return xc=(0,w.Z)(function*(n,e){var t;e&&bn(n).Xo&&(yield(t=(0,w.Z)(function*(r,s){if(rf(i=s.code)&&i!==b.ABORTED){const o=r._u.shift();bn(r).$o(),yield bp(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield bs(r)}var i}),function(r,s){return t.apply(this,arguments)})(n,e)),Cp(n)&&xp(n)}),xc.apply(this,arguments)}function Ep(n,e){return Ec.apply(this,arguments)}function Ec(){return Ec=(0,w.Z)(function*(n,e){const t=D(n);t.asyncQueue.verifyOperationInProgress(),A("RemoteStore","RemoteStore received new credentials");const r=zt(t);t.mu.add(3),yield _s(t),r&&t.pu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.mu.delete(3),yield ao(t)}),Ec.apply(this,arguments)}function Tc(n,e){return Ac.apply(this,arguments)}function Ac(){return Ac=(0,w.Z)(function*(n,e){const t=D(n);e?(t.mu.delete(2),yield ao(t)):e||(t.mu.add(2),yield _s(t),t.pu.set("Unknown"))}),Ac.apply(this,arguments)}function Cs(n){return n.Tu||(n.Tu=function(e,t,r){const s=D(e);return s.ru(),new Jw(t,s.connection,s.authCredentials,s.appCheckCredentials,s.Tt,r)}(n.datastore,n.asyncQueue,{Xr:iv.bind(null,n),no:ov.bind(null,n),Ho:av.bind(null,n)}),n.gu.push(function(){var e=(0,w.Z)(function*(t){t?(n.Tu.$o(),pc(n)?fc(n):n.pu.set("Unknown")):(yield n.Tu.stop(),_p(n))});return function(t){return e.apply(this,arguments)}}())),n.Tu}function bn(n){return n.Eu||(n.Eu=function(e,t,r){const s=D(e);return s.ru(),new ev(t,s.connection,s.authCredentials,s.appCheckCredentials,s.Tt,r)}(n.datastore,n.asyncQueue,{Xr:cv.bind(null,n),no:fv.bind(null,n),nu:hv.bind(null,n),eu:dv.bind(null,n)}),n.gu.push(function(){var e=(0,w.Z)(function*(t){t?(n.Eu.$o(),yield bs(n)):(yield n.Eu.stop(),n._u.length>0&&(A("RemoteStore",`Stopping write stream with ${n._u.length} pending writes`),n._u=[]))});return function(t){return e.apply(this,arguments)}}())),n.Eu}class Ic{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ie,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new Ic(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new T(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xs(n,e){if(we("AsyncQueue",`${e}: ${n}`),un(n))return new T(b.UNAVAILABLE,`${e}: ${n}`);throw n}class Es{constructor(e){this.comparator=e?(t,r)=>e(t,r)||S.comparator(t.key,r.key):(t,r)=>S.comparator(t.key,r.key),this.keyedMap=Ki(),this.sortedSet=new ye(this.comparator)}static emptySet(e){return new Es(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Es)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Es;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Tp{constructor(){this.Au=new ye(S.comparator)}track(e){const t=e.doc.key,r=this.Au.get(t);r?0!==e.type&&3===r.type?this.Au=this.Au.insert(t,e):3===e.type&&1!==r.type?this.Au=this.Au.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Au=this.Au.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Au=this.Au.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Au=this.Au.remove(t):1===e.type&&2===r.type?this.Au=this.Au.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Au=this.Au.insert(t,{type:2,doc:e.doc}):M():this.Au=this.Au.insert(t,e)}Ru(){const e=[];return this.Au.inorderTraversal((t,r)=>{e.push(r)}),e}}class Ts{constructor(e,t,r,s,i,o,a,c,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Ts(e,t,Es.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class pv{constructor(){this.bu=void 0,this.listeners=[]}}class mv{constructor(){this.queries=new mn(e=>qd(e),qi),this.onlineState="Unknown",this.vu=new Set}}function Sc(n,e){return Dc.apply(this,arguments)}function Dc(){return Dc=(0,w.Z)(function*(n,e){const t=D(n),r=e.query;let s=!1,i=t.queries.get(r);if(i||(s=!0,i=new pv),s)try{i.bu=yield t.onListen(r)}catch(o){const a=xs(o,`Initialization of query '${Nu(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,i),i.listeners.push(e),e.Pu(t.onlineState),i.bu&&e.Vu(i.bu)&&Nc(t)}),Dc.apply(this,arguments)}function Mc(n,e){return kc.apply(this,arguments)}function kc(){return kc=(0,w.Z)(function*(n,e){const t=D(n),r=e.query;let s=!1;const i=t.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=0===i.listeners.length)}if(s)return t.queries.delete(r),t.onUnlisten(r)}),kc.apply(this,arguments)}function gv(n,e){const t=D(n);let r=!1;for(const s of e){const o=t.queries.get(s.query);if(o){for(const a of o.listeners)a.Vu(s)&&(r=!0);o.bu=s}}r&&Nc(t)}function yv(n,e,t){const r=D(n),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(t);r.queries.delete(e)}function Nc(n){n.vu.forEach(e=>{e.next()})}class Oc{constructor(e,t,r){this.query=e,this.Su=t,this.Du=!1,this.Cu=null,this.onlineState="Unknown",this.options=r||{}}Vu(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)3!==s.type&&r.push(s);e=new Ts(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Du?this.xu(e)&&(this.Su.next(e),t=!0):this.Nu(e,this.onlineState)&&(this.ku(e),t=!0),this.Cu=e,t}onError(e){this.Su.error(e)}Pu(e){this.onlineState=e;let t=!1;return this.Cu&&!this.Du&&this.Nu(this.Cu,e)&&(this.ku(this.Cu),t=!0),t}Nu(e,t){return!e.fromCache||(!this.options.Ou||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}xu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Cu&&this.Cu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}ku(e){e=Ts.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Du=!0,this.Su.next(e)}}class wv{constructor(e,t){this.Mu=e,this.byteLength=t}Fu(){return"metadata"in this.Mu}}class Ap{constructor(e){this.Tt=e}Zi(e){return It(this.Tt,e)}Xi(e){return e.metadata.exists?vf(this.Tt,e.document,!1):oe.newNoDocument(this.Zi(e.metadata.name),this.tr(e.metadata.readTime))}tr(e){return ve(e)}}class vv{constructor(e,t,r){this.$u=e,this.localStore=t,this.Tt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Ip(e)}Bu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Mu.namedQuery)this.queries.push(e.Mu.namedQuery);else if(e.Mu.documentMetadata){this.documents.push({metadata:e.Mu.documentMetadata}),e.Mu.documentMetadata.exists||++t;const r=Q.fromString(e.Mu.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Mu.document&&(this.documents[this.documents.length-1].document=e.Mu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Lu(e){const t=new Map,r=new Ap(this.Tt);for(const s of e)if(s.metadata.queries){const i=r.Zi(s.metadata.name);for(const o of s.metadata.queries){const a=(t.get(o)||$()).add(i);t.set(o,a)}}return t}complete(){var e=this;return(0,w.Z)(function*(){const t=yield function Hw(n,e,t,r){return nc.apply(this,arguments)}(e.localStore,new Ap(e.Tt),e.documents,e.$u.id),r=e.Lu(e.documents);for(const s of e.queries)yield Ww(e.localStore,s,r.get(s.name));return e.progress.taskState="Success",{progress:e.progress,qu:e.collectionGroups,Uu:t}})()}}function Ip(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class Sp{constructor(e){this.key=e}}class Dp{constructor(e){this.key=e}}class Mp{constructor(e,t){this.query=e,this.Ku=t,this.Gu=null,this.hasCachedResults=!1,this.current=!1,this.Qu=$(),this.mutatedKeys=$(),this.ju=jd(e),this.zu=new Es(this.ju)}get Wu(){return this.Ku}Hu(e,t){const r=t?t.Ju:new Tp,s=t?t.zu:this.zu;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,h="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,m)=>{const y=s.get(p),v=Gi(this.query,m)?m:null,E=!!y&&this.mutatedKeys.has(y.key),I=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let O=!1;y&&v?y.data.isEqual(v.data)?E!==I&&(r.track({type:3,doc:v}),O=!0):this.Yu(y,v)||(r.track({type:2,doc:v}),O=!0,(c&&this.ju(v,c)>0||h&&this.ju(v,h)<0)&&(a=!0)):!y&&v?(r.track({type:0,doc:v}),O=!0):y&&!v&&(r.track({type:1,doc:y}),O=!0,(c||h)&&(a=!0)),O&&(v?(o=o.add(v),i=I?i.add(p):i.delete(p)):(o=o.delete(p),i=i.delete(p)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const p="F"===this.query.limitType?o.last():o.first();o=o.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{zu:o,Ju:r,Li:a,mutatedKeys:i}}Yu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const s=this.zu;this.zu=e.zu,this.mutatedKeys=e.mutatedKeys;const i=e.Ju.Ru();i.sort((h,p)=>function(m,y){const v=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return M()}};return v(m)-v(y)}(h.type,p.type)||this.ju(h.doc,p.doc)),this.Zu(r);const o=t?this.Xu():[],a=0===this.Qu.size&&this.current?1:0,c=a!==this.Gu;return this.Gu=a,0!==i.length||c?{snapshot:new Ts(this.query,e.zu,s,i,e.mutatedKeys,0===a,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),tc:o}:{tc:o}}Pu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({zu:this.zu,Ju:new Tp,mutatedKeys:this.mutatedKeys,Li:!1},!1)):{tc:[]}}ec(e){return!this.Ku.has(e)&&!!this.zu.has(e)&&!this.zu.get(e).hasLocalMutations}Zu(e){e&&(e.addedDocuments.forEach(t=>this.Ku=this.Ku.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ku=this.Ku.delete(t)),this.current=e.current)}Xu(){if(!this.current)return[];const e=this.Qu;this.Qu=$(),this.zu.forEach(r=>{this.ec(r.key)&&(this.Qu=this.Qu.add(r.key))});const t=[];return e.forEach(r=>{this.Qu.has(r)||t.push(new Dp(r))}),this.Qu.forEach(r=>{e.has(r)||t.push(new Sp(r))}),t}nc(e){this.Ku=e.Yi,this.Qu=$();const t=this.Hu(e.documents);return this.applyChanges(t,!0)}sc(){return Ts.fromInitialDocuments(this.query,this.zu,this.mutatedKeys,0===this.Gu,this.hasCachedResults)}}class _v{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class bv{constructor(e){this.key=e,this.ic=!1}}class Cv{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.rc={},this.oc=new mn(a=>qd(a),qi),this.uc=new Map,this.cc=new Set,this.ac=new ye(S.comparator),this.hc=new Map,this.lc=new Qu,this.fc={},this.dc=new Map,this._c=fr.Sn(),this.onlineState="Unknown",this.wc=void 0}get isPrimaryClient(){return!0===this.wc}}function xv(n,e){return Vc.apply(this,arguments)}function Vc(){return Vc=(0,w.Z)(function*(n,e){const t=rh(n);let r,s;const i=t.oc.get(e);if(i)r=i.targetId,t.sharedClientState.addLocalQueryTarget(r),s=i.view.sc();else{const o=yield ws(t.localStore,Ze(e));t.isPrimaryClient&&Ja(t.remoteStore,o);const a=t.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=yield Pc(t,e,r,"current"===a,o.resumeToken)}return s}),Vc.apply(this,arguments)}function Pc(n,e,t,r,s){return Fc.apply(this,arguments)}function Fc(){return Fc=(0,w.Z)(function*(n,e,t,r,s){n.mc=(m,y,v)=>{return(E=(0,w.Z)(function*(I,O,J,k){let P=O.view.Hu(J);P.Li&&(P=yield Qa(I.localStore,O.query,!1).then(({documents:X})=>O.view.Hu(X,P)));const ue=k&&k.targetChanges.get(O.targetId),z=O.view.applyChanges(P,I.isPrimaryClient,ue);return zc(I,O.targetId,z.tc),z.snapshot}),function(I,O,J,k){return E.apply(this,arguments)})(n,m,y,v);var E};const i=yield Qa(n.localStore,e,!0),o=new Mp(e,i.Yi),a=o.Hu(i.documents),c=Wi.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,s),h=o.applyChanges(a,n.isPrimaryClient,c);zc(n,t,h.tc);const p=new _v(e,t,o);return n.oc.set(e,p),n.uc.has(t)?n.uc.get(t).push(e):n.uc.set(t,[e]),h.snapshot}),Fc.apply(this,arguments)}function Ev(n,e){return Lc.apply(this,arguments)}function Lc(){return Lc=(0,w.Z)(function*(n,e){const t=D(n),r=t.oc.get(e),s=t.uc.get(r.targetId);if(s.length>1)return t.uc.set(r.targetId,s.filter(i=>!qi(i,e))),void t.oc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield vs(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),lo(t.remoteStore,r.targetId),As(t,r.targetId)}).catch(ln))):(As(t,r.targetId),yield vs(t.localStore,r.targetId,!0))}),Lc.apply(this,arguments)}function Rc(){return Rc=(0,w.Z)(function*(n,e,t){const r=sh(n);try{const s=yield function(i,o){const a=D(i),c=he.now(),h=o.reduce((y,v)=>y.add(v.key),$());let p,m;return a.persistence.runTransaction("Locally write mutations","readwrite",y=>{let v=st(),E=$();return a.ji.getEntries(y,h).next(I=>{v=I,v.forEach((O,J)=>{J.isValidDocument()||(E=E.add(O))})}).next(()=>a.localDocuments.getOverlayedDocuments(y,v)).next(I=>{p=I;const O=[];for(const J of o){const k=Oy(J,p.get(J.key).overlayedDocument);null!=k&&O.push(new Kt(J.key,k,Fd(k.value.mapValue),de.exists(!0)))}return a.mutationQueue.addMutationBatch(y,c,O,o)}).next(I=>{m=I;const O=I.applyToLocalDocumentSet(p,E);return a.documentOverlayCache.saveOverlays(y,I.batchId,O)})}).then(()=>({batchId:m.batchId,changes:af(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let c=i.fc[i.currentUser.toKey()];c||(c=new ye(q)),c=c.insert(o,a),i.fc[i.currentUser.toKey()]=c}(r,s.batchId,t),yield Ht(r,s.changes),yield bs(r.remoteStore)}catch(s){const i=xs(s,"Failed to persist write");t.reject(i)}}),Rc.apply(this,arguments)}function kp(n,e){return Bc.apply(this,arguments)}function Bc(){return Bc=(0,w.Z)(function*(n,e){const t=D(n);try{const r=yield function Kw(n,e){const t=D(n),r=e.snapshotVersion;let s=t.Ki;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.ji.newChangeBuffer({trackRemovals:!0});s=t.Ki;const a=[];e.targetChanges.forEach((p,m)=>{const y=s.get(m);if(!y)return;a.push(t.Ns.removeMatchingKeys(i,p.removedDocuments,m).next(()=>t.Ns.addMatchingKeys(i,p.addedDocuments,m)));let v=y.withSequenceNumber(i.currentSequenceNumber);var E,I,O;e.targetMismatches.has(m)?v=v.withResumeToken(Se.EMPTY_BYTE_STRING,L.min()).withLastLimboFreeSnapshotVersion(L.min()):p.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(p.resumeToken,r)),s=s.insert(m,v),I=v,O=p,(0===(E=y).resumeToken.approximateByteSize()||I.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=3e8||O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0)&&a.push(t.Ns.updateTargetData(i,v))});let c=st(),h=$();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,p))}),a.push(up(i,o,e.documentUpdates).next(p=>{c=p.Hi,h=p.Ji})),!r.isEqual(L.min())){const p=t.Ns.getLastRemoteSnapshotVersion(i).next(m=>t.Ns.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(p)}return _.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,c,h)).next(()=>c)}).then(i=>(t.Ki=s,i))}(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.hc.get(i);o&&(V(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.ic=!0:s.modifiedDocuments.size>0?V(o.ic):s.removedDocuments.size>0&&(V(o.ic),o.ic=!1))}),yield Ht(t,r,e)}catch(r){yield ln(r)}}),Bc.apply(this,arguments)}function Np(n,e,t){const r=D(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const s=[];r.oc.forEach((i,o)=>{const a=o.view.Pu(e);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=D(i);a.onlineState=o;let c=!1;a.queries.forEach((h,p)=>{for(const m of p.listeners)m.Pu(o)&&(c=!0)}),c&&Nc(a)}(r.eventManager,e),s.length&&r.rc.Ho(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Av(n,e,t){return Uc.apply(this,arguments)}function Uc(){return Uc=(0,w.Z)(function*(n,e,t){const r=D(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.hc.get(e),i=s&&s.key;if(i){let o=new ye(S.comparator);o=o.insert(i,oe.newNoDocument(i,L.min()));const a=$().add(i),c=new Hi(L.min(),new Map,new ne(q),o,a);yield kp(r,c),r.ac=r.ac.remove(i),r.hc.delete(e),Hc(r)}else yield vs(r.localStore,e,!1).then(()=>As(r,e,t)).catch(ln)}),Uc.apply(this,arguments)}function Iv(n,e){return qc.apply(this,arguments)}function qc(){return qc=(0,w.Z)(function*(n,e){const t=D(n),r=e.batch.batchId;try{const s=yield function $w(n,e){const t=D(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.ji.newChangeBuffer({trackRemovals:!0});return function(o,a,c,h){const p=c.batch,m=p.keys();let y=_.resolve();return m.forEach(v=>{y=y.next(()=>h.getEntry(a,v)).next(E=>{const I=c.docVersions.get(v);V(null!==I),E.version.compareTo(I)<0&&(p.applyToRemoteDocument(E,c),E.isValidDocument()&&(E.setReadTime(c.commitVersion),h.addEntry(E)))})}),y.next(()=>o.mutationQueue.removeMutationBatch(a,p))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=$();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}(t.localStore,e);Kc(t,r,null),$c(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Ht(t,s)}catch(s){yield ln(s)}}),qc.apply(this,arguments)}function Sv(n,e,t){return Gc.apply(this,arguments)}function Gc(){return Gc=(0,w.Z)(function*(n,e,t){const r=D(n);try{const s=yield function(i,o){const a=D(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return a.mutationQueue.lookupMutationBatch(c,o).next(p=>(V(null!==p),h=p.keys(),a.mutationQueue.removeMutationBatch(c,p))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,h,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>a.localDocuments.getDocuments(c,h))})}(r.localStore,e);Kc(r,e,t),$c(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Ht(r,s)}catch(s){yield ln(s)}}),Gc.apply(this,arguments)}function jc(){return jc=(0,w.Z)(function*(n,e){const t=D(n);zt(t.remoteStore)||A("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(i){const o=D(i);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(t.localStore);if(-1===r)return void e.resolve();const s=t.dc.get(r)||[];s.push(e),t.dc.set(r,s)}catch(r){const s=xs(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}),jc.apply(this,arguments)}function $c(n,e){(n.dc.get(e)||[]).forEach(t=>{t.resolve()}),n.dc.delete(e)}function Kc(n,e,t){const r=D(n);let s=r.fc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.fc[r.currentUser.toKey()]=s}}function As(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.uc.get(e))n.oc.delete(r),t&&n.rc.gc(r,t);n.uc.delete(e),n.isPrimaryClient&&n.lc.ds(e).forEach(r=>{n.lc.containsKey(r)||Op(n,r)})}function Op(n,e){n.cc.delete(e.path.canonicalString());const t=n.ac.get(e);null!==t&&(lo(n.remoteStore,t),n.ac=n.ac.remove(e),n.hc.delete(t),Hc(n))}function zc(n,e,t){for(const r of t)r instanceof Sp?(n.lc.addReference(r.key,e),Mv(n,r)):r instanceof Dp?(A("SyncEngine","Document no longer in limbo: "+r.key),n.lc.removeReference(r.key,e),n.lc.containsKey(r.key)||Op(n,r.key)):M()}function Mv(n,e){const t=e.key,r=t.path.canonicalString();n.ac.get(t)||n.cc.has(r)||(A("SyncEngine","New document in limbo: "+t),n.cc.add(r),Hc(n))}function Hc(n){for(;n.cc.size>0&&n.ac.size<n.maxConcurrentLimboResolutions;){const e=n.cc.values().next().value;n.cc.delete(e);const t=new S(Q.fromString(e)),r=n._c.next();n.hc.set(r,new bv(t)),n.ac=n.ac.insert(t,r),Ja(n.remoteStore,new yn(Ze(us(t.path)),r,2,ut.at))}}function Ht(n,e,t){return Wc.apply(this,arguments)}function Wc(){return Wc=(0,w.Z)(function*(n,e,t){const r=D(n),s=[],i=[],o=[];var a;r.oc.isEmpty()||(r.oc.forEach((a,c)=>{o.push(r.mc(c,e,t).then(h=>{if((h||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,h?.fromCache?"not-current":"current"),h){s.push(h);const p=Ju.Ni(c.targetId,h);i.push(p)}}))}),yield Promise.all(o),r.rc.Ho(s),yield(a=(0,w.Z)(function*(c,h){const p=D(c);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>_.forEach(h,y=>_.forEach(y.Ci,v=>p.persistence.referenceDelegate.addReference(m,y.targetId,v)).next(()=>_.forEach(y.xi,v=>p.persistence.referenceDelegate.removeReference(m,y.targetId,v)))))}catch(m){if(!un(m))throw m;A("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const y=m.targetId;if(!m.fromCache){const v=p.Ki.get(y),I=v.withLastLimboFreeSnapshotVersion(v.snapshotVersion);p.Ki=p.Ki.insert(y,I)}}}),function(c,h){return a.apply(this,arguments)})(r.localStore,i))}),Wc.apply(this,arguments)}function kv(n,e){return Qc.apply(this,arguments)}function Qc(){return Qc=(0,w.Z)(function*(n,e){const t=D(n);if(!t.currentUser.isEqual(e)){A("SyncEngine","User change. New user:",e.toKey());const r=yield ap(t.localStore,e);t.currentUser=e,(s=t).dc.forEach(o=>{o.forEach(a=>{a.reject(new T(b.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.dc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ht(t,r.Wi)}var s}),Qc.apply(this,arguments)}function Nv(n,e){const t=D(n),r=t.hc.get(e);if(r&&r.ic)return $().add(r.key);{let s=$();const i=t.uc.get(e);if(!i)return s;for(const o of i){const a=t.oc.get(o);s=s.unionWith(a.view.Wu)}return s}}function Ov(n,e){return Zc.apply(this,arguments)}function Zc(){return Zc=(0,w.Z)(function*(n,e){const t=D(n),r=yield Qa(t.localStore,e.query,!0),s=e.view.nc(r);return t.isPrimaryClient&&zc(t,e.targetId,s.tc),s}),Zc.apply(this,arguments)}function Vv(n,e){return Yc.apply(this,arguments)}function Yc(){return Yc=(0,w.Z)(function*(n,e){const t=D(n);return hp(t.localStore,e).then(r=>Ht(t,r))}),Yc.apply(this,arguments)}function Pv(n,e,t,r){return Xc.apply(this,arguments)}function Xc(){return Xc=(0,w.Z)(function*(n,e,t,r){const s=D(n),i=yield function(o,a){const c=D(o),h=D(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.An(p,a).next(m=>m?c.localDocuments.getDocuments(p,m):_.resolve(null)))}(s.localStore,e);var a;null!==i?("pending"===t?yield bs(s.remoteStore):"acknowledged"===t||"rejected"===t?(Kc(s,e,r||null),$c(s,e),a=e,D(D(s.localStore).mutationQueue).bn(a)):M(),yield Ht(s,i)):A("SyncEngine","Cannot apply mutation batch with id: "+e)}),Xc.apply(this,arguments)}function Jc(){return Jc=(0,w.Z)(function*(n,e){const t=D(n);if(rh(t),sh(t),!0===e&&!0!==t.wc){const r=t.sharedClientState.getAllActiveQueryTargets(),s=yield Vp(t,r.toArray());t.wc=!0,yield Tc(t.remoteStore,!0);for(const i of s)Ja(t.remoteStore,i)}else if(!1===e&&!1!==t.wc){const r=[];let s=Promise.resolve();t.uc.forEach((i,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(As(t,o),vs(t.localStore,o,!0))),lo(t.remoteStore,o)}),yield s,yield Vp(t,r),function(i){const o=D(i);o.hc.forEach((a,c)=>{lo(o.remoteStore,c)}),o.lc._s(),o.hc=new Map,o.ac=new ye(S.comparator)}(t),t.wc=!1,yield Tc(t.remoteStore,!1)}}),Jc.apply(this,arguments)}function Vp(n,e,t){return eh.apply(this,arguments)}function eh(){return eh=(0,w.Z)(function*(n,e,t){const r=D(n),s=[],i=[];for(const o of e){let a;const c=r.uc.get(o);if(c&&0!==c.length){a=yield ws(r.localStore,Ze(c[0]));for(const h of c){const p=r.oc.get(h),m=yield Ov(r,p);m.snapshot&&i.push(m.snapshot)}}else{const h=yield cp(r.localStore,o);a=yield ws(r.localStore,h),yield Pc(r,Pp(h),o,!1,a.resumeToken)}s.push(a)}return r.rc.Ho(i),s}),eh.apply(this,arguments)}function Pp(n){return Bd(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Lv(n){const e=D(n);return D(D(e.localStore).persistence).Si()}function Rv(n,e,t,r){return th.apply(this,arguments)}function th(){return th=(0,w.Z)(function*(n,e,t,r){const s=D(n);if(s.wc)return void A("SyncEngine","Ignoring unexpected query state notification.");const i=s.uc.get(e);if(i&&i.length>0)switch(t){case"current":case"not-current":{const o=yield hp(s.localStore,Gd(i[0])),a=Hi.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,Se.EMPTY_BYTE_STRING);yield Ht(s,o,a);break}case"rejected":yield vs(s.localStore,e,!0),As(s,e,r);break;default:M()}}),th.apply(this,arguments)}function Bv(n,e,t){return nh.apply(this,arguments)}function nh(){return nh=(0,w.Z)(function*(n,e,t){const r=rh(n);if(r.wc){for(const s of e){if(r.uc.has(s)){A("SyncEngine","Adding an already active target "+s);continue}const i=yield cp(r.localStore,s),o=yield ws(r.localStore,i);yield Pc(r,Pp(i),o.targetId,!1,o.resumeToken),Ja(r.remoteStore,o)}for(const s of t)r.uc.has(s)&&(yield vs(r.localStore,s,!1).then(()=>{lo(r.remoteStore,s),As(r,s)}).catch(ln))}}),nh.apply(this,arguments)}function rh(n){const e=D(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=kp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Nv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Av.bind(null,e),e.rc.Ho=gv.bind(null,e.eventManager),e.rc.gc=yv.bind(null,e.eventManager),e}function sh(n){const e=D(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Iv.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Sv.bind(null,e),e}class Fp{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,w.Z)(function*(){t.Tt=oo(e.databaseInfo.databaseId),t.sharedClientState=t.Ic(e),t.persistence=t.Tc(e),yield t.persistence.start(),t.localStore=t.Ec(e),t.gcScheduler=t.Ac(e,t.localStore),t.indexBackfillerScheduler=t.Rc(e,t.localStore)})()}Ac(e,t){return null}Rc(e,t){return null}Ec(e){return op(this.persistence,new ip,e.initialUser,this.Tt)}Tc(e){return new rp(Ha.qs,this.Tt)}Ic(e){return new mp}terminate(){var e=this;return(0,w.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Lp extends Fp{constructor(e,t,r){super(),this.bc=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,w.Z)(function*(){yield t().call(r,e),yield r.bc.initialize(r,e),yield sh(r.bc.syncEngine),yield bs(r.bc.remoteStore),yield r.persistence.di(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}Ec(e){return op(this.persistence,new ip,e.initialUser,this.Tt)}Ac(e,t){return new Dw(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Rc(e,t){const r=new cy(t,this.persistence);return new uy(e.asyncQueue,r)}Tc(e){const t=Xu(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?it.withCacheSize(this.cacheSizeBytes):it.DEFAULT;return new Yu(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,yp(),Xa(),this.Tt,this.sharedClientState,!!this.forceOwnership)}Ic(e){return new mp}}class qv extends Lp{constructor(e,t){super(e,t,!1),this.bc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,w.Z)(function*(){yield t().call(r,e);const s=r.bc.syncEngine;r.sharedClientState instanceof ac&&(r.sharedClientState.syncEngine={Br:Pv.bind(null,s),Lr:Rv.bind(null,s),qr:Bv.bind(null,s),Si:Lv.bind(null,s),$r:Vv.bind(null,s)},yield r.sharedClientState.start()),yield r.persistence.di(function(){var i=(0,w.Z)(function*(o){yield function Fv(n,e){return Jc.apply(this,arguments)}(r.bc.syncEngine,o),r.gcScheduler&&(o&&!r.gcScheduler.started?r.gcScheduler.start():o||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(o&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():o||r.indexBackfillerScheduler.stop())});return function(o){return i.apply(this,arguments)}}())})()}Ic(e){const t=yp();if(!ac.C(t))throw new T(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Xu(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ac(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class ih{initialize(e,t){var r=this;return(0,w.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=s=>Np(r.syncEngine,s,1),r.remoteStore.remoteSyncer.handleCredentialChange=kv.bind(null,r.syncEngine),yield Tc(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new mv}createDatastore(e){const t=oo(e.databaseInfo.databaseId),r=new Xw(e.databaseInfo);return new tv(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,s=e.asyncQueue,i=a=>Np(this.syncEngine,a,0),o=gp.C()?new gp:new Qw,new sv(t,r,s,i,o);var t,r,s,i,o}createSyncEngine(e,t){return function(r,s,i,o,a,c,h){const p=new Cv(r,s,i,o,a,c);return h&&(p.wc=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,w.Z)(function*(t){const r=D(t);A("RemoteStore","RemoteStore shutting down."),r.mu.add(5),yield _s(r),r.yu.shutdown(),r.pu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function Rp(n,e=10240){let t=0;return{read:()=>(0,w.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,w.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class tl{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.vc(this.observer.next,e)}error(e){this.observer.error?this.vc(this.observer.error,e):we("Uncaught Error in snapshot listener:",e.toString())}Pc(){this.muted=!0}vc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Gv{constructor(e,t){this.Vc=e,this.Tt=t,this.metadata=new Ie,this.buffer=new Uint8Array,this.Sc=new TextDecoder("utf-8"),this.Dc().then(r=>{r&&r.Fu()?this.metadata.resolve(r.Mu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Mu)}`))},r=>this.metadata.reject(r))}close(){return this.Vc.cancel()}getMetadata(){var e=this;return(0,w.Z)(function*(){return e.metadata.promise})()}yc(){var e=this;return(0,w.Z)(function*(){return yield e.getMetadata(),e.Dc()})()}Dc(){var e=this;return(0,w.Z)(function*(){const t=yield e.Cc();if(null===t)return null;const r=e.Sc.decode(t),s=Number(r);isNaN(s)&&e.xc(`length string (${r}) is not valid number`);const i=yield e.Nc(s);return new wv(JSON.parse(i),t.length+s)})()}kc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Cc(){var e=this;return(0,w.Z)(function*(){for(;e.kc()<0&&!(yield e.Oc()););if(0===e.buffer.length)return null;const t=e.kc();t<0&&e.xc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Nc(e){var t=this;return(0,w.Z)(function*(){for(;t.buffer.length<e;)(yield t.Oc())&&t.xc("Reached the end of bundle when more is expected.");const r=t.Sc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}xc(e){throw this.Vc.cancel(),new Error(`Invalid bundle format: ${e}`)}Oc(){var e=this;return(0,w.Z)(function*(){const t=yield e.Vc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class jv{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,w.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new T(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(s=(0,w.Z)(function*(i,o){const a=D(i),c=Zi(a.Tt)+"/documents",h={documents:o.map(v=>Qi(a.Tt,v))},p=yield a.mo("BatchGetDocuments",c,h,o.length),m=new Map;p.forEach(v=>{const E=function Ky(n,e){return"found"in e?function(t,r){V(!!r.found);const s=It(t,r.found.name),i=ve(r.found.updateTime),o=r.found.createTime?ve(r.found.createTime):L.min(),a=new Ve({mapValue:{fields:r.found.fields}});return oe.newFoundDocument(s,i,o,a)}(n,e):"missing"in e?function(t,r){V(!!r.missing),V(!!r.readTime);const s=It(t,r.missing),i=ve(r.readTime);return oe.newNoDocument(s,i)}(n,e):M()}(a.Tt,v);m.set(E.key.toString(),E)});const y=[];return o.forEach(v=>{const E=m.get(v.toString());V(!!E),y.push(E)}),y}),function(i,o){return s.apply(this,arguments)})(t.datastore,e);var s;return r.forEach(s=>t.recordVersion(s)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new fs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,w.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,s)=>{const i=S.fromPath(s);e.mutations.push(new Ou(i,e.precondition(i)))}),yield(r=(0,w.Z)(function*(s,i){const o=D(s),a=Zi(o.Tt)+"/documents",c={writes:i.map(h=>Yi(o.Tt,h))};yield o.lo("Commit",a,c)}),function(s,i){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw M();t=L.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new T(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(L.min())?de.exists(!1):de.updateTime(t):de.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(L.min()))throw new T(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return de.updateTime(t)}return de.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class $v{constructor(e,t,r,s,i){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=i,this.Mc=r.maxAttempts,this.ko=new lc(this.asyncQueue,"transaction_retry")}run(){this.Mc-=1,this.Fc()}Fc(){var e=this;this.ko.vo((0,w.Z)(function*(){const t=new jv(e.datastore),r=e.$c(t);r&&r.then(s=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(s)}).catch(i=>{e.Bc(i)}))}).catch(s=>{e.Bc(s)})}))}$c(e){try{const t=this.updateFunction(e);return!Vi(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Bc(e){this.Mc>0&&this.Lc(e)?(this.Mc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Fc(),Promise.resolve()))):this.deferred.reject(e)}Lc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!rf(t)}return!1}}class Kv{constructor(e,t,r,s){var i=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Oe.UNAUTHENTICATED,this.clientId=ud.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=(0,w.Z)(function*(a){A("FirestoreClient","Received user=",a.uid),yield i.authCredentialListener(a),i.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(A("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return(0,w.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new T(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Ie;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,w.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const s=xs(r,"Failed to shutdown persistence");t.reject(s)}})),t.promise}}function Bp(n,e){return oh.apply(this,arguments)}function oh(){return oh=(0,w.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),A("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var s=(0,w.Z)(function*(i){r.isEqual(i)||(yield ap(e.localStore,i),r=i)});return function(i){return s.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),oh.apply(this,arguments)}function Up(n,e){return ah.apply(this,arguments)}function ah(){return ah=(0,w.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield lh(n);A("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(s=>Ep(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>Ep(e.remoteStore,i)),n.onlineComponents=e}),ah.apply(this,arguments)}function lh(n){return uh.apply(this,arguments)}function uh(){return uh=(0,w.Z)(function*(n){return n.offlineComponents||(A("FirestoreClient","Using default OfflineComponentProvider"),yield Bp(n,new Fp)),n.offlineComponents}),uh.apply(this,arguments)}function nl(n){return ch.apply(this,arguments)}function ch(){return ch=(0,w.Z)(function*(n){return n.onlineComponents||(A("FirestoreClient","Using default OnlineComponentProvider"),yield Up(n,new ih)),n.onlineComponents}),ch.apply(this,arguments)}function qp(n){return lh(n).then(e=>e.persistence)}function rl(n){return lh(n).then(e=>e.localStore)}function hh(n){return nl(n).then(e=>e.remoteStore)}function dh(n){return nl(n).then(e=>e.syncEngine)}function Is(n){return fh.apply(this,arguments)}function fh(){return fh=(0,w.Z)(function*(n){const e=yield nl(n),t=e.eventManager;return t.onListen=xv.bind(null,e.syncEngine),t.onUnlisten=Ev.bind(null,e.syncEngine),t}),fh.apply(this,arguments)}function jp(n,e,t={}){const r=new Ie;return n.asyncQueue.enqueueAndForget((0,w.Z)(function*(){return function(s,i,o,a,c){const h=new tl({next:m=>{i.enqueueAndForget(()=>Mc(s,p));const y=m.docs.has(o);!y&&m.fromCache?c.reject(new T(b.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&a&&"server"===a.source?c.reject(new T(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new Oc(us(o.path),h,{includeMetadataChanges:!0,Ou:!0});return Sc(s,p)}(yield Is(n),n.asyncQueue,e,t,r)})),r.promise}function $p(n,e,t={}){const r=new Ie;return n.asyncQueue.enqueueAndForget((0,w.Z)(function*(){return function(s,i,o,a,c){const h=new tl({next:m=>{i.enqueueAndForget(()=>Mc(s,p)),m.fromCache&&"server"===a.source?c.reject(new T(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new Oc(o,h,{includeMetadataChanges:!0,Ou:!0});return Sc(s,p)}(yield Is(n),n.asyncQueue,e,t,r)})),r.promise}const Kp=new Map;function ph(n,e,t){if(!t)throw new T(b.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function zp(n,e,t,r){if(!0===e&&!0===r)throw new T(b.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Hp(n){if(!S.isDocumentKey(n))throw new T(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Wp(n){if(S.isDocumentKey(n))throw new T(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function sl(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":M()}function W(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new T(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=sl(n);throw new T(b.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Qp(n,e){if(e<=0)throw new T(b.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class Zp{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new T(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new T(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,zp("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class uo{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Zp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new T(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new T(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Zp(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new Yg;switch(t.type){case"gapi":return new ty(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new T(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Kp.get(e);t&&(A("ComponentProvider","Removing Datastore"),Kp.delete(e),t.terminate())}(this),Promise.resolve()}}class ae{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ae(this.firestore,e,this._key)}}class Ge{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ge(this.firestore,e,this._query)}}class Dt extends Ge{constructor(e,t,r){super(e,t,us(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ae(this.firestore,null,new S(e))}withConverter(e){return new Dt(this.firestore,e,this._path)}}function Xp(n,e,...t){if(n=(0,U.m9)(n),ph("collection","path",e),n instanceof uo){const r=Q.fromString(e,...t);return Wp(r),new Dt(n,null,r)}{if(!(n instanceof ae||n instanceof Dt))throw new T(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Q.fromString(e,...t));return Wp(r),new Dt(n.firestore,null,r)}}function il(n,e,...t){if(n=(0,U.m9)(n),1===arguments.length&&(e=ud.R()),ph("doc","path",e),n instanceof uo){const r=Q.fromString(e,...t);return Hp(r),new ae(n,null,new S(r))}{if(!(n instanceof ae||n instanceof Dt))throw new T(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Q.fromString(e,...t));return Hp(r),new ae(n.firestore,n instanceof Dt?n.converter:null,new S(r))}}function Jp(n,e){return n=(0,U.m9)(n),e=(0,U.m9)(e),(n instanceof ae||n instanceof Dt)&&(e instanceof ae||e instanceof Dt)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function mh(n,e){return n=(0,U.m9)(n),e=(0,U.m9)(e),n instanceof Ge&&e instanceof Ge&&n.firestore===e.firestore&&qi(n._query,e._query)&&n.converter===e.converter}class e_{constructor(){this.qc=Promise.resolve(),this.Uc=[],this.Kc=!1,this.Gc=[],this.Qc=null,this.jc=!1,this.zc=!1,this.Wc=[],this.ko=new lc(this,"async_queue_retry"),this.Hc=()=>{const t=Xa();t&&A("AsyncQueue","Visibility state changed to "+t.visibilityState),this.ko.Vo()};const e=Xa();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Hc)}get isShuttingDown(){return this.Kc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Jc(),this.Yc(e)}enterRestrictedMode(e){if(!this.Kc){this.Kc=!0,this.zc=e||!1;const t=Xa();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Hc)}}enqueue(e){if(this.Jc(),this.Kc)return new Promise(()=>{});const t=new Ie;return this.Yc(()=>this.Kc&&this.zc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Uc.push(e),this.Zc()))}Zc(){var e=this;return(0,w.Z)(function*(){if(0!==e.Uc.length){try{yield e.Uc[0](),e.Uc.shift(),e.ko.reset()}catch(t){if(!un(t))throw t;A("AsyncQueue","Operation failed with retryable error: "+t)}e.Uc.length>0&&e.ko.vo(()=>e.Zc())}})()}Yc(e){const t=this.qc.then(()=>(this.jc=!0,e().catch(r=>{throw this.Qc=r,this.jc=!1,we("INTERNAL UNHANDLED ERROR: ",function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+"\n"+i.stack),o}(r)),r}).then(r=>(this.jc=!1,r))));return this.qc=t,t}enqueueAfterDelay(e,t,r){this.Jc(),this.Wc.indexOf(e)>-1&&(t=0);const s=Ic.createAndSchedule(this,e,t,r,i=>this.Xc(i));return this.Gc.push(s),s}Jc(){this.Qc&&M()}verifyOperationInProgress(){}ta(){var e=this;return(0,w.Z)(function*(){let t;do{t=e.qc,yield t}while(t!==e.qc)})()}ea(e){for(const t of this.Gc)if(t.timerId===e)return!0;return!1}na(e){return this.ta().then(()=>{this.Gc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Gc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.ta()})}sa(e){this.Wc.push(e)}Xc(e){const t=this.Gc.indexOf(e);this.Gc.splice(t,1)}}function gh(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const s of["next","error","complete"])if(s in r&&"function"==typeof r[s])return!0;return!1}(n)}class t_{constructor(){this._progressObserver={},this._taskCompletionResolver=new Ie,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class le extends uo{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new e_,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||em(this),this._firestoreClient.terminate()}}function _e(n){return n._firestoreClient||em(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function em(n){var e;const t=n._freezeSettings(),r=(i=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new fy(n._databaseId,i,n._persistenceKey,(a=t).host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams));var i,a;n._firestoreClient=new Kv(n._authCredentials,n._appCheckCredentials,n._queue,r)}function tm(n,e,t){const r=new Ie;return n.asyncQueue.enqueue((0,w.Z)(function*(){try{yield Bp(n,t),yield Up(n,e),r.resolve()}catch(s){const i=s;if(!("FirebaseError"===(o=i).name?o.code===b.FAILED_PRECONDITION||o.code===b.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||22===o.code||20===o.code||11===o.code))throw i;Yn("Error enabling offline persistence. Falling back to persistence disabled: "+i),r.reject(i)}var o})).then(()=>r.promise)}function nm(n){if(n._initialized||n._terminated)throw new T(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Mt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mt(Se.fromBase64String(e))}catch(t){throw new T(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Mt(Se.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Wt{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new T(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new me(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class mr{constructor(e){this._methodName=e}}class ol{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new T(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new T(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return q(this._lat,e._lat)||q(this._long,e._long)}}const d_=/^__.*__$/;class f_{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Kt(e,this.data,this.fieldMask,t,this.fieldTransforms):new ds(e,this.data,t,this.fieldTransforms)}}class rm{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Kt(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function sm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw M()}}class al{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.Tt=r,this.ignoreUndefinedProperties=s,void 0===i&&this.ia(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ra(){return this.settings.ra}oa(e){return new al(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.Tt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ua(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),s=this.oa({path:r,ca:!1});return s.aa(e),s}ha(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),s=this.oa({path:r,ca:!1});return s.ia(),s}la(e){return this.oa({path:void 0,ca:!0})}fa(e){return cl(e,this.settings.methodName,this.settings.da||!1,this.path,this.settings._a)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ia(){if(this.path)for(let e=0;e<this.path.length;e++)this.aa(this.path.get(e))}aa(e){if(0===e.length)throw this.fa("Document fields must not be empty");if(sm(this.ra)&&d_.test(e))throw this.fa('Document fields cannot begin and end with "__"')}}class p_{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.Tt=r||oo(e)}wa(e,t,r,s=!1){return new al({ra:e,methodName:t,_a:r,path:me.emptyPath(),ca:!1,da:s},this.databaseId,this.Tt,this.ignoreUndefinedProperties)}}function gr(n){const e=n._freezeSettings(),t=oo(n._databaseId);return new p_(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ll(n,e,t,r,s,i={}){const o=n.wa(i.merge||i.mergeFields?2:0,e,t,s);_h("Data must be an object, but it was:",o,r);const a=am(r,o);let c,h;if(i.merge)c=new rt(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const p=[];for(const m of i.mergeFields){const y=fo(e,m,t);if(!o.contains(y))throw new T(b.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);um(p,y)||p.push(y)}c=new rt(p),h=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,h=o.fieldTransforms;return new f_(new Ve(a),c,h)}class ho extends mr{_toFieldTransform(e){if(2!==e.ra)throw e.fa(1===e.ra?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ho}}function im(n,e,t){return new al({ra:3,_a:e.settings._a,methodName:n._methodName,ca:t},e.databaseId,e.Tt,e.ignoreUndefinedProperties)}class yh extends mr{_toFieldTransform(e){return new ji(e.path,new cs)}isEqual(e){return e instanceof yh}}class m_ extends mr{constructor(e,t){super(e),this.ma=t}_toFieldTransform(e){const t=im(this,e,!0),r=this.ma.map(i=>yr(i,t)),s=new or(r);return new ji(e.path,s)}isEqual(e){return this===e}}class g_ extends mr{constructor(e,t){super(e),this.ma=t}_toFieldTransform(e){const t=im(this,e,!0),r=this.ma.map(i=>yr(i,t)),s=new ar(r);return new ji(e.path,s)}isEqual(e){return this===e}}class y_ extends mr{constructor(e,t){super(e),this.ga=t}_toFieldTransform(e){const t=new hs(e.Tt,zd(e.Tt,this.ga));return new ji(e.path,t)}isEqual(e){return this===e}}function wh(n,e,t,r){const s=n.wa(1,e,t);_h("Data must be an object, but it was:",s,r);const i=[],o=Ve.empty();er(r,(c,h)=>{const p=ul(e,c,t);h=(0,U.m9)(h);const m=s.ha(p);if(h instanceof ho)i.push(p);else{const y=yr(h,m);null!=y&&(i.push(p),o.set(p,y))}});const a=new rt(i);return new rm(o,a,s.fieldTransforms)}function vh(n,e,t,r,s,i){const o=n.wa(1,e,t),a=[fo(e,r,t)],c=[s];if(i.length%2!=0)throw new T(b.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)a.push(fo(e,i[y])),c.push(i[y+1]);const h=[],p=Ve.empty();for(let y=a.length-1;y>=0;--y)if(!um(h,a[y])){const v=a[y];let E=c[y];E=(0,U.m9)(E);const I=o.ha(v);if(E instanceof ho)h.push(v);else{const O=yr(E,I);null!=O&&(h.push(v),p.set(v,O))}}const m=new rt(h);return new rm(p,m,o.fieldTransforms)}function om(n,e,t,r=!1){return yr(t,n.wa(r?4:3,e))}function yr(n,e){if(lm(n=(0,U.m9)(n)))return _h("Unsupported field value:",e,n),am(n,e);if(n instanceof mr)return function(t,r){if(!sm(r.ra))throw r.fa(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.fa(`${t._methodName}() is not currently supported inside arrays`);const s=t._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.ca&&4!==e.ra)throw e.fa("Nested arrays are not supported");return function(t,r){const s=[];let i=0;for(const o of t){let a=yr(o,r.la(i));null==a&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(n,e)}return function(t,r){if(null===(t=(0,U.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return zd(r.Tt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const s=he.fromDate(t);return{timestampValue:ps(r.Tt,s)}}if(t instanceof he){const s=new he(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ps(r.Tt,s)}}if(t instanceof ol)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Mt)return{bytesValue:pf(r.Tt,t._byteString)};if(t instanceof ae){const s=r.databaseId,i=t.firestore._databaseId;if(!i.isEqual(s))throw r.fa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Vu(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.fa(`Unsupported field value: ${sl(t)}`)}(n,e)}function am(n,e){const t={};return yd(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):er(n,(r,s)=>{const i=yr(s,e.ua(r));null!=i&&(t[r]=i)}),{mapValue:{fields:t}}}function lm(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof he||n instanceof ol||n instanceof Mt||n instanceof ae||n instanceof mr)}function _h(n,e,t){if(!lm(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=sl(t);throw e.fa("an object"===r?n+" a custom object":n+" "+r)}var r}function fo(n,e,t){if((e=(0,U.m9)(e))instanceof Wt)return e._internalPath;if("string"==typeof e)return ul(n,e);throw cl("Field path arguments must be of type string or ",n,!1,void 0,t)}const w_=new RegExp("[~\\*/\\[\\]]");function ul(n,e,t){if(e.search(w_)>=0)throw cl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Wt(...e.split("."))._internalPath}catch{throw cl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function cl(n,e,t,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new T(b.INVALID_ARGUMENT,a+n+c)}function um(n,e){return n.some(t=>t.isEqual(e))}class po{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ae(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new v_(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(hl("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class v_ extends po{data(){return super.data()}}function hl(n,e){return"string"==typeof e?ul(n,e):e instanceof Wt?e._internalPath:e._delegate._internalPath}function cm(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new T(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class bh{}class mo extends bh{}function Cn(n,e,...t){let r=[];e instanceof bh&&r.push(e),r=r.concat(t),function(s){const i=s.filter(a=>a instanceof Ss).length,o=s.filter(a=>a instanceof go).length;if(i>1||i>0&&o>0)throw new T(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class go extends mo{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new go(e,t,r)}_apply(e){const t=this._parse(e);return pm(e._query,t),new Ge(e.firestore,e.converter,ku(e._query,t))}_parse(e){const t=gr(e.firestore);return function(s,i,o,a,c,h,p){let m;if(c.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new T(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){fm(p,h);const y=[];for(const v of p)y.push(dm(a,s,v));m={arrayValue:{values:y}}}else m=dm(a,s,p)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||fm(p,h),m=om(o,"where",p,"in"===h||"not-in"===h);return H.create(c,h,m)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class Ss extends bh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ss(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===t.length?t[0]:te.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(r,s){let i=r;const o=s.getFlattenedFilters();for(const a of o)pm(i,a),i=ku(i,a)}(e._query,t),new Ge(e.firestore,e.converter,ku(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Ch extends mo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Ch(e,t)}_apply(e){const t=function(r,s,i){if(null!==r.startAt)throw new T(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new T(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new as(s,i);return function(a,c){if(null===Du(a)){const h=ka(a);null!==h&&mm(0,h,c.field)}}(r,o),o}(e._query,this._field,this._direction);return new Ge(e.firestore,e.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new $t(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class dl extends mo{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new dl(e,t,r)}_apply(e){return new Ge(e.firestore,e.converter,Na(e._query,this._limit,this._limitType))}}class fl extends mo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new fl(e,t,r)}_apply(e){const t=hm(e,this.type,this._docOrFields,this._inclusive);return new Ge(e.firestore,e.converter,(s=t,new $t((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,s,r.endAt)));var r,s}}class pl extends mo{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new pl(e,t,r)}_apply(e){const t=hm(e,this.type,this._docOrFields,this._inclusive);return new Ge(e.firestore,e.converter,(s=t,new $t((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,s)));var r,s}}function hm(n,e,t,r){if(t[0]=(0,U.m9)(t[0]),t[0]instanceof po)return function(s,i,o,a,c){if(!a)throw new T(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const h=[];for(const p of ir(s))if(p.field.isKeyField())h.push(rr(i,a.key));else{const m=a.data.field(p.field);if(Cu(m))throw new T(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===m){const y=p.field.canonicalString();throw new T(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}h.push(m)}return new pn(h,c)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=gr(n.firestore);return function(i,o,a,c,h,p){const m=i.explicitOrderBy;if(h.length>m.length)throw new T(b.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const y=[];for(let v=0;v<h.length;v++){const E=h[v];if(m[v].field.isKeyField()){if("string"!=typeof E)throw new T(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof E}`);if(!Mu(i)&&-1!==E.indexOf("/"))throw new T(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${E}' contains a slash.`);const I=i.path.child(Q.fromString(E));if(!S.isDocumentKey(I))throw new T(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${I}' is not because it contains an odd number of segments.`);const O=new S(I);y.push(rr(o,O))}else{const I=om(a,c,E);y.push(I)}}return new pn(y,p)}(n._query,n.firestore._databaseId,s,e,t,r)}}function dm(n,e,t){if("string"==typeof(t=(0,U.m9)(t))){if(""===t)throw new T(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Mu(e)&&-1!==t.indexOf("/"))throw new T(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Q.fromString(t));if(!S.isDocumentKey(r))throw new T(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return rr(n,new S(r))}if(t instanceof ae)return rr(n,t._key);throw new T(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sl(t)}.`)}function fm(n,e){if(!Array.isArray(n)||0===n.length)throw new T(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function pm(n,e){if(e.isInequality()){const r=ka(n),s=e.field;if(null!==r&&!r.isEqual(s))throw new T(b.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${s.toString()}'`);const i=Du(n);null!==i&&mm(0,s,i)}const t=function(r,s){for(const i of r)for(const o of i.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new T(b.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function mm(n,e,t){if(!t.isEqual(e))throw new T(b.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class xh{convertValue(e,t="none"){switch(nr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(tr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw M()}}convertObject(e,t){const r={};return er(e.fields,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertGeoPoint(e){return new ol(ge(e.latitude),ge(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=vd(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Fi(e));default:return null}}convertTimestamp(e){const t=hn(e);return new he(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Q.fromString(e);V(Ef(r));const s=new cn(r.get(1),r.get(3)),i=new S(r.popFirst(5));return s.isEqual(t)||we(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function ml(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class S_ extends xh{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ae(this.firestore,null,t)}}class wr{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qt extends po{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new yo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(hl("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class yo extends Qt{data(e={}){return super.data(e)}}class xn{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new wr(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new yo(this._firestore,this._userDataWriter,r.key,r,new wr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new T(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new yo(r._firestore,r._userDataWriter,o.doc.key,o.doc,new wr(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||3!==o.type).map(o=>{const a=new yo(r._firestore,r._userDataWriter,o.doc.key,o.doc,new wr(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,h=-1;return 0!==o.type&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),1!==o.type&&(i=i.add(o.doc),h=i.indexOf(o.doc.key)),{type:M_(o.type),doc:a,oldIndex:c,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function M_(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return M()}}function ym(n,e){return n instanceof Qt&&e instanceof Qt?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof xn&&e instanceof xn&&n._firestore===e._firestore&&mh(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class En extends xh{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ae(this.firestore,null,t)}}function wm(n,e,t){n=W(n,ae);const r=W(n.firestore,le),s=ml(n.converter,e,t);return Ds(r,[ll(gr(r),"setDoc",n._key,s,null!==n.converter,t).toMutation(n._key,de.none())])}function vm(n,e,t,...r){n=W(n,ae);const s=W(n.firestore,le),i=gr(s);let o;return o="string"==typeof(e=(0,U.m9)(e))||e instanceof Wt?vh(i,"updateDoc",n._key,e,t,r):wh(i,"updateDoc",n._key,e),Ds(s,[o.toMutation(n._key,de.exists(!0))])}function _m(n,...e){var t,r,s;n=(0,U.m9)(n);let i={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||gh(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(gh(e[o])){const m=e[o];e[o]=null===(t=m.next)||void 0===t?void 0:t.bind(m),e[o+1]=null===(r=m.error)||void 0===r?void 0:r.bind(m),e[o+2]=null===(s=m.complete)||void 0===s?void 0:s.bind(m)}let c,h,p;if(n instanceof ae)h=W(n.firestore,le),p=us(n._key.path),c={next:m=>{e[o]&&e[o](Eh(h,n,m))},error:e[o+1],complete:e[o+2]};else{const m=W(n,Ge);h=W(m.firestore,le),p=m._query;const y=new En(h);c={next:v=>{e[o]&&e[o](new xn(h,y,m,v))},error:e[o+1],complete:e[o+2]},cm(n._query)}return function(m,y,v,E){const I=new tl(E),O=new Oc(y,I,v);return m.asyncQueue.enqueueAndForget((0,w.Z)(function*(){return Sc(yield Is(m),O)})),()=>{I.Pc(),m.asyncQueue.enqueueAndForget((0,w.Z)(function*(){return Mc(yield Is(m),O)}))}}(_e(h),p,a,c)}function Ds(n,e){return function(t,r){const s=new Ie;return t.asyncQueue.enqueueAndForget((0,w.Z)(function*(){return function Tv(n,e,t){return Rc.apply(this,arguments)}(yield dh(t),r,s)})),s.promise}(_e(n),e)}function Eh(n,e,t){const r=t.docs.get(e._key),s=new En(n);return new Qt(n,s,e._key,r,new wr(t.hasPendingWrites,t.fromCache),e.converter)}const q_={maxAttempts:5};class bm{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=gr(e)}set(e,t,r){this._verifyNotCommitted();const s=Tn(e,this._firestore),i=ml(s.converter,t,r),o=ll(this._dataReader,"WriteBatch.set",s._key,i,null!==s.converter,r);return this._mutations.push(o.toMutation(s._key,de.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const i=Tn(e,this._firestore);let o;return o="string"==typeof(t=(0,U.m9)(t))||t instanceof Wt?vh(this._dataReader,"WriteBatch.update",i._key,t,r,s):wh(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,de.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Tn(e,this._firestore);return this._mutations=this._mutations.concat(new fs(t._key,de.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new T(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Tn(n,e){if((n=(0,U.m9)(n)).firestore!==e)throw new T(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class G_ extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=gr(e)}get(e){const t=Tn(e,this._firestore),r=new S_(this._firestore);return this._transaction.lookup([t._key]).then(s=>{if(!s||1!==s.length)return M();const i=s[0];if(i.isFoundDocument())return new po(this._firestore,r,i.key,i,t.converter);if(i.isNoDocument())return new po(this._firestore,r,t._key,null,t.converter);throw M()})}set(e,t,r){const s=Tn(e,this._firestore),i=ml(s.converter,t,r),o=ll(this._dataReader,"Transaction.set",s._key,i,null!==s.converter,r);return this._transaction.set(s._key,o),this}update(e,t,r,...s){const i=Tn(e,this._firestore);let o;return o="string"==typeof(t=(0,U.m9)(t))||t instanceof Wt?vh(this._dataReader,"Transaction.update",i._key,t,r,s):wh(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,o),this}delete(e){const t=Tn(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Tn(e,this._firestore),r=new En(this._firestore);return super.get(e).then(s=>new Qt(this._firestore,r,t._key,s._document,new wr(!1,!1),t.converter))}}!function(n,e=!0){rs=Qe.SDK_VERSION,(0,Qe._registerComponent)(new gt.wA("firestore",(t,{instanceIdentifier:r,options:s})=>{const i=t.getProvider("app").getImmediate(),o=new le(new Jg(t.getProvider("auth-internal")),new ny(t.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new T(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new cn(a.options.projectId,c)}(i,r),i);return s=Object.assign({useFetchStreams:e},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),(0,Qe.registerVersion)(od,"3.8.4",n),(0,Qe.registerVersion)(od,"3.8.4","esm2017")}();function Th(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new T("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function xm(){if(typeof Uint8Array>"u")throw new T("unimplemented","Uint8Arrays are not available in this environment.")}function Em(){if(!function my(){return typeof atob<"u"}())throw new T("unimplemented","Blobs are unavailable in Firestore in this environment.")}class wo{constructor(e){this._delegate=e}static fromBase64String(e){return Em(),new wo(Mt.fromBase64String(e))}static fromUint8Array(e){return xm(),new wo(Mt.fromUint8Array(e))}toBase64(){return Em(),this._delegate.toBase64()}toUint8Array(){return xm(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Ah(n){return function Y_(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class X_{enableIndexedDbPersistence(e,t){return function r_(n,e){nm(n=W(n,le));const t=_e(n),r=n._freezeSettings(),s=new ih;return tm(t,s,new Lp(s,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function s_(n){nm(n=W(n,le));const e=_e(n),t=n._freezeSettings(),r=new ih;return tm(e,r,new qv(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function i_(n){if(n._initialized&&!n._terminated)throw new T(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Ie;return n._queue.enqueueAndForgetEvenWhileRestricted((0,w.Z)(function*(){try{yield(t=(0,w.Z)(function*(r){if(!vt.C())return Promise.resolve();const s=r+"main";yield vt.delete(s)}),function(r){return t.apply(this,arguments)})(Xu(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class Tm{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof cn||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Yn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function Yp(n,e,t,r={}){var s;const i=(n=W(n,uo))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Yn("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},i),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let o,a;if("string"==typeof r.mockUserToken)o=r.mockUserToken,a=Oe.MOCK_USER;else{o=(0,U.Sg)(r.mockUserToken,null===(s=n._app)||void 0===s?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new T(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new Oe(c)}n._authCredentials=new Xg(new ad(o,a))}}(this._delegate,e,t,r)}enableNetwork(){return function a_(n){return function zv(n){return n.asyncQueue.enqueue((0,w.Z)(function*(){const e=yield qp(n),t=yield hh(n);return e.setNetworkEnabled(!0),function(r){const s=D(r);return s.mu.delete(0),ao(s)}(t)}))}(_e(n=W(n,le)))}(this._delegate)}disableNetwork(){return function l_(n){return function Hv(n){return n.asyncQueue.enqueue((0,w.Z)(function*(){const e=yield qp(n),t=yield hh(n);return e.setNetworkEnabled(!1),(r=(0,w.Z)(function*(s){const i=D(s);i.mu.add(0),yield _s(i),i.pu.set("Offline")}),function(s){return r.apply(this,arguments)})(t);var r}))}(_e(n=W(n,le)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,zp("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function o_(n){return function(e){const t=new Ie;return e.asyncQueue.enqueueAndForget((0,w.Z)(function*(){return function Dv(n,e){return jc.apply(this,arguments)}(yield dh(e),t)})),t.promise}(_e(n=W(n,le)))}(this._delegate)}onSnapshotsInSync(e){return function B_(n,e){return function Zv(n,e){const t=new tl(e);return n.asyncQueue.enqueueAndForget((0,w.Z)(function*(){return r=yield Is(n),s=t,D(r).vu.add(s),void s.next();var r,s})),()=>{t.Pc(),n.asyncQueue.enqueueAndForget((0,w.Z)(function*(){return r=yield Is(n),s=t,void D(r).vu.delete(s);var r,s}))}}(_e(n=W(n,le)),gh(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new T("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ms(this,Xp(this._delegate,e))}catch(t){throw Xe(t,"collection()","Firestore.collection()")}}doc(e){try{return new mt(this,il(this._delegate,e))}catch(t){throw Xe(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Je(this,function Jv(n,e){if(n=W(n,uo),ph("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new T(b.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ge(n,null,(t=e,new $t(Q.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Xe(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function j_(n,e,t){n=W(n,le);const r=Object.assign(Object.assign({},q_),t);return function(s){if(s.maxAttempts<1)throw new T(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,i,o){const a=new Ie;return s.asyncQueue.enqueueAndForget((0,w.Z)(function*(){const c=yield function Gp(n){return nl(n).then(e=>e.datastore)}(s);new $v(s.asyncQueue,c,o,i,a).run()})),a.promise}(_e(n),s=>e(new G_(n,s)),r)}(this._delegate,t=>e(new Am(this,t)))}batch(){return _e(this._delegate),new Im(new bm(this._delegate,e=>Ds(this._delegate,e)))}loadBundle(e){return function u_(n,e){const t=_e(n=W(n,le)),r=new t_;return function Yv(n,e,t,r){const s=function(i,o){let a;return a="string"==typeof i?(new TextEncoder).encode(i):i,c=function(c,h){if(c instanceof Uint8Array)return Rp(c,h);if(c instanceof ArrayBuffer)return Rp(new Uint8Array(c),h);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),new Gv(c,o);var c}(t,oo(e));n.asyncQueue.enqueueAndForget((0,w.Z)(function*(){!function Uv(n,e,t){const r=D(n);var s;(s=(0,w.Z)(function*(i,o,a){try{const c=yield o.getMetadata();if(yield function(y,v){const E=D(y),I=ve(v.createTime);return E.persistence.runTransaction("hasNewerBundle","readonly",O=>E.Os.getBundleMetadata(O,v.id)).then(O=>!!O&&O.createTime.compareTo(I)>=0)}(i.localStore,c))return yield o.close(),a._completeWith({taskState:"Success",documentsLoaded:(y=c).totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}),Promise.resolve(new Set);a._updateProgress(Ip(c));const h=new vv(c,i.localStore,o.Tt);let p=yield o.yc();for(;p;){const y=yield h.Bu(p);y&&a._updateProgress(y),p=yield o.yc()}const m=yield h.complete();return yield Ht(i,m.Uu,void 0),yield function(y,v){const E=D(y);return E.persistence.runTransaction("Save bundle","readwrite",I=>E.Os.saveBundleMetadata(I,v))}(i.localStore,c),a._completeWith(m.progress),Promise.resolve(m.qu)}catch(c){return Yn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}var y}),function(i,o,a){return s.apply(this,arguments)})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}(yield dh(n),s,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function c_(n,e){return function Xv(n,e){return n.asyncQueue.enqueue((0,w.Z)(function*(){return function(t,r){const s=D(t);return s.persistence.runTransaction("Get named query","readonly",i=>s.Os.getNamedQuery(i,r))}(yield rl(n),e)}))}(_e(n=W(n,le)),e).then(t=>t?new Ge(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Je(this,t):null)}}class gl extends xh{constructor(e){super(),this.firestore=e}convertBytes(e){return new wo(new Mt(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return mt.forKey(t,this.firestore,null)}}class Am{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new gl(e)}get(e){const t=_r(e);return this._delegate.get(t).then(r=>new vo(this._firestore,new Qt(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const s=_r(e);return r?(Th("Transaction.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const i=_r(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,r,...s),this}delete(e){const t=_r(e);return this._delegate.delete(t),this}}class Im{constructor(e){this._delegate=e}set(e,t,r){const s=_r(e);return r?(Th("WriteBatch.set",r),this._delegate.set(s,t,r)):this._delegate.set(s,t),this}update(e,t,r,...s){const i=_r(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,r,...s),this}delete(e){const t=_r(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class vr{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new yo(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new _o(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=vr.INSTANCES;let s=r.get(e);s||(s=new WeakMap,r.set(e,s));let i=s.get(t);return i||(i=new vr(e,new gl(e),t),s.set(t,i)),i}}vr.INSTANCES=new WeakMap;class mt{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new gl(e)}static forPath(e,t,r){if(e.length%2!=0)throw new T("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new mt(t,new ae(t._delegate,r,new S(e)))}static forKey(e,t,r){return new mt(t,new ae(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ms(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ms(this.firestore,Xp(this._delegate,e))}catch(t){throw Xe(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,U.m9)(e))instanceof ae&&Jp(this._delegate,e)}set(e,t){t=Th("DocumentReference.set",t);try{return t?wm(this._delegate,e,t):wm(this._delegate,e)}catch(r){throw Xe(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?vm(this._delegate,e):vm(this._delegate,e,t,...r)}catch(s){throw Xe(s,"updateDoc()","DocumentReference.update()")}}delete(){return function L_(n){return Ds(W(n.firestore,le),[new fs(n._key,de.none())])}(this._delegate)}onSnapshot(...e){const t=Sm(e),r=Dm(e,s=>new vo(this.firestore,new Qt(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return _m(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function N_(n){n=W(n,ae);const e=W(n.firestore,le),t=_e(e),r=new En(e);return function Wv(n,e){const t=new Ie;return n.asyncQueue.enqueueAndForget((0,w.Z)(function*(){return(r=(0,w.Z)(function*(s,i,o){try{const a=yield function(c,h){const p=D(c);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,h))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new T(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const c=xs(a,`Failed to get document '${i} from cache`);o.reject(c)}}),function(s,i,o){return r.apply(this,arguments)})(yield rl(n),e,t);var r})),t.promise}(t,n._key).then(s=>new Qt(e,r,n._key,s,new wr(null!==s&&s.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function O_(n){n=W(n,ae);const e=W(n.firestore,le);return jp(_e(e),n._key,{source:"server"}).then(t=>Eh(e,n,t))}(this._delegate):function k_(n){n=W(n,ae);const e=W(n.firestore,le);return jp(_e(e),n._key).then(t=>Eh(e,n,t))}(this._delegate),t.then(r=>new vo(this.firestore,new Qt(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new mt(this.firestore,this._delegate.withConverter(e?vr.getInstance(this.firestore,e):null))}}function Xe(n,e,t){return n.message=n.message.replace(e,t),n}function Sm(n){for(const e of n)if("object"==typeof e&&!Ah(e))return e;return{}}function Dm(n,e){var t,r;let s;return s=Ah(n[0])?n[0]:Ah(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:i=>{s.next&&s.next(e(i))},error:null===(t=s.error)||void 0===t?void 0:t.bind(s),complete:null===(r=s.complete)||void 0===r?void 0:r.bind(s)}}class vo{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new mt(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return ym(this._delegate,e._delegate)}}class _o extends vo{data(e){const t=this._delegate.data(e);return function Zg(n,e){n||M()}(void 0!==t),t}}class Je{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new gl(e)}where(e,t,r){try{return new Je(this.firestore,Cn(this._delegate,function __(n,e,t){const r=e,s=hl("where",n);return go._create(s,r,t)}(e,t,r)))}catch(s){throw Xe(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Je(this.firestore,Cn(this._delegate,function b_(n,e="asc"){const t=e,r=hl("orderBy",n);return Ch._create(r,t)}(e,t)))}catch(r){throw Xe(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Je(this.firestore,Cn(this._delegate,function C_(n){return Qp("limit",n),dl._create("limit",n,"F")}(e)))}catch(t){throw Xe(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Je(this.firestore,Cn(this._delegate,function x_(n){return Qp("limitToLast",n),dl._create("limitToLast",n,"L")}(e)))}catch(t){throw Xe(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Je(this.firestore,Cn(this._delegate,function E_(...n){return fl._create("startAt",n,!0)}(...e)))}catch(t){throw Xe(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Je(this.firestore,Cn(this._delegate,function T_(...n){return fl._create("startAfter",n,!1)}(...e)))}catch(t){throw Xe(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Je(this.firestore,Cn(this._delegate,function A_(...n){return pl._create("endBefore",n,!1)}(...e)))}catch(t){throw Xe(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Je(this.firestore,Cn(this._delegate,function I_(...n){return pl._create("endAt",n,!0)}(...e)))}catch(t){throw Xe(t,"endAt()","Query.endAt()")}}isEqual(e){return mh(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function P_(n){n=W(n,Ge);const e=W(n.firestore,le),t=_e(e),r=new En(e);return function Qv(n,e){const t=new Ie;return n.asyncQueue.enqueueAndForget((0,w.Z)(function*(){return(r=(0,w.Z)(function*(s,i,o){try{const a=yield Qa(s,i,!0),c=new Mp(i,a.Yi),h=c.Hu(a.documents),p=c.applyChanges(h,!1);o.resolve(p.snapshot)}catch(a){const c=xs(a,`Failed to execute query '${i} against cache`);o.reject(c)}}),function(s,i,o){return r.apply(this,arguments)})(yield rl(n),e,t);var r})),t.promise}(t,n._query).then(s=>new xn(e,r,n,s))}(this._delegate):"server"===e?.source?function F_(n){n=W(n,Ge);const e=W(n.firestore,le),t=_e(e),r=new En(e);return $p(t,n._query,{source:"server"}).then(s=>new xn(e,r,n,s))}(this._delegate):function V_(n){n=W(n,Ge);const e=W(n.firestore,le),t=_e(e),r=new En(e);return cm(n._query),$p(t,n._query).then(s=>new xn(e,r,n,s))}(this._delegate),t.then(r=>new Ih(this.firestore,new xn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=Sm(e),r=Dm(e,s=>new Ih(this.firestore,new xn(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return _m(this._delegate,t,r)}withConverter(e){return new Je(this.firestore,this._delegate.withConverter(e?vr.getInstance(this.firestore,e):null))}}class e0{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new _o(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Ih{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Je(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new _o(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new e0(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new _o(this._firestore,r))})}isEqual(e){return ym(this._delegate,e._delegate)}}class Ms extends Je{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new mt(this.firestore,e):null}doc(e){try{return new mt(this.firestore,void 0===e?il(this._delegate):il(this._delegate,e))}catch(t){throw Xe(t,"doc()","CollectionReference.doc()")}}add(e){return function R_(n,e){const t=W(n.firestore,le),r=il(n),s=ml(n.converter,e);return Ds(t,[ll(gr(n.firestore),"addDoc",r._key,s,null!==n.converter,{}).toMutation(r._key,de.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new mt(this.firestore,t))}isEqual(e){return Jp(this._delegate,e._delegate)}withConverter(e){return new Ms(this.firestore,this._delegate.withConverter(e?vr.getInstance(this.firestore,e):null))}}function _r(n){return W(n,ae)}class Sh{constructor(...e){this._delegate=new Wt(...e)}static documentId(){return new Sh(me.keyField().canonicalString())}isEqual(e){return(e=(0,U.m9)(e))instanceof Wt&&this._delegate._internalPath.isEqual(e._internalPath)}}class br{constructor(e){this._delegate=e}static serverTimestamp(){const e=function K_(){return new yh("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new br(e)}static delete(){const e=function $_(){return new ho("deleteField")}();return e._methodName="FieldValue.delete",new br(e)}static arrayUnion(...e){const t=function z_(...n){return new m_("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new br(t)}static arrayRemove(...e){const t=function H_(...n){return new g_("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new br(t)}static increment(e){const t=function W_(n){return new y_("increment",n)}(e);return t._methodName="FieldValue.increment",new br(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const t0={Firestore:Tm,GeoPoint:ol,Timestamp:he,Blob:wo,Transaction:Am,WriteBatch:Im,DocumentReference:mt,DocumentSnapshot:vo,Query:Je,QueryDocumentSnapshot:_o,QuerySnapshot:Ih,CollectionReference:Ms,FieldPath:Sh,FieldValue:br,setLogLevel:function J_(n){!function Qg(n){an.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function r0(n){(function n0(n,e){n.INTERNAL.registerComponent(new gt.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),s=t.getProvider("firestore").getImmediate();return e(r,s)},"PUBLIC").setServiceProps(Object.assign({},t0)))})(n,(e,t)=>new Tm(e,t,new X_)),n.registerVersion("@firebase/firestore-compat","0.3.4")}(Mo.Z);var An=G(1205),s0=G(6217);function Mm(n,e){return function o0(n,e=Ls.z){return new _t.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function Dh(n,e){return Mm(n,e).pipe((0,be.U)(t=>({payload:t,type:"query"})))}function yl(n,e){return Dh(n,e).pipe((0,Yt.O)(void 0),Re(),(0,be.U)(([t,r])=>{const s=r.payload.docChanges(),i=s.map(o=>({type:o.type,payload:o}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((o,a)=>{const c=s.find(p=>p.doc.ref.isEqual(o.ref)),h=t?.payload.docs.find(p=>p.ref.isEqual(o.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(o.metadata)||!c&&h&&JSON.stringify(h.metadata)===JSON.stringify(o.metadata)||i.push({type:"modified",payload:{oldIndex:a,newIndex:a,type:"modified",doc:o}})}),i}))}function km(n,e,t){return yl(n,t).pipe((0,ot.R)((r,s)=>function l0(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function u0(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return Mh(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return Mh(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Mh(n,e.oldIndex,1)}return n}(n,r))}),n}(r,s.map(i=>i.payload),e),[]),(0,Ol.x)(),(0,be.U)(r=>r.map(s=>({type:s.type,payload:s}))))}function Mh(n,e,t,...r){const s=n.slice();return s.splice(e,t,...r),s}function Nm(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}G(9260);class Om{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=yl(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,be.U)(r=>r.filter(s=>e.indexOf(s.type)>-1)))),t.pipe((0,Yt.O)(void 0),Re(),(0,We.h)(([r,s])=>s.length>0||!r),(0,be.U)(([r,s])=>s),$e.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,ot.R)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=Nm(e);return km(this.query,t,this.afs.schedulers.outsideAngular).pipe($e.iC)}valueChanges(e={}){return Dh(this.query,this.afs.schedulers.outsideAngular).pipe((0,be.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),$e.iC)}get(e){return(0,On.D)(this.query.get(e)).pipe($e.iC)}add(e){return this.ref.add(e)}doc(e){return new Vm(this.ref.doc(e),this.afs)}}class Vm{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:s,query:i}=Pm(r,t);return new Om(s,i,this.afs)}snapshotChanges(){return function a0(n,e){return Mm(n,e).pipe((0,Yt.O)(void 0),Re(),(0,be.U)(([t,r])=>r.exists?t?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe($e.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,be.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,On.D)(this.ref.get(e)).pipe($e.iC)}}class c0{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?yl(this.query,this.afs.schedulers.outsideAngular).pipe((0,be.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),(0,We.h)(t=>t.length>0),$e.iC):yl(this.query,this.afs.schedulers.outsideAngular).pipe($e.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,ot.R)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=Nm(e);return km(this.query,t,this.afs.schedulers.outsideAngular).pipe($e.iC)}valueChanges(e={}){return Dh(this.query,this.afs.schedulers.outsideAngular).pipe((0,be.U)(r=>r.payload.docs.map(s=>e.idField?Object.assign({[e.idField]:s.id},s.data()):s.data())),$e.iC)}get(e){return(0,On.D)(this.query.get(e)).pipe($e.iC)}}const h0=new d.OlP("angularfire2.enableFirestorePersistence"),d0=new d.OlP("angularfire2.firestore.persistenceSettings"),f0=new d.OlP("angularfire2.firestore.settings"),p0=new d.OlP("angularfire2.firestore.use-emulator");function Pm(n,e=(t=>t)){return{query:e(n),ref:n}}let kh=(()=>{class n{constructor(t,r,s,i,o,a,c,h,p,m,y,v,E,I,O,J,k){this.schedulers=c;const P=(0,Xt.on)(t,a,r),ue=p;m&&(0,An.nw)(P,a,y,E,I,O,v,J),[this.firestore,this.persistenceEnabled$]=(0,Xt.cc)(`${P.name}.firestore`,"AngularFirestore",P.name,()=>{const z=a.runOutsideAngular(()=>P.firestore());if(i&&z.settings(i),ue&&z.useEmulator(...ue),s&&!(0,Le.PM)(o)){const X=()=>{try{return(0,On.D)(z.enablePersistence(h||void 0).then(()=>!0,()=>!1))}catch(De){return typeof console<"u"&&console.warn(De),(0,Ir.of)(!1)}};return[z,a.runOutsideAngular(X)]}return[z,(0,Ir.of)(!1)]},[i,ue,s])}collection(t,r){let s;s="string"==typeof t?this.firestore.collection(t):t;const{ref:i,query:o}=Pm(s,r),a=this.schedulers.ngZone.run(()=>i);return new Om(a,o,this)}collectionGroup(t,r){const s=r||(o=>o),i=this.firestore.collectionGroup(t);return new c0(s(i),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const s=this.schedulers.ngZone.run(()=>r);return new Vm(s,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(Xt.Dh),d.LFG(Xt.xv,8),d.LFG(h0,8),d.LFG(f0,8),d.LFG(d.Lbi),d.LFG(d.R0b),d.LFG($e.HU),d.LFG(d0,8),d.LFG(p0,8),d.LFG(An.zQ,8),d.LFG(An.Qv,8),d.LFG(An.L6,8),d.LFG(An._Q,8),d.LFG(An.rT,8),d.LFG(An.lh,8),d.LFG(An.f7,8),d.LFG(s0.nm,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),Fm=(()=>{class n extends Fs{constructor(t){super(Do,t,"calendarios")}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(kh))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),m0=(()=>{class n extends Fs{constructor(t){super(Ar,t,"refeicoes")}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(kh))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),w0=(()=>{class n{compress(t){const r=t.type||"image/jpeg",s=new FileReader;return s.readAsDataURL(t),_t.y.create(i=>{s.onload=o=>{const a=this.createImage(o),c=a.width>a.height?a.width:a.height;let h=c>500?500/c:.8,p=t.size>25e4?25e4/t.size:.7;a.onload=()=>{const m=document.createElement("canvas");m.width=500,m.height=500/(a.width*h)*(a.height*h),console.log("teste img:",m);const y=m.getContext("2d");y.drawImage(a,0,0,m.width,m.height),y.canvas.toBlob(v=>{i.next(new File([v],t.name,{type:r,lastModified:Date.now()}))},r,p)}},s.onerror=o=>i.error(o)})}createImage(t){let r=t.target.result;const s=new Image;return s.src=r,s}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var v0=G(4742),_0=G(8421),b0=G(7669),C0=G(3268),x0=G(1810);let Bm=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.Qsj),d.Y36(d.SBq))},n.\u0275dir=d.lG2({type:n}),n})(),Cr=(()=>{class n extends Bm{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=d.n5z(n)))(r||n)}}(),n.\u0275dir=d.lG2({type:n,features:[d.qOj]}),n})();const kt=new d.OlP("NgValueAccessor"),A0={provide:kt,useExisting:(0,d.Gpc)(()=>wl),multi:!0},S0=new d.OlP("CompositionEventMode");let wl=(()=>{class n extends Bm{constructor(t,r,s){super(t,r),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function I0(){const n=(0,Le.q)()?(0,Le.q)().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.Qsj),d.Y36(d.SBq),d.Y36(S0,8))},n.\u0275dir=d.lG2({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,r){1&t&&d.NdJ("input",function(i){return r._handleInput(i.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(i){return r._compositionEnd(i.target.value)})},features:[d._Bn([A0]),d.qOj]}),n})();const D0=!1,He=new d.OlP("NgValidators"),Sn=new d.OlP("NgAsyncValidators");function Zm(n){return null!=n}function Ym(n){const e=(0,d.QGY)(n)?(0,On.D)(n):n;if(D0&&!(0,d.CqO)(e)){let t="Expected async validator to return Promise or Observable.";throw"object"==typeof n&&(t+=" Are you using a synchronous validator where an async validator is expected?"),new d.vHH(-1101,t)}return e}function Xm(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function Jm(n,e){return e.map(t=>t(n))}function eg(n){return n.map(e=>function k0(n){return!n.validate}(e)?e:t=>e.validate(t))}function Nh(n){return null!=n?function tg(n){if(!n)return null;const e=n.filter(Zm);return 0==e.length?null:function(t){return Xm(Jm(t,e))}}(eg(n)):null}function Oh(n){return null!=n?function ng(n){if(!n)return null;const e=n.filter(Zm);return 0==e.length?null:function(t){return function E0(...n){const e=(0,b0.jO)(n),{args:t,keys:r}=(0,v0.D)(n),s=new _t.y(i=>{const{length:o}=t;if(!o)return void i.complete();const a=new Array(o);let c=o,h=o;for(let p=0;p<o;p++){let m=!1;(0,_0.Xf)(t[p]).subscribe((0,Ot.x)(i,y=>{m||(m=!0,h--),a[p]=y},()=>c--,void 0,()=>{(!c||!m)&&(h||i.next(r?(0,x0.n)(r,a):a),i.complete())}))}});return e?s.pipe((0,C0.Z)(e)):s}(Jm(t,e).map(Ym)).pipe((0,be.U)(Xm))}}(eg(n)):null}function rg(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Vh(n){return n?Array.isArray(n)?n:[n]:[]}function _l(n,e){return Array.isArray(n)?n.includes(e):n===e}function og(n,e){const t=Vh(e);return Vh(n).forEach(s=>{_l(t,s)||t.push(s)}),t}function ag(n,e){return Vh(e).filter(t=>!_l(n,t))}class lg{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Nh(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Oh(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class et extends lg{get formDirective(){return null}get path(){return null}}class Dn extends lg{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class ug{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let cg=(()=>{class n extends ug{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(Dn,2))},n.\u0275dir=d.lG2({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,r){2&t&&d.ekj("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[d.qOj]}),n})();const bo="VALID",Cl="INVALID",ks="PENDING",Co="DISABLED";function xl(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class pg{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===bo}get invalid(){return this.status===Cl}get pending(){return this.status==ks}get disabled(){return this.status===Co}get enabled(){return this.status!==Co}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(og(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(og(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(ag(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(ag(e,this._rawAsyncValidators))}hasValidator(e){return _l(this._rawValidators,e)}hasAsyncValidator(e){return _l(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=ks,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Co,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=bo,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===bo||this.status===ks)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Co:bo}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=ks,this._hasOwnPendingAsyncValidator=!0;const t=Ym(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((r,s)=>r&&r._find(s),this)}getError(e,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new d.vpe,this.statusChanges=new d.vpe}_calculateStatus(){return this._allControlsDisabled()?Co:this.errors?Cl:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ks)?ks:this._anyControlsHaveStatus(Cl)?Cl:bo}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){xl(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function B0(n){return Array.isArray(n)?Nh(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function U0(n){return Array.isArray(n)?Oh(n):n||null}(this._rawAsyncValidators)}}const Ns=new d.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>El}),El="always";function xo(n,e,t=El){(function qh(n,e){const t=function sg(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(rg(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const r=function ig(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(rg(r,e.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const s=()=>n.updateValueAndValidity();Il(e._rawValidators,s),Il(e._rawAsyncValidators,s)})(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function j0(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&mg(n,e)})}(n,e),function K0(n,e){const t=(r,s)=>{e.valueAccessor.writeValue(r),s&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function $0(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&mg(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function G0(n,e){if(e.valueAccessor.setDisabledState){const t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function Il(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function mg(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function wg(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function vg(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const _g=class extends pg{constructor(e=null,t,r){super(function Rh(n){return(xl(n)?n.validators:n)||null}(t),function Bh(n,e){return(xl(e)?e.asyncValidators:n)||null}(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),xl(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=vg(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){wg(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){wg(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){vg(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},J0={provide:Dn,useExisting:(0,d.Gpc)(()=>zh)},xg=(()=>Promise.resolve())();let zh=(()=>{class n extends Dn{constructor(t,r,s,i,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new _g,this._registered=!1,this.update=new d.vpe,this._parent=t,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=function $h(n,e){if(!e)return null;let t,r,s;return Array.isArray(e),e.forEach(i=>{i.constructor===wl?t=i:function W0(n){return Object.getPrototypeOf(n.constructor)===Cr}(i)?r=i:s=i}),s||r||t||null}(0,i)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function jh(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){xo(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){xg.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const r=t.isDisabled.currentValue,s=0!==r&&(0,d.D6c)(r);xg.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function Tl(n,e){return[...e.path,n]}(t,this._parent):[t]}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(et,9),d.Y36(He,10),d.Y36(Sn,10),d.Y36(kt,10),d.Y36(d.sBO,8),d.Y36(Ns,8))},n.\u0275dir=d.lG2({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[d._Bn([J0]),d.qOj,d.TTD]}),n})(),Tg=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({}),n})(),Eb=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[Tg]}),n})(),Ab=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Ns,useValue:t.callSetDisabledState??El}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[Eb]}),n})();function Ib(n,e){if(1&n){const t=d.EpF();d.ynx(0),d.TgZ(1,"div",14),d.NdJ("click",function(){d.CHM(t);const s=d.oxw().$implicit,i=d.oxw(3);return d.KtG(i.openImage(s.foto))}),d._UZ(2,"img",15),d.qZA(),d.BQk()}if(2&n){const t=d.oxw().$implicit;d.xp6(2),d.Q6J("src",t.foto,d.LSH)}}function Sb(n,e){1&n&&(d.ynx(0),d._UZ(1,"div",16),d.BQk())}function Db(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"div",12)(1,"button",9),d.NdJ("click",function(){const i=d.CHM(t).index,o=d.oxw().index,a=d.oxw(2);return d.KtG(a.deleteRefeicoes(o,i))}),d._UZ(2,"i",13),d.qZA(),d.TgZ(3,"div")(4,"h4"),d._uU(5),d.qZA(),d.TgZ(6,"p"),d._uU(7),d.qZA()(),d.YNc(8,Ib,3,1,"ng-container",0),d.YNc(9,Sb,2,0,"ng-container",0),d.qZA()}if(2&n){const t=e.$implicit;d.xp6(5),d.Oqu(t.hora),d.xp6(2),d.Oqu(t.prato),d.xp6(1),d.Q6J("ngIf",t.foto),d.xp6(1),d.Q6J("ngIf",!t.foto)}}function Mb(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"div")(1,"header")(2,"h3"),d._uU(3),d.qZA(),d.TgZ(4,"button",9),d.NdJ("click",function(){const i=d.CHM(t).index,o=d.oxw(2);return d.KtG(o.deleteDia(i))}),d._UZ(5,"i",10),d.qZA()(),d.TgZ(6,"div"),d.YNc(7,Db,10,4,"div",11),d.qZA(),d.TgZ(8,"button",9),d.NdJ("click",function(){const i=d.CHM(t).index,o=d.oxw(2);return d.KtG(o.createRefeicoes(i))}),d._UZ(9,"i",6),d._uU(10," Adicionar Refei\xe7\xe3o"),d.qZA()()}if(2&n){const t=e.$implicit;d.xp6(3),d.Oqu(t.nome),d.xp6(4),d.Q6J("ngForOf",t.refeicoes)}}function kb(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"div")(1,"header",1)(2,"h2"),d._uU(3),d.qZA(),d.TgZ(4,"a",2),d._uU(5,"Voltar"),d.qZA()(),d.TgZ(6,"div",3),d.YNc(7,Mb,11,2,"div",4),d.TgZ(8,"button",5),d.NdJ("click",function(){d.CHM(t);const s=d.oxw();return d.KtG(s.createDia())}),d._UZ(9,"i",6),d._uU(10," Adicionar Dia"),d.qZA()(),d.TgZ(11,"div",7)(12,"h3"),d._uU(13,"Observa\xe7\xf5es"),d.qZA(),d.TgZ(14,"textarea",8),d.NdJ("ngModelChange",function(s){d.CHM(t);const i=d.oxw();return d.KtG(i.calendario.observacao=s)}),d._uU(15),d.qZA(),d.TgZ(16,"button",9),d.NdJ("click",function(){d.CHM(t);const s=d.oxw();return d.KtG(s.salvarObservacao())}),d._uU(17,"Salvar Observa\xe7\xe3o"),d.qZA()()()}if(2&n){const t=d.oxw();d.xp6(3),d.AsE("",t.convertMes(t.calendarioPrint.nome)," de ",t.calendarioPrint.ano," "),d.xp6(4),d.Q6J("ngForOf",t.calendarioPrint.dias),d.xp6(7),d.Q6J("ngModel",t.calendario.observacao),d.xp6(1),d.Oqu(t.calendario.observacao)}}let Nb=(()=>{class n{constructor(t,r,s,i,o){this.service=t,this.serviceRefeicoes=r,this.route=s,this.compressImage=i,this.router=o,this.isload=!1,this.id="",this.formRefeicoes='<label class="label-swal">Horas:<input id="hora-input" type="time" class="form-control" required></label><label class="label-swal">Refei\xe7\xe3o:<input id="comida-input" class="form-control" required></label><label class="label-swal">Foto:<input id="foto-input" type="file" accept="image/png, image/jpeg" class="form-control"></label>',this.formDia='<label class="label-swal">Dia:<input id="dia-input" type="number" min="1" max="31" class="form-control" required></label>'}ngOnInit(){this.route.paramMap.subscribe(t=>{this.id=t.params.id,this.updateList()})}createDia(){Me().fire({title:"Novo Dia",html:this.formDia,confirmButtonText:"Salvar a Dia",focusConfirm:!1,preConfirm:()=>{const t=document.querySelector("#dia-input");t.value?(this.calendario.dias.push({nome:t.value,refeicoes:[]}),this.calendario.dias=this.calendario.dias.sort((r,s)=>parseInt(r.nome)-parseInt(s.nome)),this.service.createOrUpdate(this.calendario).then(()=>{this.updateList(),Me().fire({icon:"success",title:"Dia Salvo"})})):Me().showValidationMessage("Preencha todos os campos obrigat\xf3rios")}})}deleteDia(t){console.log("index",t),console.log("this.calendario.dias",this.calendario.dias),console.log("this.calendario.dias[index]",this.calendario.dias[t]),Me().fire({title:"Deseja Deletar esse Dia?",showDenyButton:!0,confirmButtonText:"Sim",denyButtonText:"N\xe3o"}).then(r=>{r.isConfirmed&&(this.calendario.dias.splice(t,1),console.log("this.calendario.dias",this.calendario.dias),this.service.createOrUpdate(this.calendario).then(()=>{Me().fire({icon:"success",title:"Refei\xe7\xe3o Deletada"}),this.updateList()}))})}createRefeicoes(t){Me().fire({title:"Nova Refei\xe7\xe3o",html:this.formRefeicoes,confirmButtonText:"Salvar a Refei\xe7\xe3o",focusConfirm:!1,preConfirm:()=>{const r=document.querySelector("#hora-input"),s=document.querySelector("#comida-input"),i=document.querySelector("#foto-input");r.value&&s.value?this.saveRefeicoes({hora:r.value,prato:s.value,foto:i},t).subscribe(a=>{this.calendario.dias[t].refeicoes.push(a.id),this.service.createOrUpdate(this.calendario).then(()=>{this.updateList(),Me().fire({icon:"success",title:"Refei\xe7\xe3o Salva"})})}):Me().showValidationMessage("Preencha todos os campos obrigat\xf3rios")}})}deleteRefeicoes(t,r){Me().fire({title:"Deseja Deletar essa refei\xe7\xe3o?",showDenyButton:!0,confirmButtonText:"Sim",denyButtonText:"N\xe3o"}).then(s=>{s.isConfirmed&&this.serviceRefeicoes.delete(this.calendarioPrint.dias[t].refeicoes[r].id).then(()=>{const i=this.calendario.dias[t].refeicoes.indexOf(o=>o.id==this.calendarioPrint.dias[t].refeicoes[r].id);console.log("indexDelete: ",i),this.calendario.dias[t].refeicoes.splice(i,1),this.service.createOrUpdate(this.calendario).then(()=>{Me().fire({icon:"success",title:"Refei\xe7\xe3o Deletada"}),this.updateList()})})})}openImage(t){Me().fire({html:`<img src="${t}">`,showConfirmButton:!1})}getBase64(t){return new Promise((r,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=()=>r(i.result),i.onerror=o=>s(o)})}updateList(){this.isload=!1,this.service.get(this.id).subscribe(t=>{this.calendario=JSON.parse(JSON.stringify(t)),this.calendario.observacao||(this.calendario.observacao=""),this.calendario.dias.length||(this.isload=!0),t.dias.forEach((r,s)=>{t.dias.length==s+1&&(this.calendarioPrint=JSON.parse(JSON.stringify(t)),this.isload=!0);let i=0;r.refeicoes.forEach((o,a)=>{this.serviceRefeicoes.get(o).subscribe(c=>{i++,r.refeicoes[a]=c,i==r.refeicoes.length&&(r.refeicoes=r.refeicoes.sort((h,p)=>parseInt(h.hora.replace(/[^0-9]/g,""))-parseInt(p.hora.replace(/[^0-9]/g,""))),this.calendarioPrint=JSON.parse(JSON.stringify(t)),this.isload=!0)})})})})}saveRefeicoes(t,r){return new _t.y(s=>{t.foto.files[0]?this.compressImage.compress(t.foto.files[0]).pipe((0,Ao.q)(1)).subscribe(i=>{console.log(`Image size after compressed: ${i.size} bytes.`),this.getBase64(i).then(o=>{t.foto=o,this.serviceRefeicoes.createOrUpdate(t).then(()=>{s.next(t)})})}):(t.foto="",this.serviceRefeicoes.createOrUpdate(t).then(()=>{s.next(t)}))})}salvarObservacao(){console.log("Teste: ",this.calendario),this.service.createOrUpdate(this.calendario).then(()=>{this.updateList(),Me().fire({icon:"success",title:"Observa\xe7\xe3o Salva com sucesso"})})}convertMes(t){return["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][t-1]}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(Fm),d.Y36(m0),d.Y36(C.gz),d.Y36(w0),d.Y36(C.F0))},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-mes"]],decls:1,vars:1,consts:[[4,"ngIf"],["id","header-detail"],["routerLink","/"],["id","list-dia"],[4,"ngFor","ngForOf"],["id","newCard",3,"click"],[1,"fa-solid","fa-plus"],["id","observacao"],[3,"ngModel","ngModelChange"],[3,"click"],[1,"fa-solid","fa-delete-left"],["class","item",4,"ngFor","ngForOf"],[1,"item"],[1,"fa-solid","fa-delete-right"],[1,"foto",3,"click"],[3,"src"],[1,"foto"]],template:function(t,r){1&t&&d.YNc(0,kb,18,5,"div",0),2&t&&d.Q6J("ngIf",r.isload)},dependencies:[Le.sg,Le.O5,C.rH,wl,cg,zh],styles:["#list-dia[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:flex-start}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:calc(33.33% - 20px);margin:10px;border-radius:10px;overflow:hidden;background-color:#fff;border:solid 1px #dddddd;box-shadow:1px 1px 2px 1px #ddd;display:table}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > header[_ngcontent-%COMP%]{width:100%;text-align:center;font-weight:700;font-size:28px;padding:5px 10px;background-color:#ffc901;box-shadow:#0000004d 2px 0 5px 1px;position:relative}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px;color:#fff;box-shadow:#0000004d 2px 0 5px 1px;padding:3px 5px;background-color:#d20404;border-radius:50%;top:10px;right:20px;position:absolute}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:auto}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{padding:10px;border-bottom:solid 1px #dddddd;display:flex;align-items:flex-start}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{display:flex;width:30px;height:30px;border-radius:50%;color:#fff;align-items:center;justify-content:center;background:#d20404;text-shadow:1px 1px 1px black;margin-right:10px}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:calc(100% - 100px)}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .foto[_ngcontent-%COMP%]{flex:100px;width:100px;height:100px;background-color:gray;display:flex;align-items:center;justify-content:center;cursor:pointer}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .foto[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{min-width:100%;min-height:100%;max-width:none;max-height:none;width:100%;height:100%}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{display:table;margin-top:10px;padding:15px 5px;background-color:#ffedad;border:solid #ffc901 1px;color:#dd7d02;width:100%}#header-detail[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}#header-detail[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:28px}#header-detail[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{background:#ffedad;border:solid 1px #ffc901;color:#dd7f02;padding:5px 30px;margin:20px;border-radius:10px;text-decoration:none}#observacao[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:20px;text-align:center}#observacao[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;min-width:100%;max-width:100%;height:8em;min-height:3em;max-height:10em;padding:.375rem .75rem;font-size:1rem;line-height:1.5;color:#495057;background-color:#fff;background-clip:padding-box;border:1px solid #ced4da;border-radius:.25rem}#observacao[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:table;background:#ffedad;border:solid 1px #ffc901;color:#dd7f02;padding:10px 30px;margin:20px auto;border-radius:10px}@media (max-width: 1000px){#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:calc(100% - 20px)}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:auto}#list-dia[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .foto[_ngcontent-%COMP%]{flex:50px;width:50px;height:50px}}"]}),n})(),Ob=(()=>{class n extends Fs{constructor(t){super(Nn,t,"meses")}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(kh))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Vb=function(n){return[n]};function Pb(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"div")(1,"header")(2,"h2"),d._uU(3),d.TgZ(4,"span"),d._uU(5),d.qZA()()(),d.TgZ(6,"div")(7,"a",4),d._uU(8,"Entrar"),d.qZA(),d.TgZ(9,"button",5),d.NdJ("click",function(){const i=d.CHM(t).$implicit,o=d.oxw();return d.KtG(o.deleteMes(i.id))}),d._uU(10,"Deletar"),d.qZA(),d.TgZ(11,"button"),d._UZ(12,"i",6),d._uU(13,"Visto"),d.qZA()()()}if(2&n){const t=e.$implicit,r=d.oxw();d.xp6(3),d.hij("",r.convertMes(t.nome)," "),d.xp6(2),d.Oqu(t.ano),d.xp6(2),d.Q6J("routerLink",d.VKq(3,Vb,"mes/"+t.calendario))}}const Fb=[{path:"",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-panel"]],decls:6,vars:0,consts:[["id","panel"],[1,"container"],["src","/dailyfood/assets/svg/logo.svg","alt","Daily Food"]],template:function(t,r){1&t&&(d.TgZ(0,"div",0)(1,"div")(2,"div",1)(3,"h1"),d._UZ(4,"img",2),d.qZA(),d._UZ(5,"router-outlet"),d.qZA()()())},dependencies:[C.lC],styles:["#panel[_ngcontent-%COMP%]{background-color:#ffc901;background-image:url(/dailyfood/assets/img/bg-food-30.png);background-size:260px;padding-top:70px}#panel[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;min-height:calc(100vh - 70px);background-color:#f1f1f1;border-radius:20px 20px 0 0;box-shadow:#0003 0 -5px 5px}#panel[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{width:160px;transform:translateY(-60px);margin:0 auto -40px}"]}),n})(),children:[{path:"",component:(()=>{class n{constructor(t,r){this.service=t,this.serviceCalendario=r,this.meses=[],this.refCalendaro={nome:"",ano:"",dias:[]}}ngOnInit(){this.updateList()}createMes(){Me().fire({title:"Novo M\xeas",html:'\n        <label class="label-swal">\n          Dia:\n          <input id="mes-input" type="month" class="form-control">\n        </label>\n        ',confirmButtonText:"Salvar a Refei\xe7\xe3o",focusConfirm:!1,preConfirm:()=>{const t=document.querySelector("#mes-input");if(t.value){const r=t.value.split("-");this.refCalendaro.nome=r[1],this.refCalendaro.ano=r[0],this.serviceCalendario.createOrUpdate(this.refCalendaro).then(s=>{this.service.createOrUpdate({nome:r[1],ano:r[0],calendario:this.refCalendaro.id}).then(()=>{this.updateList()})})}else Me().showValidationMessage("Preencha todos os campos obrigat\xf3rios")}})}deleteMes(t){this.service.get(t).subscribe(r=>{this.serviceCalendario.delete(r.calendario).then(()=>{this.service.delete(t).then(()=>{this.updateList()})})})}convertMes(t){return["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][t-1]}updateList(){this.service.list().subscribe(t=>{this.meses=t})}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(Ob),d.Y36(Fm))},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-meses"]],decls:5,vars:1,consts:[["id","list-meses"],[4,"ngFor","ngForOf"],["id","newCard",3,"click"],[1,"fa-solid","fa-plus"],[3,"routerLink"],[3,"click"],[1,"fa-duotone","fa-toggle-large-on"]],template:function(t,r){1&t&&(d.TgZ(0,"div",0),d.YNc(1,Pb,14,5,"div",1),d.TgZ(2,"button",2),d.NdJ("click",function(){return r.createMes()}),d._UZ(3,"i",3),d._uU(4," Adicionar Dia"),d.qZA()()),2&t&&(d.xp6(1),d.Q6J("ngForOf",r.meses))},dependencies:[Le.sg,C.rH],styles:["#list-meses[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:calc(25% - 20px);margin:10px;border-radius:10px;overflow:hidden;background-color:#fff;border:solid 1px #dddddd;box-shadow:1px 1px 2px 1px #ddd;display:table}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]{background-color:#ffc901;font-size:20px;padding:10px 15px;text-transform:uppercase;font-weight:700;box-shadow:#0000004d 0 2px 5px 1px}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.7em;opacity:.5}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], #list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;width:33.333%;height:50px;align-items:center;justify-content:center;border-top:solid 1px transparent;border-left:solid 1px #dddddd;border-right:solid 1px #f1f1f1;text-decoration:none;color:#313131}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:not(:last-child), #list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:last-child){background-color:#ffc901;color:#000;cursor:pointer;border-top:solid 1px white}#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] > i[_ngcontent-%COMP%], #list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{font-size:2em;margin-right:10px;cursor:pointer}@media (max-width: 1000px){#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:calc(50% - 20px)}}@media (max-width: 700px){#list-meses[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:calc(100% - 20px)}}"]}),n})()},{path:"mes/:id",component:Nb}]},{path:"**",redirectTo:""}];let Lb=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[C.Bz.forChild(Fb),C.Bz]}),n})(),Rb=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[Le.ez,Lb,Ab]}),n})()},5226:function(Jh){Jh.exports=function(){"use strict";var B={awaitingPromise:new WeakMap,promise:new WeakMap,innerParams:new WeakMap,domCache:new WeakMap};const Le=l=>{const u={};for(const f in l)u[l[f]]="swal2-"+l[f];return u},C=Le(["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"]),_t=Le(["success","warning","info","question","error"]),Ao="SweetAlert2:",Me=l=>l.charAt(0).toUpperCase()+l.slice(1),d=l=>{console.warn(`${Ao} ${"object"==typeof l?l.join(" "):l}`)},be=l=>{console.error(`${Ao} ${l}`)},j=[],je=(l,u)=>{(l=>{j.includes(l)||(j.push(l),d(l))})(`"${l}" is deprecated and will be removed in the next major release. Please use "${u}" instead.`)},Er=l=>"function"==typeof l?l():l,Os=l=>l&&"function"==typeof l.toPromise,Mn=l=>Os(l)?l.toPromise():Promise.resolve(l),bt=l=>l&&Promise.resolve(l)===l,fe=()=>document.body.querySelector(`.${C.container}`),kn=l=>{const u=fe();return u?u.querySelector(l):null},se=l=>kn(`.${l}`),Y=()=>se(C.popup),Tr=()=>se(C.icon),Io=()=>se(C.title),Vs=()=>se(C["html-container"]),kl=()=>se(C.image),So=()=>se(C["progress-steps"]),Ps=()=>se(C["validation-message"]),ct=()=>kn(`.${C.actions} .${C.confirm}`),Zt=()=>kn(`.${C.actions} .${C.cancel}`),Nt=()=>kn(`.${C.actions} .${C.deny}`),Ct=()=>kn(`.${C.loader}`),Nn=()=>se(C.actions),Do=()=>se(C.footer),Ar=()=>se(C["timer-progress-bar"]),Ls=()=>se(C.close),Ir=()=>{const l=Array.from(Y().querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])')).sort((f,g)=>{const x=parseInt(f.getAttribute("tabindex")),F=parseInt(g.getAttribute("tabindex"));return x>F?1:x<F?-1:0}),u=Array.from(Y().querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n')).filter(f=>"-1"!==f.getAttribute("tabindex"));return(l=>{const u=[];for(let f=0;f<l.length;f++)-1===u.indexOf(l[f])&&u.push(l[f]);return u})(l.concat(u)).filter(f=>Be(f))},$e=()=>ot(document.body,C.shown)&&!ot(document.body,C["toast-shown"])&&!ot(document.body,C["no-backdrop"]),Yt=()=>Y()&&ot(Y(),C.toast),Ot={previousBodyPadding:null},Re=(l,u)=>{if(l.textContent="",u){const g=(new DOMParser).parseFromString(u,"text/html");Array.from(g.querySelector("head").childNodes).forEach(x=>{l.appendChild(x)}),Array.from(g.querySelector("body").childNodes).forEach(x=>{x instanceof HTMLVideoElement||x instanceof HTMLAudioElement?l.appendChild(x.cloneNode(!0)):l.appendChild(x)})}},ot=(l,u)=>{if(!u)return!1;const f=u.split(/\s+/);for(let g=0;g<f.length;g++)if(!l.classList.contains(f[g]))return!1;return!0},We=(l,u,f)=>{if(((l,u)=>{Array.from(l.classList).forEach(f=>{!Object.values(C).includes(f)&&!Object.values(_t).includes(f)&&!Object.values(u.showClass).includes(f)&&l.classList.remove(f)})})(l,u),u.customClass&&u.customClass[f]){if("string"!=typeof u.customClass[f]&&!u.customClass[f].forEach)return void d(`Invalid type of customClass.${f}! Expected string or iterable object, got "${typeof u.customClass[f]}"`);w(l,u.customClass[f])}},Xt=(l,u)=>{if(!u)return null;switch(u){case"select":case"textarea":case"file":return l.querySelector(`.${C.popup} > .${C[u]}`);case"checkbox":return l.querySelector(`.${C.popup} > .${C.checkbox} input`);case"radio":return l.querySelector(`.${C.popup} > .${C.radio} input:checked`)||l.querySelector(`.${C.popup} > .${C.radio} input:first-child`);case"range":return l.querySelector(`.${C.popup} > .${C.range} input`);default:return l.querySelector(`.${C.popup} > .${C.input}`)}},Vl=l=>{if(l.focus(),"file"!==l.type){const u=l.value;l.value="",l.value=u}},Mo=(l,u,f)=>{!l||!u||("string"==typeof u&&(u=u.split(/\s+/).filter(Boolean)),u.forEach(g=>{Array.isArray(l)?l.forEach(x=>{f?x.classList.add(g):x.classList.remove(g)}):f?l.classList.add(g):l.classList.remove(g)}))},w=(l,u)=>{Mo(l,u,!0)},Qe=(l,u)=>{Mo(l,u,!1)},gt=(l,u)=>{const f=Array.from(l.children);for(let g=0;g<f.length;g++){const x=f[g];if(x instanceof HTMLElement&&ot(x,u))return x}},tt=(l,u,f)=>{f===`${parseInt(f)}`&&(f=parseInt(f)),f||0===parseInt(f)?l.style[u]="number"==typeof f?`${f}px`:f:l.style.removeProperty(u)},U=function(l){l.style.display=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex"},ke=l=>{l.style.display="none"},ht=(l,u,f,g)=>{const x=l.querySelector(u);x&&(x.style[f]=g)},N=function(l,u){u?U(l,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):ke(l)},Be=l=>!(!l||!(l.offsetWidth||l.offsetHeight||l.getClientRects().length)),Vn=l=>l.scrollHeight>l.clientHeight,Pn=l=>{const u=window.getComputedStyle(l),f=parseFloat(u.getPropertyValue("animation-duration")||"0"),g=parseFloat(u.getPropertyValue("transition-duration")||"0");return f>0||g>0},Vt=function(l){let u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const f=Ar();Be(f)&&(u&&(f.style.transition="none",f.style.width="100%"),setTimeout(()=>{f.style.transition=`width ${l/1e3}s linear`,f.style.width="0%"},10))},K={},Ll=l=>new Promise(u=>{if(!l)return u();const f=window.scrollX,g=window.scrollY;K.restoreFocusTimeout=setTimeout(()=>{K.previousActiveElement instanceof HTMLElement?(K.previousActiveElement.focus(),K.previousActiveElement=null):document.body&&document.body.focus(),u()},100),window.scrollTo(f,g)}),Te=()=>typeof window>"u"||typeof document>"u",Sr=`\n <div aria-labelledby="${C.title}" aria-describedby="${C["html-container"]}" class="${C.popup}" tabindex="-1">\n   <button type="button" class="${C.close}"></button>\n   <ul class="${C["progress-steps"]}"></ul>\n   <div class="${C.icon}"></div>\n   <img class="${C.image}" />\n   <h2 class="${C.title}" id="${C.title}"></h2>\n   <div class="${C["html-container"]}" id="${C["html-container"]}"></div>\n   <input class="${C.input}" />\n   <input type="file" class="${C.file}" />\n   <div class="${C.range}">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="${C.select}"></select>\n   <div class="${C.radio}"></div>\n   <label for="${C.checkbox}" class="${C.checkbox}">\n     <input type="checkbox" />\n     <span class="${C.label}"></span>\n   </label>\n   <textarea class="${C.textarea}"></textarea>\n   <div class="${C["validation-message"]}" id="${C["validation-message"]}"></div>\n   <div class="${C.actions}">\n     <div class="${C.loader}"></div>\n     <button type="button" class="${C.confirm}"></button>\n     <button type="button" class="${C.deny}"></button>\n     <button type="button" class="${C.cancel}"></button>\n   </div>\n   <div class="${C.footer}"></div>\n   <div class="${C["timer-progress-bar-container"]}">\n     <div class="${C["timer-progress-bar"]}"></div>\n   </div>\n </div>\n`.replace(/(^|\n)\s*/g,""),Ke=()=>{K.currentInstance.resetValidationMessage()},Ne=l=>{const u=(()=>{const l=fe();return!!l&&(l.remove(),Qe([document.documentElement,document.body],[C["no-backdrop"],C["toast-shown"],C["has-column"]]),!0)})();if(Te())return void be("SweetAlert2 requires document to initialize");const f=document.createElement("div");f.className=C.container,u&&w(f,C["no-transition"]),Re(f,Sr);const g=(l=>"string"==typeof l?document.querySelector(l):l)(l.target);g.appendChild(f),(l=>{const u=Y();u.setAttribute("role",l.toast?"alert":"dialog"),u.setAttribute("aria-live",l.toast?"polite":"assertive"),l.toast||u.setAttribute("aria-modal","true")})(l),(l=>{"rtl"===window.getComputedStyle(l).direction&&w(fe(),C.rtl)})(g),(()=>{const l=Y(),u=gt(l,C.input),f=gt(l,C.file),g=l.querySelector(`.${C.range} input`),x=l.querySelector(`.${C.range} output`),F=gt(l,C.select),ee=l.querySelector(`.${C.checkbox} input`),ze=gt(l,C.textarea);u.oninput=Ke,f.onchange=Ke,F.onchange=Ke,ee.onchange=Ke,ze.oninput=Ke,g.oninput=()=>{Ke(),x.value=g.value},g.onchange=()=>{Ke(),x.value=g.value}})()},Us=(l,u)=>{l instanceof HTMLElement?u.appendChild(l):"object"==typeof l?Dr(l,u):l&&Re(u,l)},Dr=(l,u)=>{l.jquery?Oo(u,l):Re(u,l.toString())},Oo=(l,u)=>{if(l.textContent="",0 in u)for(let f=0;f in u;f++)l.appendChild(u[f].cloneNode(!0));else l.appendChild(u.cloneNode(!0))},Pt=(()=>{if(Te())return!1;const l=document.createElement("div"),u={WebkitAnimation:"webkitAnimationEnd",animation:"animationend"};for(const f in u)if(Object.prototype.hasOwnProperty.call(u,f)&&typeof l.style[f]<"u")return u[f];return!1})(),dt=(l,u)=>{const f=Nn(),g=Ct();u.showConfirmButton||u.showDenyButton||u.showCancelButton?U(f):ke(f),We(f,u,"actions"),function qs(l,u,f){const g=ct(),x=Nt(),F=Zt();Gs(g,"confirm",f),Gs(x,"deny",f),Gs(F,"cancel",f),function Bl(l,u,f,g){g.buttonsStyling?(w([l,u,f],C.styled),g.confirmButtonColor&&(l.style.backgroundColor=g.confirmButtonColor,w(l,C["default-outline"])),g.denyButtonColor&&(u.style.backgroundColor=g.denyButtonColor,w(u,C["default-outline"])),g.cancelButtonColor&&(f.style.backgroundColor=g.cancelButtonColor,w(f,C["default-outline"]))):Qe([l,u,f],C.styled)}(g,x,F,f),f.reverseButtons&&(f.toast?(l.insertBefore(F,g),l.insertBefore(x,g)):(l.insertBefore(F,u),l.insertBefore(x,u),l.insertBefore(g,u)))}(f,g,u),Re(g,u.loaderHtml),We(g,u,"loader")};function Gs(l,u,f){N(l,f[`show${Me(u)}Button`],"inline-block"),Re(l,f[`${u}ButtonText`]),l.setAttribute("aria-label",f[`${u}ButtonAriaLabel`]),l.className=C[u],We(l,f,`${u}Button`),w(l,f[`${u}ButtonClass`])}const Vo=(l,u)=>{const f=fe();f&&(function js(l,u){"string"==typeof u?l.style.background=u:u||w([document.documentElement,document.body],C["no-backdrop"])}(f,u.backdrop),function Po(l,u){u in C?w(l,C[u]):(d('The "position" parameter is not valid, defaulting to "center"'),w(l,C.center))}(f,u.position),function Ul(l,u){if(u&&"string"==typeof u){const f=`grow-${u}`;f in C&&w(l,C[f])}}(f,u.grow),We(f,u,"container"))};const Fo=["input","file","range","select","radio","checkbox","textarea"],$s=l=>{if(!Ce[l.input])return void be(`Unexpected type of input! Expected "text", "email", "password", "number", "tel", "select", "radio", "checkbox", "textarea", "file" or "url", got "${l.input}"`);const u=Ws(l.input),f=Ce[l.input](u,l);U(u),l.inputAutoFocus&&setTimeout(()=>{Vl(f)})},zs=(l,u)=>{const f=Xt(Y(),l);if(f){(l=>{for(let u=0;u<l.attributes.length;u++){const f=l.attributes[u].name;["type","value","style"].includes(f)||l.removeAttribute(f)}})(f);for(const g in u)f.setAttribute(g,u[g])}},ql=l=>{const u=Ws(l.input);"object"==typeof l.customClass&&w(u,l.customClass.input)},Hs=(l,u)=>{(!l.placeholder||u.inputPlaceholder)&&(l.placeholder=u.inputPlaceholder)},Ft=(l,u,f)=>{if(f.inputLabel){l.id=C.input;const g=document.createElement("label"),x=C["input-label"];g.setAttribute("for",l.id),g.className=x,"object"==typeof f.customClass&&w(g,f.customClass.inputLabel),g.innerText=f.inputLabel,u.insertAdjacentElement("beforebegin",g)}},Ws=l=>gt(Y(),C[l]||C.input),Nr=(l,u)=>{["string","number"].includes(typeof u)?l.value=`${u}`:bt(u)||d(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof u}"`)},Ce={};Ce.text=Ce.email=Ce.password=Ce.number=Ce.tel=Ce.url=(l,u)=>(Nr(l,u.inputValue),Ft(l,l,u),Hs(l,u),l.type=u.input,l),Ce.file=(l,u)=>(Ft(l,l,u),Hs(l,u),l),Ce.range=(l,u)=>{const f=l.querySelector("input"),g=l.querySelector("output");return Nr(f,u.inputValue),f.type=u.input,Nr(g,u.inputValue),Ft(f,l,u),l},Ce.select=(l,u)=>{if(l.textContent="",u.inputPlaceholder){const f=document.createElement("option");Re(f,u.inputPlaceholder),f.value="",f.disabled=!0,f.selected=!0,l.appendChild(f)}return Ft(l,l,u),l},Ce.radio=l=>(l.textContent="",l),Ce.checkbox=(l,u)=>{const f=Xt(Y(),"checkbox");f.value="1",f.id=C.checkbox,f.checked=Boolean(u.inputValue);const g=l.querySelector("span");return Re(g,u.inputPlaceholder),f},Ce.textarea=(l,u)=>{Nr(l,u.inputValue),Hs(l,u),Ft(l,l,u);return setTimeout(()=>{if("MutationObserver"in window){const g=parseInt(window.getComputedStyle(Y()).width);new MutationObserver(()=>{const F=l.offsetWidth+(g=>parseInt(window.getComputedStyle(g).marginLeft)+parseInt(window.getComputedStyle(g).marginRight))(l);Y().style.width=F>g?`${F}px`:null}).observe(l,{attributes:!0,attributeFilter:["style"]})}}),l};const Gl=(l,u)=>{const f=Vs();We(f,u,"htmlContainer"),u.html?(Us(u.html,f),U(f,"block")):u.text?(f.textContent=u.text,U(f,"block")):ke(f),((l,u)=>{const f=Y(),g=B.innerParams.get(l),x=!g||u.input!==g.input;Fo.forEach(F=>{const ee=gt(f,C[F]);zs(F,u.inputAttributes),ee.className=C[F],x&&ke(ee)}),u.input&&(x&&$s(u),ql(u))})(l,u)},Lo=(l,u)=>{for(const f in _t)u.icon!==f&&Qe(l,_t[f]);w(l,_t[u.icon]),Bo(l,u),Or(),We(l,u,"icon")},Or=()=>{const l=Y(),u=window.getComputedStyle(l).getPropertyValue("background-color"),f=l.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let g=0;g<f.length;g++)f[g].style.backgroundColor=u},Zs=(l,u)=>{let g,f=l.innerHTML;u.iconHtml?g=Ln(u.iconHtml):"success"===u.icon?(g='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',f=f.replace(/ style=".*?"/g,"")):g="error"===u.icon?'\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n':Ln({question:"?",warning:"!",info:"i"}[u.icon]),f.trim()!==g.trim()&&Re(l,g)},Bo=(l,u)=>{if(u.iconColor){l.style.color=u.iconColor,l.style.borderColor=u.iconColor;for(const f of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])ht(l,f,"backgroundColor",u.iconColor);ht(l,".swal2-success-ring","borderColor",u.iconColor)}},Ln=l=>`<div class="${C["icon-content"]}">${l}</div>`,Js=(l,u)=>{l.className=`${C.popup} ${Be(l)?u.showClass.popup:""}`,u.toast?(w([document.documentElement,document.body],C["toast-shown"]),w(l,C.toast)):w(l,C.modal),We(l,u,"popup"),"string"==typeof u.customClass&&w(l,u.customClass),u.icon&&w(l,C[`icon-${u.icon}`])},Uo=l=>{const u=document.createElement("li");return w(u,C["progress-step"]),Re(u,l),u},qo=l=>{const u=document.createElement("li");return w(u,C["progress-step-line"]),l.progressStepsDistance&&tt(u,"width",l.progressStepsDistance),u},ti=(l,u)=>{((l,u)=>{const f=fe(),g=Y();u.toast?(tt(f,"width",u.width),g.style.width="100%",g.insertBefore(Ct(),Tr())):tt(g,"width",u.width),tt(g,"padding",u.padding),u.color&&(g.style.color=u.color),u.background&&(g.style.background=u.background),ke(Ps()),Js(g,u)})(0,u),Vo(0,u),((l,u)=>{const f=So();u.progressSteps&&0!==u.progressSteps.length?(U(f),f.textContent="",u.currentProgressStep>=u.progressSteps.length&&d("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),u.progressSteps.forEach((g,x)=>{const F=Uo(g);if(f.appendChild(F),x===u.currentProgressStep&&w(F,C["active-progress-step"]),x!==u.progressSteps.length-1){const ee=qo(u);f.appendChild(ee)}})):ke(f)})(0,u),((l,u)=>{const f=B.innerParams.get(l),g=Tr();f&&u.icon===f.icon?(Zs(g,u),Lo(g,u)):u.icon||u.iconHtml?u.icon&&-1===Object.keys(_t).indexOf(u.icon)?(be(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${u.icon}"`),ke(g)):(U(g),Zs(g,u),Lo(g,u),w(g,u.showClass.icon)):ke(g)})(l,u),((l,u)=>{const f=kl();u.imageUrl?(U(f,""),f.setAttribute("src",u.imageUrl),f.setAttribute("alt",u.imageAlt),tt(f,"width",u.imageWidth),tt(f,"height",u.imageHeight),f.className=C.image,We(f,u,"image")):ke(f)})(0,u),((l,u)=>{const f=Io();N(f,u.title||u.titleText,"block"),u.title&&Us(u.title,f),u.titleText&&(f.innerText=u.titleText),We(f,u,"title")})(0,u),((l,u)=>{const f=Ls();Re(f,u.closeButtonHtml),We(f,u,"closeButton"),N(f,u.showCloseButton),f.setAttribute("aria-label",u.closeButtonAriaLabel)})(0,u),Gl(l,u),dt(0,u),((l,u)=>{const f=Do();N(f,u.footer),u.footer&&Us(u.footer,f),We(f,u,"footer")})(0,u),"function"==typeof u.didRender&&u.didRender(Y())};function ni(){const l=B.innerParams.get(this);if(!l)return;const u=B.domCache.get(this);ke(u.loader),Yt()?l.icon&&U(Tr()):ri(u),Qe([u.popup,u.actions],C.loading),u.popup.removeAttribute("aria-busy"),u.popup.removeAttribute("data-loading"),u.confirmButton.disabled=!1,u.denyButton.disabled=!1,u.cancelButton.disabled=!1}const ri=l=>{const u=l.popup.getElementsByClassName(l.loader.getAttribute("data-button-to-replace"));u.length?U(u[0],"inline-block"):!Be(ct())&&!Be(Nt())&&!Be(Zt())&&ke(l.actions)};const Vr=()=>ct()&&ct().click(),ie=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),xe=l=>{l.keydownTarget&&l.keydownHandlerAdded&&(l.keydownTarget.removeEventListener("keydown",l.keydownHandler,{capture:l.keydownListenerCapture}),l.keydownHandlerAdded=!1)},Rn=(l,u)=>{const f=Ir();if(f.length)return(l+=u)===f.length?l=0:-1===l&&(l=f.length-1),void f[l].focus();Y().focus()},jo=["ArrowRight","ArrowDown"],zl=["ArrowLeft","ArrowUp"],$o=(l,u,f)=>{const g=B.innerParams.get(l);g&&(u.isComposing||229===u.keyCode||(g.stopKeydownPropagation&&u.stopPropagation(),"Enter"===u.key?Hl(l,u,g):"Tab"===u.key?Wl(u):[...jo,...zl].includes(u.key)?Ko(u.key):"Escape"===u.key&&oi(u,g,f)))},Hl=(l,u,f)=>{if(Er(f.allowEnterKey)&&u.target&&l.getInput()&&u.target instanceof HTMLElement&&u.target.outerHTML===l.getInput().outerHTML){if(["textarea","file"].includes(f.input))return;Vr(),u.preventDefault()}},Wl=l=>{const u=l.target,f=Ir();let g=-1;for(let x=0;x<f.length;x++)if(u===f[x]){g=x;break}Rn(g,l.shiftKey?-1:1),l.stopPropagation(),l.preventDefault()},Ko=l=>{const u=ct(),f=Nt(),g=Zt();if(document.activeElement instanceof HTMLElement&&![u,f,g].includes(document.activeElement))return;const F=jo.includes(l)?"nextElementSibling":"previousElementSibling";let ee=document.activeElement;for(let ze=0;ze<Nn().children.length;ze++){if(ee=ee[F],!ee)return;if(ee instanceof HTMLButtonElement&&Be(ee))break}ee instanceof HTMLButtonElement&&ee.focus()},oi=(l,u,f)=>{Er(u.allowEscapeKey)&&(l.preventDefault(),f(ie.esc))};var Bn={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const li=()=>{Array.from(document.body.children).forEach(u=>{u.hasAttribute("data-previous-aria-hidden")?(u.setAttribute("aria-hidden",u.getAttribute("data-previous-aria-hidden")),u.removeAttribute("data-previous-aria-hidden")):u.removeAttribute("aria-hidden")})},Fr=()=>{const l=navigator.userAgent,u=!!l.match(/iPad/i)||!!l.match(/iPhone/i),f=!!l.match(/WebKit/i);u&&f&&!l.match(/CriOS/i)&&Y().scrollHeight>window.innerHeight-44&&(fe().style.paddingBottom="44px")},ui=()=>{const l=fe();let u;l.ontouchstart=f=>{u=ci(f)},l.ontouchmove=f=>{u&&(f.preventDefault(),f.stopPropagation())}},ci=l=>{const u=l.target,f=fe();return!zo(l)&&!Zl(l)&&(u===f||!Vn(f)&&u instanceof HTMLElement&&"INPUT"!==u.tagName&&"TEXTAREA"!==u.tagName&&!(Vn(Vs())&&Vs().contains(u)))},zo=l=>l.touches&&l.touches.length&&"stylus"===l.touches[0].touchType,Zl=l=>l.touches&&l.touches.length>1,Un=()=>{if(ot(document.body,C.iosfix)){const l=parseInt(document.body.style.top,10);Qe(document.body,C.iosfix),document.body.style.top="",document.body.scrollTop=-1*l}},Ho=()=>{null===Ot.previousBodyPadding&&document.body.scrollHeight>window.innerHeight&&(Ot.previousBodyPadding=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Ot.previousBodyPadding+(()=>{const l=document.createElement("div");l.className=C["scrollbar-measure"],document.body.appendChild(l);const u=l.getBoundingClientRect().width-l.clientWidth;return document.body.removeChild(l),u})()}px`)},Wo=()=>{null!==Ot.previousBodyPadding&&(document.body.style.paddingRight=`${Ot.previousBodyPadding}px`,Ot.previousBodyPadding=null)};function hi(l,u,f,g){Yt()?di(l,g):(Ll(f).then(()=>di(l,g)),xe(K)),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?(u.setAttribute("style","display:none !important"),u.removeAttribute("class"),u.innerHTML=""):u.remove(),$e()&&(Wo(),Un(),li()),function Lr(){Qe([document.documentElement,document.body],[C.shown,C["height-auto"],C["no-backdrop"],C["toast-shown"]])}()}function Rr(l){l=Lt(l);const u=Bn.swalPromiseResolve.get(this),f=en(this);this.isAwaitingPromise()?l.isDismissed||(qn(this),u(l)):f&&u(l)}const en=l=>{const u=Y();if(!u)return!1;const f=B.innerParams.get(l);if(!f||ot(u,f.hideClass.popup))return!1;Qe(u,f.showClass.popup),w(u,f.hideClass.popup);const g=fe();return Qe(g,f.showClass.backdrop),w(g,f.hideClass.backdrop),Qo(l,u,f),!0};const qn=l=>{l.isAwaitingPromise()&&(B.awaitingPromise.delete(l),B.innerParams.get(l)||l._destroy())},Lt=l=>typeof l>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},l),Qo=(l,u,f)=>{const g=fe(),x=Pt&&Pn(u);"function"==typeof f.willClose&&f.willClose(u),x?Br(l,u,g,f.returnFocus,f.didClose):hi(l,g,f.returnFocus,f.didClose)},Br=(l,u,f,g,x)=>{K.swalCloseEventFinishedCallback=hi.bind(null,l,f,g,x),u.addEventListener(Pt,function(F){F.target===u&&(K.swalCloseEventFinishedCallback(),delete K.swalCloseEventFinishedCallback)})},di=(l,u)=>{setTimeout(()=>{"function"==typeof u&&u.bind(l.params)(),l._destroy()})};function tn(l,u,f){const g=B.domCache.get(l);u.forEach(x=>{g[x].disabled=f})}function fi(l,u){if(l)if("radio"===l.type){const g=l.parentNode.parentNode.querySelectorAll("input");for(let x=0;x<g.length;x++)g[x].disabled=u}else l.disabled=u}const Rt={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},Xo=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],jn={},mi=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],qr=l=>Object.prototype.hasOwnProperty.call(Rt,l),Gr=l=>-1!==Xo.indexOf(l),nn=l=>jn[l],$n=l=>{qr(l)||d(`Unknown parameter "${l}"`)},Jo=l=>{mi.includes(l)&&d(`The parameter "${l}" is incompatible with toasts`)},Jl=l=>{nn(l)&&je(l,nn(l))};const yi=l=>{const u={};return Object.keys(l).forEach(f=>{Gr(f)?u[f]=l[f]:d(`Invalid parameter to update: ${f}`)}),u};const ta=l=>{wi(l),delete l.params,delete K.keydownHandler,delete K.keydownTarget,delete K.currentInstance},wi=l=>{l.isAwaitingPromise()?(vi(B,l),B.awaitingPromise.set(l,!0)):(vi(Bn,l),vi(B,l))},vi=(l,u)=>{for(const f in l)l[f].delete(u)};var rn=Object.freeze({__proto__:null,_destroy:function ea(){const l=B.domCache.get(this),u=B.innerParams.get(this);u?(l.popup&&K.swalCloseEventFinishedCallback&&(K.swalCloseEventFinishedCallback(),delete K.swalCloseEventFinishedCallback),"function"==typeof u.didDestroy&&u.didDestroy(),ta(this)):wi(this)},close:Rr,closeModal:Rr,closePopup:Rr,closeToast:Rr,disableButtons:function Zo(){tn(this,["confirmButton","denyButton","cancelButton"],!0)},disableInput:function Ur(){fi(this.getInput(),!0)},disableLoading:ni,enableButtons:function Ue(){tn(this,["confirmButton","denyButton","cancelButton"],!1)},enableInput:function Gn(){fi(this.getInput(),!1)},getInput:function Go(l){const u=B.innerParams.get(l||this),f=B.domCache.get(l||this);return f?Xt(f.popup,u.input):null},handleAwaitingPromise:qn,hideLoading:ni,isAwaitingPromise:function Yl(){return!!B.awaitingPromise.get(this)},rejectPromise:function Xl(l){const u=Bn.swalPromiseReject.get(this);qn(this),u&&u(l)},resetValidationMessage:function pi(){const l=B.domCache.get(this);l.validationMessage&&ke(l.validationMessage);const u=this.getInput();u&&(u.removeAttribute("aria-invalid"),u.removeAttribute("aria-describedby"),Qe(u,C.inputerror))},showValidationMessage:function Yo(l){const u=B.domCache.get(this),f=B.innerParams.get(this);Re(u.validationMessage,l),u.validationMessage.className=C["validation-message"],f.customClass&&f.customClass.validationMessage&&w(u.validationMessage,f.customClass.validationMessage),U(u.validationMessage);const g=this.getInput();g&&(g.setAttribute("aria-invalid",!0),g.setAttribute("aria-describedby",C["validation-message"]),Vl(g),w(g,C.inputerror))},update:function jr(l){const u=Y(),f=B.innerParams.get(this);if(!u||ot(u,f.hideClass.popup))return void d("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");const g=yi(l),x=Object.assign({},f,g);ti(this,x),B.innerParams.set(this,x),Object.defineProperties(this,{params:{value:Object.assign({},this.params,l),writable:!1,enumerable:!0}})}});const Bt=l=>{let u=Y();u||new Et,u=Y();const f=Ct();Yt()?ke(Tr()):$r(u,l),U(f),u.setAttribute("data-loading","true"),u.setAttribute("aria-busy","true"),u.focus()},$r=(l,u)=>{const f=Nn(),g=Ct();!u&&Be(ct())&&(u=ct()),U(f),u&&(ke(u),g.setAttribute("data-button-to-replace",u.className)),g.parentNode.insertBefore(g,u),w([l,f],C.loading)},_i=l=>l.checked?1:0,eu=l=>l.checked?l.value:null,tu=l=>l.files.length?null!==l.getAttribute("multiple")?l.files:l.files[0]:null,na=(l,u)=>{const f=Y(),g=x=>{nu[u.input](f,yt(x),u)};Os(u.inputOptions)||bt(u.inputOptions)?(Bt(ct()),Mn(u.inputOptions).then(x=>{l.hideLoading(),g(x)})):"object"==typeof u.inputOptions?g(u.inputOptions):be("Unexpected type of inputOptions! Expected object, Map or Promise, got "+typeof u.inputOptions)},ra=(l,u)=>{const f=l.getInput();ke(f),Mn(u.inputValue).then(g=>{f.value="number"===u.input?`${parseFloat(g)||0}`:`${g}`,U(f),f.focus(),l.hideLoading()}).catch(g=>{be(`Error in inputValue promise: ${g}`),f.value="",U(f),f.focus(),l.hideLoading()})},nu={select:(l,u,f)=>{const g=gt(l,C.select),x=(F,ee,ze)=>{const pe=document.createElement("option");pe.value=ze,Re(pe,ee),pe.selected=ft(ze,f.inputValue),F.appendChild(pe)};u.forEach(F=>{const ee=F[0],ze=F[1];if(Array.isArray(ze)){const pe=document.createElement("optgroup");pe.label=ee,pe.disabled=!1,g.appendChild(pe),ze.forEach(jt=>x(pe,jt[1],jt[0]))}else x(g,ze,ee)}),g.focus()},radio:(l,u,f)=>{const g=gt(l,C.radio);u.forEach(F=>{const ee=F[0],ze=F[1],pe=document.createElement("input"),jt=document.createElement("label");pe.type="radio",pe.name=C.radio,pe.value=ee,ft(ee,f.inputValue)&&(pe.checked=!0);const ts=document.createElement("span");Re(ts,ze),ts.className=C.label,jt.appendChild(pe),jt.appendChild(ts),g.appendChild(jt)});const x=g.querySelectorAll("input");x.length&&x[0].focus()}},yt=l=>{const u=[];return typeof Map<"u"&&l instanceof Map?l.forEach((f,g)=>{let x=f;"object"==typeof x&&(x=yt(x)),u.push([g,x])}):Object.keys(l).forEach(f=>{let g=l[f];"object"==typeof g&&(g=yt(g)),u.push([f,g])}),u},ft=(l,u)=>u&&u.toString()===l.toString(),re=(l,u)=>{const f=B.innerParams.get(l);if(!f.input)return void be(`The "input" parameter is needed to be set when using returnInputValueOn${Me(u)}`);const g=((l,u)=>{const f=l.getInput();if(!f)return null;switch(u.input){case"checkbox":return _i(f);case"radio":return eu(f);case"file":return tu(f);default:return u.inputAutoTrim?f.value.trim():f.value}})(l,f);f.inputValidator?Hr(l,g,u):l.getInput().checkValidity()?"deny"===u?qt(l,g):Wr(l,g):(l.enableButtons(),l.showValidationMessage(f.validationMessage))},Hr=(l,u,f)=>{const g=B.innerParams.get(l);l.disableInput(),Promise.resolve().then(()=>Mn(g.inputValidator(u,g.validationMessage))).then(F=>{l.enableButtons(),l.enableInput(),F?l.showValidationMessage(F):"deny"===f?qt(l,u):Wr(l,u)})},qt=(l,u)=>{const f=B.innerParams.get(l||void 0);f.showLoaderOnDeny&&Bt(Nt()),f.preDeny?(B.awaitingPromise.set(l||void 0,!0),Promise.resolve().then(()=>Mn(f.preDeny(u,f.validationMessage))).then(x=>{!1===x?(l.hideLoading(),qn(l)):l.close({isDenied:!0,value:typeof x>"u"?u:x})}).catch(x=>ia(l||void 0,x))):l.close({isDenied:!0,value:u})},sn=(l,u)=>{l.close({isConfirmed:!0,value:u})},ia=(l,u)=>{l.rejectPromise(u)},Wr=(l,u)=>{const f=B.innerParams.get(l||void 0);f.showLoaderOnConfirm&&Bt(),f.preConfirm?(l.resetValidationMessage(),B.awaitingPromise.set(l||void 0,!0),Promise.resolve().then(()=>Mn(f.preConfirm(u,f.validationMessage))).then(x=>{Be(Ps())||!1===x?(l.hideLoading(),qn(l)):sn(l,typeof x>"u"?u:x)}).catch(x=>ia(l||void 0,x))):sn(l,u)},su=(l,u,f)=>{u.popup.onclick=()=>{const g=B.innerParams.get(l);g&&(iu(g)||g.timer||g.input)||f(ie.close)}},iu=l=>l.showConfirmButton||l.showDenyButton||l.showCancelButton||l.showCloseButton;let Qr=!1;const zn=l=>{l.popup.onmousedown=()=>{l.container.onmouseup=function(u){l.container.onmouseup=void 0,u.target===l.container&&(Qr=!0)}}},xt=l=>{l.container.onmousedown=()=>{l.popup.onmouseup=function(u){l.popup.onmouseup=void 0,(u.target===l.popup||l.popup.contains(u.target))&&(Qr=!0)}}},oa=(l,u,f)=>{u.container.onclick=g=>{const x=B.innerParams.get(l);Qr?Qr=!1:g.target===u.container&&Er(x.allowOutsideClick)&&f(ie.backdrop)}},bi=l=>l instanceof Element||(l=>"object"==typeof l&&l.jquery)(l);const ua=()=>{if(K.timeout)return(()=>{const l=Ar(),u=parseInt(window.getComputedStyle(l).width);l.style.removeProperty("transition"),l.style.width="100%";const f=parseInt(window.getComputedStyle(l).width);l.style.width=u/f*100+"%"})(),K.timeout.stop()},Ci=()=>{if(K.timeout){const l=K.timeout.start();return Vt(l),l}};let Ti=!1;const Zr={};const lu=l=>{for(let u=l.target;u&&u!==document;u=u.parentNode)for(const f in Zr){const g=u.getAttribute(f);if(g)return void Zr[f].fire({template:g})}};var uu=Object.freeze({__proto__:null,argsToParams:l=>{const u={};return"object"!=typeof l[0]||bi(l[0])?["title","html","icon"].forEach((f,g)=>{const x=l[g];"string"==typeof x||bi(x)?u[f]=x:void 0!==x&&be(`Unexpected type of ${f}! Expected "string" or "Element", got ${typeof x}`)}):Object.assign(u,l[0]),u},bindClickHandler:function Ai(){Zr[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,Ti||(document.body.addEventListener("click",lu),Ti=!0)},clickCancel:()=>Zt()&&Zt().click(),clickConfirm:Vr,clickDeny:()=>Nt()&&Nt().click(),enableLoading:Bt,fire:function ou(){for(var u=arguments.length,f=new Array(u),g=0;g<u;g++)f[g]=arguments[g];return new this(...f)},getActions:Nn,getCancelButton:Zt,getCloseButton:Ls,getConfirmButton:ct,getContainer:fe,getDenyButton:Nt,getFocusableElements:Ir,getFooter:Do,getHtmlContainer:Vs,getIcon:Tr,getIconContent:()=>se(C["icon-content"]),getImage:kl,getInputLabel:()=>se(C["input-label"]),getLoader:Ct,getPopup:Y,getProgressSteps:So,getTimerLeft:()=>K.timeout&&K.timeout.getTimerLeft(),getTimerProgressBar:Ar,getTitle:Io,getValidationMessage:Ps,increaseTimer:l=>{if(K.timeout){const u=K.timeout.increase(l);return Vt(u,!0),u}},isDeprecatedParameter:nn,isLoading:()=>Y().hasAttribute("data-loading"),isTimerRunning:()=>K.timeout&&K.timeout.isRunning(),isUpdatableParameter:Gr,isValidParameter:qr,isVisible:()=>Be(Y()),mixin:function au(l){return class u extends(this){_main(g,x){return super._main(g,Object.assign({},l,x))}}},resumeTimer:Ci,showLoading:Bt,stopTimer:ua,toggleTimer:()=>{const l=K.timeout;return l&&(l.running?ua():Ci())}});class cu{constructor(u,f){this.callback=u,this.remaining=f,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}increase(u){const f=this.running;return f&&this.stop(),this.remaining+=u,f&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const Hn=["swal-title","swal-html","swal-footer"],Yr=l=>{const u={};return Array.from(l.querySelectorAll("swal-param")).forEach(g=>{Gt(g,["name","value"]);const x=g.getAttribute("name"),F=g.getAttribute("value");u[x]="boolean"==typeof Rt[x]?"false"!==F:"object"==typeof Rt[x]?JSON.parse(F):F}),u},Ii=l=>{const u={};return Array.from(l.querySelectorAll("swal-function-param")).forEach(g=>{const x=g.getAttribute("name"),F=g.getAttribute("value");u[x]=new Function(`return ${F}`)()}),u},ha=l=>{const u={};return Array.from(l.querySelectorAll("swal-button")).forEach(g=>{Gt(g,["type","color","aria-label"]);const x=g.getAttribute("type");u[`${x}ButtonText`]=g.innerHTML,u[`show${Me(x)}Button`]=!0,g.hasAttribute("color")&&(u[`${x}ButtonColor`]=g.getAttribute("color")),g.hasAttribute("aria-label")&&(u[`${x}ButtonAriaLabel`]=g.getAttribute("aria-label"))}),u},Qn=l=>{const u={},f=l.querySelector("swal-image");return f&&(Gt(f,["src","width","height","alt"]),f.hasAttribute("src")&&(u.imageUrl=f.getAttribute("src")),f.hasAttribute("width")&&(u.imageWidth=f.getAttribute("width")),f.hasAttribute("height")&&(u.imageHeight=f.getAttribute("height")),f.hasAttribute("alt")&&(u.imageAlt=f.getAttribute("alt"))),u},Zn=l=>{const u={},f=l.querySelector("swal-icon");return f&&(Gt(f,["type","color"]),f.hasAttribute("type")&&(u.icon=f.getAttribute("type")),f.hasAttribute("color")&&(u.iconColor=f.getAttribute("color")),u.iconHtml=f.innerHTML),u},hu=l=>{const u={},f=l.querySelector("swal-input");f&&(Gt(f,["type","label","placeholder","value"]),u.input=f.getAttribute("type")||"text",f.hasAttribute("label")&&(u.inputLabel=f.getAttribute("label")),f.hasAttribute("placeholder")&&(u.inputPlaceholder=f.getAttribute("placeholder")),f.hasAttribute("value")&&(u.inputValue=f.getAttribute("value")));const g=Array.from(l.querySelectorAll("swal-input-option"));return g.length&&(u.inputOptions={},g.forEach(x=>{Gt(x,["value"]);const F=x.getAttribute("value");u.inputOptions[F]=x.innerHTML})),u},ce=(l,u)=>{const f={};for(const g in u){const x=u[g],F=l.querySelector(x);F&&(Gt(F,[]),f[x.replace(/^swal-/,"")]=F.innerHTML.trim())}return f},da=l=>{const u=Hn.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(l.children).forEach(f=>{const g=f.tagName.toLowerCase();u.includes(g)||d(`Unrecognized element <${g}>`)})},Gt=(l,u)=>{Array.from(l.attributes).forEach(f=>{-1===u.indexOf(f.name)&&d([`Unrecognized attribute "${f.name}" on <${l.tagName.toLowerCase()}>.`,u.length?`Allowed attributes are: ${u.join(", ")}`:"To set the value, use HTML within the element."])})},du=l=>{const u=fe(),f=Y();"function"==typeof l.willOpen&&l.willOpen(f);const x=window.getComputedStyle(document.body).overflowY;Xr(u,f,l),setTimeout(()=>{pa(u,f)},10),$e()&&(ma(u,l.scrollbarPadding,x),Array.from(document.body.children).forEach(u=>{u===fe()||u.contains(fe())||(u.hasAttribute("aria-hidden")&&u.setAttribute("data-previous-aria-hidden",u.getAttribute("aria-hidden")),u.setAttribute("aria-hidden","true"))})),!Yt()&&!K.previousActiveElement&&(K.previousActiveElement=document.activeElement),"function"==typeof l.didOpen&&setTimeout(()=>l.didOpen(f)),Qe(u,C["no-transition"])},Si=l=>{const u=Y();if(l.target!==u)return;const f=fe();u.removeEventListener(Pt,Si),f.style.overflowY="auto"},pa=(l,u)=>{Pt&&Pn(u)?(l.style.overflowY="hidden",u.addEventListener(Pt,Si)):l.style.overflowY="auto"},ma=(l,u,f)=>{(()=>{if((/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!ot(document.body,C.iosfix)){const u=document.body.scrollTop;document.body.style.top=-1*u+"px",w(document.body,C.iosfix),ui(),Fr()}})(),u&&"hidden"!==f&&Ho(),setTimeout(()=>{l.scrollTop=0})},Xr=(l,u,f)=>{w(l,f.showClass.backdrop),u.style.setProperty("opacity","0","important"),U(u,"grid"),setTimeout(()=>{w(u,f.showClass.popup),u.style.removeProperty("opacity")},10),w([document.documentElement,document.body],C.shown),f.heightAuto&&f.backdrop&&!f.toast&&w([document.documentElement,document.body],C["height-auto"])};var Di={email:(l,u)=>/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(l)?Promise.resolve():Promise.resolve(u||"Invalid email address"),url:(l,u)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(l)?Promise.resolve():Promise.resolve(u||"Invalid URL")};function ya(l){(function wt(l){l.inputValidator||Object.keys(Di).forEach(u=>{l.input===u&&(l.inputValidator=Di[u])})})(l),l.showLoaderOnConfirm&&!l.preConfirm&&d("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),function ga(l){(!l.target||"string"==typeof l.target&&!document.querySelector(l.target)||"string"!=typeof l.target&&!l.target.appendChild)&&(d('Target parameter is not valid, defaulting to "body"'),l.target="body")}(l),"string"==typeof l.title&&(l.title=l.title.split("\n").join("<br />")),Ne(l)}let nt;class pt{constructor(){if(typeof window>"u")return;nt=this;for(var u=arguments.length,f=new Array(u),g=0;g<u;g++)f[g]=arguments[g];const x=Object.freeze(this.constructor.argsToParams(f));Object.defineProperties(this,{params:{value:x,writable:!1,enumerable:!0,configurable:!0}});const F=nt._main(nt.params);B.promise.set(this,F)}_main(u){let f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(l=>{!1===l.backdrop&&l.allowOutsideClick&&d('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`');for(const u in l)$n(u),l.toast&&Jo(u),Jl(u)})(Object.assign({},f,u)),K.currentInstance&&(K.currentInstance._destroy(),$e()&&li()),K.currentInstance=nt;const g=Mi(u,f);ya(g),Object.freeze(g),K.timeout&&(K.timeout.stop(),delete K.timeout),clearTimeout(K.restoreFocusTimeout);const x=Jr(nt);return ti(nt,g),B.innerParams.set(nt,g),wa(nt,x,g)}then(u){return B.promise.get(this).then(u)}finally(u){return B.promise.get(this).finally(u)}}const wa=(l,u,f)=>new Promise((g,x)=>{const F=ee=>{l.close({isDismissed:!0,dismiss:ee})};Bn.swalPromiseResolve.set(l,g),Bn.swalPromiseReject.set(l,x),u.confirmButton.onclick=()=>{(l=>{const u=B.innerParams.get(l);l.disableButtons(),u.input?re(l,"confirm"):Wr(l,!0)})(l)},u.denyButton.onclick=()=>{(l=>{const u=B.innerParams.get(l);l.disableButtons(),u.returnInputValueOnDeny?re(l,"deny"):qt(l,!1)})(l)},u.cancelButton.onclick=()=>{((l,u)=>{l.disableButtons(),u(ie.cancel)})(l,F)},u.closeButton.onclick=()=>{F(ie.close)},((l,u,f)=>{B.innerParams.get(l).toast?su(l,u,f):(zn(u),xt(u),oa(l,u,f))})(l,u,F),((l,u,f,g)=>{xe(u),f.toast||(u.keydownHandler=x=>$o(l,x,g),u.keydownTarget=f.keydownListenerCapture?window:Y(),u.keydownListenerCapture=f.keydownListenerCapture,u.keydownTarget.addEventListener("keydown",u.keydownHandler,{capture:u.keydownListenerCapture}),u.keydownHandlerAdded=!0)})(l,K,f,F),((l,u)=>{"select"===u.input||"radio"===u.input?na(l,u):["text","email","number","tel","textarea"].includes(u.input)&&(Os(u.inputValue)||bt(u.inputValue))&&(Bt(ct()),ra(l,u))})(l,f),du(f),va(K,f,F),es(u,f),setTimeout(()=>{u.container.scrollTop=0})}),Mi=(l,u)=>{const f=(l=>{const u="string"==typeof l.template?document.querySelector(l.template):l.template;if(!u)return{};const f=u.content;return da(f),Object.assign(Yr(f),Ii(f),ha(f),Qn(f),Zn(f),hu(f),ce(f,Hn))})(l),g=Object.assign({},Rt,u,f,l);return g.showClass=Object.assign({},Rt.showClass,g.showClass),g.hideClass=Object.assign({},Rt.hideClass,g.hideClass),g},Jr=l=>{const u={popup:Y(),container:fe(),actions:Nn(),confirmButton:ct(),denyButton:Nt(),cancelButton:Zt(),loader:Ct(),closeButton:Ls(),validationMessage:Ps(),progressSteps:So()};return B.domCache.set(l,u),u},va=(l,u,f)=>{const g=Ar();ke(g),u.timer&&(l.timeout=new cu(()=>{f("timer"),delete l.timeout},u.timer),u.timerProgressBar&&(U(g),We(g,u,"timerProgressBar"),setTimeout(()=>{l.timeout&&l.timeout.running&&Vt(u.timer)})))},es=(l,u)=>{if(!u.toast){if(!Er(u.allowEnterKey))return void _a();fu(l,u)||Rn(-1,1)}},fu=(l,u)=>u.focusDeny&&Be(l.denyButton)?(l.denyButton.focus(),!0):u.focusCancel&&Be(l.cancelButton)?(l.cancelButton.focus(),!0):!(!u.focusConfirm||!Be(l.confirmButton)||(l.confirmButton.focus(),0)),_a=()=>{document.activeElement instanceof HTMLElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|xn--p1ai)$/)){const l=new Date,u=localStorage.getItem("swal-initiation");u?(l.getTime()-Date.parse(u))/864e5>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const f=document.createElement("audio");f.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",f.loop=!0,document.body.appendChild(f),setTimeout(()=>{f.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${l}`)}Object.assign(pt.prototype,rn),Object.assign(pt,uu),Object.keys(rn).forEach(l=>{pt[l]=function(){if(nt)return nt[l](...arguments)}}),pt.DismissReason=ie,pt.version="11.7.3";const Et=pt;return Et.default=Et,Et}(),typeof this<"u"&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),typeof document<"u"&&function(B,G){var Le=B.createElement("style");if(B.getElementsByTagName("head")[0].appendChild(Le),Le.styleSheet)Le.styleSheet.disabled||(Le.styleSheet.cssText=G);else try{Le.innerHTML=G}catch{Le.innerText=G}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;transform:rotate(45deg);border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}.swal2-container{display:grid;position:fixed;z-index:1060;top:0;right:0;bottom:0;left:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}.swal2-container.swal2-backdrop-show,.swal2-container.swal2-noanimation{background:rgba(0,0,0,.4)}.swal2-container.swal2-backdrop-hide{background:rgba(0,0,0,0) !important}.swal2-container.swal2-top-start,.swal2-container.swal2-center-start,.swal2-container.swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}.swal2-container.swal2-top,.swal2-container.swal2-center,.swal2-container.swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}.swal2-container.swal2-top-end,.swal2-container.swal2-center-end,.swal2-container.swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}.swal2-container.swal2-top-start>.swal2-popup{align-self:start}.swal2-container.swal2-top>.swal2-popup{grid-column:2;align-self:start;justify-self:center}.swal2-container.swal2-top-end>.swal2-popup,.swal2-container.swal2-top-right>.swal2-popup{grid-column:3;align-self:start;justify-self:end}.swal2-container.swal2-center-start>.swal2-popup,.swal2-container.swal2-center-left>.swal2-popup{grid-row:2;align-self:center}.swal2-container.swal2-center>.swal2-popup{grid-column:2;grid-row:2;align-self:center;justify-self:center}.swal2-container.swal2-center-end>.swal2-popup,.swal2-container.swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;align-self:center;justify-self:end}.swal2-container.swal2-bottom-start>.swal2-popup,.swal2-container.swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}.swal2-container.swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;justify-self:center;align-self:end}.swal2-container.swal2-bottom-end>.swal2-popup,.swal2-container.swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;align-self:end;justify-self:end}.swal2-container.swal2-grow-row>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}.swal2-container.swal2-grow-column>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}.swal2-container.swal2-no-transition{transition:none !important}.swal2-popup{display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}.swal2-popup:focus{outline:none}.swal2-popup.swal2-loading{overflow-y:hidden}.swal2-title{position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}.swal2-actions{display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}.swal2-actions:not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}.swal2-actions:not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}.swal2-actions:not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}.swal2-loader{display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}.swal2-styled{margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}.swal2-styled:not([disabled]){cursor:pointer}.swal2-styled.swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}.swal2-styled.swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}.swal2-styled.swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}.swal2-styled.swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}.swal2-styled.swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}.swal2-styled.swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}.swal2-styled.swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}.swal2-styled:focus{outline:none}.swal2-styled::-moz-focus-inner{border:0}.swal2-footer{justify-content:center;margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em}.swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}.swal2-timer-progress-bar{width:100%;height:.25em;background:rgba(0,0,0,.2)}.swal2-image{max-width:100%;margin:2em auto 1em}.swal2-close{z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:serif;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}.swal2-close:hover{transform:none;background:rgba(0,0,0,0);color:#f27474}.swal2-close:focus{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}.swal2-close::-moz-focus-inner{border:0}.swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}.swal2-input,.swal2-file,.swal2-textarea,.swal2-select,.swal2-radio,.swal2-checkbox{margin:1em 2em 3px}.swal2-input,.swal2-file,.swal2-textarea{box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}.swal2-input.swal2-inputerror,.swal2-file.swal2-inputerror,.swal2-textarea.swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}.swal2-input:focus,.swal2-file:focus,.swal2-textarea:focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}.swal2-input::placeholder,.swal2-file::placeholder,.swal2-textarea::placeholder{color:#ccc}.swal2-range{margin:1em 2em 3px;background:#fff}.swal2-range input{width:80%}.swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}.swal2-range input,.swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}.swal2-input{height:2.625em;padding:0 .75em}.swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}.swal2-textarea{height:6.75em;padding:.75em}.swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}.swal2-radio,.swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}.swal2-radio label,.swal2-checkbox label{margin:0 .6em;font-size:1.125em}.swal2-radio input,.swal2-checkbox input{flex-shrink:0;margin:0 .4em}.swal2-input-label{display:flex;justify-content:center;margin:1em auto 0}.swal2-validation-message{align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}.swal2-validation-message::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}.swal2-icon{position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}.swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}.swal2-icon.swal2-error{border-color:#f27474;color:#f27474}.swal2-icon.swal2-error .swal2-x-mark{position:relative;flex-grow:1}.swal2-icon.swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}.swal2-icon.swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}.swal2-icon.swal2-warning{border-color:#facea8;color:#f8bb86}.swal2-icon.swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}.swal2-icon.swal2-info{border-color:#9de0f6;color:#3fc3ee}.swal2-icon.swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}.swal2-icon.swal2-question{border-color:#c9dae1;color:#87adbd}.swal2-icon.swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}.swal2-icon.swal2-success{border-color:#a5dc86;color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;transform:rotate(45deg);border-radius:50%}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}.swal2-icon.swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}.swal2-icon.swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}.swal2-icon.swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}.swal2-icon.swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}.swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}.swal2-progress-steps li{display:inline-block;position:relative}.swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}.swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{top:0;right:auto;bottom:auto;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{top:0;right:0;bottom:auto;left:auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{top:0;right:auto;bottom:auto;left:0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{top:50%;right:auto;bottom:auto;left:0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{top:50%;right:auto;bottom:auto;left:50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{top:50%;right:0;bottom:auto;left:auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{top:auto;right:auto;bottom:0;left:0}body.swal2-toast-shown .swal2-container.swal2-bottom{top:auto;right:auto;bottom:0;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{top:auto;right:0;bottom:0;left:auto}')}}]);